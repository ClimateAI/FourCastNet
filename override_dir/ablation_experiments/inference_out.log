2023-07-25 01:12:57,563 - root - INFO - ------------------ Configuration ------------------
2023-07-25 01:12:57,563 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 01:12:57,563 - root - INFO - Configuration name: afno_backbone
2023-07-25 01:12:57,563 - root - INFO - log_to_wandb True
2023-07-25 01:12:57,563 - root - INFO - lr 0.0005
2023-07-25 01:12:57,563 - root - INFO - batch_size 64
2023-07-25 01:12:57,563 - root - INFO - max_epochs 150
2023-07-25 01:12:57,564 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 01:12:57,564 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 01:12:57,564 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 01:12:57,564 - root - INFO - orography False
2023-07-25 01:12:57,564 - root - INFO - orography_path None
2023-07-25 01:12:57,564 - root - INFO - exp_dir FourCastNet/results
2023-07-25 01:12:57,564 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 01:12:57,564 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 01:12:57,564 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 01:12:57,564 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 01:12:57,564 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 01:12:57,564 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 01:12:57,564 - root - INFO - loss l2
2023-07-25 01:12:57,564 - root - INFO - num_data_workers 4
2023-07-25 01:12:57,564 - root - INFO - dt 1
2023-07-25 01:12:57,564 - root - INFO - n_history 0
2023-07-25 01:12:57,564 - root - INFO - prediction_type iterative
2023-07-25 01:12:57,564 - root - INFO - prediction_length 30
2023-07-25 01:12:57,564 - root - INFO - n_initial_conditions 5
2023-07-25 01:12:57,565 - root - INFO - ics_type default
2023-07-25 01:12:57,565 - root - INFO - save_raw_forecasts True
2023-07-25 01:12:57,565 - root - INFO - save_channel False
2023-07-25 01:12:57,565 - root - INFO - masked_acc False
2023-07-25 01:12:57,565 - root - INFO - maskpath None
2023-07-25 01:12:57,565 - root - INFO - perturb False
2023-07-25 01:12:57,565 - root - INFO - add_grid False
2023-07-25 01:12:57,565 - root - INFO - N_grid_channels 0
2023-07-25 01:12:57,565 - root - INFO - gridtype sinusoidal
2023-07-25 01:12:57,565 - root - INFO - roll False
2023-07-25 01:12:57,565 - root - INFO - num_blocks 8
2023-07-25 01:12:57,565 - root - INFO - nettype afno
2023-07-25 01:12:57,565 - root - INFO - patch_size 8
2023-07-25 01:12:57,565 - root - INFO - width 56
2023-07-25 01:12:57,565 - root - INFO - modes 32
2023-07-25 01:12:57,565 - root - INFO - target U10
2023-07-25 01:12:57,565 - root - INFO - normalization zscore
2023-07-25 01:12:57,565 - root - INFO - log_to_screen True
2023-07-25 01:12:57,566 - root - INFO - save_checkpoint True
2023-07-25 01:12:57,566 - root - INFO - enable_nhwc False
2023-07-25 01:12:57,566 - root - INFO - optimizer_type FusedAdam
2023-07-25 01:12:57,566 - root - INFO - crop_size_x None
2023-07-25 01:12:57,566 - root - INFO - crop_size_y None
2023-07-25 01:12:57,566 - root - INFO - two_step_training False
2023-07-25 01:12:57,566 - root - INFO - plot_animations False
2023-07-25 01:12:57,566 - root - INFO - add_noise False
2023-07-25 01:12:57,566 - root - INFO - noise_std 0
2023-07-25 01:12:57,566 - root - INFO - world_size 1
2023-07-25 01:12:57,566 - root - INFO - interp 0
2023-07-25 01:12:57,566 - root - INFO - use_daily_climatology False
2023-07-25 01:12:57,566 - root - INFO - global_batch_size 64
2023-07-25 01:12:57,566 - root - INFO - ablate V10
2023-07-25 01:12:57,566 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 01:12:57,566 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 01:12:57,566 - root - INFO - resuming False
2023-07-25 01:12:57,567 - root - INFO - local_rank 0
2023-07-25 01:12:57,567 - root - INFO - ---------------------------------------------------
2023-07-25 01:12:57,567 - root - INFO - Inference for 1 initial conditions
2023-07-25 01:12:57,994 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 01:12:57,994 - root - INFO - Number of samples per year: 1460
2023-07-25 01:12:57,995 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 01:12:57,995 - root - INFO - Delta t: 6 hours
2023-07-25 01:12:57,995 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 01:12:57,995 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 01:14:09,039 - root - INFO - Loading inference data
2023-07-25 01:14:09,040 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 01:14:09,415 - root - INFO - Initial condition 1 of 1
2023-07-25 01:14:10,248 - root - INFO - Extracting valid data from the first year
2023-07-25 01:16:48,392 - root - INFO - Standardizing data
2023-07-25 01:16:57,200 - root - INFO - Loading time means
2023-07-25 01:17:12,240 - root - INFO - Begin autoregressive inference
2023-07-25 01:17:22,769 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 01:17:33,991 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 1.015738844871521, ACC: 0.9675650596618652
2023-07-25 01:17:44,884 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 1.019405722618103, ACC: 0.9681703448295593
2023-07-25 01:17:55,947 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 1.0718101263046265, ACC: 0.9647919535636902
2023-07-25 01:18:07,450 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 1.1643385887145996, ACC: 0.9588988423347473
2023-07-25 01:18:17,363 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 1.2518218755722046, ACC: 0.9548254609107971
2023-07-25 01:18:27,838 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 1.3601574897766113, ACC: 0.9478813409805298
2023-07-25 01:18:39,307 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 1.4675520658493042, ACC: 0.9406313300132751
2023-07-25 01:18:49,955 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 1.609976887702942, ACC: 0.9285122752189636
2023-07-25 01:19:01,059 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 1.716546893119812, ACC: 0.9225418567657471
2023-07-25 01:19:11,851 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 1.829625129699707, ACC: 0.912588357925415
2023-07-25 01:19:22,289 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 1.9543230533599854, ACC: 0.9027238488197327
2023-07-25 01:19:32,350 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 2.127753734588623, ACC: 0.884070873260498
2023-07-25 01:19:43,136 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 2.2882187366485596, ACC: 0.8711220622062683
2023-07-25 01:19:55,135 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 2.4148833751678467, ACC: 0.8583412170410156
2023-07-25 01:20:07,131 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 2.5287551879882812, ACC: 0.8418885469436646
2023-07-25 01:20:18,943 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 2.637934684753418, ACC: 0.8202774524688721
2023-07-25 01:20:30,910 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 2.728729486465454, ACC: 0.8050839304924011
2023-07-25 01:20:41,084 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 2.786705493927002, ACC: 0.7945597767829895
2023-07-25 01:20:52,268 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 2.8240208625793457, ACC: 0.7834042906761169
2023-07-25 01:21:02,701 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 2.8759360313415527, ACC: 0.7643275856971741
2023-07-25 01:21:13,901 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 2.973846435546875, ACC: 0.7544884085655212
2023-07-25 01:21:23,829 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 3.1361234188079834, ACC: 0.728598415851593
2023-07-25 01:21:34,170 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 3.3385603427886963, ACC: 0.7035700678825378
2023-07-25 01:21:44,063 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 3.4476189613342285, ACC: 0.6776911616325378
2023-07-25 01:21:54,346 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 3.512631893157959, ACC: 0.6750161647796631
2023-07-25 01:22:05,729 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 3.5631237030029297, ACC: 0.6632282137870789
2023-07-25 01:22:17,772 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 3.6443920135498047, ACC: 0.6509254574775696
2023-07-25 01:22:28,630 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 3.7287862300872803, ACC: 0.618995189666748
2023-07-25 01:22:39,688 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 3.9432225227355957, ACC: 0.582073450088501
2023-07-25 01:22:39,776 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-V10_30-timesteps_vis.h5
2023-07-25 01:23:32,994 - root - INFO - ------------------ Configuration ------------------
2023-07-25 01:23:32,994 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 01:23:32,994 - root - INFO - Configuration name: afno_backbone
2023-07-25 01:23:32,994 - root - INFO - log_to_wandb True
2023-07-25 01:23:32,994 - root - INFO - lr 0.0005
2023-07-25 01:23:32,994 - root - INFO - batch_size 64
2023-07-25 01:23:32,994 - root - INFO - max_epochs 150
2023-07-25 01:23:32,994 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 01:23:32,994 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 01:23:32,995 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 01:23:32,995 - root - INFO - orography False
2023-07-25 01:23:32,995 - root - INFO - orography_path None
2023-07-25 01:23:32,995 - root - INFO - exp_dir FourCastNet/results
2023-07-25 01:23:32,995 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 01:23:32,995 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 01:23:32,995 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 01:23:32,995 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 01:23:32,995 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 01:23:32,995 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 01:23:32,995 - root - INFO - loss l2
2023-07-25 01:23:32,995 - root - INFO - num_data_workers 4
2023-07-25 01:23:32,995 - root - INFO - dt 1
2023-07-25 01:23:32,995 - root - INFO - n_history 0
2023-07-25 01:23:32,995 - root - INFO - prediction_type iterative
2023-07-25 01:23:32,995 - root - INFO - prediction_length 30
2023-07-25 01:23:32,995 - root - INFO - n_initial_conditions 5
2023-07-25 01:23:32,995 - root - INFO - ics_type default
2023-07-25 01:23:32,996 - root - INFO - save_raw_forecasts True
2023-07-25 01:23:32,996 - root - INFO - save_channel False
2023-07-25 01:23:32,996 - root - INFO - masked_acc False
2023-07-25 01:23:32,996 - root - INFO - maskpath None
2023-07-25 01:23:32,996 - root - INFO - perturb False
2023-07-25 01:23:32,996 - root - INFO - add_grid False
2023-07-25 01:23:32,996 - root - INFO - N_grid_channels 0
2023-07-25 01:23:32,996 - root - INFO - gridtype sinusoidal
2023-07-25 01:23:32,996 - root - INFO - roll False
2023-07-25 01:23:32,996 - root - INFO - num_blocks 8
2023-07-25 01:23:32,996 - root - INFO - nettype afno
2023-07-25 01:23:32,996 - root - INFO - patch_size 8
2023-07-25 01:23:32,996 - root - INFO - width 56
2023-07-25 01:23:32,996 - root - INFO - modes 32
2023-07-25 01:23:32,996 - root - INFO - target U10
2023-07-25 01:23:32,996 - root - INFO - normalization zscore
2023-07-25 01:23:32,996 - root - INFO - log_to_screen True
2023-07-25 01:23:32,996 - root - INFO - save_checkpoint True
2023-07-25 01:23:32,996 - root - INFO - enable_nhwc False
2023-07-25 01:23:32,996 - root - INFO - optimizer_type FusedAdam
2023-07-25 01:23:32,996 - root - INFO - crop_size_x None
2023-07-25 01:23:32,996 - root - INFO - crop_size_y None
2023-07-25 01:23:32,997 - root - INFO - two_step_training False
2023-07-25 01:23:32,997 - root - INFO - plot_animations False
2023-07-25 01:23:32,997 - root - INFO - add_noise False
2023-07-25 01:23:32,997 - root - INFO - noise_std 0
2023-07-25 01:23:32,997 - root - INFO - world_size 1
2023-07-25 01:23:32,997 - root - INFO - interp 0
2023-07-25 01:23:32,997 - root - INFO - use_daily_climatology False
2023-07-25 01:23:32,997 - root - INFO - global_batch_size 64
2023-07-25 01:23:32,997 - root - INFO - ablate T2m
2023-07-25 01:23:32,997 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 01:23:32,997 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 01:23:32,997 - root - INFO - resuming False
2023-07-25 01:23:32,997 - root - INFO - local_rank 0
2023-07-25 01:23:32,997 - root - INFO - ---------------------------------------------------
2023-07-25 01:23:32,997 - root - INFO - Inference for 1 initial conditions
2023-07-25 01:23:33,357 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 01:23:33,358 - root - INFO - Number of samples per year: 1460
2023-07-25 01:23:33,358 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 01:23:33,358 - root - INFO - Delta t: 6 hours
2023-07-25 01:23:33,358 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 01:23:33,358 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 01:24:42,558 - root - INFO - Loading inference data
2023-07-25 01:24:42,559 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 01:24:42,721 - root - INFO - Initial condition 1 of 1
2023-07-25 01:24:43,618 - root - INFO - Extracting valid data from the first year
2023-07-25 01:27:13,903 - root - INFO - Standardizing data
2023-07-25 01:27:20,108 - root - INFO - Loading time means
2023-07-25 01:27:36,844 - root - INFO - Begin autoregressive inference
2023-07-25 01:27:46,754 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 01:27:57,828 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 15.283706665039062, ACC: 0.15640325844287872
2023-07-25 01:28:08,216 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 116.04800415039062, ACC: 0.0399276502430439
2023-07-25 01:28:17,821 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 196.17376708984375, ACC: 0.025599973276257515
2023-07-25 01:28:28,200 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 224.4232940673828, ACC: 0.01150109525769949
2023-07-25 01:28:38,981 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 242.4939727783203, ACC: 0.012950250878930092
2023-07-25 01:28:48,980 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 265.73834228515625, ACC: 0.009591654874384403
2023-07-25 01:28:59,037 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 290.24859619140625, ACC: 0.008817720226943493
2023-07-25 01:29:08,921 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 311.4952697753906, ACC: 0.010896019637584686
2023-07-25 01:29:20,101 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 328.0136413574219, ACC: 0.008795000612735748
2023-07-25 01:29:31,589 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 340.3775329589844, ACC: 0.0051341005600988865
2023-07-25 01:29:42,491 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 349.45489501953125, ACC: 0.001504023908637464
2023-07-25 01:29:53,394 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 355.9796142578125, ACC: 0.001639492460526526
2023-07-25 01:30:05,968 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 360.5820007324219, ACC: 0.0023175282403826714
2023-07-25 01:30:17,329 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 363.7969665527344, ACC: -0.0008498458191752434
2023-07-25 01:30:28,947 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 366.0008544921875, ACC: -0.0012841891730204225
2023-07-25 01:30:39,379 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 367.5229187011719, ACC: -0.004099992103874683
2023-07-25 01:30:51,064 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 368.5387878417969, ACC: 0.00042180248419754207
2023-07-25 01:31:01,525 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 369.2576904296875, ACC: -0.0004856489831581712
2023-07-25 01:31:11,981 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 369.74713134765625, ACC: 0.0007243147119879723
2023-07-25 01:31:22,515 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 370.08673095703125, ACC: 0.0018558572046458721
2023-07-25 01:31:33,184 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 370.3138427734375, ACC: 0.0054779378697276115
2023-07-25 01:31:43,975 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 370.49395751953125, ACC: 0.0033879736438393593
2023-07-25 01:31:55,301 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 370.6219787597656, ACC: 0.0019440349424257874
2023-07-25 01:32:06,535 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 370.7066650390625, ACC: 0.0020830919966101646
2023-07-25 01:32:17,740 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 370.7580261230469, ACC: 0.004385964944958687
2023-07-25 01:32:29,966 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 370.80853271484375, ACC: 0.002856715815141797
2023-07-25 01:32:41,367 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 370.837646484375, ACC: 0.0033836180809885263
2023-07-25 01:32:53,441 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 370.86236572265625, ACC: 0.002661460777744651
2023-07-25 01:33:04,126 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 370.87603759765625, ACC: 0.0033278688788414
2023-07-25 01:33:04,219 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-T2m_30-timesteps_vis.h5
2023-07-25 01:33:57,750 - root - INFO - ------------------ Configuration ------------------
2023-07-25 01:33:57,750 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 01:33:57,751 - root - INFO - Configuration name: afno_backbone
2023-07-25 01:33:57,751 - root - INFO - log_to_wandb True
2023-07-25 01:33:57,751 - root - INFO - lr 0.0005
2023-07-25 01:33:57,751 - root - INFO - batch_size 64
2023-07-25 01:33:57,751 - root - INFO - max_epochs 150
2023-07-25 01:33:57,751 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 01:33:57,751 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 01:33:57,752 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 01:33:57,752 - root - INFO - orography False
2023-07-25 01:33:57,752 - root - INFO - orography_path None
2023-07-25 01:33:57,752 - root - INFO - exp_dir FourCastNet/results
2023-07-25 01:33:57,752 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 01:33:57,752 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 01:33:57,752 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 01:33:57,752 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 01:33:57,752 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 01:33:57,752 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 01:33:57,752 - root - INFO - loss l2
2023-07-25 01:33:57,753 - root - INFO - num_data_workers 4
2023-07-25 01:33:57,753 - root - INFO - dt 1
2023-07-25 01:33:57,753 - root - INFO - n_history 0
2023-07-25 01:33:57,753 - root - INFO - prediction_type iterative
2023-07-25 01:33:57,753 - root - INFO - prediction_length 30
2023-07-25 01:33:57,753 - root - INFO - n_initial_conditions 5
2023-07-25 01:33:57,753 - root - INFO - ics_type default
2023-07-25 01:33:57,753 - root - INFO - save_raw_forecasts True
2023-07-25 01:33:57,753 - root - INFO - save_channel False
2023-07-25 01:33:57,753 - root - INFO - masked_acc False
2023-07-25 01:33:57,753 - root - INFO - maskpath None
2023-07-25 01:33:57,753 - root - INFO - perturb False
2023-07-25 01:33:57,754 - root - INFO - add_grid False
2023-07-25 01:33:57,754 - root - INFO - N_grid_channels 0
2023-07-25 01:33:57,754 - root - INFO - gridtype sinusoidal
2023-07-25 01:33:57,754 - root - INFO - roll False
2023-07-25 01:33:57,754 - root - INFO - num_blocks 8
2023-07-25 01:33:57,754 - root - INFO - nettype afno
2023-07-25 01:33:57,754 - root - INFO - patch_size 8
2023-07-25 01:33:57,754 - root - INFO - width 56
2023-07-25 01:33:57,754 - root - INFO - modes 32
2023-07-25 01:33:57,754 - root - INFO - target U10
2023-07-25 01:33:57,754 - root - INFO - normalization zscore
2023-07-25 01:33:57,754 - root - INFO - log_to_screen True
2023-07-25 01:33:57,754 - root - INFO - save_checkpoint True
2023-07-25 01:33:57,755 - root - INFO - enable_nhwc False
2023-07-25 01:33:57,755 - root - INFO - optimizer_type FusedAdam
2023-07-25 01:33:57,755 - root - INFO - crop_size_x None
2023-07-25 01:33:57,755 - root - INFO - crop_size_y None
2023-07-25 01:33:57,755 - root - INFO - two_step_training False
2023-07-25 01:33:57,755 - root - INFO - plot_animations False
2023-07-25 01:33:57,755 - root - INFO - add_noise False
2023-07-25 01:33:57,755 - root - INFO - noise_std 0
2023-07-25 01:33:57,755 - root - INFO - world_size 1
2023-07-25 01:33:57,755 - root - INFO - interp 0
2023-07-25 01:33:57,755 - root - INFO - use_daily_climatology False
2023-07-25 01:33:57,755 - root - INFO - global_batch_size 64
2023-07-25 01:33:57,756 - root - INFO - ablate sp
2023-07-25 01:33:57,756 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 01:33:57,756 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 01:33:57,756 - root - INFO - resuming False
2023-07-25 01:33:57,756 - root - INFO - local_rank 0
2023-07-25 01:33:57,756 - root - INFO - ---------------------------------------------------
2023-07-25 01:33:57,756 - root - INFO - Inference for 1 initial conditions
2023-07-25 01:33:58,067 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 01:33:58,068 - root - INFO - Number of samples per year: 1460
2023-07-25 01:33:58,068 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 01:33:58,068 - root - INFO - Delta t: 6 hours
2023-07-25 01:33:58,068 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 01:33:58,068 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 01:35:10,498 - root - INFO - Loading inference data
2023-07-25 01:35:10,501 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 01:35:10,696 - root - INFO - Initial condition 1 of 1
2023-07-25 01:35:11,572 - root - INFO - Extracting valid data from the first year
2023-07-25 01:37:44,489 - root - INFO - Standardizing data
2023-07-25 01:37:51,252 - root - INFO - Loading time means
2023-07-25 01:38:06,518 - root - INFO - Begin autoregressive inference
2023-07-25 01:38:17,269 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 01:38:27,727 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 1.5924994945526123, ACC: 0.9192646145820618
2023-07-25 01:38:39,178 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 2.627829074859619, ACC: 0.7724573612213135
2023-07-25 01:38:50,110 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 5.068450450897217, ACC: 0.4672461152076721
2023-07-25 01:39:01,062 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 5.2386298179626465, ACC: 0.4284228980541229
2023-07-25 01:39:11,744 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 5.338698863983154, ACC: 0.396209180355072
2023-07-25 01:39:22,623 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 5.6218976974487305, ACC: 0.35233351588249207
2023-07-25 01:39:34,030 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 6.027033805847168, ACC: 0.2979145348072052
2023-07-25 01:39:44,159 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 6.39923620223999, ACC: 0.25177812576293945
2023-07-25 01:39:54,132 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 6.8437933921813965, ACC: 0.20971471071243286
2023-07-25 01:40:04,954 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 7.3495378494262695, ACC: 0.17438721656799316
2023-07-25 01:40:15,590 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 7.972635746002197, ACC: 0.14147838950157166
2023-07-25 01:40:25,653 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 8.431848526000977, ACC: 0.1144135519862175
2023-07-25 01:40:36,068 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 8.91666030883789, ACC: 0.09154947847127914
2023-07-25 01:40:46,209 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 9.3162260055542, ACC: 0.08264155685901642
2023-07-25 01:40:55,984 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 9.702555656433105, ACC: 0.07645043730735779
2023-07-25 01:41:05,961 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 10.126421928405762, ACC: 0.0692477822303772
2023-07-25 01:41:16,774 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 10.543654441833496, ACC: 0.057333700358867645
2023-07-25 01:41:26,635 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 11.009820938110352, ACC: 0.054616134613752365
2023-07-25 01:41:36,519 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 11.332098007202148, ACC: 0.055496715009212494
2023-07-25 01:41:46,688 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 11.602907180786133, ACC: 0.0528143048286438
2023-07-25 01:41:56,818 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 12.007046699523926, ACC: 0.04722835123538971
2023-07-25 01:42:07,591 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 12.314386367797852, ACC: 0.04736446216702461
2023-07-25 01:42:18,207 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 12.593184471130371, ACC: 0.04874984920024872
2023-07-25 01:42:27,790 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 12.80581283569336, ACC: 0.048544712364673615
2023-07-25 01:42:37,487 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 13.19082260131836, ACC: 0.04068523645401001
2023-07-25 01:42:47,574 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 13.520010948181152, ACC: 0.03884245827794075
2023-07-25 01:42:57,225 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 13.879684448242188, ACC: 0.03560900688171387
2023-07-25 01:43:08,184 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 14.185324668884277, ACC: 0.03565376251935959
2023-07-25 01:43:18,735 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 14.568530082702637, ACC: 0.028905367478728294
2023-07-25 01:43:18,840 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-sp_30-timesteps_vis.h5
2023-07-25 01:44:12,940 - root - INFO - ------------------ Configuration ------------------
2023-07-25 01:44:12,940 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 01:44:12,940 - root - INFO - Configuration name: afno_backbone
2023-07-25 01:44:12,941 - root - INFO - log_to_wandb True
2023-07-25 01:44:12,941 - root - INFO - lr 0.0005
2023-07-25 01:44:12,941 - root - INFO - batch_size 64
2023-07-25 01:44:12,941 - root - INFO - max_epochs 150
2023-07-25 01:44:12,941 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 01:44:12,941 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 01:44:12,941 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 01:44:12,941 - root - INFO - orography False
2023-07-25 01:44:12,941 - root - INFO - orography_path None
2023-07-25 01:44:12,941 - root - INFO - exp_dir FourCastNet/results
2023-07-25 01:44:12,941 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 01:44:12,941 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 01:44:12,941 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 01:44:12,941 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 01:44:12,941 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 01:44:12,941 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 01:44:12,941 - root - INFO - loss l2
2023-07-25 01:44:12,942 - root - INFO - num_data_workers 4
2023-07-25 01:44:12,942 - root - INFO - dt 1
2023-07-25 01:44:12,942 - root - INFO - n_history 0
2023-07-25 01:44:12,942 - root - INFO - prediction_type iterative
2023-07-25 01:44:12,942 - root - INFO - prediction_length 30
2023-07-25 01:44:12,942 - root - INFO - n_initial_conditions 5
2023-07-25 01:44:12,942 - root - INFO - ics_type default
2023-07-25 01:44:12,942 - root - INFO - save_raw_forecasts True
2023-07-25 01:44:12,942 - root - INFO - save_channel False
2023-07-25 01:44:12,942 - root - INFO - masked_acc False
2023-07-25 01:44:12,942 - root - INFO - maskpath None
2023-07-25 01:44:12,942 - root - INFO - perturb False
2023-07-25 01:44:12,942 - root - INFO - add_grid False
2023-07-25 01:44:12,942 - root - INFO - N_grid_channels 0
2023-07-25 01:44:12,942 - root - INFO - gridtype sinusoidal
2023-07-25 01:44:12,942 - root - INFO - roll False
2023-07-25 01:44:12,942 - root - INFO - num_blocks 8
2023-07-25 01:44:12,942 - root - INFO - nettype afno
2023-07-25 01:44:12,942 - root - INFO - patch_size 8
2023-07-25 01:44:12,942 - root - INFO - width 56
2023-07-25 01:44:12,942 - root - INFO - modes 32
2023-07-25 01:44:12,942 - root - INFO - target U10
2023-07-25 01:44:12,942 - root - INFO - normalization zscore
2023-07-25 01:44:12,942 - root - INFO - log_to_screen True
2023-07-25 01:44:12,942 - root - INFO - save_checkpoint True
2023-07-25 01:44:12,943 - root - INFO - enable_nhwc False
2023-07-25 01:44:12,943 - root - INFO - optimizer_type FusedAdam
2023-07-25 01:44:12,943 - root - INFO - crop_size_x None
2023-07-25 01:44:12,943 - root - INFO - crop_size_y None
2023-07-25 01:44:12,943 - root - INFO - two_step_training False
2023-07-25 01:44:12,943 - root - INFO - plot_animations False
2023-07-25 01:44:12,943 - root - INFO - add_noise False
2023-07-25 01:44:12,943 - root - INFO - noise_std 0
2023-07-25 01:44:12,943 - root - INFO - world_size 1
2023-07-25 01:44:12,943 - root - INFO - interp 0
2023-07-25 01:44:12,943 - root - INFO - use_daily_climatology False
2023-07-25 01:44:12,943 - root - INFO - global_batch_size 64
2023-07-25 01:44:12,943 - root - INFO - ablate mslp
2023-07-25 01:44:12,943 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 01:44:12,943 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 01:44:12,943 - root - INFO - resuming False
2023-07-25 01:44:12,943 - root - INFO - local_rank 0
2023-07-25 01:44:12,943 - root - INFO - ---------------------------------------------------
2023-07-25 01:44:12,943 - root - INFO - Inference for 1 initial conditions
2023-07-25 01:44:13,196 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 01:44:13,197 - root - INFO - Number of samples per year: 1460
2023-07-25 01:44:13,197 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 01:44:13,197 - root - INFO - Delta t: 6 hours
2023-07-25 01:44:13,197 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 01:44:13,197 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 01:45:26,330 - root - INFO - Loading inference data
2023-07-25 01:45:26,331 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 01:45:26,578 - root - INFO - Initial condition 1 of 1
2023-07-25 01:45:27,420 - root - INFO - Extracting valid data from the first year
2023-07-25 01:47:58,966 - root - INFO - Standardizing data
2023-07-25 01:48:05,742 - root - INFO - Loading time means
2023-07-25 01:48:24,057 - root - INFO - Begin autoregressive inference
2023-07-25 01:48:35,445 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 01:48:46,355 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 2.9643068313598633, ACC: 0.7559933066368103
2023-07-25 01:48:56,593 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 18.560182571411133, ACC: 0.1812649667263031
2023-07-25 01:49:06,727 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 32.80040740966797, ACC: 0.09751024842262268
2023-07-25 01:49:17,726 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 36.386600494384766, ACC: 0.08124719560146332
2023-07-25 01:49:28,110 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 38.71194839477539, ACC: 0.0632801428437233
2023-07-25 01:49:39,198 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 42.41189956665039, ACC: 0.047812312841415405
2023-07-25 01:49:49,389 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 47.15201187133789, ACC: 0.033430054783821106
2023-07-25 01:49:59,321 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 52.03727340698242, ACC: 0.030341509729623795
2023-07-25 01:50:09,937 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 56.72419357299805, ACC: 0.02479521557688713
2023-07-25 01:50:20,196 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 61.19108963012695, ACC: 0.026040304452180862
2023-07-25 01:50:29,837 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 65.31816864013672, ACC: 0.027015745639801025
2023-07-25 01:50:40,106 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 69.24271392822266, ACC: 0.03360694274306297
2023-07-25 01:50:49,480 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 73.27189636230469, ACC: 0.031312160193920135
2023-07-25 01:50:59,470 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 77.2133560180664, ACC: 0.027090255171060562
2023-07-25 01:51:10,787 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 81.3010482788086, ACC: 0.017208106815814972
2023-07-25 01:51:21,414 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 85.812255859375, ACC: 0.004522989969700575
2023-07-25 01:51:31,721 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 91.03357696533203, ACC: -0.011544391512870789
2023-07-25 01:51:41,815 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 96.97958374023438, ACC: -0.016773710027337074
2023-07-25 01:51:53,015 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 103.9372787475586, ACC: -0.020199734717607498
2023-07-25 01:52:02,868 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 112.20742797851562, ACC: -0.01949940249323845
2023-07-25 01:52:13,219 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 125.41453552246094, ACC: -0.017449934035539627
2023-07-25 01:52:23,745 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 153.7614288330078, ACC: 0.01390025019645691
2023-07-25 01:52:34,181 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 190.68609619140625, ACC: 0.018398603424429893
2023-07-25 01:52:44,521 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 219.8263397216797, ACC: 0.020038282498717308
2023-07-25 01:52:54,627 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 242.4235076904297, ACC: 0.01803869567811489
2023-07-25 01:53:05,047 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 263.81268310546875, ACC: 0.01581089198589325
2023-07-25 01:53:15,361 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 284.8918762207031, ACC: 0.013319422490894794
2023-07-25 01:53:24,783 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 304.3970031738281, ACC: 0.007755266968160868
2023-07-25 01:53:35,725 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 320.9055480957031, ACC: 0.006262259557843208
2023-07-25 01:53:35,817 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-mslp_30-timesteps_vis.h5
2023-07-25 01:54:28,914 - root - INFO - ------------------ Configuration ------------------
2023-07-25 01:54:28,914 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 01:54:28,914 - root - INFO - Configuration name: afno_backbone
2023-07-25 01:54:28,915 - root - INFO - log_to_wandb True
2023-07-25 01:54:28,915 - root - INFO - lr 0.0005
2023-07-25 01:54:28,915 - root - INFO - batch_size 64
2023-07-25 01:54:28,915 - root - INFO - max_epochs 150
2023-07-25 01:54:28,915 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 01:54:28,915 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 01:54:28,915 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 01:54:28,915 - root - INFO - orography False
2023-07-25 01:54:28,915 - root - INFO - orography_path None
2023-07-25 01:54:28,915 - root - INFO - exp_dir FourCastNet/results
2023-07-25 01:54:28,915 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 01:54:28,915 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 01:54:28,915 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 01:54:28,915 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 01:54:28,915 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 01:54:28,915 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 01:54:28,915 - root - INFO - loss l2
2023-07-25 01:54:28,915 - root - INFO - num_data_workers 4
2023-07-25 01:54:28,916 - root - INFO - dt 1
2023-07-25 01:54:28,916 - root - INFO - n_history 0
2023-07-25 01:54:28,916 - root - INFO - prediction_type iterative
2023-07-25 01:54:28,916 - root - INFO - prediction_length 30
2023-07-25 01:54:28,916 - root - INFO - n_initial_conditions 5
2023-07-25 01:54:28,916 - root - INFO - ics_type default
2023-07-25 01:54:28,916 - root - INFO - save_raw_forecasts True
2023-07-25 01:54:28,916 - root - INFO - save_channel False
2023-07-25 01:54:28,916 - root - INFO - masked_acc False
2023-07-25 01:54:28,916 - root - INFO - maskpath None
2023-07-25 01:54:28,916 - root - INFO - perturb False
2023-07-25 01:54:28,916 - root - INFO - add_grid False
2023-07-25 01:54:28,916 - root - INFO - N_grid_channels 0
2023-07-25 01:54:28,916 - root - INFO - gridtype sinusoidal
2023-07-25 01:54:28,916 - root - INFO - roll False
2023-07-25 01:54:28,916 - root - INFO - num_blocks 8
2023-07-25 01:54:28,916 - root - INFO - nettype afno
2023-07-25 01:54:28,916 - root - INFO - patch_size 8
2023-07-25 01:54:28,916 - root - INFO - width 56
2023-07-25 01:54:28,916 - root - INFO - modes 32
2023-07-25 01:54:28,916 - root - INFO - target U10
2023-07-25 01:54:28,917 - root - INFO - normalization zscore
2023-07-25 01:54:28,917 - root - INFO - log_to_screen True
2023-07-25 01:54:28,917 - root - INFO - save_checkpoint True
2023-07-25 01:54:28,917 - root - INFO - enable_nhwc False
2023-07-25 01:54:28,917 - root - INFO - optimizer_type FusedAdam
2023-07-25 01:54:28,917 - root - INFO - crop_size_x None
2023-07-25 01:54:28,917 - root - INFO - crop_size_y None
2023-07-25 01:54:28,917 - root - INFO - two_step_training False
2023-07-25 01:54:28,917 - root - INFO - plot_animations False
2023-07-25 01:54:28,917 - root - INFO - add_noise False
2023-07-25 01:54:28,917 - root - INFO - noise_std 0
2023-07-25 01:54:28,917 - root - INFO - world_size 1
2023-07-25 01:54:28,917 - root - INFO - interp 0
2023-07-25 01:54:28,917 - root - INFO - use_daily_climatology False
2023-07-25 01:54:28,917 - root - INFO - global_batch_size 64
2023-07-25 01:54:28,917 - root - INFO - ablate U1000
2023-07-25 01:54:28,917 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 01:54:28,917 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 01:54:28,917 - root - INFO - resuming False
2023-07-25 01:54:28,917 - root - INFO - local_rank 0
2023-07-25 01:54:28,918 - root - INFO - ---------------------------------------------------
2023-07-25 01:54:28,918 - root - INFO - Inference for 1 initial conditions
2023-07-25 01:54:29,234 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 01:54:29,235 - root - INFO - Number of samples per year: 1460
2023-07-25 01:54:29,235 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 01:54:29,235 - root - INFO - Delta t: 6 hours
2023-07-25 01:54:29,235 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 01:54:29,236 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 01:55:42,541 - root - INFO - Loading inference data
2023-07-25 01:55:42,542 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 01:55:42,771 - root - INFO - Initial condition 1 of 1
2023-07-25 01:55:43,616 - root - INFO - Extracting valid data from the first year
2023-07-25 01:58:15,122 - root - INFO - Standardizing data
2023-07-25 01:58:21,207 - root - INFO - Loading time means
2023-07-25 01:58:36,448 - root - INFO - Begin autoregressive inference
2023-07-25 01:58:47,532 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 01:58:58,564 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 5.022721767425537, ACC: 0.5558876395225525
2023-07-25 01:59:10,578 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 23.86048126220703, ACC: 0.09932650625705719
2023-07-25 01:59:21,627 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 49.40359115600586, ACC: 0.05113815888762474
2023-07-25 01:59:32,289 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 70.78691101074219, ACC: 0.029190972447395325
2023-07-25 01:59:42,823 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 89.43077850341797, ACC: 0.024851754307746887
2023-07-25 01:59:53,217 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 116.71978759765625, ACC: 0.026337880641222
2023-07-25 02:00:05,024 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 166.51901245117188, ACC: -0.0030394187197089195
2023-07-25 02:00:16,600 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 212.05462646484375, ACC: 0.007357439491897821
2023-07-25 02:00:27,900 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 242.0513153076172, ACC: 0.012906895019114017
2023-07-25 02:00:38,629 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 264.104248046875, ACC: 0.011359726078808308
2023-07-25 02:00:48,825 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 285.1781921386719, ACC: 0.008733704686164856
2023-07-25 02:00:59,229 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 304.78338623046875, ACC: 0.005968174431473017
2023-07-25 02:01:09,489 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 321.3003845214844, ACC: 0.004340304993093014
2023-07-25 02:01:19,953 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 334.2814636230469, ACC: -0.0018460745923221111
2023-07-25 02:01:30,460 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 344.14447021484375, ACC: -0.002786007709801197
2023-07-25 02:01:41,405 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 351.5253601074219, ACC: -0.0052088527008891106
2023-07-25 02:01:51,496 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 356.9901428222656, ACC: 0.0005388156860135496
2023-07-25 02:02:02,153 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 361.04180908203125, ACC: -0.00013869702524971217
2023-07-25 02:02:12,867 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 363.983642578125, ACC: 0.001058364869095385
2023-07-25 02:02:22,479 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 366.09881591796875, ACC: 0.002075623022392392
2023-07-25 02:02:32,505 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 367.5769958496094, ACC: 0.005683873780071735
2023-07-25 02:02:42,997 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 368.62066650390625, ACC: 0.0034878759179264307
2023-07-25 02:02:52,842 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 369.3385314941406, ACC: 0.0020135538652539253
2023-07-25 02:03:04,112 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 369.8250427246094, ACC: 0.0021230699494481087
2023-07-25 02:03:14,278 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 370.1499328613281, ACC: 0.004422429483383894
2023-07-25 02:03:25,746 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 370.38720703125, ACC: 0.0028732423670589924
2023-07-25 02:03:36,455 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 370.5443420410156, ACC: 0.0034004889894276857
2023-07-25 02:03:46,481 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 370.65716552734375, ACC: 0.0026719497982412577
2023-07-25 02:03:57,408 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 370.731689453125, ACC: 0.003338269190862775
2023-07-25 02:03:57,497 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-U1000_30-timesteps_vis.h5
2023-07-25 02:04:50,689 - root - INFO - ------------------ Configuration ------------------
2023-07-25 02:04:50,689 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 02:04:50,689 - root - INFO - Configuration name: afno_backbone
2023-07-25 02:04:50,689 - root - INFO - log_to_wandb True
2023-07-25 02:04:50,689 - root - INFO - lr 0.0005
2023-07-25 02:04:50,689 - root - INFO - batch_size 64
2023-07-25 02:04:50,689 - root - INFO - max_epochs 150
2023-07-25 02:04:50,689 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 02:04:50,690 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 02:04:50,690 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 02:04:50,690 - root - INFO - orography False
2023-07-25 02:04:50,690 - root - INFO - orography_path None
2023-07-25 02:04:50,690 - root - INFO - exp_dir FourCastNet/results
2023-07-25 02:04:50,690 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 02:04:50,690 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 02:04:50,690 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 02:04:50,690 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 02:04:50,690 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 02:04:50,690 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 02:04:50,690 - root - INFO - loss l2
2023-07-25 02:04:50,690 - root - INFO - num_data_workers 4
2023-07-25 02:04:50,690 - root - INFO - dt 1
2023-07-25 02:04:50,690 - root - INFO - n_history 0
2023-07-25 02:04:50,690 - root - INFO - prediction_type iterative
2023-07-25 02:04:50,691 - root - INFO - prediction_length 30
2023-07-25 02:04:50,691 - root - INFO - n_initial_conditions 5
2023-07-25 02:04:50,691 - root - INFO - ics_type default
2023-07-25 02:04:50,691 - root - INFO - save_raw_forecasts True
2023-07-25 02:04:50,691 - root - INFO - save_channel False
2023-07-25 02:04:50,691 - root - INFO - masked_acc False
2023-07-25 02:04:50,691 - root - INFO - maskpath None
2023-07-25 02:04:50,691 - root - INFO - perturb False
2023-07-25 02:04:50,691 - root - INFO - add_grid False
2023-07-25 02:04:50,691 - root - INFO - N_grid_channels 0
2023-07-25 02:04:50,691 - root - INFO - gridtype sinusoidal
2023-07-25 02:04:50,691 - root - INFO - roll False
2023-07-25 02:04:50,691 - root - INFO - num_blocks 8
2023-07-25 02:04:50,691 - root - INFO - nettype afno
2023-07-25 02:04:50,691 - root - INFO - patch_size 8
2023-07-25 02:04:50,691 - root - INFO - width 56
2023-07-25 02:04:50,692 - root - INFO - modes 32
2023-07-25 02:04:50,692 - root - INFO - target U10
2023-07-25 02:04:50,692 - root - INFO - normalization zscore
2023-07-25 02:04:50,692 - root - INFO - log_to_screen True
2023-07-25 02:04:50,692 - root - INFO - save_checkpoint True
2023-07-25 02:04:50,692 - root - INFO - enable_nhwc False
2023-07-25 02:04:50,692 - root - INFO - optimizer_type FusedAdam
2023-07-25 02:04:50,692 - root - INFO - crop_size_x None
2023-07-25 02:04:50,692 - root - INFO - crop_size_y None
2023-07-25 02:04:50,692 - root - INFO - two_step_training False
2023-07-25 02:04:50,692 - root - INFO - plot_animations False
2023-07-25 02:04:50,692 - root - INFO - add_noise False
2023-07-25 02:04:50,692 - root - INFO - noise_std 0
2023-07-25 02:04:50,692 - root - INFO - world_size 1
2023-07-25 02:04:50,692 - root - INFO - interp 0
2023-07-25 02:04:50,692 - root - INFO - use_daily_climatology False
2023-07-25 02:04:50,693 - root - INFO - global_batch_size 64
2023-07-25 02:04:50,693 - root - INFO - ablate V1000
2023-07-25 02:04:50,693 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 02:04:50,693 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 02:04:50,693 - root - INFO - resuming False
2023-07-25 02:04:50,693 - root - INFO - local_rank 0
2023-07-25 02:04:50,693 - root - INFO - ---------------------------------------------------
2023-07-25 02:04:50,693 - root - INFO - Inference for 1 initial conditions
2023-07-25 02:04:51,060 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 02:04:51,061 - root - INFO - Number of samples per year: 1460
2023-07-25 02:04:51,061 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 02:04:51,061 - root - INFO - Delta t: 6 hours
2023-07-25 02:04:51,061 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 02:04:51,062 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 02:06:10,022 - root - INFO - Loading inference data
2023-07-25 02:06:10,023 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 02:06:10,383 - root - INFO - Initial condition 1 of 1
2023-07-25 02:06:11,239 - root - INFO - Extracting valid data from the first year
2023-07-25 02:09:04,580 - root - INFO - Standardizing data
2023-07-25 02:09:11,209 - root - INFO - Loading time means
2023-07-25 02:09:28,072 - root - INFO - Begin autoregressive inference
2023-07-25 02:09:39,988 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 02:09:52,263 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 1.4986989498138428, ACC: 0.9313529133796692
2023-07-25 02:10:05,774 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 1.383534550666809, ACC: 0.9401935338973999
2023-07-25 02:10:18,061 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 1.3466535806655884, ACC: 0.9437032341957092
2023-07-25 02:10:30,076 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 1.4326618909835815, ACC: 0.9371397495269775
2023-07-25 02:10:42,350 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 1.5231984853744507, ACC: 0.932855486869812
2023-07-25 02:10:54,710 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 1.6080626249313354, ACC: 0.9271575808525085
2023-07-25 02:11:07,151 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 1.709214448928833, ACC: 0.9200180768966675
2023-07-25 02:11:19,225 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 1.857728123664856, ACC: 0.9058473110198975
2023-07-25 02:11:30,941 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 2.0518720149993896, ACC: 0.891219973564148
2023-07-25 02:11:42,749 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 2.1813080310821533, ACC: 0.8771587610244751
2023-07-25 02:11:55,466 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 2.354447364807129, ACC: 0.8606739044189453
2023-07-25 02:12:08,163 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 2.5032289028167725, ACC: 0.8407414555549622
2023-07-25 02:12:20,062 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 2.6125500202178955, ACC: 0.8326481580734253
2023-07-25 02:12:32,136 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 2.728410005569458, ACC: 0.8185224533081055
2023-07-25 02:12:43,449 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 2.8531064987182617, ACC: 0.7980648279190063
2023-07-25 02:12:55,907 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 2.9596669673919678, ACC: 0.7722638845443726
2023-07-25 02:13:08,220 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 3.0134575366973877, ACC: 0.7609294652938843
2023-07-25 02:13:19,646 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 3.114856481552124, ACC: 0.7405508160591125
2023-07-25 02:13:31,304 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 3.1591525077819824, ACC: 0.7260809540748596
2023-07-25 02:13:43,173 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 3.2458994388580322, ACC: 0.695285439491272
2023-07-25 02:13:55,981 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 3.404876708984375, ACC: 0.6717280745506287
2023-07-25 02:14:08,226 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 3.562347888946533, ACC: 0.6417877674102783
2023-07-25 02:14:20,811 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 3.7011070251464844, ACC: 0.6283277273178101
2023-07-25 02:14:32,818 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 3.8559255599975586, ACC: 0.5917719006538391
2023-07-25 02:14:43,856 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 4.02104377746582, ACC: 0.5759905576705933
2023-07-25 02:14:55,559 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 4.142003059387207, ACC: 0.5515864491462708
2023-07-25 02:15:09,007 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 4.233785152435303, ACC: 0.5410258173942566
2023-07-25 02:15:23,161 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 4.261097431182861, ACC: 0.51971834897995
2023-07-25 02:15:36,054 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 4.297235488891602, ACC: 0.5226078629493713
2023-07-25 02:15:36,145 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-V1000_30-timesteps_vis.h5
2023-07-25 02:16:29,559 - root - INFO - ------------------ Configuration ------------------
2023-07-25 02:16:29,559 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 02:16:29,559 - root - INFO - Configuration name: afno_backbone
2023-07-25 02:16:29,559 - root - INFO - log_to_wandb True
2023-07-25 02:16:29,560 - root - INFO - lr 0.0005
2023-07-25 02:16:29,560 - root - INFO - batch_size 64
2023-07-25 02:16:29,560 - root - INFO - max_epochs 150
2023-07-25 02:16:29,560 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 02:16:29,560 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 02:16:29,560 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 02:16:29,560 - root - INFO - orography False
2023-07-25 02:16:29,560 - root - INFO - orography_path None
2023-07-25 02:16:29,560 - root - INFO - exp_dir FourCastNet/results
2023-07-25 02:16:29,560 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 02:16:29,560 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 02:16:29,560 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 02:16:29,560 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 02:16:29,560 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 02:16:29,560 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 02:16:29,560 - root - INFO - loss l2
2023-07-25 02:16:29,560 - root - INFO - num_data_workers 4
2023-07-25 02:16:29,560 - root - INFO - dt 1
2023-07-25 02:16:29,560 - root - INFO - n_history 0
2023-07-25 02:16:29,560 - root - INFO - prediction_type iterative
2023-07-25 02:16:29,560 - root - INFO - prediction_length 30
2023-07-25 02:16:29,560 - root - INFO - n_initial_conditions 5
2023-07-25 02:16:29,561 - root - INFO - ics_type default
2023-07-25 02:16:29,561 - root - INFO - save_raw_forecasts True
2023-07-25 02:16:29,561 - root - INFO - save_channel False
2023-07-25 02:16:29,561 - root - INFO - masked_acc False
2023-07-25 02:16:29,561 - root - INFO - maskpath None
2023-07-25 02:16:29,561 - root - INFO - perturb False
2023-07-25 02:16:29,561 - root - INFO - add_grid False
2023-07-25 02:16:29,561 - root - INFO - N_grid_channels 0
2023-07-25 02:16:29,561 - root - INFO - gridtype sinusoidal
2023-07-25 02:16:29,561 - root - INFO - roll False
2023-07-25 02:16:29,561 - root - INFO - num_blocks 8
2023-07-25 02:16:29,561 - root - INFO - nettype afno
2023-07-25 02:16:29,561 - root - INFO - patch_size 8
2023-07-25 02:16:29,561 - root - INFO - width 56
2023-07-25 02:16:29,561 - root - INFO - modes 32
2023-07-25 02:16:29,561 - root - INFO - target U10
2023-07-25 02:16:29,561 - root - INFO - normalization zscore
2023-07-25 02:16:29,561 - root - INFO - log_to_screen True
2023-07-25 02:16:29,562 - root - INFO - save_checkpoint True
2023-07-25 02:16:29,562 - root - INFO - enable_nhwc False
2023-07-25 02:16:29,562 - root - INFO - optimizer_type FusedAdam
2023-07-25 02:16:29,562 - root - INFO - crop_size_x None
2023-07-25 02:16:29,562 - root - INFO - crop_size_y None
2023-07-25 02:16:29,562 - root - INFO - two_step_training False
2023-07-25 02:16:29,562 - root - INFO - plot_animations False
2023-07-25 02:16:29,562 - root - INFO - add_noise False
2023-07-25 02:16:29,562 - root - INFO - noise_std 0
2023-07-25 02:16:29,562 - root - INFO - world_size 1
2023-07-25 02:16:29,562 - root - INFO - interp 0
2023-07-25 02:16:29,562 - root - INFO - use_daily_climatology False
2023-07-25 02:16:29,562 - root - INFO - global_batch_size 64
2023-07-25 02:16:29,562 - root - INFO - ablate Z1000
2023-07-25 02:16:29,562 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 02:16:29,562 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 02:16:29,562 - root - INFO - resuming False
2023-07-25 02:16:29,562 - root - INFO - local_rank 0
2023-07-25 02:16:29,562 - root - INFO - ---------------------------------------------------
2023-07-25 02:16:29,562 - root - INFO - Inference for 1 initial conditions
2023-07-25 02:16:30,100 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 02:16:30,101 - root - INFO - Number of samples per year: 1460
2023-07-25 02:16:30,101 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 02:16:30,101 - root - INFO - Delta t: 6 hours
2023-07-25 02:16:30,101 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 02:16:30,102 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 02:17:51,360 - root - INFO - Loading inference data
2023-07-25 02:17:51,361 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 02:17:51,726 - root - INFO - Initial condition 1 of 1
2023-07-25 02:17:52,549 - root - INFO - Extracting valid data from the first year
2023-07-25 02:20:39,643 - root - INFO - Standardizing data
2023-07-25 02:20:46,339 - root - INFO - Loading time means
2023-07-25 02:21:04,624 - root - INFO - Begin autoregressive inference
2023-07-25 02:21:15,057 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 02:21:26,292 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 1.1294770240783691, ACC: 0.959544837474823
2023-07-25 02:21:36,855 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 1.0112966299057007, ACC: 0.9683462977409363
2023-07-25 02:21:46,897 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 1.0276484489440918, ACC: 0.9675605297088623
2023-07-25 02:21:57,228 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 1.1501436233520508, ACC: 0.9599122405052185
2023-07-25 02:22:08,445 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 1.2127442359924316, ACC: 0.9577233195304871
2023-07-25 02:22:19,050 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 1.3391141891479492, ACC: 0.9496562480926514
2023-07-25 02:22:29,773 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 1.464281439781189, ACC: 0.9411939978599548
2023-07-25 02:22:40,211 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 1.6180248260498047, ACC: 0.9282918572425842
2023-07-25 02:22:49,393 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 1.7450348138809204, ACC: 0.9205585718154907
2023-07-25 02:22:59,473 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 1.895333170890808, ACC: 0.9064300060272217
2023-07-25 02:23:10,654 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 2.0636305809020996, ACC: 0.8914316892623901
2023-07-25 02:23:20,953 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 2.2316014766693115, ACC: 0.8719885349273682
2023-07-25 02:23:31,277 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 2.3566031455993652, ACC: 0.8627970814704895
2023-07-25 02:23:42,027 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 2.4855971336364746, ACC: 0.8493555188179016
2023-07-25 02:23:52,145 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 2.6243982315063477, ACC: 0.8287732601165771
2023-07-25 02:24:02,435 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 2.747866153717041, ACC: 0.8035631775856018
2023-07-25 02:24:13,427 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 2.8312630653381348, ACC: 0.7880170941352844
2023-07-25 02:24:23,302 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 2.9097514152526855, ACC: 0.7728292942047119
2023-07-25 02:24:33,714 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 2.9467525482177734, ACC: 0.7600786685943604
2023-07-25 02:24:44,053 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 3.014568328857422, ACC: 0.7353257536888123
2023-07-25 02:24:54,513 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 3.1482512950897217, ACC: 0.718796968460083
2023-07-25 02:25:04,982 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 3.329033136367798, ACC: 0.687802255153656
2023-07-25 02:25:15,634 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 3.4795849323272705, ACC: 0.6738359332084656
2023-07-25 02:25:26,400 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 3.6180617809295654, ACC: 0.6446065306663513
2023-07-25 02:25:36,909 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 3.71722412109375, ACC: 0.6399609446525574
2023-07-25 02:25:47,807 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 3.833966016769409, ACC: 0.6176763772964478
2023-07-25 02:25:58,299 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 3.9434995651245117, ACC: 0.6057188510894775
2023-07-25 02:26:08,314 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 3.982515811920166, ACC: 0.585823655128479
2023-07-25 02:26:18,736 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 4.056107521057129, ACC: 0.5811606645584106
2023-07-25 02:26:18,822 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-Z1000_30-timesteps_vis.h5
2023-07-25 02:27:12,122 - root - INFO - ------------------ Configuration ------------------
2023-07-25 02:27:12,122 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 02:27:12,122 - root - INFO - Configuration name: afno_backbone
2023-07-25 02:27:12,123 - root - INFO - log_to_wandb True
2023-07-25 02:27:12,123 - root - INFO - lr 0.0005
2023-07-25 02:27:12,123 - root - INFO - batch_size 64
2023-07-25 02:27:12,123 - root - INFO - max_epochs 150
2023-07-25 02:27:12,123 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 02:27:12,123 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 02:27:12,123 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 02:27:12,123 - root - INFO - orography False
2023-07-25 02:27:12,123 - root - INFO - orography_path None
2023-07-25 02:27:12,123 - root - INFO - exp_dir FourCastNet/results
2023-07-25 02:27:12,123 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 02:27:12,123 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 02:27:12,123 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 02:27:12,123 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 02:27:12,123 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 02:27:12,123 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 02:27:12,123 - root - INFO - loss l2
2023-07-25 02:27:12,124 - root - INFO - num_data_workers 4
2023-07-25 02:27:12,124 - root - INFO - dt 1
2023-07-25 02:27:12,124 - root - INFO - n_history 0
2023-07-25 02:27:12,124 - root - INFO - prediction_type iterative
2023-07-25 02:27:12,124 - root - INFO - prediction_length 30
2023-07-25 02:27:12,124 - root - INFO - n_initial_conditions 5
2023-07-25 02:27:12,124 - root - INFO - ics_type default
2023-07-25 02:27:12,124 - root - INFO - save_raw_forecasts True
2023-07-25 02:27:12,124 - root - INFO - save_channel False
2023-07-25 02:27:12,124 - root - INFO - masked_acc False
2023-07-25 02:27:12,125 - root - INFO - maskpath None
2023-07-25 02:27:12,125 - root - INFO - perturb False
2023-07-25 02:27:12,125 - root - INFO - add_grid False
2023-07-25 02:27:12,125 - root - INFO - N_grid_channels 0
2023-07-25 02:27:12,125 - root - INFO - gridtype sinusoidal
2023-07-25 02:27:12,125 - root - INFO - roll False
2023-07-25 02:27:12,125 - root - INFO - num_blocks 8
2023-07-25 02:27:12,125 - root - INFO - nettype afno
2023-07-25 02:27:12,125 - root - INFO - patch_size 8
2023-07-25 02:27:12,125 - root - INFO - width 56
2023-07-25 02:27:12,125 - root - INFO - modes 32
2023-07-25 02:27:12,125 - root - INFO - target U10
2023-07-25 02:27:12,126 - root - INFO - normalization zscore
2023-07-25 02:27:12,127 - root - INFO - log_to_screen True
2023-07-25 02:27:12,127 - root - INFO - save_checkpoint True
2023-07-25 02:27:12,127 - root - INFO - enable_nhwc False
2023-07-25 02:27:12,127 - root - INFO - optimizer_type FusedAdam
2023-07-25 02:27:12,127 - root - INFO - crop_size_x None
2023-07-25 02:27:12,127 - root - INFO - crop_size_y None
2023-07-25 02:27:12,127 - root - INFO - two_step_training False
2023-07-25 02:27:12,127 - root - INFO - plot_animations False
2023-07-25 02:27:12,127 - root - INFO - add_noise False
2023-07-25 02:27:12,127 - root - INFO - noise_std 0
2023-07-25 02:27:12,127 - root - INFO - world_size 1
2023-07-25 02:27:12,127 - root - INFO - interp 0
2023-07-25 02:27:12,127 - root - INFO - use_daily_climatology False
2023-07-25 02:27:12,127 - root - INFO - global_batch_size 64
2023-07-25 02:27:12,127 - root - INFO - ablate T850
2023-07-25 02:27:12,127 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 02:27:12,127 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 02:27:12,127 - root - INFO - resuming False
2023-07-25 02:27:12,127 - root - INFO - local_rank 0
2023-07-25 02:27:12,128 - root - INFO - ---------------------------------------------------
2023-07-25 02:27:12,128 - root - INFO - Inference for 1 initial conditions
2023-07-25 02:27:12,671 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 02:27:12,672 - root - INFO - Number of samples per year: 1460
2023-07-25 02:27:12,672 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 02:27:12,673 - root - INFO - Delta t: 6 hours
2023-07-25 02:27:12,673 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 02:27:12,673 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 02:28:46,009 - root - INFO - Loading inference data
2023-07-25 02:28:46,009 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 02:28:46,353 - root - INFO - Initial condition 1 of 1
2023-07-25 02:28:47,173 - root - INFO - Extracting valid data from the first year
2023-07-25 02:31:50,490 - root - INFO - Standardizing data
2023-07-25 02:31:56,976 - root - INFO - Loading time means
2023-07-25 02:32:15,597 - root - INFO - Begin autoregressive inference
2023-07-25 02:32:26,371 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 02:32:37,232 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 18.09833526611328, ACC: 0.2530447542667389
2023-07-25 02:32:48,411 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 76.83207702636719, ACC: 0.052559807896614075
2023-07-25 02:32:59,334 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 114.51447296142578, ACC: 0.008678874932229519
2023-07-25 02:33:10,987 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 172.4379425048828, ACC: 0.010367708280682564
2023-07-25 02:33:23,333 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 209.75608825683594, ACC: 0.01254410482943058
2023-07-25 02:33:35,082 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 234.85183715820312, ACC: 0.006621112115681171
2023-07-25 02:33:46,117 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 259.4875793457031, ACC: 0.005586234852671623
2023-07-25 02:33:57,737 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 283.6351623535156, ACC: 0.010645206086337566
2023-07-25 02:34:09,372 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 305.1117248535156, ACC: 0.010887122713029385
2023-07-25 02:34:20,026 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 322.46734619140625, ACC: 0.008301416411995888
2023-07-25 02:34:30,879 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 335.8180236816406, ACC: 0.004220764618366957
2023-07-25 02:34:41,312 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 345.8234558105469, ACC: 0.0030516672413796186
2023-07-25 02:34:52,512 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 353.2203674316406, ACC: 0.003103365655988455
2023-07-25 02:35:04,280 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 358.6048278808594, ACC: -0.0004810656828340143
2023-07-25 02:35:15,850 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 362.4112243652344, ACC: -0.0010547178098931909
2023-07-25 02:35:26,176 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 365.0706787109375, ACC: -0.004034950863569975
2023-07-25 02:35:37,388 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 366.873291015625, ACC: 0.0005268662353046238
2023-07-25 02:35:48,407 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 368.1280822753906, ACC: -0.00041292820242233574
2023-07-25 02:36:00,487 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 368.979248046875, ACC: 0.0007673448417335749
2023-07-25 02:36:12,161 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 369.5624084472656, ACC: 0.001875330344773829
2023-07-25 02:36:22,449 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 369.9537658691406, ACC: 0.005505683366209269
2023-07-25 02:36:32,864 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 370.24517822265625, ACC: 0.0034089384134858847
2023-07-25 02:36:44,309 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 370.4490051269531, ACC: 0.001966161420568824
2023-07-25 02:36:56,087 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 370.5857849121094, ACC: 0.0020944776479154825
2023-07-25 02:37:07,740 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 370.6730651855469, ACC: 0.004395596217364073
2023-07-25 02:37:18,217 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 370.74859619140625, ACC: 0.00286226999014616
2023-07-25 02:37:28,888 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 370.7951965332031, ACC: 0.0033880851697176695
2023-07-25 02:37:39,402 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 370.8321838378906, ACC: 0.0026634614914655685
2023-07-25 02:37:49,064 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 370.8544921875, ACC: 0.0033296579495072365
2023-07-25 02:37:49,151 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-T850_30-timesteps_vis.h5
2023-07-25 02:38:42,226 - root - INFO - ------------------ Configuration ------------------
2023-07-25 02:38:42,227 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 02:38:42,227 - root - INFO - Configuration name: afno_backbone
2023-07-25 02:38:42,227 - root - INFO - log_to_wandb True
2023-07-25 02:38:42,227 - root - INFO - lr 0.0005
2023-07-25 02:38:42,227 - root - INFO - batch_size 64
2023-07-25 02:38:42,227 - root - INFO - max_epochs 150
2023-07-25 02:38:42,227 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 02:38:42,227 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 02:38:42,227 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 02:38:42,227 - root - INFO - orography False
2023-07-25 02:38:42,227 - root - INFO - orography_path None
2023-07-25 02:38:42,227 - root - INFO - exp_dir FourCastNet/results
2023-07-25 02:38:42,228 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 02:38:42,228 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 02:38:42,228 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 02:38:42,228 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 02:38:42,228 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 02:38:42,228 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 02:38:42,228 - root - INFO - loss l2
2023-07-25 02:38:42,228 - root - INFO - num_data_workers 4
2023-07-25 02:38:42,228 - root - INFO - dt 1
2023-07-25 02:38:42,228 - root - INFO - n_history 0
2023-07-25 02:38:42,228 - root - INFO - prediction_type iterative
2023-07-25 02:38:42,228 - root - INFO - prediction_length 30
2023-07-25 02:38:42,228 - root - INFO - n_initial_conditions 5
2023-07-25 02:38:42,228 - root - INFO - ics_type default
2023-07-25 02:38:42,228 - root - INFO - save_raw_forecasts True
2023-07-25 02:38:42,228 - root - INFO - save_channel False
2023-07-25 02:38:42,228 - root - INFO - masked_acc False
2023-07-25 02:38:42,228 - root - INFO - maskpath None
2023-07-25 02:38:42,228 - root - INFO - perturb False
2023-07-25 02:38:42,228 - root - INFO - add_grid False
2023-07-25 02:38:42,229 - root - INFO - N_grid_channels 0
2023-07-25 02:38:42,229 - root - INFO - gridtype sinusoidal
2023-07-25 02:38:42,229 - root - INFO - roll False
2023-07-25 02:38:42,229 - root - INFO - num_blocks 8
2023-07-25 02:38:42,229 - root - INFO - nettype afno
2023-07-25 02:38:42,229 - root - INFO - patch_size 8
2023-07-25 02:38:42,229 - root - INFO - width 56
2023-07-25 02:38:42,229 - root - INFO - modes 32
2023-07-25 02:38:42,229 - root - INFO - target U10
2023-07-25 02:38:42,229 - root - INFO - normalization zscore
2023-07-25 02:38:42,229 - root - INFO - log_to_screen True
2023-07-25 02:38:42,229 - root - INFO - save_checkpoint True
2023-07-25 02:38:42,229 - root - INFO - enable_nhwc False
2023-07-25 02:38:42,229 - root - INFO - optimizer_type FusedAdam
2023-07-25 02:38:42,229 - root - INFO - crop_size_x None
2023-07-25 02:38:42,229 - root - INFO - crop_size_y None
2023-07-25 02:38:42,229 - root - INFO - two_step_training False
2023-07-25 02:38:42,229 - root - INFO - plot_animations False
2023-07-25 02:38:42,229 - root - INFO - add_noise False
2023-07-25 02:38:42,230 - root - INFO - noise_std 0
2023-07-25 02:38:42,230 - root - INFO - world_size 1
2023-07-25 02:38:42,230 - root - INFO - interp 0
2023-07-25 02:38:42,230 - root - INFO - use_daily_climatology False
2023-07-25 02:38:42,230 - root - INFO - global_batch_size 64
2023-07-25 02:38:42,230 - root - INFO - ablate U850
2023-07-25 02:38:42,230 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 02:38:42,230 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 02:38:42,230 - root - INFO - resuming False
2023-07-25 02:38:42,230 - root - INFO - local_rank 0
2023-07-25 02:38:42,230 - root - INFO - ---------------------------------------------------
2023-07-25 02:38:42,230 - root - INFO - Inference for 1 initial conditions
2023-07-25 02:38:42,676 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 02:38:42,677 - root - INFO - Number of samples per year: 1460
2023-07-25 02:38:42,677 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 02:38:42,677 - root - INFO - Delta t: 6 hours
2023-07-25 02:38:42,678 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 02:38:42,678 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 02:40:02,098 - root - INFO - Loading inference data
2023-07-25 02:40:02,099 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 02:40:02,415 - root - INFO - Initial condition 1 of 1
2023-07-25 02:40:03,339 - root - INFO - Extracting valid data from the first year
2023-07-25 02:42:49,103 - root - INFO - Standardizing data
2023-07-25 02:42:55,492 - root - INFO - Loading time means
2023-07-25 02:43:12,707 - root - INFO - Begin autoregressive inference
2023-07-25 02:43:22,897 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 02:43:33,208 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 0.9518685340881348, ACC: 0.9714365005493164
2023-07-25 02:43:43,968 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 1.3757096529006958, ACC: 0.9410685300827026
2023-07-25 02:43:54,097 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 1.4507712125778198, ACC: 0.9344393610954285
2023-07-25 02:44:04,294 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 1.5388656854629517, ACC: 0.926948070526123
2023-07-25 02:44:14,836 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 1.5806175470352173, ACC: 0.9269596934318542
2023-07-25 02:44:25,179 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 1.6368300914764404, ACC: 0.9238545894622803
2023-07-25 02:44:34,904 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 1.708932876586914, ACC: 0.9193793535232544
2023-07-25 02:44:43,916 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 1.8282909393310547, ACC: 0.9081316590309143
2023-07-25 02:44:54,070 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 1.9948605298995972, ACC: 0.8962291479110718
2023-07-25 02:45:04,047 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 2.126254081726074, ACC: 0.8831775188446045
2023-07-25 02:45:15,200 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 2.247012138366699, ACC: 0.8729915618896484
2023-07-25 02:45:25,840 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 2.3944616317749023, ACC: 0.8550581336021423
2023-07-25 02:45:36,027 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 2.5406267642974854, ACC: 0.8428542017936707
2023-07-25 02:45:46,586 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 2.7140727043151855, ACC: 0.822459876537323
2023-07-25 02:45:56,442 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 2.866236686706543, ACC: 0.7991465330123901
2023-07-25 02:46:05,513 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 3.017273187637329, ACC: 0.7676474452018738
2023-07-25 02:46:15,897 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 3.124507188796997, ACC: 0.7475460171699524
2023-07-25 02:46:25,850 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 3.200417995452881, ACC: 0.7316353917121887
2023-07-25 02:46:35,853 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 3.251598596572876, ACC: 0.7153958082199097
2023-07-25 02:46:45,859 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 3.3489606380462646, ACC: 0.6813452243804932
2023-07-25 02:46:56,033 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 3.4960925579071045, ACC: 0.6571213603019714
2023-07-25 02:47:06,291 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 3.6857173442840576, ACC: 0.6183973550796509
2023-07-25 02:47:16,229 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 3.768251419067383, ACC: 0.6134835481643677
2023-07-25 02:47:25,543 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 3.808121681213379, ACC: 0.5978837013244629
2023-07-25 02:47:36,717 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 3.8870692253112793, ACC: 0.5939851999282837
2023-07-25 02:47:46,804 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 4.016726493835449, ACC: 0.5678443312644958
2023-07-25 02:47:56,702 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 4.126410007476807, ACC: 0.552649974822998
2023-07-25 02:48:06,359 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 4.195819854736328, ACC: 0.5242211818695068
2023-07-25 02:48:17,007 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 4.26801872253418, ACC: 0.5214734077453613
2023-07-25 02:48:17,093 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-U850_30-timesteps_vis.h5
2023-07-25 02:49:10,219 - root - INFO - ------------------ Configuration ------------------
2023-07-25 02:49:10,219 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 02:49:10,219 - root - INFO - Configuration name: afno_backbone
2023-07-25 02:49:10,219 - root - INFO - log_to_wandb True
2023-07-25 02:49:10,219 - root - INFO - lr 0.0005
2023-07-25 02:49:10,219 - root - INFO - batch_size 64
2023-07-25 02:49:10,219 - root - INFO - max_epochs 150
2023-07-25 02:49:10,220 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 02:49:10,220 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 02:49:10,220 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 02:49:10,220 - root - INFO - orography False
2023-07-25 02:49:10,220 - root - INFO - orography_path None
2023-07-25 02:49:10,220 - root - INFO - exp_dir FourCastNet/results
2023-07-25 02:49:10,220 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 02:49:10,220 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 02:49:10,220 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 02:49:10,220 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 02:49:10,220 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 02:49:10,220 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 02:49:10,220 - root - INFO - loss l2
2023-07-25 02:49:10,220 - root - INFO - num_data_workers 4
2023-07-25 02:49:10,220 - root - INFO - dt 1
2023-07-25 02:49:10,220 - root - INFO - n_history 0
2023-07-25 02:49:10,220 - root - INFO - prediction_type iterative
2023-07-25 02:49:10,220 - root - INFO - prediction_length 30
2023-07-25 02:49:10,220 - root - INFO - n_initial_conditions 5
2023-07-25 02:49:10,220 - root - INFO - ics_type default
2023-07-25 02:49:10,221 - root - INFO - save_raw_forecasts True
2023-07-25 02:49:10,221 - root - INFO - save_channel False
2023-07-25 02:49:10,221 - root - INFO - masked_acc False
2023-07-25 02:49:10,221 - root - INFO - maskpath None
2023-07-25 02:49:10,221 - root - INFO - perturb False
2023-07-25 02:49:10,221 - root - INFO - add_grid False
2023-07-25 02:49:10,221 - root - INFO - N_grid_channels 0
2023-07-25 02:49:10,221 - root - INFO - gridtype sinusoidal
2023-07-25 02:49:10,221 - root - INFO - roll False
2023-07-25 02:49:10,221 - root - INFO - num_blocks 8
2023-07-25 02:49:10,221 - root - INFO - nettype afno
2023-07-25 02:49:10,221 - root - INFO - patch_size 8
2023-07-25 02:49:10,221 - root - INFO - width 56
2023-07-25 02:49:10,221 - root - INFO - modes 32
2023-07-25 02:49:10,221 - root - INFO - target U10
2023-07-25 02:49:10,221 - root - INFO - normalization zscore
2023-07-25 02:49:10,221 - root - INFO - log_to_screen True
2023-07-25 02:49:10,221 - root - INFO - save_checkpoint True
2023-07-25 02:49:10,221 - root - INFO - enable_nhwc False
2023-07-25 02:49:10,222 - root - INFO - optimizer_type FusedAdam
2023-07-25 02:49:10,222 - root - INFO - crop_size_x None
2023-07-25 02:49:10,222 - root - INFO - crop_size_y None
2023-07-25 02:49:10,222 - root - INFO - two_step_training False
2023-07-25 02:49:10,222 - root - INFO - plot_animations False
2023-07-25 02:49:10,222 - root - INFO - add_noise False
2023-07-25 02:49:10,222 - root - INFO - noise_std 0
2023-07-25 02:49:10,222 - root - INFO - world_size 1
2023-07-25 02:49:10,222 - root - INFO - interp 0
2023-07-25 02:49:10,222 - root - INFO - use_daily_climatology False
2023-07-25 02:49:10,222 - root - INFO - global_batch_size 64
2023-07-25 02:49:10,222 - root - INFO - ablate V850
2023-07-25 02:49:10,222 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 02:49:10,222 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 02:49:10,222 - root - INFO - resuming False
2023-07-25 02:49:10,222 - root - INFO - local_rank 0
2023-07-25 02:49:10,222 - root - INFO - ---------------------------------------------------
2023-07-25 02:49:10,223 - root - INFO - Inference for 1 initial conditions
2023-07-25 02:49:10,551 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 02:49:10,552 - root - INFO - Number of samples per year: 1460
2023-07-25 02:49:10,553 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 02:49:10,553 - root - INFO - Delta t: 6 hours
2023-07-25 02:49:10,553 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 02:49:10,553 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 02:50:24,211 - root - INFO - Loading inference data
2023-07-25 02:50:24,212 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 02:50:24,433 - root - INFO - Initial condition 1 of 1
2023-07-25 02:50:25,256 - root - INFO - Extracting valid data from the first year
2023-07-25 02:52:55,421 - root - INFO - Standardizing data
2023-07-25 02:53:02,391 - root - INFO - Loading time means
2023-07-25 02:53:18,771 - root - INFO - Begin autoregressive inference
2023-07-25 02:53:29,921 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 02:53:41,006 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 0.9561775326728821, ACC: 0.971569836139679
2023-07-25 02:53:52,094 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 1.0930825471878052, ACC: 0.9630449414253235
2023-07-25 02:54:03,473 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 1.1629645824432373, ACC: 0.9582533240318298
2023-07-25 02:54:14,641 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 1.281864881515503, ACC: 0.9499300122261047
2023-07-25 02:54:25,370 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 1.3248591423034668, ACC: 0.9492591619491577
2023-07-25 02:54:36,368 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 1.413232684135437, ACC: 0.9436485767364502
2023-07-25 02:54:46,855 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 1.512276291847229, ACC: 0.9370037317276001
2023-07-25 02:54:57,637 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 1.63555908203125, ACC: 0.9263975620269775
2023-07-25 02:55:08,709 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 1.7771985530853271, ACC: 0.9171849489212036
2023-07-25 02:55:19,905 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 1.9038712978363037, ACC: 0.9053890109062195
2023-07-25 02:55:30,223 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 2.0331614017486572, ACC: 0.8945860266685486
2023-07-25 02:55:41,244 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 2.183126449584961, ACC: 0.8777503967285156
2023-07-25 02:55:52,916 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 2.3144922256469727, ACC: 0.8681190013885498
2023-07-25 02:56:03,315 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 2.416691303253174, ACC: 0.8581553101539612
2023-07-25 02:56:15,002 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 2.5633671283721924, ACC: 0.8377586007118225
2023-07-25 02:56:25,837 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 2.6787796020507812, ACC: 0.8149778246879578
2023-07-25 02:56:37,003 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 2.787432909011841, ACC: 0.7969393134117126
2023-07-25 02:56:48,093 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 2.9023520946502686, ACC: 0.7766070365905762
2023-07-25 02:56:59,040 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 2.9740078449249268, ACC: 0.7591389417648315
2023-07-25 02:57:09,477 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 3.0279958248138428, ACC: 0.7375673055648804
2023-07-25 02:57:19,605 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 3.1563642024993896, ACC: 0.7223157286643982
2023-07-25 02:57:29,829 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 3.318382501602173, ACC: 0.6942575573921204
2023-07-25 02:57:40,319 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 3.4119582176208496, ACC: 0.6874966621398926
2023-07-25 02:57:51,817 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 3.452479362487793, ACC: 0.6723741888999939
2023-07-25 02:58:02,543 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 3.5022225379943848, ACC: 0.6728155612945557
2023-07-25 02:58:12,547 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 3.581023931503296, ACC: 0.6563543677330017
2023-07-25 02:58:23,112 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 3.656670093536377, ACC: 0.647659420967102
2023-07-25 02:58:33,992 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 3.6958887577056885, ACC: 0.626839280128479
2023-07-25 02:58:44,153 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 3.745692253112793, ACC: 0.6270289421081543
2023-07-25 02:58:44,237 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-V850_30-timesteps_vis.h5
2023-07-25 02:59:37,625 - root - INFO - ------------------ Configuration ------------------
2023-07-25 02:59:37,625 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 02:59:37,625 - root - INFO - Configuration name: afno_backbone
2023-07-25 02:59:37,625 - root - INFO - log_to_wandb True
2023-07-25 02:59:37,625 - root - INFO - lr 0.0005
2023-07-25 02:59:37,625 - root - INFO - batch_size 64
2023-07-25 02:59:37,625 - root - INFO - max_epochs 150
2023-07-25 02:59:37,625 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 02:59:37,626 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 02:59:37,626 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 02:59:37,626 - root - INFO - orography False
2023-07-25 02:59:37,626 - root - INFO - orography_path None
2023-07-25 02:59:37,626 - root - INFO - exp_dir FourCastNet/results
2023-07-25 02:59:37,626 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 02:59:37,626 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 02:59:37,626 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 02:59:37,626 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 02:59:37,626 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 02:59:37,626 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 02:59:37,626 - root - INFO - loss l2
2023-07-25 02:59:37,626 - root - INFO - num_data_workers 4
2023-07-25 02:59:37,626 - root - INFO - dt 1
2023-07-25 02:59:37,626 - root - INFO - n_history 0
2023-07-25 02:59:37,626 - root - INFO - prediction_type iterative
2023-07-25 02:59:37,626 - root - INFO - prediction_length 30
2023-07-25 02:59:37,626 - root - INFO - n_initial_conditions 5
2023-07-25 02:59:37,626 - root - INFO - ics_type default
2023-07-25 02:59:37,626 - root - INFO - save_raw_forecasts True
2023-07-25 02:59:37,626 - root - INFO - save_channel False
2023-07-25 02:59:37,626 - root - INFO - masked_acc False
2023-07-25 02:59:37,626 - root - INFO - maskpath None
2023-07-25 02:59:37,626 - root - INFO - perturb False
2023-07-25 02:59:37,626 - root - INFO - add_grid False
2023-07-25 02:59:37,627 - root - INFO - N_grid_channels 0
2023-07-25 02:59:37,627 - root - INFO - gridtype sinusoidal
2023-07-25 02:59:37,627 - root - INFO - roll False
2023-07-25 02:59:37,627 - root - INFO - num_blocks 8
2023-07-25 02:59:37,627 - root - INFO - nettype afno
2023-07-25 02:59:37,627 - root - INFO - patch_size 8
2023-07-25 02:59:37,627 - root - INFO - width 56
2023-07-25 02:59:37,627 - root - INFO - modes 32
2023-07-25 02:59:37,627 - root - INFO - target U10
2023-07-25 02:59:37,627 - root - INFO - normalization zscore
2023-07-25 02:59:37,627 - root - INFO - log_to_screen True
2023-07-25 02:59:37,627 - root - INFO - save_checkpoint True
2023-07-25 02:59:37,627 - root - INFO - enable_nhwc False
2023-07-25 02:59:37,627 - root - INFO - optimizer_type FusedAdam
2023-07-25 02:59:37,627 - root - INFO - crop_size_x None
2023-07-25 02:59:37,627 - root - INFO - crop_size_y None
2023-07-25 02:59:37,627 - root - INFO - two_step_training False
2023-07-25 02:59:37,627 - root - INFO - plot_animations False
2023-07-25 02:59:37,627 - root - INFO - add_noise False
2023-07-25 02:59:37,627 - root - INFO - noise_std 0
2023-07-25 02:59:37,627 - root - INFO - world_size 1
2023-07-25 02:59:37,627 - root - INFO - interp 0
2023-07-25 02:59:37,627 - root - INFO - use_daily_climatology False
2023-07-25 02:59:37,627 - root - INFO - global_batch_size 64
2023-07-25 02:59:37,627 - root - INFO - ablate Z850
2023-07-25 02:59:37,627 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 02:59:37,627 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 02:59:37,628 - root - INFO - resuming False
2023-07-25 02:59:37,628 - root - INFO - local_rank 0
2023-07-25 02:59:37,628 - root - INFO - ---------------------------------------------------
2023-07-25 02:59:37,628 - root - INFO - Inference for 1 initial conditions
2023-07-25 02:59:38,014 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 02:59:38,016 - root - INFO - Number of samples per year: 1460
2023-07-25 02:59:38,016 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 02:59:38,016 - root - INFO - Delta t: 6 hours
2023-07-25 02:59:38,016 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 02:59:38,016 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 03:00:50,920 - root - INFO - Loading inference data
2023-07-25 03:00:50,923 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 03:00:51,164 - root - INFO - Initial condition 1 of 1
2023-07-25 03:00:52,073 - root - INFO - Extracting valid data from the first year
2023-07-25 03:03:29,221 - root - INFO - Standardizing data
2023-07-25 03:03:36,326 - root - INFO - Loading time means
2023-07-25 03:03:50,737 - root - INFO - Begin autoregressive inference
2023-07-25 03:04:01,503 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 03:04:13,381 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 28.166261672973633, ACC: 0.19081169366836548
2023-07-25 03:04:24,580 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 177.9534454345703, ACC: 0.044366538524627686
2023-07-25 03:04:36,029 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 225.58572387695312, ACC: 0.02706918679177761
2023-07-25 03:04:47,230 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 239.572998046875, ACC: 0.01694454997777939
2023-07-25 03:04:58,604 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 256.1572265625, ACC: 0.019633961841464043
2023-07-25 03:05:10,840 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 278.70123291015625, ACC: 0.013854422606527805
2023-07-25 03:05:23,492 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 301.2325744628906, ACC: 0.010620239190757275
2023-07-25 03:05:36,802 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 319.8262023925781, ACC: 0.011684244498610497
2023-07-25 03:05:48,488 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 334.1387939453125, ACC: 0.009931715205311775
2023-07-25 03:06:00,038 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 344.9079895019531, ACC: 0.006488030310720205
2023-07-25 03:06:12,518 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 352.7868957519531, ACC: 0.002645180094987154
2023-07-25 03:06:24,247 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 358.3771057128906, ACC: 0.0024749054573476315
2023-07-25 03:06:35,751 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 362.2738952636719, ACC: 0.0029532217886298895
2023-07-25 03:06:47,893 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 364.97735595703125, ACC: -0.00042125280015170574
2023-07-25 03:06:59,834 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 366.82281494140625, ACC: -0.0010532692540436983
2023-07-25 03:07:10,924 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 368.0966796875, ACC: -0.003929354716092348
2023-07-25 03:07:22,891 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 368.9417419433594, ACC: 0.000526582938618958
2023-07-25 03:07:34,739 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 369.54229736328125, ACC: -0.00041684930329211056
2023-07-25 03:07:45,856 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 369.9490966796875, ACC: 0.0007644100696779788
2023-07-25 03:07:56,870 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 370.23040771484375, ACC: 0.0018922121962532401
2023-07-25 03:08:08,316 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 370.4164123535156, ACC: 0.005499419756233692
2023-07-25 03:08:19,693 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 370.56732177734375, ACC: 0.003402794012799859
2023-07-25 03:08:30,986 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 370.674560546875, ACC: 0.0019530088175088167
2023-07-25 03:08:42,239 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 370.744384765625, ACC: 0.002090568421408534
2023-07-25 03:08:53,345 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 370.7851257324219, ACC: 0.004389000125229359
2023-07-25 03:09:04,415 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 370.82806396484375, ACC: 0.0028591668233275414
2023-07-25 03:09:15,321 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 370.8516540527344, ACC: 0.0033855929505079985
2023-07-25 03:09:26,446 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 370.8724670410156, ACC: 0.0026632912922650576
2023-07-25 03:09:38,042 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 370.8832702636719, ACC: 0.0033281894866377115
2023-07-25 03:09:38,131 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-Z850_30-timesteps_vis.h5
2023-07-25 03:10:31,334 - root - INFO - ------------------ Configuration ------------------
2023-07-25 03:10:31,334 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 03:10:31,334 - root - INFO - Configuration name: afno_backbone
2023-07-25 03:10:31,334 - root - INFO - log_to_wandb True
2023-07-25 03:10:31,334 - root - INFO - lr 0.0005
2023-07-25 03:10:31,334 - root - INFO - batch_size 64
2023-07-25 03:10:31,334 - root - INFO - max_epochs 150
2023-07-25 03:10:31,335 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 03:10:31,335 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 03:10:31,335 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 03:10:31,335 - root - INFO - orography False
2023-07-25 03:10:31,335 - root - INFO - orography_path None
2023-07-25 03:10:31,335 - root - INFO - exp_dir FourCastNet/results
2023-07-25 03:10:31,335 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 03:10:31,335 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 03:10:31,335 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 03:10:31,335 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 03:10:31,335 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 03:10:31,335 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 03:10:31,335 - root - INFO - loss l2
2023-07-25 03:10:31,335 - root - INFO - num_data_workers 4
2023-07-25 03:10:31,335 - root - INFO - dt 1
2023-07-25 03:10:31,335 - root - INFO - n_history 0
2023-07-25 03:10:31,335 - root - INFO - prediction_type iterative
2023-07-25 03:10:31,335 - root - INFO - prediction_length 30
2023-07-25 03:10:31,335 - root - INFO - n_initial_conditions 5
2023-07-25 03:10:31,335 - root - INFO - ics_type default
2023-07-25 03:10:31,335 - root - INFO - save_raw_forecasts True
2023-07-25 03:10:31,335 - root - INFO - save_channel False
2023-07-25 03:10:31,335 - root - INFO - masked_acc False
2023-07-25 03:10:31,335 - root - INFO - maskpath None
2023-07-25 03:10:31,335 - root - INFO - perturb False
2023-07-25 03:10:31,335 - root - INFO - add_grid False
2023-07-25 03:10:31,336 - root - INFO - N_grid_channels 0
2023-07-25 03:10:31,336 - root - INFO - gridtype sinusoidal
2023-07-25 03:10:31,336 - root - INFO - roll False
2023-07-25 03:10:31,336 - root - INFO - num_blocks 8
2023-07-25 03:10:31,336 - root - INFO - nettype afno
2023-07-25 03:10:31,336 - root - INFO - patch_size 8
2023-07-25 03:10:31,336 - root - INFO - width 56
2023-07-25 03:10:31,336 - root - INFO - modes 32
2023-07-25 03:10:31,336 - root - INFO - target U10
2023-07-25 03:10:31,336 - root - INFO - normalization zscore
2023-07-25 03:10:31,336 - root - INFO - log_to_screen True
2023-07-25 03:10:31,336 - root - INFO - save_checkpoint True
2023-07-25 03:10:31,336 - root - INFO - enable_nhwc False
2023-07-25 03:10:31,336 - root - INFO - optimizer_type FusedAdam
2023-07-25 03:10:31,336 - root - INFO - crop_size_x None
2023-07-25 03:10:31,336 - root - INFO - crop_size_y None
2023-07-25 03:10:31,336 - root - INFO - two_step_training False
2023-07-25 03:10:31,336 - root - INFO - plot_animations False
2023-07-25 03:10:31,336 - root - INFO - add_noise False
2023-07-25 03:10:31,336 - root - INFO - noise_std 0
2023-07-25 03:10:31,336 - root - INFO - world_size 1
2023-07-25 03:10:31,336 - root - INFO - interp 0
2023-07-25 03:10:31,336 - root - INFO - use_daily_climatology False
2023-07-25 03:10:31,336 - root - INFO - global_batch_size 64
2023-07-25 03:10:31,337 - root - INFO - ablate RH850
2023-07-25 03:10:31,337 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 03:10:31,337 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 03:10:31,337 - root - INFO - resuming False
2023-07-25 03:10:31,337 - root - INFO - local_rank 0
2023-07-25 03:10:31,337 - root - INFO - ---------------------------------------------------
2023-07-25 03:10:31,337 - root - INFO - Inference for 1 initial conditions
2023-07-25 03:10:31,682 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 03:10:31,684 - root - INFO - Number of samples per year: 1460
2023-07-25 03:10:31,686 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 03:10:31,687 - root - INFO - Delta t: 6 hours
2023-07-25 03:10:31,687 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 03:10:31,688 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 03:11:49,253 - root - INFO - Loading inference data
2023-07-25 03:11:49,254 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 03:11:49,487 - root - INFO - Initial condition 1 of 1
2023-07-25 03:11:50,392 - root - INFO - Extracting valid data from the first year
2023-07-25 03:14:34,327 - root - INFO - Standardizing data
2023-07-25 03:14:41,125 - root - INFO - Loading time means
2023-07-25 03:14:58,361 - root - INFO - Begin autoregressive inference
2023-07-25 03:15:11,485 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 03:15:23,193 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 1.1839559078216553, ACC: 0.9559586048126221
2023-07-25 03:15:34,092 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 1.3466225862503052, ACC: 0.9431600570678711
2023-07-25 03:15:46,237 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 1.451069712638855, ACC: 0.9342161417007446
2023-07-25 03:15:57,124 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 1.5874079465866089, ACC: 0.9221372008323669
2023-07-25 03:16:08,309 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 1.702918529510498, ACC: 0.9148111939430237
2023-07-25 03:16:20,099 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 1.8181695938110352, ACC: 0.9050684571266174
2023-07-25 03:16:30,153 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 1.9355310201644897, ACC: 0.894527792930603
2023-07-25 03:16:40,624 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 2.0540504455566406, ACC: 0.8810886144638062
2023-07-25 03:16:51,835 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 2.265334129333496, ACC: 0.8619335293769836
2023-07-25 03:17:02,656 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 2.3951871395111084, ACC: 0.8472267985343933
2023-07-25 03:17:13,424 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 2.543630361557007, ACC: 0.8326115608215332
2023-07-25 03:17:23,415 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 2.7028298377990723, ACC: 0.8111040592193604
2023-07-25 03:17:34,613 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 2.849026679992676, ACC: 0.7995163798332214
2023-07-25 03:17:45,671 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 2.948448419570923, ACC: 0.7881491184234619
2023-07-25 03:17:56,548 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 3.063413381576538, ACC: 0.7687229514122009
2023-07-25 03:18:07,591 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 3.2085514068603516, ACC: 0.7361247539520264
2023-07-25 03:18:17,932 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 3.329489231109619, ACC: 0.7132514715194702
2023-07-25 03:18:29,400 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 3.437527894973755, ACC: 0.690325140953064
2023-07-25 03:18:40,665 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 3.5039010047912598, ACC: 0.6715403199195862
2023-07-25 03:18:51,914 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 3.6035566329956055, ACC: 0.6349440813064575
2023-07-25 03:19:02,370 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 3.756427049636841, ACC: 0.6109774112701416
2023-07-25 03:19:12,902 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 3.924180269241333, ACC: 0.5740162134170532
2023-07-25 03:19:23,287 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 4.089070796966553, ACC: 0.5507398843765259
2023-07-25 03:19:33,566 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 4.215431213378906, ACC: 0.5102823972702026
2023-07-25 03:19:45,015 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 4.271983623504639, ACC: 0.5103294253349304
2023-07-25 03:19:55,250 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 4.287202835083008, ACC: 0.5043922662734985
2023-07-25 03:20:07,126 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 4.337283611297607, ACC: 0.5017919540405273
2023-07-25 03:20:18,210 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 4.316738128662109, ACC: 0.49560898542404175
2023-07-25 03:20:29,014 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 4.399213790893555, ACC: 0.49709418416023254
2023-07-25 03:20:29,111 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-RH850_30-timesteps_vis.h5
2023-07-25 03:21:22,479 - root - INFO - ------------------ Configuration ------------------
2023-07-25 03:21:22,479 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 03:21:22,479 - root - INFO - Configuration name: afno_backbone
2023-07-25 03:21:22,479 - root - INFO - log_to_wandb True
2023-07-25 03:21:22,479 - root - INFO - lr 0.0005
2023-07-25 03:21:22,479 - root - INFO - batch_size 64
2023-07-25 03:21:22,480 - root - INFO - max_epochs 150
2023-07-25 03:21:22,480 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 03:21:22,480 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 03:21:22,480 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 03:21:22,480 - root - INFO - orography False
2023-07-25 03:21:22,480 - root - INFO - orography_path None
2023-07-25 03:21:22,480 - root - INFO - exp_dir FourCastNet/results
2023-07-25 03:21:22,480 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 03:21:22,480 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 03:21:22,480 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 03:21:22,480 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 03:21:22,480 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 03:21:22,480 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 03:21:22,480 - root - INFO - loss l2
2023-07-25 03:21:22,480 - root - INFO - num_data_workers 4
2023-07-25 03:21:22,480 - root - INFO - dt 1
2023-07-25 03:21:22,480 - root - INFO - n_history 0
2023-07-25 03:21:22,480 - root - INFO - prediction_type iterative
2023-07-25 03:21:22,480 - root - INFO - prediction_length 30
2023-07-25 03:21:22,481 - root - INFO - n_initial_conditions 5
2023-07-25 03:21:22,481 - root - INFO - ics_type default
2023-07-25 03:21:22,481 - root - INFO - save_raw_forecasts True
2023-07-25 03:21:22,481 - root - INFO - save_channel False
2023-07-25 03:21:22,481 - root - INFO - masked_acc False
2023-07-25 03:21:22,481 - root - INFO - maskpath None
2023-07-25 03:21:22,481 - root - INFO - perturb False
2023-07-25 03:21:22,481 - root - INFO - add_grid False
2023-07-25 03:21:22,481 - root - INFO - N_grid_channels 0
2023-07-25 03:21:22,481 - root - INFO - gridtype sinusoidal
2023-07-25 03:21:22,481 - root - INFO - roll False
2023-07-25 03:21:22,481 - root - INFO - num_blocks 8
2023-07-25 03:21:22,481 - root - INFO - nettype afno
2023-07-25 03:21:22,481 - root - INFO - patch_size 8
2023-07-25 03:21:22,481 - root - INFO - width 56
2023-07-25 03:21:22,481 - root - INFO - modes 32
2023-07-25 03:21:22,481 - root - INFO - target U10
2023-07-25 03:21:22,481 - root - INFO - normalization zscore
2023-07-25 03:21:22,481 - root - INFO - log_to_screen True
2023-07-25 03:21:22,482 - root - INFO - save_checkpoint True
2023-07-25 03:21:22,482 - root - INFO - enable_nhwc False
2023-07-25 03:21:22,482 - root - INFO - optimizer_type FusedAdam
2023-07-25 03:21:22,482 - root - INFO - crop_size_x None
2023-07-25 03:21:22,482 - root - INFO - crop_size_y None
2023-07-25 03:21:22,482 - root - INFO - two_step_training False
2023-07-25 03:21:22,482 - root - INFO - plot_animations False
2023-07-25 03:21:22,482 - root - INFO - add_noise False
2023-07-25 03:21:22,482 - root - INFO - noise_std 0
2023-07-25 03:21:22,482 - root - INFO - world_size 1
2023-07-25 03:21:22,482 - root - INFO - interp 0
2023-07-25 03:21:22,482 - root - INFO - use_daily_climatology False
2023-07-25 03:21:22,482 - root - INFO - global_batch_size 64
2023-07-25 03:21:22,482 - root - INFO - ablate T500
2023-07-25 03:21:22,482 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 03:21:22,482 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 03:21:22,482 - root - INFO - resuming False
2023-07-25 03:21:22,482 - root - INFO - local_rank 0
2023-07-25 03:21:22,483 - root - INFO - ---------------------------------------------------
2023-07-25 03:21:22,483 - root - INFO - Inference for 1 initial conditions
2023-07-25 03:21:22,769 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 03:21:22,770 - root - INFO - Number of samples per year: 1460
2023-07-25 03:21:22,770 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 03:21:22,770 - root - INFO - Delta t: 6 hours
2023-07-25 03:21:22,770 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 03:21:22,771 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 03:22:42,051 - root - INFO - Loading inference data
2023-07-25 03:22:42,052 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 03:22:42,316 - root - INFO - Initial condition 1 of 1
2023-07-25 03:22:43,154 - root - INFO - Extracting valid data from the first year
2023-07-25 03:25:27,162 - root - INFO - Standardizing data
2023-07-25 03:25:34,396 - root - INFO - Loading time means
2023-07-25 03:25:51,081 - root - INFO - Begin autoregressive inference
2023-07-25 03:26:02,385 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 03:26:13,204 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 0.7669153809547424, ACC: 0.9815952777862549
2023-07-25 03:26:23,529 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 1.029616117477417, ACC: 0.9671263694763184
2023-07-25 03:26:34,981 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 1.1414697170257568, ACC: 0.9597994089126587
2023-07-25 03:26:46,106 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 1.2562034130096436, ACC: 0.9519885778427124
2023-07-25 03:26:58,090 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 1.3408286571502686, ACC: 0.9480648636817932
2023-07-25 03:27:08,526 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 1.4709866046905518, ACC: 0.9388715624809265
2023-07-25 03:27:19,317 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 1.5901880264282227, ACC: 0.9301364421844482
2023-07-25 03:27:30,795 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 1.7231366634368896, ACC: 0.9177074432373047
2023-07-25 03:27:40,837 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 1.8485937118530273, ACC: 0.9095426201820374
2023-07-25 03:27:51,994 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 1.9527807235717773, ACC: 0.8997059464454651
2023-07-25 03:28:02,672 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 2.0789778232574463, ACC: 0.889213502407074
2023-07-25 03:28:13,948 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 2.246145486831665, ACC: 0.8701766133308411
2023-07-25 03:28:24,268 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 2.3988349437713623, ACC: 0.8578411340713501
2023-07-25 03:28:35,170 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 2.5266215801239014, ACC: 0.8446469902992249
2023-07-25 03:28:45,799 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 2.6842637062072754, ACC: 0.8218002319335938
2023-07-25 03:28:56,756 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 2.8137457370758057, ACC: 0.7955223917961121
2023-07-25 03:29:08,033 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 2.9444141387939453, ACC: 0.7723855376243591
2023-07-25 03:29:18,712 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 3.039748191833496, ACC: 0.7542262077331543
2023-07-25 03:29:30,355 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 3.0669472217559814, ACC: 0.7426077127456665
2023-07-25 03:29:42,378 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 3.0723159313201904, ACC: 0.7277914881706238
2023-07-25 03:29:54,210 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 3.1141719818115234, ACC: 0.726076066493988
2023-07-25 03:30:06,162 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 3.2223150730133057, ACC: 0.7078624963760376
2023-07-25 03:30:19,477 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 3.3557915687561035, ACC: 0.6950863599777222
2023-07-25 03:30:30,120 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 3.477581739425659, ACC: 0.6684083938598633
2023-07-25 03:30:42,970 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 3.629106283187866, ACC: 0.6522870659828186
2023-07-25 03:30:54,395 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 3.779888391494751, ACC: 0.6220883727073669
2023-07-25 03:31:06,054 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 3.9557604789733887, ACC: 0.5943903923034668
2023-07-25 03:31:18,476 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 4.107611656188965, ACC: 0.5493559241294861
2023-07-25 03:31:30,179 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 4.2210516929626465, ACC: 0.5356040596961975
2023-07-25 03:31:30,265 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-T500_30-timesteps_vis.h5
2023-07-25 03:32:23,676 - root - INFO - ------------------ Configuration ------------------
2023-07-25 03:32:23,677 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 03:32:23,677 - root - INFO - Configuration name: afno_backbone
2023-07-25 03:32:23,677 - root - INFO - log_to_wandb True
2023-07-25 03:32:23,677 - root - INFO - lr 0.0005
2023-07-25 03:32:23,677 - root - INFO - batch_size 64
2023-07-25 03:32:23,677 - root - INFO - max_epochs 150
2023-07-25 03:32:23,677 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 03:32:23,677 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 03:32:23,677 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 03:32:23,677 - root - INFO - orography False
2023-07-25 03:32:23,677 - root - INFO - orography_path None
2023-07-25 03:32:23,677 - root - INFO - exp_dir FourCastNet/results
2023-07-25 03:32:23,677 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 03:32:23,677 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 03:32:23,677 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 03:32:23,678 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 03:32:23,678 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 03:32:23,678 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 03:32:23,678 - root - INFO - loss l2
2023-07-25 03:32:23,678 - root - INFO - num_data_workers 4
2023-07-25 03:32:23,678 - root - INFO - dt 1
2023-07-25 03:32:23,678 - root - INFO - n_history 0
2023-07-25 03:32:23,678 - root - INFO - prediction_type iterative
2023-07-25 03:32:23,678 - root - INFO - prediction_length 30
2023-07-25 03:32:23,678 - root - INFO - n_initial_conditions 5
2023-07-25 03:32:23,678 - root - INFO - ics_type default
2023-07-25 03:32:23,678 - root - INFO - save_raw_forecasts True
2023-07-25 03:32:23,678 - root - INFO - save_channel False
2023-07-25 03:32:23,678 - root - INFO - masked_acc False
2023-07-25 03:32:23,678 - root - INFO - maskpath None
2023-07-25 03:32:23,678 - root - INFO - perturb False
2023-07-25 03:32:23,678 - root - INFO - add_grid False
2023-07-25 03:32:23,678 - root - INFO - N_grid_channels 0
2023-07-25 03:32:23,679 - root - INFO - gridtype sinusoidal
2023-07-25 03:32:23,679 - root - INFO - roll False
2023-07-25 03:32:23,679 - root - INFO - num_blocks 8
2023-07-25 03:32:23,679 - root - INFO - nettype afno
2023-07-25 03:32:23,679 - root - INFO - patch_size 8
2023-07-25 03:32:23,679 - root - INFO - width 56
2023-07-25 03:32:23,679 - root - INFO - modes 32
2023-07-25 03:32:23,679 - root - INFO - target U10
2023-07-25 03:32:23,679 - root - INFO - normalization zscore
2023-07-25 03:32:23,679 - root - INFO - log_to_screen True
2023-07-25 03:32:23,679 - root - INFO - save_checkpoint True
2023-07-25 03:32:23,679 - root - INFO - enable_nhwc False
2023-07-25 03:32:23,679 - root - INFO - optimizer_type FusedAdam
2023-07-25 03:32:23,679 - root - INFO - crop_size_x None
2023-07-25 03:32:23,679 - root - INFO - crop_size_y None
2023-07-25 03:32:23,679 - root - INFO - two_step_training False
2023-07-25 03:32:23,680 - root - INFO - plot_animations False
2023-07-25 03:32:23,680 - root - INFO - add_noise False
2023-07-25 03:32:23,680 - root - INFO - noise_std 0
2023-07-25 03:32:23,680 - root - INFO - world_size 1
2023-07-25 03:32:23,680 - root - INFO - interp 0
2023-07-25 03:32:23,680 - root - INFO - use_daily_climatology False
2023-07-25 03:32:23,680 - root - INFO - global_batch_size 64
2023-07-25 03:32:23,680 - root - INFO - ablate U500
2023-07-25 03:32:23,680 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 03:32:23,680 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 03:32:23,680 - root - INFO - resuming False
2023-07-25 03:32:23,680 - root - INFO - local_rank 0
2023-07-25 03:32:23,680 - root - INFO - ---------------------------------------------------
2023-07-25 03:32:23,680 - root - INFO - Inference for 1 initial conditions
2023-07-25 03:32:23,968 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 03:32:23,969 - root - INFO - Number of samples per year: 1460
2023-07-25 03:32:23,969 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 03:32:23,969 - root - INFO - Delta t: 6 hours
2023-07-25 03:32:23,969 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 03:32:23,970 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 03:33:45,956 - root - INFO - Loading inference data
2023-07-25 03:33:45,957 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 03:33:46,235 - root - INFO - Initial condition 1 of 1
2023-07-25 03:33:47,201 - root - INFO - Extracting valid data from the first year
2023-07-25 03:36:23,625 - root - INFO - Standardizing data
2023-07-25 03:36:30,948 - root - INFO - Loading time means
2023-07-25 03:36:46,404 - root - INFO - Begin autoregressive inference
2023-07-25 03:36:58,083 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 03:37:10,635 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 22.65984535217285, ACC: 0.16220985352993011
2023-07-25 03:37:21,520 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 177.9950714111328, ACC: 0.03844255581498146
2023-07-25 03:37:31,876 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 219.2020721435547, ACC: 0.010694136843085289
2023-07-25 03:37:42,350 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 237.05490112304688, ACC: 0.003168725408613682
2023-07-25 03:37:52,319 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 260.51312255859375, ACC: 0.007523259613662958
2023-07-25 03:38:02,328 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 287.20965576171875, ACC: 0.008199797943234444
2023-07-25 03:38:13,184 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 310.2465515136719, ACC: 0.00815536268055439
2023-07-25 03:38:23,938 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 327.7359313964844, ACC: 0.01098036952316761
2023-07-25 03:38:34,220 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 340.53515625, ACC: 0.009814165532588959
2023-07-25 03:38:45,376 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 349.8020324707031, ACC: 0.006600857712328434
2023-07-25 03:38:55,345 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 356.4032287597656, ACC: 0.0027205958031117916
2023-07-25 03:39:05,964 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 360.9892272949219, ACC: 0.0024956909473985434
2023-07-25 03:39:17,688 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 364.1310119628906, ACC: 0.00292200013063848
2023-07-25 03:39:27,998 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 366.2840881347656, ACC: -0.0004069546121172607
2023-07-25 03:39:39,859 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 367.73846435546875, ACC: -0.0010421667248010635
2023-07-25 03:39:49,878 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 368.7379150390625, ACC: -0.003913425374776125
2023-07-25 03:40:01,184 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 369.3918762207031, ACC: 0.0005067578167654574
2023-07-25 03:40:11,470 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 369.8592224121094, ACC: -0.0004308890493120998
2023-07-25 03:40:22,019 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 370.1728820800781, ACC: 0.0007480779313482344
2023-07-25 03:40:32,407 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 370.38897705078125, ACC: 0.001877298578619957
2023-07-25 03:40:43,208 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 370.5290832519531, ACC: 0.00547637976706028
2023-07-25 03:40:54,025 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 370.64752197265625, ACC: 0.00338509539142251
2023-07-25 03:41:03,909 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 370.7318115234375, ACC: 0.0019402618054300547
2023-07-25 03:41:16,491 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 370.7852783203125, ACC: 0.0020844689570367336
2023-07-25 03:41:26,723 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 370.8144226074219, ACC: 0.0043837763369083405
2023-07-25 03:41:36,696 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 370.84906005859375, ACC: 0.002855266211554408
2023-07-25 03:41:47,222 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 370.8667297363281, ACC: 0.0033827563747763634
2023-07-25 03:41:57,974 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 370.8832702636719, ACC: 0.0026622347068041563
2023-07-25 03:42:07,927 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 370.89105224609375, ACC: 0.0033271450083702803
2023-07-25 03:42:08,028 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-U500_30-timesteps_vis.h5
2023-07-25 03:43:01,553 - root - INFO - ------------------ Configuration ------------------
2023-07-25 03:43:01,553 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 03:43:01,553 - root - INFO - Configuration name: afno_backbone
2023-07-25 03:43:01,553 - root - INFO - log_to_wandb True
2023-07-25 03:43:01,553 - root - INFO - lr 0.0005
2023-07-25 03:43:01,553 - root - INFO - batch_size 64
2023-07-25 03:43:01,553 - root - INFO - max_epochs 150
2023-07-25 03:43:01,553 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 03:43:01,553 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 03:43:01,553 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 03:43:01,554 - root - INFO - orography False
2023-07-25 03:43:01,554 - root - INFO - orography_path None
2023-07-25 03:43:01,554 - root - INFO - exp_dir FourCastNet/results
2023-07-25 03:43:01,554 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 03:43:01,554 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 03:43:01,554 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 03:43:01,554 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 03:43:01,554 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 03:43:01,554 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 03:43:01,554 - root - INFO - loss l2
2023-07-25 03:43:01,554 - root - INFO - num_data_workers 4
2023-07-25 03:43:01,554 - root - INFO - dt 1
2023-07-25 03:43:01,554 - root - INFO - n_history 0
2023-07-25 03:43:01,554 - root - INFO - prediction_type iterative
2023-07-25 03:43:01,554 - root - INFO - prediction_length 30
2023-07-25 03:43:01,554 - root - INFO - n_initial_conditions 5
2023-07-25 03:43:01,554 - root - INFO - ics_type default
2023-07-25 03:43:01,554 - root - INFO - save_raw_forecasts True
2023-07-25 03:43:01,555 - root - INFO - save_channel False
2023-07-25 03:43:01,555 - root - INFO - masked_acc False
2023-07-25 03:43:01,555 - root - INFO - maskpath None
2023-07-25 03:43:01,555 - root - INFO - perturb False
2023-07-25 03:43:01,555 - root - INFO - add_grid False
2023-07-25 03:43:01,555 - root - INFO - N_grid_channels 0
2023-07-25 03:43:01,555 - root - INFO - gridtype sinusoidal
2023-07-25 03:43:01,555 - root - INFO - roll False
2023-07-25 03:43:01,555 - root - INFO - num_blocks 8
2023-07-25 03:43:01,555 - root - INFO - nettype afno
2023-07-25 03:43:01,555 - root - INFO - patch_size 8
2023-07-25 03:43:01,555 - root - INFO - width 56
2023-07-25 03:43:01,555 - root - INFO - modes 32
2023-07-25 03:43:01,555 - root - INFO - target U10
2023-07-25 03:43:01,555 - root - INFO - normalization zscore
2023-07-25 03:43:01,555 - root - INFO - log_to_screen True
2023-07-25 03:43:01,555 - root - INFO - save_checkpoint True
2023-07-25 03:43:01,555 - root - INFO - enable_nhwc False
2023-07-25 03:43:01,556 - root - INFO - optimizer_type FusedAdam
2023-07-25 03:43:01,556 - root - INFO - crop_size_x None
2023-07-25 03:43:01,556 - root - INFO - crop_size_y None
2023-07-25 03:43:01,556 - root - INFO - two_step_training False
2023-07-25 03:43:01,556 - root - INFO - plot_animations False
2023-07-25 03:43:01,556 - root - INFO - add_noise False
2023-07-25 03:43:01,556 - root - INFO - noise_std 0
2023-07-25 03:43:01,556 - root - INFO - world_size 1
2023-07-25 03:43:01,556 - root - INFO - interp 0
2023-07-25 03:43:01,556 - root - INFO - use_daily_climatology False
2023-07-25 03:43:01,556 - root - INFO - global_batch_size 64
2023-07-25 03:43:01,556 - root - INFO - ablate V500
2023-07-25 03:43:01,556 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 03:43:01,556 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 03:43:01,556 - root - INFO - resuming False
2023-07-25 03:43:01,556 - root - INFO - local_rank 0
2023-07-25 03:43:01,556 - root - INFO - ---------------------------------------------------
2023-07-25 03:43:01,556 - root - INFO - Inference for 1 initial conditions
2023-07-25 03:43:01,944 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 03:43:01,945 - root - INFO - Number of samples per year: 1460
2023-07-25 03:43:01,945 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 03:43:01,945 - root - INFO - Delta t: 6 hours
2023-07-25 03:43:01,945 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 03:43:01,945 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 03:44:09,128 - root - INFO - Loading inference data
2023-07-25 03:44:09,129 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 03:44:09,424 - root - INFO - Initial condition 1 of 1
2023-07-25 03:44:10,230 - root - INFO - Extracting valid data from the first year
2023-07-25 03:46:40,269 - root - INFO - Standardizing data
2023-07-25 03:46:47,220 - root - INFO - Loading time means
2023-07-25 03:47:02,918 - root - INFO - Begin autoregressive inference
2023-07-25 03:47:14,078 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 03:47:25,006 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 136.88853454589844, ACC: 0.02292960323393345
2023-07-25 03:47:36,082 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 196.84698486328125, ACC: 0.026612209156155586
2023-07-25 03:47:46,792 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 224.85867309570312, ACC: 0.02205526828765869
2023-07-25 03:47:57,040 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 248.9437713623047, ACC: 0.01252822857350111
2023-07-25 03:48:07,238 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 275.057373046875, ACC: 0.013110838830471039
2023-07-25 03:48:17,767 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 299.569580078125, ACC: 0.009220571257174015
2023-07-25 03:48:29,308 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 319.3544921875, ACC: 0.008274094201624393
2023-07-25 03:48:39,757 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 334.2652893066406, ACC: 0.009888495318591595
2023-07-25 03:48:50,881 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 345.092041015625, ACC: 0.008620566688477993
2023-07-25 03:49:02,027 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 352.8742370605469, ACC: 0.006010056938976049
2023-07-25 03:49:13,552 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 358.167724609375, ACC: 0.0026625171303749084
2023-07-25 03:49:23,736 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 361.82379150390625, ACC: 0.0032206117175519466
2023-07-25 03:49:34,440 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 364.4002990722656, ACC: 0.0035885185934603214
2023-07-25 03:49:46,066 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 366.2817687988281, ACC: 0.00010724861931521446
2023-07-25 03:49:56,617 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 367.65325927734375, ACC: -0.0006527734221890569
2023-07-25 03:50:09,442 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 368.6499938964844, ACC: -0.003703083610162139
2023-07-25 03:50:20,712 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 369.32177734375, ACC: 0.0006051651434972882
2023-07-25 03:50:31,316 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 369.808837890625, ACC: -0.00039443105924874544
2023-07-25 03:50:41,334 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 370.1398620605469, ACC: 0.0007674668449908495
2023-07-25 03:50:53,167 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 370.3688049316406, ACC: 0.0018835432128980756
2023-07-25 03:51:04,447 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 370.5174865722656, ACC: 0.005482684355229139
2023-07-25 03:51:16,694 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 370.6413269042969, ACC: 0.0033928093034774065
2023-07-25 03:51:27,259 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 370.7287292480469, ACC: 0.00194828980602324
2023-07-25 03:51:38,524 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 370.7839050292969, ACC: 0.002087144646793604
2023-07-25 03:51:49,340 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 370.8139343261719, ACC: 0.004385401960462332
2023-07-25 03:52:01,136 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 370.84906005859375, ACC: 0.002856967505067587
2023-07-25 03:52:13,289 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 370.866943359375, ACC: 0.0033835815265774727
2023-07-25 03:52:24,973 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 370.8835754394531, ACC: 0.0026612663641572
2023-07-25 03:52:35,499 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 370.891357421875, ACC: 0.003326267236843705
2023-07-25 03:52:35,589 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-V500_30-timesteps_vis.h5
2023-07-25 03:53:28,869 - root - INFO - ------------------ Configuration ------------------
2023-07-25 03:53:28,869 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 03:53:28,869 - root - INFO - Configuration name: afno_backbone
2023-07-25 03:53:28,870 - root - INFO - log_to_wandb True
2023-07-25 03:53:28,870 - root - INFO - lr 0.0005
2023-07-25 03:53:28,870 - root - INFO - batch_size 64
2023-07-25 03:53:28,870 - root - INFO - max_epochs 150
2023-07-25 03:53:28,870 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 03:53:28,870 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 03:53:28,870 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 03:53:28,870 - root - INFO - orography False
2023-07-25 03:53:28,870 - root - INFO - orography_path None
2023-07-25 03:53:28,870 - root - INFO - exp_dir FourCastNet/results
2023-07-25 03:53:28,870 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 03:53:28,870 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 03:53:28,870 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 03:53:28,870 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 03:53:28,870 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 03:53:28,870 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 03:53:28,870 - root - INFO - loss l2
2023-07-25 03:53:28,870 - root - INFO - num_data_workers 4
2023-07-25 03:53:28,870 - root - INFO - dt 1
2023-07-25 03:53:28,870 - root - INFO - n_history 0
2023-07-25 03:53:28,870 - root - INFO - prediction_type iterative
2023-07-25 03:53:28,870 - root - INFO - prediction_length 30
2023-07-25 03:53:28,870 - root - INFO - n_initial_conditions 5
2023-07-25 03:53:28,870 - root - INFO - ics_type default
2023-07-25 03:53:28,871 - root - INFO - save_raw_forecasts True
2023-07-25 03:53:28,871 - root - INFO - save_channel False
2023-07-25 03:53:28,871 - root - INFO - masked_acc False
2023-07-25 03:53:28,871 - root - INFO - maskpath None
2023-07-25 03:53:28,871 - root - INFO - perturb False
2023-07-25 03:53:28,871 - root - INFO - add_grid False
2023-07-25 03:53:28,871 - root - INFO - N_grid_channels 0
2023-07-25 03:53:28,871 - root - INFO - gridtype sinusoidal
2023-07-25 03:53:28,871 - root - INFO - roll False
2023-07-25 03:53:28,871 - root - INFO - num_blocks 8
2023-07-25 03:53:28,871 - root - INFO - nettype afno
2023-07-25 03:53:28,871 - root - INFO - patch_size 8
2023-07-25 03:53:28,871 - root - INFO - width 56
2023-07-25 03:53:28,871 - root - INFO - modes 32
2023-07-25 03:53:28,871 - root - INFO - target U10
2023-07-25 03:53:28,871 - root - INFO - normalization zscore
2023-07-25 03:53:28,871 - root - INFO - log_to_screen True
2023-07-25 03:53:28,871 - root - INFO - save_checkpoint True
2023-07-25 03:53:28,871 - root - INFO - enable_nhwc False
2023-07-25 03:53:28,871 - root - INFO - optimizer_type FusedAdam
2023-07-25 03:53:28,871 - root - INFO - crop_size_x None
2023-07-25 03:53:28,871 - root - INFO - crop_size_y None
2023-07-25 03:53:28,871 - root - INFO - two_step_training False
2023-07-25 03:53:28,871 - root - INFO - plot_animations False
2023-07-25 03:53:28,871 - root - INFO - add_noise False
2023-07-25 03:53:28,871 - root - INFO - noise_std 0
2023-07-25 03:53:28,871 - root - INFO - world_size 1
2023-07-25 03:53:28,871 - root - INFO - interp 0
2023-07-25 03:53:28,871 - root - INFO - use_daily_climatology False
2023-07-25 03:53:28,872 - root - INFO - global_batch_size 64
2023-07-25 03:53:28,872 - root - INFO - ablate Z500
2023-07-25 03:53:28,872 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 03:53:28,872 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 03:53:28,872 - root - INFO - resuming False
2023-07-25 03:53:28,872 - root - INFO - local_rank 0
2023-07-25 03:53:28,872 - root - INFO - ---------------------------------------------------
2023-07-25 03:53:28,872 - root - INFO - Inference for 1 initial conditions
2023-07-25 03:53:29,130 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 03:53:29,131 - root - INFO - Number of samples per year: 1460
2023-07-25 03:53:29,131 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 03:53:29,131 - root - INFO - Delta t: 6 hours
2023-07-25 03:53:29,131 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 03:53:29,131 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 03:54:34,052 - root - INFO - Loading inference data
2023-07-25 03:54:34,056 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 03:54:34,285 - root - INFO - Initial condition 1 of 1
2023-07-25 03:54:35,086 - root - INFO - Extracting valid data from the first year
2023-07-25 03:56:52,977 - root - INFO - Standardizing data
2023-07-25 03:57:00,195 - root - INFO - Loading time means
2023-07-25 03:57:14,048 - root - INFO - Begin autoregressive inference
2023-07-25 03:57:25,800 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 03:57:37,318 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 0.5660403966903687, ACC: 0.989997148513794
2023-07-25 03:57:48,237 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 0.8013003468513489, ACC: 0.9802305698394775
2023-07-25 03:57:59,898 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 0.9061262011528015, ACC: 0.9749621152877808
2023-07-25 03:58:10,563 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 1.0617295503616333, ACC: 0.9660378098487854
2023-07-25 03:58:21,858 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 1.1714690923690796, ACC: 0.9608712196350098
2023-07-25 03:58:33,144 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 1.3364156484603882, ACC: 0.9502685070037842
2023-07-25 03:58:43,835 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 1.4951971769332886, ACC: 0.9391950368881226
2023-07-25 03:58:55,287 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 1.6802960634231567, ACC: 0.9232691526412964
2023-07-25 03:59:05,678 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 1.8340153694152832, ACC: 0.9132764339447021
2023-07-25 03:59:16,990 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 2.025378942489624, ACC: 0.8942458033561707
2023-07-25 03:59:27,347 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 2.226224899291992, ACC: 0.8751810193061829
2023-07-25 03:59:38,250 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 2.409980058670044, ACC: 0.8527137637138367
2023-07-25 03:59:50,307 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 2.577674627304077, ACC: 0.8381539583206177
2023-07-25 04:00:01,052 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 2.693845272064209, ACC: 0.8241246342658997
2023-07-25 04:00:14,725 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 2.850922107696533, ACC: 0.7982845306396484
2023-07-25 04:00:25,521 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 3.0072646141052246, ACC: 0.7641071677207947
2023-07-25 04:00:36,915 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 3.105234384536743, ACC: 0.7455694675445557
2023-07-25 04:00:48,064 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 3.211698532104492, ACC: 0.724746823310852
2023-07-25 04:00:58,756 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 3.261545419692993, ACC: 0.7105552554130554
2023-07-25 04:01:10,351 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 3.3327767848968506, ACC: 0.68239426612854
2023-07-25 04:01:21,490 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 3.4663095474243164, ACC: 0.6665670275688171
2023-07-25 04:01:33,048 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 3.654811382293701, ACC: 0.6296504735946655
2023-07-25 04:01:44,244 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 3.862919330596924, ACC: 0.6018576622009277
2023-07-25 04:01:55,867 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 4.044543266296387, ACC: 0.5521793365478516
2023-07-25 04:02:06,447 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 4.280909061431885, ACC: 0.5184127688407898
2023-07-25 04:02:16,809 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 4.47785758972168, ACC: 0.46772727370262146
2023-07-25 04:02:26,930 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 4.555673599243164, ACC: 0.4592127501964569
2023-07-25 04:02:37,250 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 4.592173099517822, ACC: 0.4319205582141876
2023-07-25 04:02:48,766 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 4.748369216918945, ACC: 0.41149985790252686
2023-07-25 04:02:48,855 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-Z500_30-timesteps_vis.h5
2023-07-25 04:03:42,023 - root - INFO - ------------------ Configuration ------------------
2023-07-25 04:03:42,023 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 04:03:42,023 - root - INFO - Configuration name: afno_backbone
2023-07-25 04:03:42,023 - root - INFO - log_to_wandb True
2023-07-25 04:03:42,023 - root - INFO - lr 0.0005
2023-07-25 04:03:42,023 - root - INFO - batch_size 64
2023-07-25 04:03:42,023 - root - INFO - max_epochs 150
2023-07-25 04:03:42,023 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 04:03:42,023 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 04:03:42,023 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 04:03:42,024 - root - INFO - orography False
2023-07-25 04:03:42,024 - root - INFO - orography_path None
2023-07-25 04:03:42,024 - root - INFO - exp_dir FourCastNet/results
2023-07-25 04:03:42,024 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 04:03:42,024 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 04:03:42,024 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 04:03:42,024 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 04:03:42,024 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 04:03:42,024 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 04:03:42,024 - root - INFO - loss l2
2023-07-25 04:03:42,024 - root - INFO - num_data_workers 4
2023-07-25 04:03:42,024 - root - INFO - dt 1
2023-07-25 04:03:42,024 - root - INFO - n_history 0
2023-07-25 04:03:42,024 - root - INFO - prediction_type iterative
2023-07-25 04:03:42,024 - root - INFO - prediction_length 30
2023-07-25 04:03:42,024 - root - INFO - n_initial_conditions 5
2023-07-25 04:03:42,024 - root - INFO - ics_type default
2023-07-25 04:03:42,024 - root - INFO - save_raw_forecasts True
2023-07-25 04:03:42,024 - root - INFO - save_channel False
2023-07-25 04:03:42,024 - root - INFO - masked_acc False
2023-07-25 04:03:42,025 - root - INFO - maskpath None
2023-07-25 04:03:42,025 - root - INFO - perturb False
2023-07-25 04:03:42,025 - root - INFO - add_grid False
2023-07-25 04:03:42,025 - root - INFO - N_grid_channels 0
2023-07-25 04:03:42,025 - root - INFO - gridtype sinusoidal
2023-07-25 04:03:42,025 - root - INFO - roll False
2023-07-25 04:03:42,025 - root - INFO - num_blocks 8
2023-07-25 04:03:42,025 - root - INFO - nettype afno
2023-07-25 04:03:42,025 - root - INFO - patch_size 8
2023-07-25 04:03:42,025 - root - INFO - width 56
2023-07-25 04:03:42,025 - root - INFO - modes 32
2023-07-25 04:03:42,025 - root - INFO - target U10
2023-07-25 04:03:42,025 - root - INFO - normalization zscore
2023-07-25 04:03:42,025 - root - INFO - log_to_screen True
2023-07-25 04:03:42,025 - root - INFO - save_checkpoint True
2023-07-25 04:03:42,025 - root - INFO - enable_nhwc False
2023-07-25 04:03:42,025 - root - INFO - optimizer_type FusedAdam
2023-07-25 04:03:42,025 - root - INFO - crop_size_x None
2023-07-25 04:03:42,025 - root - INFO - crop_size_y None
2023-07-25 04:03:42,026 - root - INFO - two_step_training False
2023-07-25 04:03:42,026 - root - INFO - plot_animations False
2023-07-25 04:03:42,026 - root - INFO - add_noise False
2023-07-25 04:03:42,026 - root - INFO - noise_std 0
2023-07-25 04:03:42,026 - root - INFO - world_size 1
2023-07-25 04:03:42,026 - root - INFO - interp 0
2023-07-25 04:03:42,026 - root - INFO - use_daily_climatology False
2023-07-25 04:03:42,026 - root - INFO - global_batch_size 64
2023-07-25 04:03:42,026 - root - INFO - ablate RH500
2023-07-25 04:03:42,026 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 04:03:42,026 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 04:03:42,026 - root - INFO - resuming False
2023-07-25 04:03:42,026 - root - INFO - local_rank 0
2023-07-25 04:03:42,026 - root - INFO - ---------------------------------------------------
2023-07-25 04:03:42,026 - root - INFO - Inference for 1 initial conditions
2023-07-25 04:03:42,365 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 04:03:42,365 - root - INFO - Number of samples per year: 1460
2023-07-25 04:03:42,366 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 04:03:42,366 - root - INFO - Delta t: 6 hours
2023-07-25 04:03:42,366 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 04:03:42,366 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 04:05:01,317 - root - INFO - Loading inference data
2023-07-25 04:05:01,318 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 04:05:01,603 - root - INFO - Initial condition 1 of 1
2023-07-25 04:05:02,393 - root - INFO - Extracting valid data from the first year
2023-07-25 04:07:54,603 - root - INFO - Standardizing data
2023-07-25 04:08:02,225 - root - INFO - Loading time means
2023-07-25 04:08:19,770 - root - INFO - Begin autoregressive inference
2023-07-25 04:08:30,455 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 04:08:41,174 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 0.5762086510658264, ACC: 0.9896329641342163
2023-07-25 04:08:52,299 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 0.7977530360221863, ACC: 0.9803915023803711
2023-07-25 04:09:02,410 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 0.8907912969589233, ACC: 0.9757210612297058
2023-07-25 04:09:12,071 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 1.0464470386505127, ACC: 0.9669231176376343
2023-07-25 04:09:22,093 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 1.1639995574951172, ACC: 0.9612258672714233
2023-07-25 04:09:32,420 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 1.2999467849731445, ACC: 0.9528149366378784
2023-07-25 04:09:42,467 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 1.43623685836792, ACC: 0.9438394904136658
2023-07-25 04:09:53,400 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 1.5667188167572021, ACC: 0.933212399482727
2023-07-25 04:10:03,996 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 1.7154346704483032, ACC: 0.9238338470458984
2023-07-25 04:10:15,737 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 1.8580719232559204, ACC: 0.9106813669204712
2023-07-25 04:10:26,174 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 2.0408196449279785, ACC: 0.894790768623352
2023-07-25 04:10:36,856 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 2.2372994422912598, ACC: 0.8726986050605774
2023-07-25 04:10:47,394 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 2.4177939891815186, ACC: 0.8572671413421631
2023-07-25 04:10:58,370 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 2.569474935531616, ACC: 0.8407777547836304
2023-07-25 04:11:10,144 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 2.74249267578125, ACC: 0.8154072165489197
2023-07-25 04:11:20,683 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 2.892174482345581, ACC: 0.785071611404419
2023-07-25 04:11:31,448 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 2.9963526725769043, ACC: 0.765802800655365
2023-07-25 04:11:42,875 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 3.1143062114715576, ACC: 0.7434388399124146
2023-07-25 04:11:53,275 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 3.1635756492614746, ACC: 0.7280709147453308
2023-07-25 04:12:05,449 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 3.2097089290618896, ACC: 0.704123318195343
2023-07-25 04:12:16,504 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 3.317786931991577, ACC: 0.6923664212226868
2023-07-25 04:12:27,276 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 3.456491470336914, ACC: 0.6679806113243103
2023-07-25 04:12:38,011 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 3.5931413173675537, ACC: 0.6583704948425293
2023-07-25 04:12:48,131 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 3.6544792652130127, ACC: 0.6434184312820435
2023-07-25 04:12:59,446 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 3.7356696128845215, ACC: 0.6444429755210876
2023-07-25 04:13:10,688 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 3.805713653564453, ACC: 0.632783055305481
2023-07-25 04:13:22,126 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 3.8960516452789307, ACC: 0.6256029009819031
2023-07-25 04:13:32,383 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 3.9832146167755127, ACC: 0.5962665677070618
2023-07-25 04:13:42,433 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 4.066806793212891, ACC: 0.5876457095146179
2023-07-25 04:13:42,521 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-RH500_30-timesteps_vis.h5
2023-07-25 04:14:36,256 - root - INFO - ------------------ Configuration ------------------
2023-07-25 04:14:36,257 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 04:14:36,257 - root - INFO - Configuration name: afno_backbone
2023-07-25 04:14:36,257 - root - INFO - log_to_wandb True
2023-07-25 04:14:36,257 - root - INFO - lr 0.0005
2023-07-25 04:14:36,257 - root - INFO - batch_size 64
2023-07-25 04:14:36,257 - root - INFO - max_epochs 150
2023-07-25 04:14:36,257 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 04:14:36,257 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 04:14:36,257 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 04:14:36,257 - root - INFO - orography False
2023-07-25 04:14:36,257 - root - INFO - orography_path None
2023-07-25 04:14:36,257 - root - INFO - exp_dir FourCastNet/results
2023-07-25 04:14:36,257 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 04:14:36,258 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 04:14:36,258 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 04:14:36,258 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 04:14:36,258 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 04:14:36,258 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 04:14:36,258 - root - INFO - loss l2
2023-07-25 04:14:36,258 - root - INFO - num_data_workers 4
2023-07-25 04:14:36,258 - root - INFO - dt 1
2023-07-25 04:14:36,258 - root - INFO - n_history 0
2023-07-25 04:14:36,258 - root - INFO - prediction_type iterative
2023-07-25 04:14:36,258 - root - INFO - prediction_length 30
2023-07-25 04:14:36,258 - root - INFO - n_initial_conditions 5
2023-07-25 04:14:36,258 - root - INFO - ics_type default
2023-07-25 04:14:36,258 - root - INFO - save_raw_forecasts True
2023-07-25 04:14:36,258 - root - INFO - save_channel False
2023-07-25 04:14:36,258 - root - INFO - masked_acc False
2023-07-25 04:14:36,258 - root - INFO - maskpath None
2023-07-25 04:14:36,259 - root - INFO - perturb False
2023-07-25 04:14:36,259 - root - INFO - add_grid False
2023-07-25 04:14:36,259 - root - INFO - N_grid_channels 0
2023-07-25 04:14:36,259 - root - INFO - gridtype sinusoidal
2023-07-25 04:14:36,259 - root - INFO - roll False
2023-07-25 04:14:36,259 - root - INFO - num_blocks 8
2023-07-25 04:14:36,259 - root - INFO - nettype afno
2023-07-25 04:14:36,259 - root - INFO - patch_size 8
2023-07-25 04:14:36,259 - root - INFO - width 56
2023-07-25 04:14:36,259 - root - INFO - modes 32
2023-07-25 04:14:36,259 - root - INFO - target U10
2023-07-25 04:14:36,259 - root - INFO - normalization zscore
2023-07-25 04:14:36,259 - root - INFO - log_to_screen True
2023-07-25 04:14:36,259 - root - INFO - save_checkpoint True
2023-07-25 04:14:36,259 - root - INFO - enable_nhwc False
2023-07-25 04:14:36,259 - root - INFO - optimizer_type FusedAdam
2023-07-25 04:14:36,260 - root - INFO - crop_size_x None
2023-07-25 04:14:36,260 - root - INFO - crop_size_y None
2023-07-25 04:14:36,260 - root - INFO - two_step_training False
2023-07-25 04:14:36,260 - root - INFO - plot_animations False
2023-07-25 04:14:36,260 - root - INFO - add_noise False
2023-07-25 04:14:36,260 - root - INFO - noise_std 0
2023-07-25 04:14:36,260 - root - INFO - world_size 1
2023-07-25 04:14:36,260 - root - INFO - interp 0
2023-07-25 04:14:36,260 - root - INFO - use_daily_climatology False
2023-07-25 04:14:36,260 - root - INFO - global_batch_size 64
2023-07-25 04:14:36,260 - root - INFO - ablate Z50
2023-07-25 04:14:36,260 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 04:14:36,260 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 04:14:36,260 - root - INFO - resuming False
2023-07-25 04:14:36,260 - root - INFO - local_rank 0
2023-07-25 04:14:36,260 - root - INFO - ---------------------------------------------------
2023-07-25 04:14:36,260 - root - INFO - Inference for 1 initial conditions
2023-07-25 04:14:36,624 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 04:14:36,625 - root - INFO - Number of samples per year: 1460
2023-07-25 04:14:36,625 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 04:14:36,625 - root - INFO - Delta t: 6 hours
2023-07-25 04:14:36,626 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 04:14:36,626 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 04:16:01,182 - root - INFO - Loading inference data
2023-07-25 04:16:01,182 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 04:16:01,517 - root - INFO - Initial condition 1 of 1
2023-07-25 04:16:02,374 - root - INFO - Extracting valid data from the first year
2023-07-25 04:18:56,206 - root - INFO - Standardizing data
2023-07-25 04:19:03,490 - root - INFO - Loading time means
2023-07-25 04:19:23,465 - root - INFO - Begin autoregressive inference
2023-07-25 04:19:33,973 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 04:19:45,635 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 0.646761417388916, ACC: 0.9869176149368286
2023-07-25 04:19:56,896 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 0.8732665181159973, ACC: 0.9764671325683594
2023-07-25 04:20:08,327 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 0.9474982023239136, ACC: 0.9725949168205261
2023-07-25 04:20:20,021 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 1.0858640670776367, ACC: 0.9644456505775452
2023-07-25 04:20:31,472 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 1.1691386699676514, ACC: 0.9609740972518921
2023-07-25 04:20:42,185 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 1.3018087148666382, ACC: 0.9528552889823914
2023-07-25 04:20:53,933 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 1.420596957206726, ACC: 0.9452722668647766
2023-07-25 04:21:04,656 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 1.5596951246261597, ACC: 0.9342193007469177
2023-07-25 04:21:16,239 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 1.6737796068191528, ACC: 0.9277523159980774
2023-07-25 04:21:26,797 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 1.8135572671890259, ACC: 0.9153724312782288
2023-07-25 04:21:37,420 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 1.9538193941116333, ACC: 0.9037788510322571
2023-07-25 04:21:47,450 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 2.1205708980560303, ACC: 0.8856105804443359
2023-07-25 04:21:58,414 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 2.2605690956115723, ACC: 0.8747196197509766
2023-07-25 04:22:10,385 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 2.3902618885040283, ACC: 0.8615052700042725
2023-07-25 04:22:20,548 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 2.5405964851379395, ACC: 0.8401884436607361
2023-07-25 04:22:31,947 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 2.7051522731781006, ACC: 0.8101967573165894
2023-07-25 04:22:43,054 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 2.787438154220581, ACC: 0.7954995632171631
2023-07-25 04:22:54,613 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 2.857374429702759, ACC: 0.782667338848114
2023-07-25 04:23:06,384 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 2.8747365474700928, ACC: 0.7731330990791321
2023-07-25 04:23:17,031 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 2.9472992420196533, ACC: 0.7480756640434265
2023-07-25 04:23:27,506 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 3.082258462905884, ACC: 0.729958713054657
2023-07-25 04:23:39,223 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 3.2690210342407227, ACC: 0.6968620419502258
2023-07-25 04:23:49,966 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 3.45837140083313, ACC: 0.6717586517333984
2023-07-25 04:24:01,379 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 3.6059341430664062, ACC: 0.6364369988441467
2023-07-25 04:24:12,317 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 3.7360103130340576, ACC: 0.6227866411209106
2023-07-25 04:24:22,297 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 3.84670352935791, ACC: 0.5987973213195801
2023-07-25 04:24:32,788 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 3.947504758834839, ACC: 0.5845580101013184
2023-07-25 04:24:44,463 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 3.9752871990203857, ACC: 0.5618116855621338
2023-07-25 04:24:55,531 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 4.034891605377197, ACC: 0.5588629841804504
2023-07-25 04:24:55,631 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-Z50_30-timesteps_vis.h5
2023-07-25 04:25:49,004 - root - INFO - ------------------ Configuration ------------------
2023-07-25 04:25:49,004 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 04:25:49,004 - root - INFO - Configuration name: afno_backbone
2023-07-25 04:25:49,004 - root - INFO - log_to_wandb True
2023-07-25 04:25:49,004 - root - INFO - lr 0.0005
2023-07-25 04:25:49,004 - root - INFO - batch_size 64
2023-07-25 04:25:49,004 - root - INFO - max_epochs 150
2023-07-25 04:25:49,004 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 04:25:49,004 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 04:25:49,004 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 04:25:49,004 - root - INFO - orography False
2023-07-25 04:25:49,004 - root - INFO - orography_path None
2023-07-25 04:25:49,004 - root - INFO - exp_dir FourCastNet/results
2023-07-25 04:25:49,004 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 04:25:49,004 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 04:25:49,005 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 04:25:49,005 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 04:25:49,005 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 04:25:49,005 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 04:25:49,005 - root - INFO - loss l2
2023-07-25 04:25:49,005 - root - INFO - num_data_workers 4
2023-07-25 04:25:49,005 - root - INFO - dt 1
2023-07-25 04:25:49,005 - root - INFO - n_history 0
2023-07-25 04:25:49,005 - root - INFO - prediction_type iterative
2023-07-25 04:25:49,005 - root - INFO - prediction_length 30
2023-07-25 04:25:49,005 - root - INFO - n_initial_conditions 5
2023-07-25 04:25:49,005 - root - INFO - ics_type default
2023-07-25 04:25:49,005 - root - INFO - save_raw_forecasts True
2023-07-25 04:25:49,005 - root - INFO - save_channel False
2023-07-25 04:25:49,005 - root - INFO - masked_acc False
2023-07-25 04:25:49,005 - root - INFO - maskpath None
2023-07-25 04:25:49,005 - root - INFO - perturb False
2023-07-25 04:25:49,005 - root - INFO - add_grid False
2023-07-25 04:25:49,005 - root - INFO - N_grid_channels 0
2023-07-25 04:25:49,005 - root - INFO - gridtype sinusoidal
2023-07-25 04:25:49,006 - root - INFO - roll False
2023-07-25 04:25:49,006 - root - INFO - num_blocks 8
2023-07-25 04:25:49,006 - root - INFO - nettype afno
2023-07-25 04:25:49,006 - root - INFO - patch_size 8
2023-07-25 04:25:49,006 - root - INFO - width 56
2023-07-25 04:25:49,006 - root - INFO - modes 32
2023-07-25 04:25:49,006 - root - INFO - target U10
2023-07-25 04:25:49,006 - root - INFO - normalization zscore
2023-07-25 04:25:49,006 - root - INFO - log_to_screen True
2023-07-25 04:25:49,006 - root - INFO - save_checkpoint True
2023-07-25 04:25:49,006 - root - INFO - enable_nhwc False
2023-07-25 04:25:49,006 - root - INFO - optimizer_type FusedAdam
2023-07-25 04:25:49,006 - root - INFO - crop_size_x None
2023-07-25 04:25:49,006 - root - INFO - crop_size_y None
2023-07-25 04:25:49,006 - root - INFO - two_step_training False
2023-07-25 04:25:49,006 - root - INFO - plot_animations False
2023-07-25 04:25:49,006 - root - INFO - add_noise False
2023-07-25 04:25:49,006 - root - INFO - noise_std 0
2023-07-25 04:25:49,006 - root - INFO - world_size 1
2023-07-25 04:25:49,006 - root - INFO - interp 0
2023-07-25 04:25:49,006 - root - INFO - use_daily_climatology False
2023-07-25 04:25:49,006 - root - INFO - global_batch_size 64
2023-07-25 04:25:49,006 - root - INFO - ablate TCWV
2023-07-25 04:25:49,006 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 04:25:49,007 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 04:25:49,007 - root - INFO - resuming False
2023-07-25 04:25:49,007 - root - INFO - local_rank 0
2023-07-25 04:25:49,007 - root - INFO - ---------------------------------------------------
2023-07-25 04:25:49,007 - root - INFO - Inference for 1 initial conditions
2023-07-25 04:25:49,291 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 04:25:49,292 - root - INFO - Number of samples per year: 1460
2023-07-25 04:25:49,292 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 04:25:49,292 - root - INFO - Delta t: 6 hours
2023-07-25 04:25:49,292 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 04:25:49,293 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 04:27:18,136 - root - INFO - Loading inference data
2023-07-25 04:27:18,137 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 04:27:18,504 - root - INFO - Initial condition 1 of 1
2023-07-25 04:27:19,368 - root - INFO - Extracting valid data from the first year
2023-07-25 04:30:24,780 - root - INFO - Standardizing data
2023-07-25 04:30:32,600 - root - INFO - Loading time means
2023-07-25 04:30:54,904 - root - INFO - Begin autoregressive inference
2023-07-25 04:31:06,424 - root - INFO - Predicted timestep 0 of 30. U10 RMS Error: 0.0, ACC: 1.0
2023-07-25 04:31:18,365 - root - INFO - Predicted timestep 1 of 30. U10 RMS Error: 2.0416629314422607, ACC: 0.8697107434272766
2023-07-25 04:31:30,144 - root - INFO - Predicted timestep 2 of 30. U10 RMS Error: 3.3051085472106934, ACC: 0.7120649814605713
2023-07-25 04:31:41,106 - root - INFO - Predicted timestep 3 of 30. U10 RMS Error: 12.1768159866333, ACC: 0.24593283236026764
2023-07-25 04:31:52,669 - root - INFO - Predicted timestep 4 of 30. U10 RMS Error: 17.735239028930664, ACC: 0.161190003156662
2023-07-25 04:32:04,884 - root - INFO - Predicted timestep 5 of 30. U10 RMS Error: 20.882295608520508, ACC: 0.13371197879314423
2023-07-25 04:32:18,000 - root - INFO - Predicted timestep 6 of 30. U10 RMS Error: 23.6057071685791, ACC: 0.11257662624120712
2023-07-25 04:32:30,339 - root - INFO - Predicted timestep 7 of 30. U10 RMS Error: 26.269786834716797, ACC: 0.09866158664226532
2023-07-25 04:32:41,281 - root - INFO - Predicted timestep 8 of 30. U10 RMS Error: 28.842580795288086, ACC: 0.0815456360578537
2023-07-25 04:32:52,978 - root - INFO - Predicted timestep 9 of 30. U10 RMS Error: 31.45391273498535, ACC: 0.06937430053949356
2023-07-25 04:33:04,428 - root - INFO - Predicted timestep 10 of 30. U10 RMS Error: 34.07164764404297, ACC: 0.06277479976415634
2023-07-25 04:33:16,228 - root - INFO - Predicted timestep 11 of 30. U10 RMS Error: 36.774818420410156, ACC: 0.05717480927705765
2023-07-25 04:33:27,896 - root - INFO - Predicted timestep 12 of 30. U10 RMS Error: 39.43549346923828, ACC: 0.04688171669840813
2023-07-25 04:33:39,316 - root - INFO - Predicted timestep 13 of 30. U10 RMS Error: 42.239418029785156, ACC: 0.04019366204738617
2023-07-25 04:33:51,021 - root - INFO - Predicted timestep 14 of 30. U10 RMS Error: 45.25593566894531, ACC: 0.036812637001276016
2023-07-25 04:34:01,545 - root - INFO - Predicted timestep 15 of 30. U10 RMS Error: 48.31108856201172, ACC: 0.033467430621385574
2023-07-25 04:34:12,289 - root - INFO - Predicted timestep 16 of 30. U10 RMS Error: 51.570274353027344, ACC: 0.025567589327692986
2023-07-25 04:34:22,803 - root - INFO - Predicted timestep 17 of 30. U10 RMS Error: 55.11064529418945, ACC: 0.014666303992271423
2023-07-25 04:34:33,891 - root - INFO - Predicted timestep 18 of 30. U10 RMS Error: 58.97285842895508, ACC: -0.0008272998384200037
2023-07-25 04:34:44,353 - root - INFO - Predicted timestep 19 of 30. U10 RMS Error: 62.99302673339844, ACC: -0.0025253728963434696
2023-07-25 04:34:54,728 - root - INFO - Predicted timestep 20 of 30. U10 RMS Error: 67.63471984863281, ACC: -0.0011171523947268724
2023-07-25 04:35:05,728 - root - INFO - Predicted timestep 21 of 30. U10 RMS Error: 74.02239990234375, ACC: -0.0034716473892331123
2023-07-25 04:35:16,809 - root - INFO - Predicted timestep 22 of 30. U10 RMS Error: 83.12991333007812, ACC: 0.0019565317779779434
2023-07-25 04:35:26,875 - root - INFO - Predicted timestep 23 of 30. U10 RMS Error: 102.73912048339844, ACC: 0.018191877752542496
2023-07-25 04:35:38,295 - root - INFO - Predicted timestep 24 of 30. U10 RMS Error: 145.4872589111328, ACC: 0.01631440781056881
2023-07-25 04:35:49,969 - root - INFO - Predicted timestep 25 of 30. U10 RMS Error: 187.17674255371094, ACC: 0.010069554671645164
2023-07-25 04:36:00,839 - root - INFO - Predicted timestep 26 of 30. U10 RMS Error: 216.8358612060547, ACC: 0.001980992266908288
2023-07-25 04:36:11,936 - root - INFO - Predicted timestep 27 of 30. U10 RMS Error: 242.4346466064453, ACC: 0.0024143969640135765
2023-07-25 04:36:22,003 - root - INFO - Predicted timestep 28 of 30. U10 RMS Error: 267.1128234863281, ACC: 0.0017809218261390924
2023-07-25 04:36:32,903 - root - INFO - Predicted timestep 29 of 30. U10 RMS Error: 290.2668151855469, ACC: 0.00603035232052207
2023-07-25 04:36:32,986 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-U10_ablate-TCWV_30-timesteps_vis.h5
2023-07-25 04:37:26,507 - root - INFO - ------------------ Configuration ------------------
2023-07-25 04:37:26,507 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 04:37:26,507 - root - INFO - Configuration name: afno_backbone
2023-07-25 04:37:26,507 - root - INFO - log_to_wandb True
2023-07-25 04:37:26,507 - root - INFO - lr 0.0005
2023-07-25 04:37:26,508 - root - INFO - batch_size 64
2023-07-25 04:37:26,508 - root - INFO - max_epochs 150
2023-07-25 04:37:26,508 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 04:37:26,508 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 04:37:26,508 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 04:37:26,508 - root - INFO - orography False
2023-07-25 04:37:26,508 - root - INFO - orography_path None
2023-07-25 04:37:26,508 - root - INFO - exp_dir FourCastNet/results
2023-07-25 04:37:26,508 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 04:37:26,508 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 04:37:26,508 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 04:37:26,508 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 04:37:26,508 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 04:37:26,508 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 04:37:26,508 - root - INFO - loss l2
2023-07-25 04:37:26,508 - root - INFO - num_data_workers 4
2023-07-25 04:37:26,508 - root - INFO - dt 1
2023-07-25 04:37:26,508 - root - INFO - n_history 0
2023-07-25 04:37:26,508 - root - INFO - prediction_type iterative
2023-07-25 04:37:26,508 - root - INFO - prediction_length 30
2023-07-25 04:37:26,508 - root - INFO - n_initial_conditions 5
2023-07-25 04:37:26,509 - root - INFO - ics_type default
2023-07-25 04:37:26,509 - root - INFO - save_raw_forecasts True
2023-07-25 04:37:26,509 - root - INFO - save_channel False
2023-07-25 04:37:26,509 - root - INFO - masked_acc False
2023-07-25 04:37:26,509 - root - INFO - maskpath None
2023-07-25 04:37:26,509 - root - INFO - perturb False
2023-07-25 04:37:26,509 - root - INFO - add_grid False
2023-07-25 04:37:26,509 - root - INFO - N_grid_channels 0
2023-07-25 04:37:26,509 - root - INFO - gridtype sinusoidal
2023-07-25 04:37:26,509 - root - INFO - roll False
2023-07-25 04:37:26,509 - root - INFO - num_blocks 8
2023-07-25 04:37:26,509 - root - INFO - nettype afno
2023-07-25 04:37:26,509 - root - INFO - patch_size 8
2023-07-25 04:37:26,509 - root - INFO - width 56
2023-07-25 04:37:26,509 - root - INFO - modes 32
2023-07-25 04:37:26,509 - root - INFO - target V10
2023-07-25 04:37:26,509 - root - INFO - normalization zscore
2023-07-25 04:37:26,509 - root - INFO - log_to_screen True
2023-07-25 04:37:26,509 - root - INFO - save_checkpoint True
2023-07-25 04:37:26,509 - root - INFO - enable_nhwc False
2023-07-25 04:37:26,509 - root - INFO - optimizer_type FusedAdam
2023-07-25 04:37:26,509 - root - INFO - crop_size_x None
2023-07-25 04:37:26,509 - root - INFO - crop_size_y None
2023-07-25 04:37:26,510 - root - INFO - two_step_training False
2023-07-25 04:37:26,510 - root - INFO - plot_animations False
2023-07-25 04:37:26,510 - root - INFO - add_noise False
2023-07-25 04:37:26,510 - root - INFO - noise_std 0
2023-07-25 04:37:26,510 - root - INFO - world_size 1
2023-07-25 04:37:26,510 - root - INFO - interp 0
2023-07-25 04:37:26,510 - root - INFO - use_daily_climatology False
2023-07-25 04:37:26,510 - root - INFO - global_batch_size 64
2023-07-25 04:37:26,510 - root - INFO - ablate U10
2023-07-25 04:37:26,510 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 04:37:26,510 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 04:37:26,510 - root - INFO - resuming False
2023-07-25 04:37:26,510 - root - INFO - local_rank 0
2023-07-25 04:37:26,510 - root - INFO - ---------------------------------------------------
2023-07-25 04:37:26,510 - root - INFO - Inference for 1 initial conditions
2023-07-25 04:37:26,824 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 04:37:26,825 - root - INFO - Number of samples per year: 1460
2023-07-25 04:37:26,825 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 04:37:26,825 - root - INFO - Delta t: 6 hours
2023-07-25 04:37:26,825 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 04:37:26,825 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 04:38:53,588 - root - INFO - Loading inference data
2023-07-25 04:38:53,591 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 04:38:53,923 - root - INFO - Initial condition 1 of 1
2023-07-25 04:38:54,653 - root - INFO - Extracting valid data from the first year
2023-07-25 04:41:38,605 - root - INFO - Standardizing data
2023-07-25 04:41:46,066 - root - INFO - Loading time means
2023-07-25 04:42:07,642 - root - INFO - Begin autoregressive inference
2023-07-25 04:42:18,900 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 04:42:29,415 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 1.6770613193511963, ACC: 0.9217802286148071
2023-07-25 04:42:39,594 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 1.8049620389938354, ACC: 0.9077807068824768
2023-07-25 04:42:50,180 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 5.7113356590271, ACC: 0.5278752446174622
2023-07-25 04:43:01,753 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 9.480340003967285, ACC: 0.33052200078964233
2023-07-25 04:43:13,273 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 11.412041664123535, ACC: 0.25581517815589905
2023-07-25 04:43:24,651 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 12.321435928344727, ACC: 0.22459419071674347
2023-07-25 04:43:35,667 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 13.216384887695312, ACC: 0.21299099922180176
2023-07-25 04:43:46,813 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 14.233860969543457, ACC: 0.1968996226787567
2023-07-25 04:43:57,940 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 15.012042045593262, ACC: 0.17124900221824646
2023-07-25 04:44:08,753 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 16.10065269470215, ACC: 0.14903195202350616
2023-07-25 04:44:20,299 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 17.368515014648438, ACC: 0.14398694038391113
2023-07-25 04:44:31,410 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 18.62940216064453, ACC: 0.1307501345872879
2023-07-25 04:44:42,464 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 19.91455078125, ACC: 0.11113668978214264
2023-07-25 04:44:53,611 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 21.103736877441406, ACC: 0.10743856430053711
2023-07-25 04:45:05,299 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 22.34731101989746, ACC: 0.1025988832116127
2023-07-25 04:45:17,228 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 23.42376136779785, ACC: 0.09049425274133682
2023-07-25 04:45:29,646 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 24.74428939819336, ACC: 0.0776517316699028
2023-07-25 04:45:40,287 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 26.400161743164062, ACC: 0.06888418644666672
2023-07-25 04:45:51,600 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 28.14546012878418, ACC: 0.0535939522087574
2023-07-25 04:46:03,362 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 29.6519832611084, ACC: 0.03589552640914917
2023-07-25 04:46:15,682 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 31.238548278808594, ACC: 0.02588917873799801
2023-07-25 04:46:27,667 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 32.967491149902344, ACC: 0.008416707627475262
2023-07-25 04:46:38,437 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 34.77732467651367, ACC: -0.004523325711488724
2023-07-25 04:46:49,294 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 36.67506790161133, ACC: -0.023371871560811996
2023-07-25 04:46:59,778 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 38.23942184448242, ACC: -0.020567292347550392
2023-07-25 04:47:10,636 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 40.504188537597656, ACC: -0.026581738144159317
2023-07-25 04:47:21,127 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 42.74797439575195, ACC: -0.02419675700366497
2023-07-25 04:47:32,347 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 44.78495788574219, ACC: -0.019817756488919258
2023-07-25 04:47:43,248 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 46.81658172607422, ACC: -0.0019237162778154016
2023-07-25 04:47:43,339 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-U10_30-timesteps_vis.h5
2023-07-25 04:48:36,383 - root - INFO - ------------------ Configuration ------------------
2023-07-25 04:48:36,383 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 04:48:36,383 - root - INFO - Configuration name: afno_backbone
2023-07-25 04:48:36,383 - root - INFO - log_to_wandb True
2023-07-25 04:48:36,383 - root - INFO - lr 0.0005
2023-07-25 04:48:36,383 - root - INFO - batch_size 64
2023-07-25 04:48:36,383 - root - INFO - max_epochs 150
2023-07-25 04:48:36,383 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 04:48:36,383 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 04:48:36,383 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 04:48:36,384 - root - INFO - orography False
2023-07-25 04:48:36,384 - root - INFO - orography_path None
2023-07-25 04:48:36,384 - root - INFO - exp_dir FourCastNet/results
2023-07-25 04:48:36,384 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 04:48:36,384 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 04:48:36,384 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 04:48:36,384 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 04:48:36,384 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 04:48:36,384 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 04:48:36,384 - root - INFO - loss l2
2023-07-25 04:48:36,384 - root - INFO - num_data_workers 4
2023-07-25 04:48:36,384 - root - INFO - dt 1
2023-07-25 04:48:36,384 - root - INFO - n_history 0
2023-07-25 04:48:36,384 - root - INFO - prediction_type iterative
2023-07-25 04:48:36,384 - root - INFO - prediction_length 30
2023-07-25 04:48:36,384 - root - INFO - n_initial_conditions 5
2023-07-25 04:48:36,384 - root - INFO - ics_type default
2023-07-25 04:48:36,384 - root - INFO - save_raw_forecasts True
2023-07-25 04:48:36,385 - root - INFO - save_channel False
2023-07-25 04:48:36,385 - root - INFO - masked_acc False
2023-07-25 04:48:36,385 - root - INFO - maskpath None
2023-07-25 04:48:36,385 - root - INFO - perturb False
2023-07-25 04:48:36,385 - root - INFO - add_grid False
2023-07-25 04:48:36,385 - root - INFO - N_grid_channels 0
2023-07-25 04:48:36,385 - root - INFO - gridtype sinusoidal
2023-07-25 04:48:36,385 - root - INFO - roll False
2023-07-25 04:48:36,385 - root - INFO - num_blocks 8
2023-07-25 04:48:36,385 - root - INFO - nettype afno
2023-07-25 04:48:36,385 - root - INFO - patch_size 8
2023-07-25 04:48:36,385 - root - INFO - width 56
2023-07-25 04:48:36,385 - root - INFO - modes 32
2023-07-25 04:48:36,385 - root - INFO - target V10
2023-07-25 04:48:36,385 - root - INFO - normalization zscore
2023-07-25 04:48:36,385 - root - INFO - log_to_screen True
2023-07-25 04:48:36,385 - root - INFO - save_checkpoint True
2023-07-25 04:48:36,385 - root - INFO - enable_nhwc False
2023-07-25 04:48:36,385 - root - INFO - optimizer_type FusedAdam
2023-07-25 04:48:36,385 - root - INFO - crop_size_x None
2023-07-25 04:48:36,386 - root - INFO - crop_size_y None
2023-07-25 04:48:36,386 - root - INFO - two_step_training False
2023-07-25 04:48:36,386 - root - INFO - plot_animations False
2023-07-25 04:48:36,386 - root - INFO - add_noise False
2023-07-25 04:48:36,386 - root - INFO - noise_std 0
2023-07-25 04:48:36,386 - root - INFO - world_size 1
2023-07-25 04:48:36,386 - root - INFO - interp 0
2023-07-25 04:48:36,386 - root - INFO - use_daily_climatology False
2023-07-25 04:48:36,386 - root - INFO - global_batch_size 64
2023-07-25 04:48:36,386 - root - INFO - ablate T2m
2023-07-25 04:48:36,386 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 04:48:36,386 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 04:48:36,386 - root - INFO - resuming False
2023-07-25 04:48:36,386 - root - INFO - local_rank 0
2023-07-25 04:48:36,386 - root - INFO - ---------------------------------------------------
2023-07-25 04:48:36,386 - root - INFO - Inference for 1 initial conditions
2023-07-25 04:48:36,735 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 04:48:36,737 - root - INFO - Number of samples per year: 1460
2023-07-25 04:48:36,737 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 04:48:36,738 - root - INFO - Delta t: 6 hours
2023-07-25 04:48:36,738 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 04:48:36,738 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 04:49:53,663 - root - INFO - Loading inference data
2023-07-25 04:49:53,663 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 04:49:53,904 - root - INFO - Initial condition 1 of 1
2023-07-25 04:49:54,713 - root - INFO - Extracting valid data from the first year
2023-07-25 04:52:31,980 - root - INFO - Standardizing data
2023-07-25 04:52:39,612 - root - INFO - Loading time means
2023-07-25 04:52:54,796 - root - INFO - Begin autoregressive inference
2023-07-25 04:53:05,498 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 04:53:16,552 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 15.850045204162598, ACC: 0.18932154774665833
2023-07-25 04:53:27,783 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 88.66856384277344, ACC: 0.07776319980621338
2023-07-25 04:53:38,091 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 183.0078887939453, ACC: 0.12287746369838715
2023-07-25 04:53:49,860 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 225.22677612304688, ACC: 0.12139014899730682
2023-07-25 04:54:00,918 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 232.62814331054688, ACC: 0.12137783318758011
2023-07-25 04:54:13,379 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 231.87208557128906, ACC: 0.10486388206481934
2023-07-25 04:54:24,497 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 234.9927520751953, ACC: 0.08091568201780319
2023-07-25 04:54:35,516 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 241.1058807373047, ACC: 0.06571256369352341
2023-07-25 04:54:45,901 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 246.47267150878906, ACC: 0.052468087524175644
2023-07-25 04:54:57,417 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 250.0374755859375, ACC: 0.04345038905739784
2023-07-25 04:55:08,746 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 252.2973175048828, ACC: 0.03623417019844055
2023-07-25 04:55:20,244 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 253.7097625732422, ACC: 0.033920567482709885
2023-07-25 04:55:31,020 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 254.57382202148438, ACC: 0.032439641654491425
2023-07-25 04:55:42,784 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 255.09033203125, ACC: 0.030057283118367195
2023-07-25 04:55:54,130 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 255.38485717773438, ACC: 0.02850729040801525
2023-07-25 04:56:05,499 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 255.54075622558594, ACC: 0.029213452711701393
2023-07-25 04:56:16,305 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 255.6236114501953, ACC: 0.030096257105469704
2023-07-25 04:56:27,308 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 255.67401123046875, ACC: 0.02946721762418747
2023-07-25 04:56:38,849 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 255.6952362060547, ACC: 0.030230911448597908
2023-07-25 04:56:49,875 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 255.72140502929688, ACC: 0.027395842596888542
2023-07-25 04:57:01,949 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 255.7166290283203, ACC: 0.030088242143392563
2023-07-25 04:57:12,845 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 255.7373046875, ACC: 0.026195334270596504
2023-07-25 04:57:22,619 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 255.7353515625, ACC: 0.027113597840070724
2023-07-25 04:57:33,479 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 255.74166870117188, ACC: 0.02590188756585121
2023-07-25 04:57:43,705 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 255.73110961914062, ACC: 0.028233597055077553
2023-07-25 04:57:54,379 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 255.7360076904297, ACC: 0.027027953416109085
2023-07-25 04:58:05,187 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 255.7315673828125, ACC: 0.0279949102550745
2023-07-25 04:58:17,008 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 255.74363708496094, ACC: 0.025526851415634155
2023-07-25 04:58:27,794 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 255.7405548095703, ACC: 0.026296697556972504
2023-07-25 04:58:27,881 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-T2m_30-timesteps_vis.h5
2023-07-25 04:59:21,025 - root - INFO - ------------------ Configuration ------------------
2023-07-25 04:59:21,026 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 04:59:21,026 - root - INFO - Configuration name: afno_backbone
2023-07-25 04:59:21,026 - root - INFO - log_to_wandb True
2023-07-25 04:59:21,026 - root - INFO - lr 0.0005
2023-07-25 04:59:21,026 - root - INFO - batch_size 64
2023-07-25 04:59:21,026 - root - INFO - max_epochs 150
2023-07-25 04:59:21,026 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 04:59:21,026 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 04:59:21,026 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 04:59:21,026 - root - INFO - orography False
2023-07-25 04:59:21,026 - root - INFO - orography_path None
2023-07-25 04:59:21,026 - root - INFO - exp_dir FourCastNet/results
2023-07-25 04:59:21,026 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 04:59:21,026 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 04:59:21,026 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 04:59:21,026 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 04:59:21,027 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 04:59:21,027 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 04:59:21,027 - root - INFO - loss l2
2023-07-25 04:59:21,027 - root - INFO - num_data_workers 4
2023-07-25 04:59:21,027 - root - INFO - dt 1
2023-07-25 04:59:21,027 - root - INFO - n_history 0
2023-07-25 04:59:21,027 - root - INFO - prediction_type iterative
2023-07-25 04:59:21,027 - root - INFO - prediction_length 30
2023-07-25 04:59:21,027 - root - INFO - n_initial_conditions 5
2023-07-25 04:59:21,027 - root - INFO - ics_type default
2023-07-25 04:59:21,027 - root - INFO - save_raw_forecasts True
2023-07-25 04:59:21,027 - root - INFO - save_channel False
2023-07-25 04:59:21,027 - root - INFO - masked_acc False
2023-07-25 04:59:21,027 - root - INFO - maskpath None
2023-07-25 04:59:21,027 - root - INFO - perturb False
2023-07-25 04:59:21,027 - root - INFO - add_grid False
2023-07-25 04:59:21,027 - root - INFO - N_grid_channels 0
2023-07-25 04:59:21,027 - root - INFO - gridtype sinusoidal
2023-07-25 04:59:21,027 - root - INFO - roll False
2023-07-25 04:59:21,027 - root - INFO - num_blocks 8
2023-07-25 04:59:21,027 - root - INFO - nettype afno
2023-07-25 04:59:21,027 - root - INFO - patch_size 8
2023-07-25 04:59:21,028 - root - INFO - width 56
2023-07-25 04:59:21,028 - root - INFO - modes 32
2023-07-25 04:59:21,028 - root - INFO - target V10
2023-07-25 04:59:21,028 - root - INFO - normalization zscore
2023-07-25 04:59:21,028 - root - INFO - log_to_screen True
2023-07-25 04:59:21,028 - root - INFO - save_checkpoint True
2023-07-25 04:59:21,028 - root - INFO - enable_nhwc False
2023-07-25 04:59:21,028 - root - INFO - optimizer_type FusedAdam
2023-07-25 04:59:21,028 - root - INFO - crop_size_x None
2023-07-25 04:59:21,028 - root - INFO - crop_size_y None
2023-07-25 04:59:21,028 - root - INFO - two_step_training False
2023-07-25 04:59:21,028 - root - INFO - plot_animations False
2023-07-25 04:59:21,028 - root - INFO - add_noise False
2023-07-25 04:59:21,028 - root - INFO - noise_std 0
2023-07-25 04:59:21,028 - root - INFO - world_size 1
2023-07-25 04:59:21,028 - root - INFO - interp 0
2023-07-25 04:59:21,028 - root - INFO - use_daily_climatology False
2023-07-25 04:59:21,028 - root - INFO - global_batch_size 64
2023-07-25 04:59:21,028 - root - INFO - ablate sp
2023-07-25 04:59:21,028 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 04:59:21,028 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 04:59:21,028 - root - INFO - resuming False
2023-07-25 04:59:21,028 - root - INFO - local_rank 0
2023-07-25 04:59:21,028 - root - INFO - ---------------------------------------------------
2023-07-25 04:59:21,028 - root - INFO - Inference for 1 initial conditions
2023-07-25 04:59:21,240 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 04:59:21,241 - root - INFO - Number of samples per year: 1460
2023-07-25 04:59:21,241 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 04:59:21,241 - root - INFO - Delta t: 6 hours
2023-07-25 04:59:21,241 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 04:59:21,242 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 05:00:29,473 - root - INFO - Loading inference data
2023-07-25 05:00:29,474 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 05:00:29,712 - root - INFO - Initial condition 1 of 1
2023-07-25 05:00:30,804 - root - INFO - Extracting valid data from the first year
2023-07-25 05:03:09,454 - root - INFO - Standardizing data
2023-07-25 05:03:16,650 - root - INFO - Loading time means
2023-07-25 05:03:34,702 - root - INFO - Begin autoregressive inference
2023-07-25 05:03:45,435 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 05:03:56,726 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 1.4249557256698608, ACC: 0.9447878003120422
2023-07-25 05:04:08,151 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 1.9885345697402954, ACC: 0.8835756778717041
2023-07-25 05:04:18,184 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 3.08772611618042, ACC: 0.7155717611312866
2023-07-25 05:04:29,499 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 4.0812554359436035, ACC: 0.5655967593193054
2023-07-25 05:04:39,974 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 4.544146537780762, ACC: 0.4824002981185913
2023-07-25 05:04:51,254 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 4.809605121612549, ACC: 0.4286085069179535
2023-07-25 05:05:01,103 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 5.071498870849609, ACC: 0.37277787923812866
2023-07-25 05:05:12,027 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 5.384904384613037, ACC: 0.31721094250679016
2023-07-25 05:05:23,465 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 5.673558235168457, ACC: 0.27273374795913696
2023-07-25 05:05:33,320 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 6.170871734619141, ACC: 0.23048506677150726
2023-07-25 05:05:43,738 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 6.776818752288818, ACC: 0.17440012097358704
2023-07-25 05:05:54,925 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 7.113924026489258, ACC: 0.14430752396583557
2023-07-25 05:06:05,941 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 7.437412261962891, ACC: 0.11940498650074005
2023-07-25 05:06:17,485 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 7.732710361480713, ACC: 0.10037831962108612
2023-07-25 05:06:27,865 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 8.070857048034668, ACC: 0.06472482532262802
2023-07-25 05:06:38,304 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 8.39706039428711, ACC: 0.0447675883769989
2023-07-25 05:06:48,997 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 8.647459983825684, ACC: 0.032074108719825745
2023-07-25 05:07:01,169 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 8.965051651000977, ACC: 0.03148125857114792
2023-07-25 05:07:11,339 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 9.204447746276855, ACC: 0.02192804217338562
2023-07-25 05:07:21,594 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 9.303458213806152, ACC: 0.023158609867095947
2023-07-25 05:07:32,151 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 9.459330558776855, ACC: 0.03193420544266701
2023-07-25 05:07:43,042 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 9.579512596130371, ACC: 0.03917452692985535
2023-07-25 05:07:52,643 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 9.643499374389648, ACC: 0.04398902878165245
2023-07-25 05:08:02,451 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 9.757133483886719, ACC: 0.05281103029847145
2023-07-25 05:08:13,296 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 10.191804885864258, ACC: 0.057403866201639175
2023-07-25 05:08:23,979 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 10.536823272705078, ACC: 0.059096116572618484
2023-07-25 05:08:35,039 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 10.73320198059082, ACC: 0.05306261032819748
2023-07-25 05:08:46,031 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 10.844661712646484, ACC: 0.04952132701873779
2023-07-25 05:08:56,686 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 10.969353675842285, ACC: 0.050261590629816055
2023-07-25 05:08:56,777 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-sp_30-timesteps_vis.h5
2023-07-25 05:09:50,247 - root - INFO - ------------------ Configuration ------------------
2023-07-25 05:09:50,247 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 05:09:50,247 - root - INFO - Configuration name: afno_backbone
2023-07-25 05:09:50,247 - root - INFO - log_to_wandb True
2023-07-25 05:09:50,247 - root - INFO - lr 0.0005
2023-07-25 05:09:50,247 - root - INFO - batch_size 64
2023-07-25 05:09:50,247 - root - INFO - max_epochs 150
2023-07-25 05:09:50,248 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 05:09:50,248 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 05:09:50,248 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 05:09:50,248 - root - INFO - orography False
2023-07-25 05:09:50,248 - root - INFO - orography_path None
2023-07-25 05:09:50,248 - root - INFO - exp_dir FourCastNet/results
2023-07-25 05:09:50,248 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 05:09:50,248 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 05:09:50,248 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 05:09:50,248 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 05:09:50,248 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 05:09:50,248 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 05:09:50,248 - root - INFO - loss l2
2023-07-25 05:09:50,248 - root - INFO - num_data_workers 4
2023-07-25 05:09:50,248 - root - INFO - dt 1
2023-07-25 05:09:50,248 - root - INFO - n_history 0
2023-07-25 05:09:50,248 - root - INFO - prediction_type iterative
2023-07-25 05:09:50,249 - root - INFO - prediction_length 30
2023-07-25 05:09:50,249 - root - INFO - n_initial_conditions 5
2023-07-25 05:09:50,249 - root - INFO - ics_type default
2023-07-25 05:09:50,249 - root - INFO - save_raw_forecasts True
2023-07-25 05:09:50,249 - root - INFO - save_channel False
2023-07-25 05:09:50,249 - root - INFO - masked_acc False
2023-07-25 05:09:50,249 - root - INFO - maskpath None
2023-07-25 05:09:50,249 - root - INFO - perturb False
2023-07-25 05:09:50,249 - root - INFO - add_grid False
2023-07-25 05:09:50,249 - root - INFO - N_grid_channels 0
2023-07-25 05:09:50,249 - root - INFO - gridtype sinusoidal
2023-07-25 05:09:50,249 - root - INFO - roll False
2023-07-25 05:09:50,249 - root - INFO - num_blocks 8
2023-07-25 05:09:50,249 - root - INFO - nettype afno
2023-07-25 05:09:50,249 - root - INFO - patch_size 8
2023-07-25 05:09:50,249 - root - INFO - width 56
2023-07-25 05:09:50,249 - root - INFO - modes 32
2023-07-25 05:09:50,249 - root - INFO - target V10
2023-07-25 05:09:50,249 - root - INFO - normalization zscore
2023-07-25 05:09:50,250 - root - INFO - log_to_screen True
2023-07-25 05:09:50,250 - root - INFO - save_checkpoint True
2023-07-25 05:09:50,250 - root - INFO - enable_nhwc False
2023-07-25 05:09:50,250 - root - INFO - optimizer_type FusedAdam
2023-07-25 05:09:50,250 - root - INFO - crop_size_x None
2023-07-25 05:09:50,250 - root - INFO - crop_size_y None
2023-07-25 05:09:50,250 - root - INFO - two_step_training False
2023-07-25 05:09:50,250 - root - INFO - plot_animations False
2023-07-25 05:09:50,250 - root - INFO - add_noise False
2023-07-25 05:09:50,250 - root - INFO - noise_std 0
2023-07-25 05:09:50,250 - root - INFO - world_size 1
2023-07-25 05:09:50,250 - root - INFO - interp 0
2023-07-25 05:09:50,250 - root - INFO - use_daily_climatology False
2023-07-25 05:09:50,250 - root - INFO - global_batch_size 64
2023-07-25 05:09:50,250 - root - INFO - ablate mslp
2023-07-25 05:09:50,250 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 05:09:50,250 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 05:09:50,250 - root - INFO - resuming False
2023-07-25 05:09:50,251 - root - INFO - local_rank 0
2023-07-25 05:09:50,251 - root - INFO - ---------------------------------------------------
2023-07-25 05:09:50,251 - root - INFO - Inference for 1 initial conditions
2023-07-25 05:09:50,503 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 05:09:50,504 - root - INFO - Number of samples per year: 1460
2023-07-25 05:09:50,504 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 05:09:50,504 - root - INFO - Delta t: 6 hours
2023-07-25 05:09:50,505 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 05:09:50,505 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 05:11:10,077 - root - INFO - Loading inference data
2023-07-25 05:11:10,077 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 05:11:10,360 - root - INFO - Initial condition 1 of 1
2023-07-25 05:11:11,178 - root - INFO - Extracting valid data from the first year
2023-07-25 05:13:56,577 - root - INFO - Standardizing data
2023-07-25 05:14:04,242 - root - INFO - Loading time means
2023-07-25 05:14:22,792 - root - INFO - Begin autoregressive inference
2023-07-25 05:14:32,847 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 05:14:44,769 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 2.523615837097168, ACC: 0.8093684911727905
2023-07-25 05:14:56,417 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 8.046457290649414, ACC: 0.34962397813796997
2023-07-25 05:15:08,716 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 23.74214744567871, ACC: 0.09945911169052124
2023-07-25 05:15:19,618 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 31.943016052246094, ACC: 0.06348295509815216
2023-07-25 05:15:30,145 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 34.99671173095703, ACC: 0.05562599375844002
2023-07-25 05:15:41,175 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 37.14204788208008, ACC: 0.052862003445625305
2023-07-25 05:15:51,757 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 40.02752685546875, ACC: 0.04981394112110138
2023-07-25 05:16:03,013 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 43.1166877746582, ACC: 0.04793260619044304
2023-07-25 05:16:13,255 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 46.19803237915039, ACC: 0.04318159446120262
2023-07-25 05:16:24,437 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 49.05219650268555, ACC: 0.04119480028748512
2023-07-25 05:16:35,628 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 51.629966735839844, ACC: 0.0303332582116127
2023-07-25 05:16:47,698 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 54.13813018798828, ACC: 0.02427467331290245
2023-07-25 05:16:59,611 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 56.822261810302734, ACC: 0.021601025015115738
2023-07-25 05:17:11,333 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 59.592185974121094, ACC: 0.017829375341534615
2023-07-25 05:17:21,820 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 62.43845748901367, ACC: 0.005059852264821529
2023-07-25 05:17:32,424 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 65.80924224853516, ACC: 0.005061953794211149
2023-07-25 05:17:43,396 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 70.05602264404297, ACC: 0.008427595719695091
2023-07-25 05:17:54,631 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 75.09627532958984, ACC: 0.013314695097506046
2023-07-25 05:18:05,169 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 81.24097442626953, ACC: 0.015086444094777107
2023-07-25 05:18:16,165 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 88.04405975341797, ACC: 0.013335559517145157
2023-07-25 05:18:26,890 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 98.5730972290039, ACC: 0.01109849289059639
2023-07-25 05:18:38,032 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 121.82023620605469, ACC: 0.0077451677061617374
2023-07-25 05:18:49,513 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 159.06723022460938, ACC: 0.05506571754813194
2023-07-25 05:19:01,015 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 193.89309692382812, ACC: 0.08811336755752563
2023-07-25 05:19:12,801 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 214.05499267578125, ACC: 0.1060146763920784
2023-07-25 05:19:23,358 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 223.57534790039062, ACC: 0.09439488500356674
2023-07-25 05:19:34,871 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 230.2303009033203, ACC: 0.07724516093730927
2023-07-25 05:19:44,937 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 237.36837768554688, ACC: 0.05314207822084427
2023-07-25 05:19:55,923 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 243.9698028564453, ACC: 0.0398917980492115
2023-07-25 05:19:56,011 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-mslp_30-timesteps_vis.h5
2023-07-25 05:20:49,257 - root - INFO - ------------------ Configuration ------------------
2023-07-25 05:20:49,257 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 05:20:49,257 - root - INFO - Configuration name: afno_backbone
2023-07-25 05:20:49,257 - root - INFO - log_to_wandb True
2023-07-25 05:20:49,257 - root - INFO - lr 0.0005
2023-07-25 05:20:49,257 - root - INFO - batch_size 64
2023-07-25 05:20:49,257 - root - INFO - max_epochs 150
2023-07-25 05:20:49,257 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 05:20:49,257 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 05:20:49,258 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 05:20:49,258 - root - INFO - orography False
2023-07-25 05:20:49,258 - root - INFO - orography_path None
2023-07-25 05:20:49,258 - root - INFO - exp_dir FourCastNet/results
2023-07-25 05:20:49,258 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 05:20:49,258 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 05:20:49,258 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 05:20:49,258 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 05:20:49,258 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 05:20:49,258 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 05:20:49,258 - root - INFO - loss l2
2023-07-25 05:20:49,258 - root - INFO - num_data_workers 4
2023-07-25 05:20:49,258 - root - INFO - dt 1
2023-07-25 05:20:49,258 - root - INFO - n_history 0
2023-07-25 05:20:49,258 - root - INFO - prediction_type iterative
2023-07-25 05:20:49,258 - root - INFO - prediction_length 30
2023-07-25 05:20:49,258 - root - INFO - n_initial_conditions 5
2023-07-25 05:20:49,259 - root - INFO - ics_type default
2023-07-25 05:20:49,259 - root - INFO - save_raw_forecasts True
2023-07-25 05:20:49,259 - root - INFO - save_channel False
2023-07-25 05:20:49,259 - root - INFO - masked_acc False
2023-07-25 05:20:49,259 - root - INFO - maskpath None
2023-07-25 05:20:49,259 - root - INFO - perturb False
2023-07-25 05:20:49,259 - root - INFO - add_grid False
2023-07-25 05:20:49,259 - root - INFO - N_grid_channels 0
2023-07-25 05:20:49,259 - root - INFO - gridtype sinusoidal
2023-07-25 05:20:49,259 - root - INFO - roll False
2023-07-25 05:20:49,259 - root - INFO - num_blocks 8
2023-07-25 05:20:49,259 - root - INFO - nettype afno
2023-07-25 05:20:49,259 - root - INFO - patch_size 8
2023-07-25 05:20:49,259 - root - INFO - width 56
2023-07-25 05:20:49,259 - root - INFO - modes 32
2023-07-25 05:20:49,259 - root - INFO - target V10
2023-07-25 05:20:49,259 - root - INFO - normalization zscore
2023-07-25 05:20:49,259 - root - INFO - log_to_screen True
2023-07-25 05:20:49,259 - root - INFO - save_checkpoint True
2023-07-25 05:20:49,259 - root - INFO - enable_nhwc False
2023-07-25 05:20:49,260 - root - INFO - optimizer_type FusedAdam
2023-07-25 05:20:49,260 - root - INFO - crop_size_x None
2023-07-25 05:20:49,260 - root - INFO - crop_size_y None
2023-07-25 05:20:49,260 - root - INFO - two_step_training False
2023-07-25 05:20:49,260 - root - INFO - plot_animations False
2023-07-25 05:20:49,260 - root - INFO - add_noise False
2023-07-25 05:20:49,260 - root - INFO - noise_std 0
2023-07-25 05:20:49,260 - root - INFO - world_size 1
2023-07-25 05:20:49,260 - root - INFO - interp 0
2023-07-25 05:20:49,260 - root - INFO - use_daily_climatology False
2023-07-25 05:20:49,260 - root - INFO - global_batch_size 64
2023-07-25 05:20:49,260 - root - INFO - ablate U1000
2023-07-25 05:20:49,260 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 05:20:49,260 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 05:20:49,260 - root - INFO - resuming False
2023-07-25 05:20:49,260 - root - INFO - local_rank 0
2023-07-25 05:20:49,260 - root - INFO - ---------------------------------------------------
2023-07-25 05:20:49,260 - root - INFO - Inference for 1 initial conditions
2023-07-25 05:20:49,575 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 05:20:49,576 - root - INFO - Number of samples per year: 1460
2023-07-25 05:20:49,576 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 05:20:49,576 - root - INFO - Delta t: 6 hours
2023-07-25 05:20:49,576 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 05:20:49,577 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 05:22:12,603 - root - INFO - Loading inference data
2023-07-25 05:22:12,605 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 05:22:12,910 - root - INFO - Initial condition 1 of 1
2023-07-25 05:22:13,766 - root - INFO - Extracting valid data from the first year
2023-07-25 05:25:09,401 - root - INFO - Standardizing data
2023-07-25 05:25:17,334 - root - INFO - Loading time means
2023-07-25 05:25:36,458 - root - INFO - Begin autoregressive inference
2023-07-25 05:25:46,227 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 05:25:57,938 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 4.624812126159668, ACC: 0.5952394008636475
2023-07-25 05:26:08,265 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 22.149093627929688, ACC: 0.10652263462543488
2023-07-25 05:26:19,452 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 46.42811584472656, ACC: 0.07679560035467148
2023-07-25 05:26:30,033 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 68.81793212890625, ACC: 0.09019164741039276
2023-07-25 05:26:41,398 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 84.05057525634766, ACC: 0.10913868993520737
2023-07-25 05:26:53,002 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 106.2884750366211, ACC: 0.1294456273317337
2023-07-25 05:27:03,626 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 148.97398376464844, ACC: 0.14511053264141083
2023-07-25 05:27:14,979 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 193.6531982421875, ACC: 0.14605379104614258
2023-07-25 05:27:26,467 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 221.97891235351562, ACC: 0.13743363320827484
2023-07-25 05:27:37,782 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 231.68380737304688, ACC: 0.1081804484128952
2023-07-25 05:27:49,272 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 234.61721801757812, ACC: 0.08024471998214722
2023-07-25 05:28:00,382 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 238.25228881835938, ACC: 0.060265425592660904
2023-07-25 05:28:12,593 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 243.04452514648438, ACC: 0.04924065247178078
2023-07-25 05:28:23,810 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 247.4491729736328, ACC: 0.03887616842985153
2023-07-25 05:28:35,640 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 250.71630859375, ACC: 0.032503798604011536
2023-07-25 05:28:46,805 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 252.8468780517578, ACC: 0.03036676160991192
2023-07-25 05:28:58,309 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 254.15158081054688, ACC: 0.030644625425338745
2023-07-25 05:29:09,137 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 254.8413848876953, ACC: 0.030327046290040016
2023-07-25 05:29:20,856 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 255.16986083984375, ACC: 0.03130972757935524
2023-07-25 05:29:32,632 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 255.3701171875, ACC: 0.02822180837392807
2023-07-25 05:29:42,970 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 255.48739624023438, ACC: 0.030704129487276077
2023-07-25 05:29:55,572 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 255.59603881835938, ACC: 0.026627400889992714
2023-07-25 05:30:07,458 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 255.65296936035156, ACC: 0.027340596541762352
2023-07-25 05:30:20,478 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 255.69537353515625, ACC: 0.026010900735855103
2023-07-25 05:30:31,572 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 255.70558166503906, ACC: 0.028287384659051895
2023-07-25 05:30:42,360 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 255.7221221923828, ACC: 0.027050400152802467
2023-07-25 05:30:54,117 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 255.72401428222656, ACC: 0.027986835688352585
2023-07-25 05:31:05,072 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 255.7394256591797, ACC: 0.025509238243103027
2023-07-25 05:31:15,519 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 255.7381591796875, ACC: 0.026279069483280182
2023-07-25 05:31:15,613 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-U1000_30-timesteps_vis.h5
2023-07-25 05:32:08,784 - root - INFO - ------------------ Configuration ------------------
2023-07-25 05:32:08,784 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 05:32:08,784 - root - INFO - Configuration name: afno_backbone
2023-07-25 05:32:08,784 - root - INFO - log_to_wandb True
2023-07-25 05:32:08,784 - root - INFO - lr 0.0005
2023-07-25 05:32:08,784 - root - INFO - batch_size 64
2023-07-25 05:32:08,784 - root - INFO - max_epochs 150
2023-07-25 05:32:08,784 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 05:32:08,784 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 05:32:08,784 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 05:32:08,784 - root - INFO - orography False
2023-07-25 05:32:08,784 - root - INFO - orography_path None
2023-07-25 05:32:08,784 - root - INFO - exp_dir FourCastNet/results
2023-07-25 05:32:08,785 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 05:32:08,785 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 05:32:08,785 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 05:32:08,785 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 05:32:08,785 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 05:32:08,785 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 05:32:08,785 - root - INFO - loss l2
2023-07-25 05:32:08,785 - root - INFO - num_data_workers 4
2023-07-25 05:32:08,785 - root - INFO - dt 1
2023-07-25 05:32:08,785 - root - INFO - n_history 0
2023-07-25 05:32:08,785 - root - INFO - prediction_type iterative
2023-07-25 05:32:08,785 - root - INFO - prediction_length 30
2023-07-25 05:32:08,785 - root - INFO - n_initial_conditions 5
2023-07-25 05:32:08,785 - root - INFO - ics_type default
2023-07-25 05:32:08,785 - root - INFO - save_raw_forecasts True
2023-07-25 05:32:08,785 - root - INFO - save_channel False
2023-07-25 05:32:08,785 - root - INFO - masked_acc False
2023-07-25 05:32:08,785 - root - INFO - maskpath None
2023-07-25 05:32:08,785 - root - INFO - perturb False
2023-07-25 05:32:08,786 - root - INFO - add_grid False
2023-07-25 05:32:08,786 - root - INFO - N_grid_channels 0
2023-07-25 05:32:08,786 - root - INFO - gridtype sinusoidal
2023-07-25 05:32:08,786 - root - INFO - roll False
2023-07-25 05:32:08,786 - root - INFO - num_blocks 8
2023-07-25 05:32:08,786 - root - INFO - nettype afno
2023-07-25 05:32:08,786 - root - INFO - patch_size 8
2023-07-25 05:32:08,786 - root - INFO - width 56
2023-07-25 05:32:08,786 - root - INFO - modes 32
2023-07-25 05:32:08,786 - root - INFO - target V10
2023-07-25 05:32:08,786 - root - INFO - normalization zscore
2023-07-25 05:32:08,786 - root - INFO - log_to_screen True
2023-07-25 05:32:08,786 - root - INFO - save_checkpoint True
2023-07-25 05:32:08,786 - root - INFO - enable_nhwc False
2023-07-25 05:32:08,786 - root - INFO - optimizer_type FusedAdam
2023-07-25 05:32:08,786 - root - INFO - crop_size_x None
2023-07-25 05:32:08,786 - root - INFO - crop_size_y None
2023-07-25 05:32:08,786 - root - INFO - two_step_training False
2023-07-25 05:32:08,786 - root - INFO - plot_animations False
2023-07-25 05:32:08,787 - root - INFO - add_noise False
2023-07-25 05:32:08,787 - root - INFO - noise_std 0
2023-07-25 05:32:08,787 - root - INFO - world_size 1
2023-07-25 05:32:08,787 - root - INFO - interp 0
2023-07-25 05:32:08,787 - root - INFO - use_daily_climatology False
2023-07-25 05:32:08,787 - root - INFO - global_batch_size 64
2023-07-25 05:32:08,787 - root - INFO - ablate V1000
2023-07-25 05:32:08,787 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 05:32:08,787 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 05:32:08,787 - root - INFO - resuming False
2023-07-25 05:32:08,787 - root - INFO - local_rank 0
2023-07-25 05:32:08,787 - root - INFO - ---------------------------------------------------
2023-07-25 05:32:08,787 - root - INFO - Inference for 1 initial conditions
2023-07-25 05:32:09,225 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 05:32:09,226 - root - INFO - Number of samples per year: 1460
2023-07-25 05:32:09,226 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 05:32:09,227 - root - INFO - Delta t: 6 hours
2023-07-25 05:32:09,227 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 05:32:09,227 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 05:33:35,542 - root - INFO - Loading inference data
2023-07-25 05:33:35,543 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 05:33:35,830 - root - INFO - Initial condition 1 of 1
2023-07-25 05:33:36,866 - root - INFO - Extracting valid data from the first year
2023-07-25 05:36:38,791 - root - INFO - Standardizing data
2023-07-25 05:36:46,483 - root - INFO - Loading time means
2023-07-25 05:37:03,346 - root - INFO - Begin autoregressive inference
2023-07-25 05:37:14,512 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 05:37:25,907 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 1.3386014699935913, ACC: 0.9490554332733154
2023-07-25 05:37:36,967 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 1.3673443794250488, ACC: 0.9466230869293213
2023-07-25 05:37:47,079 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 1.4071311950683594, ACC: 0.9429309368133545
2023-07-25 05:37:57,787 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 1.479792594909668, ACC: 0.9362473487854004
2023-07-25 05:38:08,841 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 1.5114011764526367, ACC: 0.9322453737258911
2023-07-25 05:38:19,657 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 1.6233590841293335, ACC: 0.9207255244255066
2023-07-25 05:38:30,697 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 1.7474350929260254, ACC: 0.9074064493179321
2023-07-25 05:38:41,256 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 1.906411051750183, ACC: 0.8923941254615784
2023-07-25 05:38:52,284 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 2.033844232559204, ACC: 0.8796905875205994
2023-07-25 05:39:03,160 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 2.1582508087158203, ACC: 0.8713797926902771
2023-07-25 05:39:13,847 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 2.2693512439727783, ACC: 0.8626431822776794
2023-07-25 05:39:24,529 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 2.4156417846679688, ACC: 0.8457541465759277
2023-07-25 05:39:34,846 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 2.5601744651794434, ACC: 0.8318925499916077
2023-07-25 05:39:46,480 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 2.7089247703552246, ACC: 0.8138948678970337
2023-07-25 05:39:56,505 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 2.8803024291992188, ACC: 0.7866838574409485
2023-07-25 05:40:06,948 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 2.98807430267334, ACC: 0.7655366063117981
2023-07-25 05:40:18,168 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 3.0504393577575684, ACC: 0.7527060508728027
2023-07-25 05:40:28,624 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 3.1288914680480957, ACC: 0.7317675948143005
2023-07-25 05:40:38,776 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 3.205521583557129, ACC: 0.7191452383995056
2023-07-25 05:40:49,151 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 3.300649881362915, ACC: 0.6969557404518127
2023-07-25 05:41:00,023 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 3.457545280456543, ACC: 0.6708568334579468
2023-07-25 05:41:11,392 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 3.63688588142395, ACC: 0.6366081833839417
2023-07-25 05:41:22,124 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 3.788937568664551, ACC: 0.6042312979698181
2023-07-25 05:41:34,586 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 3.9023168087005615, ACC: 0.5804471969604492
2023-07-25 05:41:45,420 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 4.075899600982666, ACC: 0.5515145063400269
2023-07-25 05:41:56,486 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 4.242377758026123, ACC: 0.5251539349555969
2023-07-25 05:42:07,394 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 4.426637172698975, ACC: 0.4817408323287964
2023-07-25 05:42:18,392 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 4.465735912322998, ACC: 0.4530651867389679
2023-07-25 05:42:29,462 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 4.537411689758301, ACC: 0.42976510524749756
2023-07-25 05:42:29,558 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-V1000_30-timesteps_vis.h5
2023-07-25 05:43:24,173 - root - INFO - ------------------ Configuration ------------------
2023-07-25 05:43:24,173 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 05:43:24,173 - root - INFO - Configuration name: afno_backbone
2023-07-25 05:43:24,173 - root - INFO - log_to_wandb True
2023-07-25 05:43:24,173 - root - INFO - lr 0.0005
2023-07-25 05:43:24,173 - root - INFO - batch_size 64
2023-07-25 05:43:24,173 - root - INFO - max_epochs 150
2023-07-25 05:43:24,173 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 05:43:24,173 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 05:43:24,174 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 05:43:24,174 - root - INFO - orography False
2023-07-25 05:43:24,174 - root - INFO - orography_path None
2023-07-25 05:43:24,174 - root - INFO - exp_dir FourCastNet/results
2023-07-25 05:43:24,174 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 05:43:24,174 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 05:43:24,174 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 05:43:24,174 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 05:43:24,174 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 05:43:24,174 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 05:43:24,174 - root - INFO - loss l2
2023-07-25 05:43:24,174 - root - INFO - num_data_workers 4
2023-07-25 05:43:24,174 - root - INFO - dt 1
2023-07-25 05:43:24,174 - root - INFO - n_history 0
2023-07-25 05:43:24,174 - root - INFO - prediction_type iterative
2023-07-25 05:43:24,174 - root - INFO - prediction_length 30
2023-07-25 05:43:24,174 - root - INFO - n_initial_conditions 5
2023-07-25 05:43:24,175 - root - INFO - ics_type default
2023-07-25 05:43:24,175 - root - INFO - save_raw_forecasts True
2023-07-25 05:43:24,175 - root - INFO - save_channel False
2023-07-25 05:43:24,175 - root - INFO - masked_acc False
2023-07-25 05:43:24,175 - root - INFO - maskpath None
2023-07-25 05:43:24,175 - root - INFO - perturb False
2023-07-25 05:43:24,175 - root - INFO - add_grid False
2023-07-25 05:43:24,175 - root - INFO - N_grid_channels 0
2023-07-25 05:43:24,175 - root - INFO - gridtype sinusoidal
2023-07-25 05:43:24,175 - root - INFO - roll False
2023-07-25 05:43:24,175 - root - INFO - num_blocks 8
2023-07-25 05:43:24,175 - root - INFO - nettype afno
2023-07-25 05:43:24,175 - root - INFO - patch_size 8
2023-07-25 05:43:24,175 - root - INFO - width 56
2023-07-25 05:43:24,175 - root - INFO - modes 32
2023-07-25 05:43:24,175 - root - INFO - target V10
2023-07-25 05:43:24,175 - root - INFO - normalization zscore
2023-07-25 05:43:24,175 - root - INFO - log_to_screen True
2023-07-25 05:43:24,176 - root - INFO - save_checkpoint True
2023-07-25 05:43:24,176 - root - INFO - enable_nhwc False
2023-07-25 05:43:24,176 - root - INFO - optimizer_type FusedAdam
2023-07-25 05:43:24,176 - root - INFO - crop_size_x None
2023-07-25 05:43:24,176 - root - INFO - crop_size_y None
2023-07-25 05:43:24,176 - root - INFO - two_step_training False
2023-07-25 05:43:24,176 - root - INFO - plot_animations False
2023-07-25 05:43:24,176 - root - INFO - add_noise False
2023-07-25 05:43:24,176 - root - INFO - noise_std 0
2023-07-25 05:43:24,176 - root - INFO - world_size 1
2023-07-25 05:43:24,176 - root - INFO - interp 0
2023-07-25 05:43:24,176 - root - INFO - use_daily_climatology False
2023-07-25 05:43:24,176 - root - INFO - global_batch_size 64
2023-07-25 05:43:24,176 - root - INFO - ablate Z1000
2023-07-25 05:43:24,176 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 05:43:24,176 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 05:43:24,176 - root - INFO - resuming False
2023-07-25 05:43:24,177 - root - INFO - local_rank 0
2023-07-25 05:43:24,177 - root - INFO - ---------------------------------------------------
2023-07-25 05:43:24,177 - root - INFO - Inference for 1 initial conditions
2023-07-25 05:43:24,566 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 05:43:24,567 - root - INFO - Number of samples per year: 1460
2023-07-25 05:43:24,567 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 05:43:24,567 - root - INFO - Delta t: 6 hours
2023-07-25 05:43:24,567 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 05:43:24,568 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 05:44:44,612 - root - INFO - Loading inference data
2023-07-25 05:44:44,613 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 05:44:44,947 - root - INFO - Initial condition 1 of 1
2023-07-25 05:44:45,849 - root - INFO - Extracting valid data from the first year
2023-07-25 05:47:41,743 - root - INFO - Standardizing data
2023-07-25 05:47:49,191 - root - INFO - Loading time means
2023-07-25 05:48:07,252 - root - INFO - Begin autoregressive inference
2023-07-25 05:48:18,574 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 05:48:30,295 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 1.0460785627365112, ACC: 0.9704331755638123
2023-07-25 05:48:40,973 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 1.046074390411377, ACC: 0.9689004421234131
2023-07-25 05:48:52,254 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 1.0686253309249878, ACC: 0.9671674370765686
2023-07-25 05:49:04,453 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 1.153315544128418, ACC: 0.9614413380622864
2023-07-25 05:49:16,028 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 1.243878960609436, ACC: 0.9541782736778259
2023-07-25 05:49:27,196 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 1.341368317604065, ACC: 0.946205735206604
2023-07-25 05:49:37,840 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 1.4563100337982178, ACC: 0.9362204670906067
2023-07-25 05:49:48,843 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 1.6267011165618896, ACC: 0.9223118424415588
2023-07-25 05:50:00,108 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 1.7480552196502686, ACC: 0.9116230010986328
2023-07-25 05:50:11,345 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 1.8614650964736938, ACC: 0.9047830700874329
2023-07-25 05:50:21,530 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 1.9884140491485596, ACC: 0.8946494460105896
2023-07-25 05:50:33,268 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 2.1590003967285156, ACC: 0.8765193819999695
2023-07-25 05:50:44,351 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 2.3030779361724854, ACC: 0.8627980947494507
2023-07-25 05:50:55,625 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 2.45116925239563, ACC: 0.8452026844024658
2023-07-25 05:51:07,364 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 2.5894079208374023, ACC: 0.8245572447776794
2023-07-25 05:51:18,438 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 2.7493879795074463, ACC: 0.7976667284965515
2023-07-25 05:51:29,602 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 2.858745813369751, ACC: 0.7770748138427734
2023-07-25 05:51:40,294 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 2.9687986373901367, ACC: 0.7513716220855713
2023-07-25 05:51:52,704 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 3.083895444869995, ACC: 0.7322710156440735
2023-07-25 05:52:04,276 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 3.211076498031616, ACC: 0.7048715353012085
2023-07-25 05:52:16,608 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 3.3638546466827393, ACC: 0.677574634552002
2023-07-25 05:52:27,223 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 3.5479345321655273, ACC: 0.6428632736206055
2023-07-25 05:52:38,495 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 3.7252590656280518, ACC: 0.6090201139450073
2023-07-25 05:52:49,324 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 3.7971394062042236, ACC: 0.5960280299186707
2023-07-25 05:53:00,283 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 3.839003086090088, ACC: 0.596728503704071
2023-07-25 05:53:11,003 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 3.9507675170898438, ACC: 0.5867775082588196
2023-07-25 05:53:21,968 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 4.066738605499268, ACC: 0.5657671689987183
2023-07-25 05:53:33,310 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 4.0973429679870605, ACC: 0.5483669638633728
2023-07-25 05:53:44,035 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 4.148929119110107, ACC: 0.5368984341621399
2023-07-25 05:53:44,135 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-Z1000_30-timesteps_vis.h5
2023-07-25 05:54:37,411 - root - INFO - ------------------ Configuration ------------------
2023-07-25 05:54:37,411 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 05:54:37,412 - root - INFO - Configuration name: afno_backbone
2023-07-25 05:54:37,412 - root - INFO - log_to_wandb True
2023-07-25 05:54:37,412 - root - INFO - lr 0.0005
2023-07-25 05:54:37,412 - root - INFO - batch_size 64
2023-07-25 05:54:37,413 - root - INFO - max_epochs 150
2023-07-25 05:54:37,413 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 05:54:37,413 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 05:54:37,413 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 05:54:37,413 - root - INFO - orography False
2023-07-25 05:54:37,413 - root - INFO - orography_path None
2023-07-25 05:54:37,414 - root - INFO - exp_dir FourCastNet/results
2023-07-25 05:54:37,414 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 05:54:37,414 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 05:54:37,414 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 05:54:37,414 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 05:54:37,415 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 05:54:37,415 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 05:54:37,415 - root - INFO - loss l2
2023-07-25 05:54:37,415 - root - INFO - num_data_workers 4
2023-07-25 05:54:37,416 - root - INFO - dt 1
2023-07-25 05:54:37,416 - root - INFO - n_history 0
2023-07-25 05:54:37,416 - root - INFO - prediction_type iterative
2023-07-25 05:54:37,416 - root - INFO - prediction_length 30
2023-07-25 05:54:37,416 - root - INFO - n_initial_conditions 5
2023-07-25 05:54:37,417 - root - INFO - ics_type default
2023-07-25 05:54:37,418 - root - INFO - save_raw_forecasts True
2023-07-25 05:54:37,418 - root - INFO - save_channel False
2023-07-25 05:54:37,418 - root - INFO - masked_acc False
2023-07-25 05:54:37,418 - root - INFO - maskpath None
2023-07-25 05:54:37,418 - root - INFO - perturb False
2023-07-25 05:54:37,419 - root - INFO - add_grid False
2023-07-25 05:54:37,419 - root - INFO - N_grid_channels 0
2023-07-25 05:54:37,419 - root - INFO - gridtype sinusoidal
2023-07-25 05:54:37,419 - root - INFO - roll False
2023-07-25 05:54:37,419 - root - INFO - num_blocks 8
2023-07-25 05:54:37,419 - root - INFO - nettype afno
2023-07-25 05:54:37,419 - root - INFO - patch_size 8
2023-07-25 05:54:37,419 - root - INFO - width 56
2023-07-25 05:54:37,419 - root - INFO - modes 32
2023-07-25 05:54:37,419 - root - INFO - target V10
2023-07-25 05:54:37,419 - root - INFO - normalization zscore
2023-07-25 05:54:37,419 - root - INFO - log_to_screen True
2023-07-25 05:54:37,419 - root - INFO - save_checkpoint True
2023-07-25 05:54:37,419 - root - INFO - enable_nhwc False
2023-07-25 05:54:37,419 - root - INFO - optimizer_type FusedAdam
2023-07-25 05:54:37,419 - root - INFO - crop_size_x None
2023-07-25 05:54:37,419 - root - INFO - crop_size_y None
2023-07-25 05:54:37,419 - root - INFO - two_step_training False
2023-07-25 05:54:37,419 - root - INFO - plot_animations False
2023-07-25 05:54:37,419 - root - INFO - add_noise False
2023-07-25 05:54:37,419 - root - INFO - noise_std 0
2023-07-25 05:54:37,419 - root - INFO - world_size 1
2023-07-25 05:54:37,419 - root - INFO - interp 0
2023-07-25 05:54:37,419 - root - INFO - use_daily_climatology False
2023-07-25 05:54:37,419 - root - INFO - global_batch_size 64
2023-07-25 05:54:37,419 - root - INFO - ablate T850
2023-07-25 05:54:37,419 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 05:54:37,420 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 05:54:37,420 - root - INFO - resuming False
2023-07-25 05:54:37,420 - root - INFO - local_rank 0
2023-07-25 05:54:37,420 - root - INFO - ---------------------------------------------------
2023-07-25 05:54:37,420 - root - INFO - Inference for 1 initial conditions
2023-07-25 05:54:37,669 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 05:54:37,670 - root - INFO - Number of samples per year: 1460
2023-07-25 05:54:37,670 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 05:54:37,670 - root - INFO - Delta t: 6 hours
2023-07-25 05:54:37,670 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 05:54:37,670 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 05:55:53,332 - root - INFO - Loading inference data
2023-07-25 05:55:53,333 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 05:55:53,691 - root - INFO - Initial condition 1 of 1
2023-07-25 05:55:54,554 - root - INFO - Extracting valid data from the first year
2023-07-25 05:58:34,374 - root - INFO - Standardizing data
2023-07-25 05:58:41,998 - root - INFO - Loading time means
2023-07-25 05:58:57,028 - root - INFO - Begin autoregressive inference
2023-07-25 05:59:07,819 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 05:59:18,374 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 13.365243911743164, ACC: 0.2059343308210373
2023-07-25 05:59:29,299 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 57.659610748291016, ACC: 0.03442331776022911
2023-07-25 05:59:40,306 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 100.94107818603516, ACC: 0.02542239800095558
2023-07-25 05:59:50,511 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 156.17257690429688, ACC: 0.08040101826190948
2023-07-25 06:00:00,873 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 201.9332275390625, ACC: 0.13263244926929474
2023-07-25 06:00:12,450 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 221.39967346191406, ACC: 0.13761045038700104
2023-07-25 06:00:24,008 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 227.5688018798828, ACC: 0.11687144637107849
2023-07-25 06:00:35,053 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 232.2366180419922, ACC: 0.09729763120412827
2023-07-25 06:00:46,135 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 238.6580047607422, ACC: 0.07887689769268036
2023-07-25 06:00:57,202 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 244.7635040283203, ACC: 0.060343872755765915
2023-07-25 06:01:08,179 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 249.05355834960938, ACC: 0.04583365470170975
2023-07-25 06:01:19,077 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 251.62326049804688, ACC: 0.03832515329122543
2023-07-25 06:01:29,915 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 253.1327362060547, ACC: 0.03290177509188652
2023-07-25 06:01:40,106 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 254.10655212402344, ACC: 0.030041392892599106
2023-07-25 06:01:50,438 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 254.7543487548828, ACC: 0.028597746044397354
2023-07-25 06:02:01,032 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 255.15972900390625, ACC: 0.029678095132112503
2023-07-25 06:02:12,067 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 255.40560913085938, ACC: 0.030107181519269943
2023-07-25 06:02:22,535 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 255.5522003173828, ACC: 0.029398808255791664
2023-07-25 06:02:33,162 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 255.62799072265625, ACC: 0.030244184657931328
2023-07-25 06:02:43,716 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 255.68460083007812, ACC: 0.02742553874850273
2023-07-25 06:02:54,715 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 255.69668579101562, ACC: 0.030072683468461037
2023-07-25 06:03:06,083 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 255.7264404296875, ACC: 0.026166489347815514
2023-07-25 06:03:16,573 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 255.7293243408203, ACC: 0.0271008163690567
2023-07-25 06:03:27,723 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 255.73825073242188, ACC: 0.02589503861963749
2023-07-25 06:03:38,386 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 255.72918701171875, ACC: 0.028223251923918724
2023-07-25 06:03:48,813 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 255.73495483398438, ACC: 0.02701743319630623
2023-07-25 06:03:59,567 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 255.73095703125, ACC: 0.027986811473965645
2023-07-25 06:04:10,360 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 255.7432861328125, ACC: 0.025521690025925636
2023-07-25 06:04:21,246 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 255.74032592773438, ACC: 0.02629249356687069
2023-07-25 06:04:21,330 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-T850_30-timesteps_vis.h5
2023-07-25 06:05:14,440 - root - INFO - ------------------ Configuration ------------------
2023-07-25 06:05:14,440 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 06:05:14,440 - root - INFO - Configuration name: afno_backbone
2023-07-25 06:05:14,440 - root - INFO - log_to_wandb True
2023-07-25 06:05:14,440 - root - INFO - lr 0.0005
2023-07-25 06:05:14,440 - root - INFO - batch_size 64
2023-07-25 06:05:14,440 - root - INFO - max_epochs 150
2023-07-25 06:05:14,440 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 06:05:14,440 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 06:05:14,440 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 06:05:14,440 - root - INFO - orography False
2023-07-25 06:05:14,440 - root - INFO - orography_path None
2023-07-25 06:05:14,440 - root - INFO - exp_dir FourCastNet/results
2023-07-25 06:05:14,440 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 06:05:14,440 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 06:05:14,441 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 06:05:14,441 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 06:05:14,441 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 06:05:14,441 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 06:05:14,441 - root - INFO - loss l2
2023-07-25 06:05:14,441 - root - INFO - num_data_workers 4
2023-07-25 06:05:14,441 - root - INFO - dt 1
2023-07-25 06:05:14,441 - root - INFO - n_history 0
2023-07-25 06:05:14,441 - root - INFO - prediction_type iterative
2023-07-25 06:05:14,441 - root - INFO - prediction_length 30
2023-07-25 06:05:14,441 - root - INFO - n_initial_conditions 5
2023-07-25 06:05:14,441 - root - INFO - ics_type default
2023-07-25 06:05:14,441 - root - INFO - save_raw_forecasts True
2023-07-25 06:05:14,441 - root - INFO - save_channel False
2023-07-25 06:05:14,441 - root - INFO - masked_acc False
2023-07-25 06:05:14,441 - root - INFO - maskpath None
2023-07-25 06:05:14,441 - root - INFO - perturb False
2023-07-25 06:05:14,441 - root - INFO - add_grid False
2023-07-25 06:05:14,441 - root - INFO - N_grid_channels 0
2023-07-25 06:05:14,441 - root - INFO - gridtype sinusoidal
2023-07-25 06:05:14,442 - root - INFO - roll False
2023-07-25 06:05:14,442 - root - INFO - num_blocks 8
2023-07-25 06:05:14,442 - root - INFO - nettype afno
2023-07-25 06:05:14,442 - root - INFO - patch_size 8
2023-07-25 06:05:14,442 - root - INFO - width 56
2023-07-25 06:05:14,442 - root - INFO - modes 32
2023-07-25 06:05:14,442 - root - INFO - target V10
2023-07-25 06:05:14,442 - root - INFO - normalization zscore
2023-07-25 06:05:14,442 - root - INFO - log_to_screen True
2023-07-25 06:05:14,442 - root - INFO - save_checkpoint True
2023-07-25 06:05:14,442 - root - INFO - enable_nhwc False
2023-07-25 06:05:14,442 - root - INFO - optimizer_type FusedAdam
2023-07-25 06:05:14,442 - root - INFO - crop_size_x None
2023-07-25 06:05:14,442 - root - INFO - crop_size_y None
2023-07-25 06:05:14,442 - root - INFO - two_step_training False
2023-07-25 06:05:14,442 - root - INFO - plot_animations False
2023-07-25 06:05:14,442 - root - INFO - add_noise False
2023-07-25 06:05:14,442 - root - INFO - noise_std 0
2023-07-25 06:05:14,442 - root - INFO - world_size 1
2023-07-25 06:05:14,443 - root - INFO - interp 0
2023-07-25 06:05:14,443 - root - INFO - use_daily_climatology False
2023-07-25 06:05:14,443 - root - INFO - global_batch_size 64
2023-07-25 06:05:14,443 - root - INFO - ablate U850
2023-07-25 06:05:14,443 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 06:05:14,443 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 06:05:14,443 - root - INFO - resuming False
2023-07-25 06:05:14,443 - root - INFO - local_rank 0
2023-07-25 06:05:14,443 - root - INFO - ---------------------------------------------------
2023-07-25 06:05:14,443 - root - INFO - Inference for 1 initial conditions
2023-07-25 06:05:14,784 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 06:05:14,785 - root - INFO - Number of samples per year: 1460
2023-07-25 06:05:14,786 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 06:05:14,786 - root - INFO - Delta t: 6 hours
2023-07-25 06:05:14,786 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 06:05:14,787 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 06:06:32,603 - root - INFO - Loading inference data
2023-07-25 06:06:32,604 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 06:06:32,884 - root - INFO - Initial condition 1 of 1
2023-07-25 06:06:33,955 - root - INFO - Extracting valid data from the first year
2023-07-25 06:09:18,226 - root - INFO - Standardizing data
2023-07-25 06:09:25,669 - root - INFO - Loading time means
2023-07-25 06:09:43,244 - root - INFO - Begin autoregressive inference
2023-07-25 06:09:53,865 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 06:10:05,418 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 1.1422325372695923, ACC: 0.9625422358512878
2023-07-25 06:10:15,644 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 1.369791865348816, ACC: 0.9463633298873901
2023-07-25 06:10:25,537 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 1.4973938465118408, ACC: 0.9349976181983948
2023-07-25 06:10:36,108 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 1.5844255685806274, ACC: 0.9267008304595947
2023-07-25 06:10:45,859 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 1.6103591918945312, ACC: 0.9228079319000244
2023-07-25 06:10:56,600 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 1.6730023622512817, ACC: 0.9154632091522217
2023-07-25 06:11:06,849 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 1.7619086503982544, ACC: 0.9054203033447266
2023-07-25 06:11:16,701 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 1.890085220336914, ACC: 0.8937032222747803
2023-07-25 06:11:27,030 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 2.0006442070007324, ACC: 0.8825762867927551
2023-07-25 06:11:36,695 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 2.107675790786743, ACC: 0.8762459754943848
2023-07-25 06:11:47,014 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 2.22147274017334, ACC: 0.867131233215332
2023-07-25 06:11:57,465 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 2.367971658706665, ACC: 0.8507779836654663
2023-07-25 06:12:08,259 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 2.5309195518493652, ACC: 0.8344804048538208
2023-07-25 06:12:18,483 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 2.686509132385254, ACC: 0.8159427642822266
2023-07-25 06:12:28,509 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 2.8335328102111816, ACC: 0.7931858897209167
2023-07-25 06:12:39,407 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 3.0190045833587646, ACC: 0.7606501579284668
2023-07-25 06:12:49,742 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 3.1454176902770996, ACC: 0.7365225553512573
2023-07-25 06:13:00,535 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 3.2454824447631836, ACC: 0.7109293937683105
2023-07-25 06:13:11,790 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 3.3411011695861816, ACC: 0.6937010288238525
2023-07-25 06:13:22,642 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 3.4701030254364014, ACC: 0.6617695093154907
2023-07-25 06:13:33,604 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 3.604743480682373, ACC: 0.6380078792572021
2023-07-25 06:13:44,378 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 3.749828577041626, ACC: 0.6121730208396912
2023-07-25 06:13:55,581 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 3.8702001571655273, ACC: 0.5869308710098267
2023-07-25 06:14:06,035 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 3.924370288848877, ACC: 0.574590265750885
2023-07-25 06:14:17,176 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 4.016387939453125, ACC: 0.5623180270195007
2023-07-25 06:14:27,277 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 4.096655368804932, ACC: 0.5543797612190247
2023-07-25 06:14:38,126 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 4.1938862800598145, ACC: 0.5317485928535461
2023-07-25 06:14:48,327 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 4.196600437164307, ACC: 0.5150397419929504
2023-07-25 06:14:58,580 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 4.230877876281738, ACC: 0.5007320046424866
2023-07-25 06:14:58,665 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-U850_30-timesteps_vis.h5
2023-07-25 06:15:53,397 - root - INFO - ------------------ Configuration ------------------
2023-07-25 06:15:53,397 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 06:15:53,397 - root - INFO - Configuration name: afno_backbone
2023-07-25 06:15:53,397 - root - INFO - log_to_wandb True
2023-07-25 06:15:53,397 - root - INFO - lr 0.0005
2023-07-25 06:15:53,397 - root - INFO - batch_size 64
2023-07-25 06:15:53,397 - root - INFO - max_epochs 150
2023-07-25 06:15:53,397 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 06:15:53,397 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 06:15:53,397 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 06:15:53,397 - root - INFO - orography False
2023-07-25 06:15:53,397 - root - INFO - orography_path None
2023-07-25 06:15:53,397 - root - INFO - exp_dir FourCastNet/results
2023-07-25 06:15:53,397 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 06:15:53,398 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 06:15:53,398 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 06:15:53,398 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 06:15:53,398 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 06:15:53,398 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 06:15:53,398 - root - INFO - loss l2
2023-07-25 06:15:53,398 - root - INFO - num_data_workers 4
2023-07-25 06:15:53,398 - root - INFO - dt 1
2023-07-25 06:15:53,398 - root - INFO - n_history 0
2023-07-25 06:15:53,398 - root - INFO - prediction_type iterative
2023-07-25 06:15:53,398 - root - INFO - prediction_length 30
2023-07-25 06:15:53,398 - root - INFO - n_initial_conditions 5
2023-07-25 06:15:53,398 - root - INFO - ics_type default
2023-07-25 06:15:53,398 - root - INFO - save_raw_forecasts True
2023-07-25 06:15:53,398 - root - INFO - save_channel False
2023-07-25 06:15:53,398 - root - INFO - masked_acc False
2023-07-25 06:15:53,398 - root - INFO - maskpath None
2023-07-25 06:15:53,398 - root - INFO - perturb False
2023-07-25 06:15:53,398 - root - INFO - add_grid False
2023-07-25 06:15:53,398 - root - INFO - N_grid_channels 0
2023-07-25 06:15:53,398 - root - INFO - gridtype sinusoidal
2023-07-25 06:15:53,398 - root - INFO - roll False
2023-07-25 06:15:53,398 - root - INFO - num_blocks 8
2023-07-25 06:15:53,398 - root - INFO - nettype afno
2023-07-25 06:15:53,398 - root - INFO - patch_size 8
2023-07-25 06:15:53,398 - root - INFO - width 56
2023-07-25 06:15:53,399 - root - INFO - modes 32
2023-07-25 06:15:53,399 - root - INFO - target V10
2023-07-25 06:15:53,399 - root - INFO - normalization zscore
2023-07-25 06:15:53,399 - root - INFO - log_to_screen True
2023-07-25 06:15:53,399 - root - INFO - save_checkpoint True
2023-07-25 06:15:53,399 - root - INFO - enable_nhwc False
2023-07-25 06:15:53,399 - root - INFO - optimizer_type FusedAdam
2023-07-25 06:15:53,399 - root - INFO - crop_size_x None
2023-07-25 06:15:53,399 - root - INFO - crop_size_y None
2023-07-25 06:15:53,399 - root - INFO - two_step_training False
2023-07-25 06:15:53,399 - root - INFO - plot_animations False
2023-07-25 06:15:53,399 - root - INFO - add_noise False
2023-07-25 06:15:53,399 - root - INFO - noise_std 0
2023-07-25 06:15:53,399 - root - INFO - world_size 1
2023-07-25 06:15:53,399 - root - INFO - interp 0
2023-07-25 06:15:53,399 - root - INFO - use_daily_climatology False
2023-07-25 06:15:53,399 - root - INFO - global_batch_size 64
2023-07-25 06:15:53,399 - root - INFO - ablate V850
2023-07-25 06:15:53,399 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 06:15:53,399 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 06:15:53,399 - root - INFO - resuming False
2023-07-25 06:15:53,399 - root - INFO - local_rank 0
2023-07-25 06:15:53,399 - root - INFO - ---------------------------------------------------
2023-07-25 06:15:53,399 - root - INFO - Inference for 1 initial conditions
2023-07-25 06:15:53,622 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 06:15:53,623 - root - INFO - Number of samples per year: 1460
2023-07-25 06:15:53,623 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 06:15:53,623 - root - INFO - Delta t: 6 hours
2023-07-25 06:15:53,623 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 06:15:53,624 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 06:17:15,171 - root - INFO - Loading inference data
2023-07-25 06:17:15,173 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 06:17:15,381 - root - INFO - Initial condition 1 of 1
2023-07-25 06:17:16,257 - root - INFO - Extracting valid data from the first year
2023-07-25 06:19:56,981 - root - INFO - Standardizing data
2023-07-25 06:20:04,636 - root - INFO - Loading time means
2023-07-25 06:20:22,458 - root - INFO - Begin autoregressive inference
2023-07-25 06:20:32,779 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 06:20:43,430 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 0.8430825471878052, ACC: 0.9798194766044617
2023-07-25 06:20:54,803 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 1.1392748355865479, ACC: 0.9649547934532166
2023-07-25 06:21:05,611 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 1.198513150215149, ACC: 0.9589311480522156
2023-07-25 06:21:17,147 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 1.3065303564071655, ACC: 0.950235903263092
2023-07-25 06:21:28,699 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 1.3895803689956665, ACC: 0.9421243667602539
2023-07-25 06:21:40,308 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 1.470791220664978, ACC: 0.9345628619194031
2023-07-25 06:21:52,316 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 1.5323736667633057, ACC: 0.9285392165184021
2023-07-25 06:22:04,180 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 1.6726313829421997, ACC: 0.9171299934387207
2023-07-25 06:22:15,272 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 1.7689388990402222, ACC: 0.9085301756858826
2023-07-25 06:22:26,422 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 1.8637456893920898, ACC: 0.9036568403244019
2023-07-25 06:22:36,044 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 1.967995524406433, ACC: 0.8959124684333801
2023-07-25 06:22:47,646 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 2.1367762088775635, ACC: 0.8778985142707825
2023-07-25 06:22:58,472 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 2.2924304008483887, ACC: 0.8627910614013672
2023-07-25 06:23:10,157 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 2.4190030097961426, ACC: 0.8480023741722107
2023-07-25 06:23:21,573 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 2.545943021774292, ACC: 0.828704297542572
2023-07-25 06:23:32,321 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 2.7151758670806885, ACC: 0.8013718724250793
2023-07-25 06:23:44,729 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 2.8307852745056152, ACC: 0.780656099319458
2023-07-25 06:23:56,053 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 2.9319918155670166, ACC: 0.757290780544281
2023-07-25 06:24:07,175 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 3.0162532329559326, ACC: 0.7456653118133545
2023-07-25 06:24:18,292 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 3.153447151184082, ACC: 0.7183962464332581
2023-07-25 06:24:29,208 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 3.253016233444214, ACC: 0.7026770710945129
2023-07-25 06:24:41,286 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 3.4010157585144043, ACC: 0.6771448254585266
2023-07-25 06:24:52,865 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 3.529895305633545, ACC: 0.655033528804779
2023-07-25 06:25:04,512 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 3.63291072845459, ACC: 0.637991189956665
2023-07-25 06:25:16,221 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 3.6711502075195312, ACC: 0.6395748853683472
2023-07-25 06:25:27,592 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 3.7027008533477783, ACC: 0.6422854661941528
2023-07-25 06:25:38,927 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 3.726583480834961, ACC: 0.6374382972717285
2023-07-25 06:25:50,361 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 3.7609810829162598, ACC: 0.6186539530754089
2023-07-25 06:26:01,611 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 3.8226077556610107, ACC: 0.6023684740066528
2023-07-25 06:26:01,718 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-V850_30-timesteps_vis.h5
2023-07-25 06:26:55,329 - root - INFO - ------------------ Configuration ------------------
2023-07-25 06:26:55,329 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 06:26:55,329 - root - INFO - Configuration name: afno_backbone
2023-07-25 06:26:55,329 - root - INFO - log_to_wandb True
2023-07-25 06:26:55,330 - root - INFO - lr 0.0005
2023-07-25 06:26:55,330 - root - INFO - batch_size 64
2023-07-25 06:26:55,330 - root - INFO - max_epochs 150
2023-07-25 06:26:55,330 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 06:26:55,330 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 06:26:55,330 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 06:26:55,330 - root - INFO - orography False
2023-07-25 06:26:55,330 - root - INFO - orography_path None
2023-07-25 06:26:55,330 - root - INFO - exp_dir FourCastNet/results
2023-07-25 06:26:55,330 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 06:26:55,330 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 06:26:55,330 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 06:26:55,330 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 06:26:55,330 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 06:26:55,330 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 06:26:55,330 - root - INFO - loss l2
2023-07-25 06:26:55,330 - root - INFO - num_data_workers 4
2023-07-25 06:26:55,330 - root - INFO - dt 1
2023-07-25 06:26:55,330 - root - INFO - n_history 0
2023-07-25 06:26:55,330 - root - INFO - prediction_type iterative
2023-07-25 06:26:55,330 - root - INFO - prediction_length 30
2023-07-25 06:26:55,331 - root - INFO - n_initial_conditions 5
2023-07-25 06:26:55,331 - root - INFO - ics_type default
2023-07-25 06:26:55,331 - root - INFO - save_raw_forecasts True
2023-07-25 06:26:55,331 - root - INFO - save_channel False
2023-07-25 06:26:55,331 - root - INFO - masked_acc False
2023-07-25 06:26:55,331 - root - INFO - maskpath None
2023-07-25 06:26:55,331 - root - INFO - perturb False
2023-07-25 06:26:55,331 - root - INFO - add_grid False
2023-07-25 06:26:55,331 - root - INFO - N_grid_channels 0
2023-07-25 06:26:55,331 - root - INFO - gridtype sinusoidal
2023-07-25 06:26:55,331 - root - INFO - roll False
2023-07-25 06:26:55,331 - root - INFO - num_blocks 8
2023-07-25 06:26:55,331 - root - INFO - nettype afno
2023-07-25 06:26:55,331 - root - INFO - patch_size 8
2023-07-25 06:26:55,331 - root - INFO - width 56
2023-07-25 06:26:55,331 - root - INFO - modes 32
2023-07-25 06:26:55,331 - root - INFO - target V10
2023-07-25 06:26:55,331 - root - INFO - normalization zscore
2023-07-25 06:26:55,331 - root - INFO - log_to_screen True
2023-07-25 06:26:55,331 - root - INFO - save_checkpoint True
2023-07-25 06:26:55,332 - root - INFO - enable_nhwc False
2023-07-25 06:26:55,332 - root - INFO - optimizer_type FusedAdam
2023-07-25 06:26:55,332 - root - INFO - crop_size_x None
2023-07-25 06:26:55,332 - root - INFO - crop_size_y None
2023-07-25 06:26:55,332 - root - INFO - two_step_training False
2023-07-25 06:26:55,332 - root - INFO - plot_animations False
2023-07-25 06:26:55,332 - root - INFO - add_noise False
2023-07-25 06:26:55,332 - root - INFO - noise_std 0
2023-07-25 06:26:55,332 - root - INFO - world_size 1
2023-07-25 06:26:55,332 - root - INFO - interp 0
2023-07-25 06:26:55,332 - root - INFO - use_daily_climatology False
2023-07-25 06:26:55,332 - root - INFO - global_batch_size 64
2023-07-25 06:26:55,332 - root - INFO - ablate Z850
2023-07-25 06:26:55,332 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 06:26:55,332 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 06:26:55,332 - root - INFO - resuming False
2023-07-25 06:26:55,332 - root - INFO - local_rank 0
2023-07-25 06:26:55,332 - root - INFO - ---------------------------------------------------
2023-07-25 06:26:55,332 - root - INFO - Inference for 1 initial conditions
2023-07-25 06:26:55,586 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 06:26:55,587 - root - INFO - Number of samples per year: 1460
2023-07-25 06:26:55,588 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 06:26:55,588 - root - INFO - Delta t: 6 hours
2023-07-25 06:26:55,588 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 06:26:55,588 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 06:28:20,840 - root - INFO - Loading inference data
2023-07-25 06:28:20,841 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 06:28:21,148 - root - INFO - Initial condition 1 of 1
2023-07-25 06:28:22,092 - root - INFO - Extracting valid data from the first year
2023-07-25 06:32:14,421 - root - INFO - Standardizing data
2023-07-25 06:32:22,233 - root - INFO - Loading time means
2023-07-25 06:32:40,687 - root - INFO - Begin autoregressive inference
2023-07-25 06:32:52,453 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 06:33:04,694 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 17.3544864654541, ACC: 0.10227498412132263
2023-07-25 06:33:16,766 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 118.12065887451172, ACC: 0.0827062800526619
2023-07-25 06:33:28,520 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 198.99632263183594, ACC: 0.12493598461151123
2023-07-25 06:33:39,936 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 226.0430908203125, ACC: 0.12836237251758575
2023-07-25 06:33:51,314 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 228.981689453125, ACC: 0.13038083910942078
2023-07-25 06:34:02,095 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 231.2754364013672, ACC: 0.10858935117721558
2023-07-25 06:34:13,874 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 237.77842712402344, ACC: 0.08082277327775955
2023-07-25 06:34:25,153 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 244.29261779785156, ACC: 0.06374252587556839
2023-07-25 06:34:36,547 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 248.55311584472656, ACC: 0.05143490061163902
2023-07-25 06:34:48,357 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 251.21426391601562, ACC: 0.042606618255376816
2023-07-25 06:35:00,102 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 252.9668426513672, ACC: 0.03587867692112923
2023-07-25 06:35:10,867 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 254.09896850585938, ACC: 0.03350112959742546
2023-07-25 06:35:21,892 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 254.79568481445312, ACC: 0.03252450004220009
2023-07-25 06:35:33,007 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 255.2147979736328, ACC: 0.029988307505846024
2023-07-25 06:35:44,490 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 255.45291137695312, ACC: 0.02843184769153595
2023-07-25 06:35:56,638 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 255.57757568359375, ACC: 0.02906915359199047
2023-07-25 06:36:08,156 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 255.6427001953125, ACC: 0.030089857056736946
2023-07-25 06:36:20,276 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 255.68365478515625, ACC: 0.029506253078579903
2023-07-25 06:36:31,460 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 255.6998748779297, ACC: 0.030306996777653694
2023-07-25 06:36:42,871 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 255.72352600097656, ACC: 0.027462750673294067
2023-07-25 06:36:56,337 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 255.71749877929688, ACC: 0.030146917328238487
2023-07-25 06:37:08,571 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 255.73757934570312, ACC: 0.026237301528453827
2023-07-25 06:37:19,231 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 255.73541259765625, ACC: 0.02714424580335617
2023-07-25 06:37:30,368 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 255.7416229248047, ACC: 0.025923606008291245
2023-07-25 06:37:41,556 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 255.73104858398438, ACC: 0.028247136622667313
2023-07-25 06:37:52,042 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 255.73599243164062, ACC: 0.02703741192817688
2023-07-25 06:38:02,520 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 255.7315216064453, ACC: 0.028002532199025154
2023-07-25 06:38:13,258 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 255.7436065673828, ACC: 0.025533458217978477
2023-07-25 06:38:24,361 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 255.74050903320312, ACC: 0.02630200795829296
2023-07-25 06:38:24,452 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-Z850_30-timesteps_vis.h5
2023-07-25 06:39:17,491 - root - INFO - ------------------ Configuration ------------------
2023-07-25 06:39:17,491 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 06:39:17,491 - root - INFO - Configuration name: afno_backbone
2023-07-25 06:39:17,491 - root - INFO - log_to_wandb True
2023-07-25 06:39:17,491 - root - INFO - lr 0.0005
2023-07-25 06:39:17,491 - root - INFO - batch_size 64
2023-07-25 06:39:17,491 - root - INFO - max_epochs 150
2023-07-25 06:39:17,491 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 06:39:17,491 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 06:39:17,491 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 06:39:17,491 - root - INFO - orography False
2023-07-25 06:39:17,492 - root - INFO - orography_path None
2023-07-25 06:39:17,492 - root - INFO - exp_dir FourCastNet/results
2023-07-25 06:39:17,492 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 06:39:17,492 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 06:39:17,492 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 06:39:17,492 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 06:39:17,492 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 06:39:17,492 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 06:39:17,492 - root - INFO - loss l2
2023-07-25 06:39:17,492 - root - INFO - num_data_workers 4
2023-07-25 06:39:17,492 - root - INFO - dt 1
2023-07-25 06:39:17,492 - root - INFO - n_history 0
2023-07-25 06:39:17,492 - root - INFO - prediction_type iterative
2023-07-25 06:39:17,492 - root - INFO - prediction_length 30
2023-07-25 06:39:17,492 - root - INFO - n_initial_conditions 5
2023-07-25 06:39:17,492 - root - INFO - ics_type default
2023-07-25 06:39:17,492 - root - INFO - save_raw_forecasts True
2023-07-25 06:39:17,492 - root - INFO - save_channel False
2023-07-25 06:39:17,492 - root - INFO - masked_acc False
2023-07-25 06:39:17,492 - root - INFO - maskpath None
2023-07-25 06:39:17,492 - root - INFO - perturb False
2023-07-25 06:39:17,493 - root - INFO - add_grid False
2023-07-25 06:39:17,493 - root - INFO - N_grid_channels 0
2023-07-25 06:39:17,493 - root - INFO - gridtype sinusoidal
2023-07-25 06:39:17,493 - root - INFO - roll False
2023-07-25 06:39:17,493 - root - INFO - num_blocks 8
2023-07-25 06:39:17,493 - root - INFO - nettype afno
2023-07-25 06:39:17,493 - root - INFO - patch_size 8
2023-07-25 06:39:17,493 - root - INFO - width 56
2023-07-25 06:39:17,493 - root - INFO - modes 32
2023-07-25 06:39:17,493 - root - INFO - target V10
2023-07-25 06:39:17,493 - root - INFO - normalization zscore
2023-07-25 06:39:17,493 - root - INFO - log_to_screen True
2023-07-25 06:39:17,493 - root - INFO - save_checkpoint True
2023-07-25 06:39:17,493 - root - INFO - enable_nhwc False
2023-07-25 06:39:17,493 - root - INFO - optimizer_type FusedAdam
2023-07-25 06:39:17,493 - root - INFO - crop_size_x None
2023-07-25 06:39:17,493 - root - INFO - crop_size_y None
2023-07-25 06:39:17,493 - root - INFO - two_step_training False
2023-07-25 06:39:17,493 - root - INFO - plot_animations False
2023-07-25 06:39:17,493 - root - INFO - add_noise False
2023-07-25 06:39:17,493 - root - INFO - noise_std 0
2023-07-25 06:39:17,494 - root - INFO - world_size 1
2023-07-25 06:39:17,494 - root - INFO - interp 0
2023-07-25 06:39:17,494 - root - INFO - use_daily_climatology False
2023-07-25 06:39:17,494 - root - INFO - global_batch_size 64
2023-07-25 06:39:17,494 - root - INFO - ablate RH850
2023-07-25 06:39:17,494 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 06:39:17,494 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 06:39:17,494 - root - INFO - resuming False
2023-07-25 06:39:17,494 - root - INFO - local_rank 0
2023-07-25 06:39:17,494 - root - INFO - ---------------------------------------------------
2023-07-25 06:39:17,494 - root - INFO - Inference for 1 initial conditions
2023-07-25 06:39:17,794 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 06:39:17,795 - root - INFO - Number of samples per year: 1460
2023-07-25 06:39:17,795 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 06:39:17,795 - root - INFO - Delta t: 6 hours
2023-07-25 06:39:17,795 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 06:39:17,795 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 06:40:35,516 - root - INFO - Loading inference data
2023-07-25 06:40:35,517 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 06:40:35,787 - root - INFO - Initial condition 1 of 1
2023-07-25 06:40:36,613 - root - INFO - Extracting valid data from the first year
2023-07-25 06:43:21,792 - root - INFO - Standardizing data
2023-07-25 06:43:29,423 - root - INFO - Loading time means
2023-07-25 06:43:48,218 - root - INFO - Begin autoregressive inference
2023-07-25 06:43:59,214 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 06:44:12,432 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 0.9990012645721436, ACC: 0.9717313647270203
2023-07-25 06:44:23,727 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 1.3104783296585083, ACC: 0.9506394267082214
2023-07-25 06:44:34,916 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 1.5356793403625488, ACC: 0.9310480952262878
2023-07-25 06:44:46,184 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 1.6932570934295654, ACC: 0.9153503179550171
2023-07-25 06:44:58,346 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 1.8572702407836914, ACC: 0.8954276442527771
2023-07-25 06:45:10,746 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 1.9672048091888428, ACC: 0.8814095854759216
2023-07-25 06:45:22,608 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 2.0900957584381104, ACC: 0.8651251196861267
2023-07-25 06:45:34,650 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 2.235107183456421, ACC: 0.849579393863678
2023-07-25 06:45:46,933 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 2.317371368408203, ACC: 0.840584933757782
2023-07-25 06:45:58,459 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 2.3863375186920166, ACC: 0.8392373919487
2023-07-25 06:46:11,221 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 2.545764207839966, ACC: 0.8228568434715271
2023-07-25 06:46:23,250 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 2.7144181728363037, ACC: 0.8007150888442993
2023-07-25 06:46:35,521 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 2.887486457824707, ACC: 0.7808052897453308
2023-07-25 06:46:48,077 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 3.002103567123413, ACC: 0.765951931476593
2023-07-25 06:47:00,233 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 3.1383779048919678, ACC: 0.7427172660827637
2023-07-25 06:47:11,357 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 3.293341636657715, ACC: 0.7114987373352051
2023-07-25 06:47:22,806 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 3.383171796798706, ACC: 0.692325234413147
2023-07-25 06:47:34,169 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 3.4639554023742676, ACC: 0.6675742268562317
2023-07-25 06:47:45,460 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 3.6152334213256836, ACC: 0.6403322815895081
2023-07-25 06:47:56,710 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 3.7832062244415283, ACC: 0.5996814370155334
2023-07-25 06:48:08,946 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 3.9827497005462646, ACC: 0.5613376498222351
2023-07-25 06:48:20,492 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 4.112818717956543, ACC: 0.5353405475616455
2023-07-25 06:48:31,001 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 4.265520095825195, ACC: 0.5014140605926514
2023-07-25 06:48:42,610 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 4.37219762802124, ACC: 0.4747960865497589
2023-07-25 06:48:54,401 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 4.530736446380615, ACC: 0.44824108481407166
2023-07-25 06:49:05,828 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 4.6328606605529785, ACC: 0.43788349628448486
2023-07-25 06:49:17,509 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 4.75156831741333, ACC: 0.4132686257362366
2023-07-25 06:49:29,376 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 4.754782199859619, ACC: 0.39422115683555603
2023-07-25 06:49:40,988 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 4.75493860244751, ACC: 0.38950401544570923
2023-07-25 06:49:41,076 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-RH850_30-timesteps_vis.h5
2023-07-25 06:50:34,291 - root - INFO - ------------------ Configuration ------------------
2023-07-25 06:50:34,291 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 06:50:34,291 - root - INFO - Configuration name: afno_backbone
2023-07-25 06:50:34,291 - root - INFO - log_to_wandb True
2023-07-25 06:50:34,291 - root - INFO - lr 0.0005
2023-07-25 06:50:34,291 - root - INFO - batch_size 64
2023-07-25 06:50:34,291 - root - INFO - max_epochs 150
2023-07-25 06:50:34,291 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 06:50:34,291 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 06:50:34,291 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 06:50:34,292 - root - INFO - orography False
2023-07-25 06:50:34,292 - root - INFO - orography_path None
2023-07-25 06:50:34,292 - root - INFO - exp_dir FourCastNet/results
2023-07-25 06:50:34,292 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 06:50:34,292 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 06:50:34,292 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 06:50:34,292 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 06:50:34,292 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 06:50:34,292 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 06:50:34,292 - root - INFO - loss l2
2023-07-25 06:50:34,292 - root - INFO - num_data_workers 4
2023-07-25 06:50:34,292 - root - INFO - dt 1
2023-07-25 06:50:34,292 - root - INFO - n_history 0
2023-07-25 06:50:34,292 - root - INFO - prediction_type iterative
2023-07-25 06:50:34,292 - root - INFO - prediction_length 30
2023-07-25 06:50:34,292 - root - INFO - n_initial_conditions 5
2023-07-25 06:50:34,292 - root - INFO - ics_type default
2023-07-25 06:50:34,292 - root - INFO - save_raw_forecasts True
2023-07-25 06:50:34,292 - root - INFO - save_channel False
2023-07-25 06:50:34,292 - root - INFO - masked_acc False
2023-07-25 06:50:34,293 - root - INFO - maskpath None
2023-07-25 06:50:34,293 - root - INFO - perturb False
2023-07-25 06:50:34,293 - root - INFO - add_grid False
2023-07-25 06:50:34,293 - root - INFO - N_grid_channels 0
2023-07-25 06:50:34,293 - root - INFO - gridtype sinusoidal
2023-07-25 06:50:34,293 - root - INFO - roll False
2023-07-25 06:50:34,293 - root - INFO - num_blocks 8
2023-07-25 06:50:34,293 - root - INFO - nettype afno
2023-07-25 06:50:34,293 - root - INFO - patch_size 8
2023-07-25 06:50:34,293 - root - INFO - width 56
2023-07-25 06:50:34,293 - root - INFO - modes 32
2023-07-25 06:50:34,293 - root - INFO - target V10
2023-07-25 06:50:34,293 - root - INFO - normalization zscore
2023-07-25 06:50:34,293 - root - INFO - log_to_screen True
2023-07-25 06:50:34,293 - root - INFO - save_checkpoint True
2023-07-25 06:50:34,293 - root - INFO - enable_nhwc False
2023-07-25 06:50:34,293 - root - INFO - optimizer_type FusedAdam
2023-07-25 06:50:34,293 - root - INFO - crop_size_x None
2023-07-25 06:50:34,293 - root - INFO - crop_size_y None
2023-07-25 06:50:34,293 - root - INFO - two_step_training False
2023-07-25 06:50:34,293 - root - INFO - plot_animations False
2023-07-25 06:50:34,294 - root - INFO - add_noise False
2023-07-25 06:50:34,294 - root - INFO - noise_std 0
2023-07-25 06:50:34,294 - root - INFO - world_size 1
2023-07-25 06:50:34,294 - root - INFO - interp 0
2023-07-25 06:50:34,294 - root - INFO - use_daily_climatology False
2023-07-25 06:50:34,294 - root - INFO - global_batch_size 64
2023-07-25 06:50:34,294 - root - INFO - ablate T500
2023-07-25 06:50:34,294 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 06:50:34,294 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 06:50:34,294 - root - INFO - resuming False
2023-07-25 06:50:34,294 - root - INFO - local_rank 0
2023-07-25 06:50:34,294 - root - INFO - ---------------------------------------------------
2023-07-25 06:50:34,294 - root - INFO - Inference for 1 initial conditions
2023-07-25 06:50:34,718 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 06:50:34,719 - root - INFO - Number of samples per year: 1460
2023-07-25 06:50:34,719 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 06:50:34,719 - root - INFO - Delta t: 6 hours
2023-07-25 06:50:34,719 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 06:50:34,719 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 06:51:54,013 - root - INFO - Loading inference data
2023-07-25 06:51:54,014 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 06:51:54,261 - root - INFO - Initial condition 1 of 1
2023-07-25 06:51:55,060 - root - INFO - Extracting valid data from the first year
2023-07-25 06:54:28,468 - root - INFO - Standardizing data
2023-07-25 06:54:35,932 - root - INFO - Loading time means
2023-07-25 06:54:52,604 - root - INFO - Begin autoregressive inference
2023-07-25 06:55:02,804 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 06:55:13,480 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 0.9075331687927246, ACC: 0.977760374546051
2023-07-25 06:55:24,243 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 1.0367034673690796, ACC: 0.9697183966636658
2023-07-25 06:55:34,945 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 1.1403249502182007, ACC: 0.962524950504303
2023-07-25 06:55:46,221 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 1.259812831878662, ACC: 0.9537625908851624
2023-07-25 06:55:56,365 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 1.3734797239303589, ACC: 0.9436655044555664
2023-07-25 06:56:07,832 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 1.4904042482376099, ACC: 0.9331036806106567
2023-07-25 06:56:19,258 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 1.5706214904785156, ACC: 0.9250901937484741
2023-07-25 06:56:30,426 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 1.7138937711715698, ACC: 0.9131118655204773
2023-07-25 06:56:41,607 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 1.8052033185958862, ACC: 0.904863715171814
2023-07-25 06:56:52,434 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 1.9241054058074951, ACC: 0.8972793221473694
2023-07-25 06:57:03,950 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 2.050840139389038, ACC: 0.8867299556732178
2023-07-25 06:57:14,420 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 2.226270914077759, ACC: 0.8669297099113464
2023-07-25 06:57:25,246 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 2.381308078765869, ACC: 0.8510035276412964
2023-07-25 06:57:35,153 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 2.5473976135253906, ACC: 0.8297222256660461
2023-07-25 06:57:46,362 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 2.7157161235809326, ACC: 0.8025663495063782
2023-07-25 06:57:57,741 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 2.8533685207366943, ACC: 0.7775667309761047
2023-07-25 06:58:08,303 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 2.9288649559020996, ACC: 0.7623122334480286
2023-07-25 06:58:19,624 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 3.0098087787628174, ACC: 0.7409921288490295
2023-07-25 06:58:29,481 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 3.062431573867798, ACC: 0.7344058156013489
2023-07-25 06:58:40,171 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 3.1301109790802, ACC: 0.7189474701881409
2023-07-25 06:58:52,122 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 3.1951677799224854, ACC: 0.7110564708709717
2023-07-25 06:59:02,821 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 3.282315969467163, ACC: 0.6966550350189209
2023-07-25 06:59:14,329 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 3.454766035079956, ACC: 0.6643103957176208
2023-07-25 06:59:25,109 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 3.6325645446777344, ACC: 0.6293156147003174
2023-07-25 06:59:35,891 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 3.7992401123046875, ACC: 0.6021236777305603
2023-07-25 06:59:47,021 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 3.942532777786255, ACC: 0.5848752856254578
2023-07-25 06:59:56,746 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 4.0958404541015625, ACC: 0.5528133511543274
2023-07-25 07:00:07,668 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 4.1643266677856445, ACC: 0.5195267796516418
2023-07-25 07:00:18,902 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 4.215342998504639, ACC: 0.4999296963214874
2023-07-25 07:00:18,999 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-T500_30-timesteps_vis.h5
2023-07-25 07:01:12,448 - root - INFO - ------------------ Configuration ------------------
2023-07-25 07:01:12,449 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 07:01:12,449 - root - INFO - Configuration name: afno_backbone
2023-07-25 07:01:12,449 - root - INFO - log_to_wandb True
2023-07-25 07:01:12,449 - root - INFO - lr 0.0005
2023-07-25 07:01:12,449 - root - INFO - batch_size 64
2023-07-25 07:01:12,449 - root - INFO - max_epochs 150
2023-07-25 07:01:12,449 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 07:01:12,449 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 07:01:12,449 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 07:01:12,449 - root - INFO - orography False
2023-07-25 07:01:12,449 - root - INFO - orography_path None
2023-07-25 07:01:12,449 - root - INFO - exp_dir FourCastNet/results
2023-07-25 07:01:12,449 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 07:01:12,449 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 07:01:12,449 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 07:01:12,449 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 07:01:12,450 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 07:01:12,450 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 07:01:12,450 - root - INFO - loss l2
2023-07-25 07:01:12,450 - root - INFO - num_data_workers 4
2023-07-25 07:01:12,450 - root - INFO - dt 1
2023-07-25 07:01:12,450 - root - INFO - n_history 0
2023-07-25 07:01:12,450 - root - INFO - prediction_type iterative
2023-07-25 07:01:12,450 - root - INFO - prediction_length 30
2023-07-25 07:01:12,450 - root - INFO - n_initial_conditions 5
2023-07-25 07:01:12,450 - root - INFO - ics_type default
2023-07-25 07:01:12,450 - root - INFO - save_raw_forecasts True
2023-07-25 07:01:12,450 - root - INFO - save_channel False
2023-07-25 07:01:12,450 - root - INFO - masked_acc False
2023-07-25 07:01:12,450 - root - INFO - maskpath None
2023-07-25 07:01:12,450 - root - INFO - perturb False
2023-07-25 07:01:12,450 - root - INFO - add_grid False
2023-07-25 07:01:12,450 - root - INFO - N_grid_channels 0
2023-07-25 07:01:12,450 - root - INFO - gridtype sinusoidal
2023-07-25 07:01:12,450 - root - INFO - roll False
2023-07-25 07:01:12,450 - root - INFO - num_blocks 8
2023-07-25 07:01:12,451 - root - INFO - nettype afno
2023-07-25 07:01:12,451 - root - INFO - patch_size 8
2023-07-25 07:01:12,451 - root - INFO - width 56
2023-07-25 07:01:12,451 - root - INFO - modes 32
2023-07-25 07:01:12,451 - root - INFO - target V10
2023-07-25 07:01:12,451 - root - INFO - normalization zscore
2023-07-25 07:01:12,451 - root - INFO - log_to_screen True
2023-07-25 07:01:12,451 - root - INFO - save_checkpoint True
2023-07-25 07:01:12,451 - root - INFO - enable_nhwc False
2023-07-25 07:01:12,451 - root - INFO - optimizer_type FusedAdam
2023-07-25 07:01:12,451 - root - INFO - crop_size_x None
2023-07-25 07:01:12,451 - root - INFO - crop_size_y None
2023-07-25 07:01:12,451 - root - INFO - two_step_training False
2023-07-25 07:01:12,451 - root - INFO - plot_animations False
2023-07-25 07:01:12,451 - root - INFO - add_noise False
2023-07-25 07:01:12,451 - root - INFO - noise_std 0
2023-07-25 07:01:12,451 - root - INFO - world_size 1
2023-07-25 07:01:12,451 - root - INFO - interp 0
2023-07-25 07:01:12,451 - root - INFO - use_daily_climatology False
2023-07-25 07:01:12,452 - root - INFO - global_batch_size 64
2023-07-25 07:01:12,452 - root - INFO - ablate U500
2023-07-25 07:01:12,452 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 07:01:12,452 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 07:01:12,452 - root - INFO - resuming False
2023-07-25 07:01:12,452 - root - INFO - local_rank 0
2023-07-25 07:01:12,452 - root - INFO - ---------------------------------------------------
2023-07-25 07:01:12,452 - root - INFO - Inference for 1 initial conditions
2023-07-25 07:01:12,796 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 07:01:12,797 - root - INFO - Number of samples per year: 1460
2023-07-25 07:01:12,797 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 07:01:12,797 - root - INFO - Delta t: 6 hours
2023-07-25 07:01:12,797 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 07:01:12,798 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 07:02:30,396 - root - INFO - Loading inference data
2023-07-25 07:02:30,397 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 07:02:30,628 - root - INFO - Initial condition 1 of 1
2023-07-25 07:02:31,499 - root - INFO - Extracting valid data from the first year
2023-07-25 07:05:13,546 - root - INFO - Standardizing data
2023-07-25 07:05:21,234 - root - INFO - Loading time means
2023-07-25 07:05:38,026 - root - INFO - Begin autoregressive inference
2023-07-25 07:05:49,431 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 07:06:01,644 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 15.938969612121582, ACC: 0.1064453274011612
2023-07-25 07:06:13,506 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 140.58468627929688, ACC: 0.14855079352855682
2023-07-25 07:06:25,301 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 226.2040557861328, ACC: 0.14920058846473694
2023-07-25 07:06:35,762 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 243.3314666748047, ACC: 0.1380389928817749
2023-07-25 07:06:46,591 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 238.16006469726562, ACC: 0.12606874108314514
2023-07-25 07:06:58,578 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 236.89376831054688, ACC: 0.09888596832752228
2023-07-25 07:07:10,219 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 241.5378875732422, ACC: 0.07127917557954788
2023-07-25 07:07:20,338 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 246.77676391601562, ACC: 0.056003328412771225
2023-07-25 07:07:31,481 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 250.39382934570312, ACC: 0.04487267881631851
2023-07-25 07:07:42,816 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 252.49522399902344, ACC: 0.03782477602362633
2023-07-25 07:07:53,655 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 253.76856994628906, ACC: 0.032862335443496704
2023-07-25 07:08:04,679 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 254.570068359375, ACC: 0.03158419206738472
2023-07-25 07:08:16,535 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 255.06690979003906, ACC: 0.03112778253853321
2023-07-25 07:08:27,737 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 255.3685302734375, ACC: 0.029154404997825623
2023-07-25 07:08:39,065 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 255.53915405273438, ACC: 0.027974823489785194
2023-07-25 07:08:49,446 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 255.62518310546875, ACC: 0.02891324833035469
2023-07-25 07:09:00,329 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 255.66873168945312, ACC: 0.030065376311540604
2023-07-25 07:09:12,630 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 255.69761657714844, ACC: 0.029554031789302826
2023-07-25 07:09:24,730 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 255.7073974609375, ACC: 0.030350180342793465
2023-07-25 07:09:35,953 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 255.72756958007812, ACC: 0.027497874572873116
2023-07-25 07:09:47,245 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 255.71966552734375, ACC: 0.03017694130539894
2023-07-25 07:09:58,349 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 255.73876953125, ACC: 0.026260457932949066
2023-07-25 07:10:09,610 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 255.73605346679688, ACC: 0.02716284617781639
2023-07-25 07:10:21,009 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 255.741943359375, ACC: 0.025939472019672394
2023-07-25 07:10:31,653 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 255.73123168945312, ACC: 0.02825925685465336
2023-07-25 07:10:41,937 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 255.736083984375, ACC: 0.027046361938118935
2023-07-25 07:10:52,938 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 255.73159790039062, ACC: 0.02800852246582508
2023-07-25 07:11:03,284 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 255.74366760253906, ACC: 0.02553689479827881
2023-07-25 07:11:15,294 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 255.7405548095703, ACC: 0.026304256170988083
2023-07-25 07:11:15,395 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-U500_30-timesteps_vis.h5
2023-07-25 07:12:08,881 - root - INFO - ------------------ Configuration ------------------
2023-07-25 07:12:08,881 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 07:12:08,881 - root - INFO - Configuration name: afno_backbone
2023-07-25 07:12:08,881 - root - INFO - log_to_wandb True
2023-07-25 07:12:08,882 - root - INFO - lr 0.0005
2023-07-25 07:12:08,882 - root - INFO - batch_size 64
2023-07-25 07:12:08,882 - root - INFO - max_epochs 150
2023-07-25 07:12:08,882 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 07:12:08,882 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 07:12:08,882 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 07:12:08,882 - root - INFO - orography False
2023-07-25 07:12:08,882 - root - INFO - orography_path None
2023-07-25 07:12:08,882 - root - INFO - exp_dir FourCastNet/results
2023-07-25 07:12:08,882 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 07:12:08,882 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 07:12:08,882 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 07:12:08,882 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 07:12:08,882 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 07:12:08,882 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 07:12:08,882 - root - INFO - loss l2
2023-07-25 07:12:08,882 - root - INFO - num_data_workers 4
2023-07-25 07:12:08,882 - root - INFO - dt 1
2023-07-25 07:12:08,883 - root - INFO - n_history 0
2023-07-25 07:12:08,883 - root - INFO - prediction_type iterative
2023-07-25 07:12:08,883 - root - INFO - prediction_length 30
2023-07-25 07:12:08,883 - root - INFO - n_initial_conditions 5
2023-07-25 07:12:08,883 - root - INFO - ics_type default
2023-07-25 07:12:08,883 - root - INFO - save_raw_forecasts True
2023-07-25 07:12:08,883 - root - INFO - save_channel False
2023-07-25 07:12:08,883 - root - INFO - masked_acc False
2023-07-25 07:12:08,883 - root - INFO - maskpath None
2023-07-25 07:12:08,883 - root - INFO - perturb False
2023-07-25 07:12:08,883 - root - INFO - add_grid False
2023-07-25 07:12:08,883 - root - INFO - N_grid_channels 0
2023-07-25 07:12:08,883 - root - INFO - gridtype sinusoidal
2023-07-25 07:12:08,883 - root - INFO - roll False
2023-07-25 07:12:08,883 - root - INFO - num_blocks 8
2023-07-25 07:12:08,883 - root - INFO - nettype afno
2023-07-25 07:12:08,884 - root - INFO - patch_size 8
2023-07-25 07:12:08,884 - root - INFO - width 56
2023-07-25 07:12:08,884 - root - INFO - modes 32
2023-07-25 07:12:08,884 - root - INFO - target V10
2023-07-25 07:12:08,884 - root - INFO - normalization zscore
2023-07-25 07:12:08,884 - root - INFO - log_to_screen True
2023-07-25 07:12:08,884 - root - INFO - save_checkpoint True
2023-07-25 07:12:08,884 - root - INFO - enable_nhwc False
2023-07-25 07:12:08,884 - root - INFO - optimizer_type FusedAdam
2023-07-25 07:12:08,884 - root - INFO - crop_size_x None
2023-07-25 07:12:08,884 - root - INFO - crop_size_y None
2023-07-25 07:12:08,884 - root - INFO - two_step_training False
2023-07-25 07:12:08,884 - root - INFO - plot_animations False
2023-07-25 07:12:08,884 - root - INFO - add_noise False
2023-07-25 07:12:08,884 - root - INFO - noise_std 0
2023-07-25 07:12:08,884 - root - INFO - world_size 1
2023-07-25 07:12:08,884 - root - INFO - interp 0
2023-07-25 07:12:08,884 - root - INFO - use_daily_climatology False
2023-07-25 07:12:08,884 - root - INFO - global_batch_size 64
2023-07-25 07:12:08,885 - root - INFO - ablate V500
2023-07-25 07:12:08,885 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 07:12:08,885 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 07:12:08,885 - root - INFO - resuming False
2023-07-25 07:12:08,885 - root - INFO - local_rank 0
2023-07-25 07:12:08,885 - root - INFO - ---------------------------------------------------
2023-07-25 07:12:08,885 - root - INFO - Inference for 1 initial conditions
2023-07-25 07:12:09,181 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 07:12:09,182 - root - INFO - Number of samples per year: 1460
2023-07-25 07:12:09,183 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 07:12:09,183 - root - INFO - Delta t: 6 hours
2023-07-25 07:12:09,183 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 07:12:09,183 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 07:13:37,000 - root - INFO - Loading inference data
2023-07-25 07:13:37,003 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 07:13:37,301 - root - INFO - Initial condition 1 of 1
2023-07-25 07:13:38,148 - root - INFO - Extracting valid data from the first year
2023-07-25 07:16:29,738 - root - INFO - Standardizing data
2023-07-25 07:16:37,599 - root - INFO - Loading time means
2023-07-25 07:16:54,699 - root - INFO - Begin autoregressive inference
2023-07-25 07:17:06,257 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 07:17:17,162 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 106.39519500732422, ACC: 0.11320342868566513
2023-07-25 07:17:28,444 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 196.87013244628906, ACC: 0.11299740523099899
2023-07-25 07:17:39,546 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 232.9290771484375, ACC: 0.1260853111743927
2023-07-25 07:17:50,954 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 235.116943359375, ACC: 0.12360779941082001
2023-07-25 07:18:03,020 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 233.5912322998047, ACC: 0.10923931747674942
2023-07-25 07:18:14,384 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 237.11538696289062, ACC: 0.08637654036283493
2023-07-25 07:18:25,363 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 242.72447204589844, ACC: 0.06383604556322098
2023-07-25 07:18:37,161 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 247.48411560058594, ACC: 0.05436587333679199
2023-07-25 07:18:47,894 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 250.79461669921875, ACC: 0.04504768177866936
2023-07-25 07:18:59,040 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 252.93846130371094, ACC: 0.03940607234835625
2023-07-25 07:19:10,876 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 254.2401885986328, ACC: 0.034532248973846436
2023-07-25 07:19:21,340 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 255.12109375, ACC: 0.03327672556042671
2023-07-25 07:19:33,219 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 255.5729217529297, ACC: 0.03278721123933792
2023-07-25 07:19:44,980 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 255.68505859375, ACC: 0.03051643632352352
2023-07-25 07:19:56,458 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 255.6802215576172, ACC: 0.02892867848277092
2023-07-25 07:20:08,334 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 255.67098999023438, ACC: 0.029455028474330902
2023-07-25 07:20:19,887 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 255.67747497558594, ACC: 0.030383991077542305
2023-07-25 07:20:32,767 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 255.69570922851562, ACC: 0.029741406440734863
2023-07-25 07:20:44,080 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 255.70428466796875, ACC: 0.0304727740585804
2023-07-25 07:20:56,202 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 255.7255096435547, ACC: 0.027573710307478905
2023-07-25 07:21:07,801 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 255.71868896484375, ACC: 0.030218690633773804
2023-07-25 07:21:19,447 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 255.7383575439453, ACC: 0.026282083243131638
2023-07-25 07:21:29,828 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 255.73590087890625, ACC: 0.027171198278665543
2023-07-25 07:21:42,078 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 255.74191284179688, ACC: 0.02594287507236004
2023-07-25 07:21:53,815 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 255.73123168945312, ACC: 0.028261156752705574
2023-07-25 07:22:05,061 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 255.736083984375, ACC: 0.02704627439379692
2023-07-25 07:22:16,662 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 255.73159790039062, ACC: 0.02800794690847397
2023-07-25 07:22:28,310 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 255.74363708496094, ACC: 0.0255360659211874
2023-07-25 07:22:38,614 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 255.7405548095703, ACC: 0.026303404942154884
2023-07-25 07:22:38,731 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-V500_30-timesteps_vis.h5
2023-07-25 07:23:33,220 - root - INFO - ------------------ Configuration ------------------
2023-07-25 07:23:33,220 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 07:23:33,220 - root - INFO - Configuration name: afno_backbone
2023-07-25 07:23:33,220 - root - INFO - log_to_wandb True
2023-07-25 07:23:33,221 - root - INFO - lr 0.0005
2023-07-25 07:23:33,221 - root - INFO - batch_size 64
2023-07-25 07:23:33,221 - root - INFO - max_epochs 150
2023-07-25 07:23:33,221 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 07:23:33,221 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 07:23:33,221 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 07:23:33,221 - root - INFO - orography False
2023-07-25 07:23:33,221 - root - INFO - orography_path None
2023-07-25 07:23:33,221 - root - INFO - exp_dir FourCastNet/results
2023-07-25 07:23:33,221 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 07:23:33,221 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 07:23:33,221 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 07:23:33,221 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 07:23:33,221 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 07:23:33,221 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 07:23:33,221 - root - INFO - loss l2
2023-07-25 07:23:33,221 - root - INFO - num_data_workers 4
2023-07-25 07:23:33,221 - root - INFO - dt 1
2023-07-25 07:23:33,222 - root - INFO - n_history 0
2023-07-25 07:23:33,222 - root - INFO - prediction_type iterative
2023-07-25 07:23:33,222 - root - INFO - prediction_length 30
2023-07-25 07:23:33,222 - root - INFO - n_initial_conditions 5
2023-07-25 07:23:33,222 - root - INFO - ics_type default
2023-07-25 07:23:33,222 - root - INFO - save_raw_forecasts True
2023-07-25 07:23:33,222 - root - INFO - save_channel False
2023-07-25 07:23:33,222 - root - INFO - masked_acc False
2023-07-25 07:23:33,222 - root - INFO - maskpath None
2023-07-25 07:23:33,222 - root - INFO - perturb False
2023-07-25 07:23:33,222 - root - INFO - add_grid False
2023-07-25 07:23:33,222 - root - INFO - N_grid_channels 0
2023-07-25 07:23:33,222 - root - INFO - gridtype sinusoidal
2023-07-25 07:23:33,222 - root - INFO - roll False
2023-07-25 07:23:33,222 - root - INFO - num_blocks 8
2023-07-25 07:23:33,222 - root - INFO - nettype afno
2023-07-25 07:23:33,222 - root - INFO - patch_size 8
2023-07-25 07:23:33,222 - root - INFO - width 56
2023-07-25 07:23:33,222 - root - INFO - modes 32
2023-07-25 07:23:33,222 - root - INFO - target V10
2023-07-25 07:23:33,222 - root - INFO - normalization zscore
2023-07-25 07:23:33,223 - root - INFO - log_to_screen True
2023-07-25 07:23:33,223 - root - INFO - save_checkpoint True
2023-07-25 07:23:33,223 - root - INFO - enable_nhwc False
2023-07-25 07:23:33,223 - root - INFO - optimizer_type FusedAdam
2023-07-25 07:23:33,223 - root - INFO - crop_size_x None
2023-07-25 07:23:33,223 - root - INFO - crop_size_y None
2023-07-25 07:23:33,223 - root - INFO - two_step_training False
2023-07-25 07:23:33,223 - root - INFO - plot_animations False
2023-07-25 07:23:33,223 - root - INFO - add_noise False
2023-07-25 07:23:33,223 - root - INFO - noise_std 0
2023-07-25 07:23:33,223 - root - INFO - world_size 1
2023-07-25 07:23:33,223 - root - INFO - interp 0
2023-07-25 07:23:33,223 - root - INFO - use_daily_climatology False
2023-07-25 07:23:33,223 - root - INFO - global_batch_size 64
2023-07-25 07:23:33,223 - root - INFO - ablate Z500
2023-07-25 07:23:33,223 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 07:23:33,223 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 07:23:33,223 - root - INFO - resuming False
2023-07-25 07:23:33,223 - root - INFO - local_rank 0
2023-07-25 07:23:33,223 - root - INFO - ---------------------------------------------------
2023-07-25 07:23:33,224 - root - INFO - Inference for 1 initial conditions
2023-07-25 07:23:33,543 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 07:23:33,544 - root - INFO - Number of samples per year: 1460
2023-07-25 07:23:33,544 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 07:23:33,544 - root - INFO - Delta t: 6 hours
2023-07-25 07:23:33,545 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 07:23:33,545 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 07:24:54,660 - root - INFO - Loading inference data
2023-07-25 07:24:54,660 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 07:24:55,069 - root - INFO - Initial condition 1 of 1
2023-07-25 07:24:55,883 - root - INFO - Extracting valid data from the first year
2023-07-25 07:27:51,867 - root - INFO - Standardizing data
2023-07-25 07:27:59,338 - root - INFO - Loading time means
2023-07-25 07:28:16,891 - root - INFO - Begin autoregressive inference
2023-07-25 07:28:27,678 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 07:28:39,200 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 0.5683211088180542, ACC: 0.9908562898635864
2023-07-25 07:28:50,296 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 0.8142570853233337, ACC: 0.9812339544296265
2023-07-25 07:29:01,824 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 0.9453648924827576, ACC: 0.9745395183563232
2023-07-25 07:29:13,349 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 1.1013950109481812, ACC: 0.9650970101356506
2023-07-25 07:29:24,488 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 1.1979278326034546, ACC: 0.9581835269927979
2023-07-25 07:29:35,367 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 1.3505772352218628, ACC: 0.9460200071334839
2023-07-25 07:29:45,961 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 1.5011056661605835, ACC: 0.9333338737487793
2023-07-25 07:29:57,696 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 1.6900908946990967, ACC: 0.916985809803009
2023-07-25 07:30:10,301 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 1.88876211643219, ACC: 0.8979753851890564
2023-07-25 07:30:23,163 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 2.036543369293213, ACC: 0.8864898681640625
2023-07-25 07:30:34,682 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 2.2290966510772705, ACC: 0.8689310550689697
2023-07-25 07:30:46,763 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 2.410310745239258, ACC: 0.8478136658668518
2023-07-25 07:30:59,662 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 2.5614688396453857, ACC: 0.832796037197113
2023-07-25 07:31:13,423 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 2.688586711883545, ACC: 0.8160853981971741
2023-07-25 07:31:25,511 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 2.8653132915496826, ACC: 0.7888363599777222
2023-07-25 07:31:38,997 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 3.0181784629821777, ACC: 0.7593541145324707
2023-07-25 07:31:51,255 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 3.1791133880615234, ACC: 0.728111207485199
2023-07-25 07:32:03,758 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 3.3130342960357666, ACC: 0.6923043727874756
2023-07-25 07:32:16,393 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 3.4518020153045654, ACC: 0.6674560308456421
2023-07-25 07:32:27,504 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 3.5891640186309814, ACC: 0.6335198283195496
2023-07-25 07:32:38,912 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 3.797308921813965, ACC: 0.5925966501235962
2023-07-25 07:32:49,724 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 3.9865715503692627, ACC: 0.5512925982475281
2023-07-25 07:33:01,013 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 4.238210201263428, ACC: 0.49535420536994934
2023-07-25 07:33:13,109 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 4.46074914932251, ACC: 0.4418555796146393
2023-07-25 07:33:24,782 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 4.718147277832031, ACC: 0.392814040184021
2023-07-25 07:33:36,070 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 4.947261810302734, ACC: 0.35152605175971985
2023-07-25 07:33:47,486 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 5.097568511962891, ACC: 0.31616711616516113
2023-07-25 07:33:58,001 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 5.158557415008545, ACC: 0.26612550020217896
2023-07-25 07:34:10,096 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 5.22811222076416, ACC: 0.22663366794586182
2023-07-25 07:34:10,188 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-Z500_30-timesteps_vis.h5
2023-07-25 07:35:03,822 - root - INFO - ------------------ Configuration ------------------
2023-07-25 07:35:03,822 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 07:35:03,822 - root - INFO - Configuration name: afno_backbone
2023-07-25 07:35:03,822 - root - INFO - log_to_wandb True
2023-07-25 07:35:03,822 - root - INFO - lr 0.0005
2023-07-25 07:35:03,822 - root - INFO - batch_size 64
2023-07-25 07:35:03,822 - root - INFO - max_epochs 150
2023-07-25 07:35:03,822 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 07:35:03,822 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 07:35:03,822 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 07:35:03,822 - root - INFO - orography False
2023-07-25 07:35:03,822 - root - INFO - orography_path None
2023-07-25 07:35:03,822 - root - INFO - exp_dir FourCastNet/results
2023-07-25 07:35:03,822 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 07:35:03,822 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 07:35:03,822 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 07:35:03,822 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 07:35:03,822 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 07:35:03,823 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 07:35:03,823 - root - INFO - loss l2
2023-07-25 07:35:03,823 - root - INFO - num_data_workers 4
2023-07-25 07:35:03,823 - root - INFO - dt 1
2023-07-25 07:35:03,823 - root - INFO - n_history 0
2023-07-25 07:35:03,823 - root - INFO - prediction_type iterative
2023-07-25 07:35:03,823 - root - INFO - prediction_length 30
2023-07-25 07:35:03,823 - root - INFO - n_initial_conditions 5
2023-07-25 07:35:03,823 - root - INFO - ics_type default
2023-07-25 07:35:03,823 - root - INFO - save_raw_forecasts True
2023-07-25 07:35:03,823 - root - INFO - save_channel False
2023-07-25 07:35:03,823 - root - INFO - masked_acc False
2023-07-25 07:35:03,823 - root - INFO - maskpath None
2023-07-25 07:35:03,823 - root - INFO - perturb False
2023-07-25 07:35:03,823 - root - INFO - add_grid False
2023-07-25 07:35:03,823 - root - INFO - N_grid_channels 0
2023-07-25 07:35:03,823 - root - INFO - gridtype sinusoidal
2023-07-25 07:35:03,823 - root - INFO - roll False
2023-07-25 07:35:03,823 - root - INFO - num_blocks 8
2023-07-25 07:35:03,823 - root - INFO - nettype afno
2023-07-25 07:35:03,823 - root - INFO - patch_size 8
2023-07-25 07:35:03,823 - root - INFO - width 56
2023-07-25 07:35:03,824 - root - INFO - modes 32
2023-07-25 07:35:03,824 - root - INFO - target V10
2023-07-25 07:35:03,824 - root - INFO - normalization zscore
2023-07-25 07:35:03,824 - root - INFO - log_to_screen True
2023-07-25 07:35:03,824 - root - INFO - save_checkpoint True
2023-07-25 07:35:03,824 - root - INFO - enable_nhwc False
2023-07-25 07:35:03,824 - root - INFO - optimizer_type FusedAdam
2023-07-25 07:35:03,824 - root - INFO - crop_size_x None
2023-07-25 07:35:03,824 - root - INFO - crop_size_y None
2023-07-25 07:35:03,824 - root - INFO - two_step_training False
2023-07-25 07:35:03,824 - root - INFO - plot_animations False
2023-07-25 07:35:03,824 - root - INFO - add_noise False
2023-07-25 07:35:03,824 - root - INFO - noise_std 0
2023-07-25 07:35:03,824 - root - INFO - world_size 1
2023-07-25 07:35:03,824 - root - INFO - interp 0
2023-07-25 07:35:03,824 - root - INFO - use_daily_climatology False
2023-07-25 07:35:03,824 - root - INFO - global_batch_size 64
2023-07-25 07:35:03,824 - root - INFO - ablate RH500
2023-07-25 07:35:03,824 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 07:35:03,825 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 07:35:03,825 - root - INFO - resuming False
2023-07-25 07:35:03,825 - root - INFO - local_rank 0
2023-07-25 07:35:03,825 - root - INFO - ---------------------------------------------------
2023-07-25 07:35:03,825 - root - INFO - Inference for 1 initial conditions
2023-07-25 07:35:04,067 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 07:35:04,068 - root - INFO - Number of samples per year: 1460
2023-07-25 07:35:04,068 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 07:35:04,069 - root - INFO - Delta t: 6 hours
2023-07-25 07:35:04,069 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 07:35:04,069 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 07:36:29,856 - root - INFO - Loading inference data
2023-07-25 07:36:29,857 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 07:36:30,234 - root - INFO - Initial condition 1 of 1
2023-07-25 07:36:31,000 - root - INFO - Extracting valid data from the first year
2023-07-25 07:39:19,316 - root - INFO - Standardizing data
2023-07-25 07:39:27,297 - root - INFO - Loading time means
2023-07-25 07:39:43,431 - root - INFO - Begin autoregressive inference
2023-07-25 07:39:55,203 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 07:40:06,790 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 0.5839934945106506, ACC: 0.9903440475463867
2023-07-25 07:40:18,526 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 0.8212257623672485, ACC: 0.980904221534729
2023-07-25 07:40:30,593 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 0.9380855560302734, ACC: 0.9748021960258484
2023-07-25 07:40:42,833 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 1.0825430154800415, ACC: 0.966090738773346
2023-07-25 07:40:54,641 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 1.1549415588378906, ACC: 0.9605612754821777
2023-07-25 07:41:06,204 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 1.2753751277923584, ACC: 0.9513788819313049
2023-07-25 07:41:18,141 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 1.393776297569275, ACC: 0.9417634606361389
2023-07-25 07:41:28,986 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 1.5690727233886719, ACC: 0.9278701543807983
2023-07-25 07:41:40,478 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 1.7294384241104126, ACC: 0.9138660430908203
2023-07-25 07:41:52,575 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 1.8491188287734985, ACC: 0.9063806533813477
2023-07-25 07:42:04,204 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 2.023512840270996, ACC: 0.8916529417037964
2023-07-25 07:42:16,604 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 2.252357006072998, ACC: 0.8666158318519592
2023-07-25 07:42:28,298 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 2.434770345687866, ACC: 0.8483630418777466
2023-07-25 07:42:40,302 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 2.5853705406188965, ACC: 0.8296750783920288
2023-07-25 07:42:51,955 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 2.7399144172668457, ACC: 0.8064119815826416
2023-07-25 07:43:03,629 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 2.9329674243927, ACC: 0.7723119258880615
2023-07-25 07:43:15,489 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 3.0286483764648438, ACC: 0.7527821660041809
2023-07-25 07:43:26,876 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 3.089508533477783, ACC: 0.7331743240356445
2023-07-25 07:43:39,342 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 3.189037561416626, ACC: 0.7170872092247009
2023-07-25 07:43:50,897 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 3.2991459369659424, ACC: 0.6923139691352844
2023-07-25 07:44:02,899 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 3.406578779220581, ACC: 0.6750364303588867
2023-07-25 07:44:14,558 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 3.551218271255493, ACC: 0.6507923603057861
2023-07-25 07:44:25,910 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 3.7138609886169434, ACC: 0.6230935454368591
2023-07-25 07:44:36,894 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 3.800496816635132, ACC: 0.6064861416816711
2023-07-25 07:44:49,211 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 3.86802339553833, ACC: 0.6011859178543091
2023-07-25 07:45:02,016 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 3.9877712726593018, ACC: 0.5875638723373413
2023-07-25 07:45:14,661 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 4.165215015411377, ACC: 0.5534067153930664
2023-07-25 07:45:27,741 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 4.331478595733643, ACC: 0.5022656917572021
2023-07-25 07:45:39,791 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 4.481287479400635, ACC: 0.46074894070625305
2023-07-25 07:45:39,884 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-RH500_30-timesteps_vis.h5
2023-07-25 07:46:32,949 - root - INFO - ------------------ Configuration ------------------
2023-07-25 07:46:32,949 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 07:46:32,949 - root - INFO - Configuration name: afno_backbone
2023-07-25 07:46:32,949 - root - INFO - log_to_wandb True
2023-07-25 07:46:32,949 - root - INFO - lr 0.0005
2023-07-25 07:46:32,949 - root - INFO - batch_size 64
2023-07-25 07:46:32,949 - root - INFO - max_epochs 150
2023-07-25 07:46:32,949 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 07:46:32,949 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 07:46:32,949 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 07:46:32,949 - root - INFO - orography False
2023-07-25 07:46:32,949 - root - INFO - orography_path None
2023-07-25 07:46:32,949 - root - INFO - exp_dir FourCastNet/results
2023-07-25 07:46:32,949 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 07:46:32,949 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 07:46:32,949 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 07:46:32,949 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 07:46:32,950 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 07:46:32,950 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 07:46:32,950 - root - INFO - loss l2
2023-07-25 07:46:32,950 - root - INFO - num_data_workers 4
2023-07-25 07:46:32,950 - root - INFO - dt 1
2023-07-25 07:46:32,950 - root - INFO - n_history 0
2023-07-25 07:46:32,950 - root - INFO - prediction_type iterative
2023-07-25 07:46:32,950 - root - INFO - prediction_length 30
2023-07-25 07:46:32,950 - root - INFO - n_initial_conditions 5
2023-07-25 07:46:32,950 - root - INFO - ics_type default
2023-07-25 07:46:32,950 - root - INFO - save_raw_forecasts True
2023-07-25 07:46:32,950 - root - INFO - save_channel False
2023-07-25 07:46:32,950 - root - INFO - masked_acc False
2023-07-25 07:46:32,950 - root - INFO - maskpath None
2023-07-25 07:46:32,950 - root - INFO - perturb False
2023-07-25 07:46:32,950 - root - INFO - add_grid False
2023-07-25 07:46:32,950 - root - INFO - N_grid_channels 0
2023-07-25 07:46:32,950 - root - INFO - gridtype sinusoidal
2023-07-25 07:46:32,950 - root - INFO - roll False
2023-07-25 07:46:32,950 - root - INFO - num_blocks 8
2023-07-25 07:46:32,950 - root - INFO - nettype afno
2023-07-25 07:46:32,950 - root - INFO - patch_size 8
2023-07-25 07:46:32,950 - root - INFO - width 56
2023-07-25 07:46:32,950 - root - INFO - modes 32
2023-07-25 07:46:32,950 - root - INFO - target V10
2023-07-25 07:46:32,950 - root - INFO - normalization zscore
2023-07-25 07:46:32,950 - root - INFO - log_to_screen True
2023-07-25 07:46:32,950 - root - INFO - save_checkpoint True
2023-07-25 07:46:32,950 - root - INFO - enable_nhwc False
2023-07-25 07:46:32,950 - root - INFO - optimizer_type FusedAdam
2023-07-25 07:46:32,950 - root - INFO - crop_size_x None
2023-07-25 07:46:32,951 - root - INFO - crop_size_y None
2023-07-25 07:46:32,951 - root - INFO - two_step_training False
2023-07-25 07:46:32,951 - root - INFO - plot_animations False
2023-07-25 07:46:32,951 - root - INFO - add_noise False
2023-07-25 07:46:32,951 - root - INFO - noise_std 0
2023-07-25 07:46:32,951 - root - INFO - world_size 1
2023-07-25 07:46:32,951 - root - INFO - interp 0
2023-07-25 07:46:32,951 - root - INFO - use_daily_climatology False
2023-07-25 07:46:32,951 - root - INFO - global_batch_size 64
2023-07-25 07:46:32,951 - root - INFO - ablate Z50
2023-07-25 07:46:32,951 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 07:46:32,951 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 07:46:32,951 - root - INFO - resuming False
2023-07-25 07:46:32,951 - root - INFO - local_rank 0
2023-07-25 07:46:32,951 - root - INFO - ---------------------------------------------------
2023-07-25 07:46:32,951 - root - INFO - Inference for 1 initial conditions
2023-07-25 07:46:33,216 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 07:46:33,222 - root - INFO - Number of samples per year: 1460
2023-07-25 07:46:33,222 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 07:46:33,222 - root - INFO - Delta t: 6 hours
2023-07-25 07:46:33,223 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 07:46:33,224 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 07:47:47,698 - root - INFO - Loading inference data
2023-07-25 07:47:47,698 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 07:47:47,939 - root - INFO - Initial condition 1 of 1
2023-07-25 07:47:48,754 - root - INFO - Extracting valid data from the first year
2023-07-25 07:50:24,240 - root - INFO - Standardizing data
2023-07-25 07:50:31,891 - root - INFO - Loading time means
2023-07-25 07:50:45,355 - root - INFO - Begin autoregressive inference
2023-07-25 07:50:56,100 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 07:51:09,186 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 0.6722252368927002, ACC: 0.9871830344200134
2023-07-25 07:51:20,104 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 0.9008565545082092, ACC: 0.9769768118858337
2023-07-25 07:51:30,580 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 1.0050005912780762, ACC: 0.9710468649864197
2023-07-25 07:51:41,613 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 1.1145271062850952, ACC: 0.9641257524490356
2023-07-25 07:51:53,654 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 1.2041797637939453, ACC: 0.9573053121566772
2023-07-25 07:52:05,521 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 1.3099387884140015, ACC: 0.9490631222724915
2023-07-25 07:52:16,780 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 1.418797492980957, ACC: 0.9397822618484497
2023-07-25 07:52:27,605 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 1.5610995292663574, ACC: 0.9286577701568604
2023-07-25 07:52:38,477 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 1.6700901985168457, ACC: 0.9193168878555298
2023-07-25 07:52:49,015 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 1.7787301540374756, ACC: 0.9130398035049438
2023-07-25 07:52:59,275 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 1.9177758693695068, ACC: 0.9018821120262146
2023-07-25 07:53:10,115 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 2.0885438919067383, ACC: 0.8843252062797546
2023-07-25 07:53:21,055 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 2.254812002182007, ACC: 0.8684890270233154
2023-07-25 07:53:31,497 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 2.388984441757202, ACC: 0.8533051609992981
2023-07-25 07:53:42,587 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 2.5251402854919434, ACC: 0.8334472179412842
2023-07-25 07:53:53,745 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 2.641036033630371, ACC: 0.8139560222625732
2023-07-25 07:54:04,785 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 2.729979991912842, ACC: 0.7973407506942749
2023-07-25 07:54:15,965 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 2.827841281890869, ACC: 0.7747048139572144
2023-07-25 07:54:26,488 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 2.941749334335327, ACC: 0.7573844194412231
2023-07-25 07:54:36,906 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 3.0826714038848877, ACC: 0.7293663024902344
2023-07-25 07:54:47,277 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 3.2386012077331543, ACC: 0.7029051184654236
2023-07-25 07:54:57,585 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 3.425133228302002, ACC: 0.6684809327125549
2023-07-25 07:55:09,360 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 3.6366989612579346, ACC: 0.6265794634819031
2023-07-25 07:55:20,669 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 3.7720673084259033, ACC: 0.5989931225776672
2023-07-25 07:55:32,228 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 3.8641419410705566, ACC: 0.5878623723983765
2023-07-25 07:55:42,400 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 4.006627559661865, ACC: 0.5686694979667664
2023-07-25 07:55:52,739 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 4.197085380554199, ACC: 0.5279861688613892
2023-07-25 07:56:03,330 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 4.310614109039307, ACC: 0.48931246995925903
2023-07-25 07:56:14,631 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 4.369353771209717, ACC: 0.4749574661254883
2023-07-25 07:56:14,716 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-Z50_30-timesteps_vis.h5
2023-07-25 07:57:09,454 - root - INFO - ------------------ Configuration ------------------
2023-07-25 07:57:09,454 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 07:57:09,455 - root - INFO - Configuration name: afno_backbone
2023-07-25 07:57:09,455 - root - INFO - log_to_wandb True
2023-07-25 07:57:09,455 - root - INFO - lr 0.0005
2023-07-25 07:57:09,455 - root - INFO - batch_size 64
2023-07-25 07:57:09,455 - root - INFO - max_epochs 150
2023-07-25 07:57:09,455 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 07:57:09,455 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 07:57:09,455 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 07:57:09,455 - root - INFO - orography False
2023-07-25 07:57:09,455 - root - INFO - orography_path None
2023-07-25 07:57:09,455 - root - INFO - exp_dir FourCastNet/results
2023-07-25 07:57:09,455 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 07:57:09,455 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 07:57:09,455 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 07:57:09,455 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 07:57:09,455 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 07:57:09,456 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 07:57:09,456 - root - INFO - loss l2
2023-07-25 07:57:09,456 - root - INFO - num_data_workers 4
2023-07-25 07:57:09,456 - root - INFO - dt 1
2023-07-25 07:57:09,456 - root - INFO - n_history 0
2023-07-25 07:57:09,456 - root - INFO - prediction_type iterative
2023-07-25 07:57:09,456 - root - INFO - prediction_length 30
2023-07-25 07:57:09,456 - root - INFO - n_initial_conditions 5
2023-07-25 07:57:09,456 - root - INFO - ics_type default
2023-07-25 07:57:09,456 - root - INFO - save_raw_forecasts True
2023-07-25 07:57:09,456 - root - INFO - save_channel False
2023-07-25 07:57:09,456 - root - INFO - masked_acc False
2023-07-25 07:57:09,456 - root - INFO - maskpath None
2023-07-25 07:57:09,456 - root - INFO - perturb False
2023-07-25 07:57:09,456 - root - INFO - add_grid False
2023-07-25 07:57:09,456 - root - INFO - N_grid_channels 0
2023-07-25 07:57:09,456 - root - INFO - gridtype sinusoidal
2023-07-25 07:57:09,456 - root - INFO - roll False
2023-07-25 07:57:09,457 - root - INFO - num_blocks 8
2023-07-25 07:57:09,457 - root - INFO - nettype afno
2023-07-25 07:57:09,457 - root - INFO - patch_size 8
2023-07-25 07:57:09,457 - root - INFO - width 56
2023-07-25 07:57:09,457 - root - INFO - modes 32
2023-07-25 07:57:09,457 - root - INFO - target V10
2023-07-25 07:57:09,457 - root - INFO - normalization zscore
2023-07-25 07:57:09,457 - root - INFO - log_to_screen True
2023-07-25 07:57:09,457 - root - INFO - save_checkpoint True
2023-07-25 07:57:09,457 - root - INFO - enable_nhwc False
2023-07-25 07:57:09,457 - root - INFO - optimizer_type FusedAdam
2023-07-25 07:57:09,457 - root - INFO - crop_size_x None
2023-07-25 07:57:09,457 - root - INFO - crop_size_y None
2023-07-25 07:57:09,457 - root - INFO - two_step_training False
2023-07-25 07:57:09,457 - root - INFO - plot_animations False
2023-07-25 07:57:09,457 - root - INFO - add_noise False
2023-07-25 07:57:09,457 - root - INFO - noise_std 0
2023-07-25 07:57:09,457 - root - INFO - world_size 1
2023-07-25 07:57:09,457 - root - INFO - interp 0
2023-07-25 07:57:09,457 - root - INFO - use_daily_climatology False
2023-07-25 07:57:09,457 - root - INFO - global_batch_size 64
2023-07-25 07:57:09,457 - root - INFO - ablate TCWV
2023-07-25 07:57:09,457 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 07:57:09,457 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 07:57:09,457 - root - INFO - resuming False
2023-07-25 07:57:09,457 - root - INFO - local_rank 0
2023-07-25 07:57:09,457 - root - INFO - ---------------------------------------------------
2023-07-25 07:57:09,458 - root - INFO - Inference for 1 initial conditions
2023-07-25 07:57:09,796 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 07:57:09,797 - root - INFO - Number of samples per year: 1460
2023-07-25 07:57:09,797 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 07:57:09,797 - root - INFO - Delta t: 6 hours
2023-07-25 07:57:09,797 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 07:57:09,805 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 07:58:19,322 - root - INFO - Loading inference data
2023-07-25 07:58:19,323 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 07:58:19,554 - root - INFO - Initial condition 1 of 1
2023-07-25 07:58:20,470 - root - INFO - Extracting valid data from the first year
2023-07-25 08:00:47,713 - root - INFO - Standardizing data
2023-07-25 08:00:55,881 - root - INFO - Loading time means
2023-07-25 08:01:12,635 - root - INFO - Begin autoregressive inference
2023-07-25 08:01:24,414 - root - INFO - Predicted timestep 0 of 30. V10 RMS Error: 0.0, ACC: 1.0
2023-07-25 08:01:38,052 - root - INFO - Predicted timestep 1 of 30. V10 RMS Error: 1.9586238861083984, ACC: 0.8872028589248657
2023-07-25 08:01:51,670 - root - INFO - Predicted timestep 2 of 30. V10 RMS Error: 2.9799482822418213, ACC: 0.7519491314888
2023-07-25 08:02:04,985 - root - INFO - Predicted timestep 3 of 30. V10 RMS Error: 11.617069244384766, ACC: 0.2815662920475006
2023-07-25 08:02:19,058 - root - INFO - Predicted timestep 4 of 30. V10 RMS Error: 17.79848861694336, ACC: 0.18572479486465454
2023-07-25 08:02:31,592 - root - INFO - Predicted timestep 5 of 30. V10 RMS Error: 19.734901428222656, ACC: 0.1572772115468979
2023-07-25 08:02:43,962 - root - INFO - Predicted timestep 6 of 30. V10 RMS Error: 20.37906837463379, ACC: 0.1388605237007141
2023-07-25 08:02:56,640 - root - INFO - Predicted timestep 7 of 30. V10 RMS Error: 21.526872634887695, ACC: 0.11806327849626541
2023-07-25 08:03:08,943 - root - INFO - Predicted timestep 8 of 30. V10 RMS Error: 23.029956817626953, ACC: 0.09948313981294632
2023-07-25 08:03:22,622 - root - INFO - Predicted timestep 9 of 30. V10 RMS Error: 24.91309356689453, ACC: 0.08738374710083008
2023-07-25 08:03:35,769 - root - INFO - Predicted timestep 10 of 30. V10 RMS Error: 27.12549591064453, ACC: 0.07402904331684113
2023-07-25 08:03:48,643 - root - INFO - Predicted timestep 11 of 30. V10 RMS Error: 29.183006286621094, ACC: 0.06418154388666153
2023-07-25 08:04:01,333 - root - INFO - Predicted timestep 12 of 30. V10 RMS Error: 31.1170597076416, ACC: 0.05375879630446434
2023-07-25 08:04:14,154 - root - INFO - Predicted timestep 13 of 30. V10 RMS Error: 33.084774017333984, ACC: 0.052601851522922516
2023-07-25 08:04:28,583 - root - INFO - Predicted timestep 14 of 30. V10 RMS Error: 35.383243560791016, ACC: 0.04683610424399376
2023-07-25 08:04:41,043 - root - INFO - Predicted timestep 15 of 30. V10 RMS Error: 37.79522705078125, ACC: 0.0332186333835125
2023-07-25 08:04:53,693 - root - INFO - Predicted timestep 16 of 30. V10 RMS Error: 40.170387268066406, ACC: 0.027545597404241562
2023-07-25 08:05:08,643 - root - INFO - Predicted timestep 17 of 30. V10 RMS Error: 42.90127944946289, ACC: 0.01970900036394596
2023-07-25 08:05:21,970 - root - INFO - Predicted timestep 18 of 30. V10 RMS Error: 45.8048095703125, ACC: 0.016124863177537918
2023-07-25 08:05:34,497 - root - INFO - Predicted timestep 19 of 30. V10 RMS Error: 49.03876876831055, ACC: 0.00910928938537836
2023-07-25 08:05:46,598 - root - INFO - Predicted timestep 20 of 30. V10 RMS Error: 52.813541412353516, ACC: 0.0017537102103233337
2023-07-25 08:06:00,543 - root - INFO - Predicted timestep 21 of 30. V10 RMS Error: 58.13059616088867, ACC: 0.0030453642830252647
2023-07-25 08:06:14,997 - root - INFO - Predicted timestep 22 of 30. V10 RMS Error: 66.66056823730469, ACC: 0.0025705865118652582
2023-07-25 08:06:29,795 - root - INFO - Predicted timestep 23 of 30. V10 RMS Error: 84.124267578125, ACC: 0.03370584547519684
2023-07-25 08:06:44,183 - root - INFO - Predicted timestep 24 of 30. V10 RMS Error: 123.70986938476562, ACC: 0.055611398071050644
2023-07-25 08:06:57,630 - root - INFO - Predicted timestep 25 of 30. V10 RMS Error: 170.50877380371094, ACC: 0.07266709953546524
2023-07-25 08:07:11,424 - root - INFO - Predicted timestep 26 of 30. V10 RMS Error: 201.5699462890625, ACC: 0.07753949612379074
2023-07-25 08:07:23,539 - root - INFO - Predicted timestep 27 of 30. V10 RMS Error: 217.69374084472656, ACC: 0.0801353007555008
2023-07-25 08:07:35,169 - root - INFO - Predicted timestep 28 of 30. V10 RMS Error: 226.8118438720703, ACC: 0.05894136056303978
2023-07-25 08:07:46,360 - root - INFO - Predicted timestep 29 of 30. V10 RMS Error: 234.48611450195312, ACC: 0.050386082381010056
2023-07-25 08:07:46,462 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-V10_ablate-TCWV_30-timesteps_vis.h5
2023-07-25 08:08:40,171 - root - INFO - ------------------ Configuration ------------------
2023-07-25 08:08:40,171 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 08:08:40,171 - root - INFO - Configuration name: afno_backbone
2023-07-25 08:08:40,171 - root - INFO - log_to_wandb True
2023-07-25 08:08:40,171 - root - INFO - lr 0.0005
2023-07-25 08:08:40,171 - root - INFO - batch_size 64
2023-07-25 08:08:40,171 - root - INFO - max_epochs 150
2023-07-25 08:08:40,172 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 08:08:40,172 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 08:08:40,172 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 08:08:40,172 - root - INFO - orography False
2023-07-25 08:08:40,172 - root - INFO - orography_path None
2023-07-25 08:08:40,172 - root - INFO - exp_dir FourCastNet/results
2023-07-25 08:08:40,172 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 08:08:40,172 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 08:08:40,172 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 08:08:40,172 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 08:08:40,172 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 08:08:40,172 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 08:08:40,172 - root - INFO - loss l2
2023-07-25 08:08:40,172 - root - INFO - num_data_workers 4
2023-07-25 08:08:40,172 - root - INFO - dt 1
2023-07-25 08:08:40,172 - root - INFO - n_history 0
2023-07-25 08:08:40,172 - root - INFO - prediction_type iterative
2023-07-25 08:08:40,172 - root - INFO - prediction_length 30
2023-07-25 08:08:40,172 - root - INFO - n_initial_conditions 5
2023-07-25 08:08:40,172 - root - INFO - ics_type default
2023-07-25 08:08:40,172 - root - INFO - save_raw_forecasts True
2023-07-25 08:08:40,172 - root - INFO - save_channel False
2023-07-25 08:08:40,172 - root - INFO - masked_acc False
2023-07-25 08:08:40,172 - root - INFO - maskpath None
2023-07-25 08:08:40,172 - root - INFO - perturb False
2023-07-25 08:08:40,172 - root - INFO - add_grid False
2023-07-25 08:08:40,173 - root - INFO - N_grid_channels 0
2023-07-25 08:08:40,173 - root - INFO - gridtype sinusoidal
2023-07-25 08:08:40,173 - root - INFO - roll False
2023-07-25 08:08:40,173 - root - INFO - num_blocks 8
2023-07-25 08:08:40,173 - root - INFO - nettype afno
2023-07-25 08:08:40,173 - root - INFO - patch_size 8
2023-07-25 08:08:40,173 - root - INFO - width 56
2023-07-25 08:08:40,173 - root - INFO - modes 32
2023-07-25 08:08:40,173 - root - INFO - target T2m
2023-07-25 08:08:40,173 - root - INFO - normalization zscore
2023-07-25 08:08:40,173 - root - INFO - log_to_screen True
2023-07-25 08:08:40,173 - root - INFO - save_checkpoint True
2023-07-25 08:08:40,173 - root - INFO - enable_nhwc False
2023-07-25 08:08:40,173 - root - INFO - optimizer_type FusedAdam
2023-07-25 08:08:40,173 - root - INFO - crop_size_x None
2023-07-25 08:08:40,173 - root - INFO - crop_size_y None
2023-07-25 08:08:40,173 - root - INFO - two_step_training False
2023-07-25 08:08:40,173 - root - INFO - plot_animations False
2023-07-25 08:08:40,173 - root - INFO - add_noise False
2023-07-25 08:08:40,174 - root - INFO - noise_std 0
2023-07-25 08:08:40,174 - root - INFO - world_size 1
2023-07-25 08:08:40,174 - root - INFO - interp 0
2023-07-25 08:08:40,174 - root - INFO - use_daily_climatology False
2023-07-25 08:08:40,174 - root - INFO - global_batch_size 64
2023-07-25 08:08:40,174 - root - INFO - ablate U10
2023-07-25 08:08:40,174 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 08:08:40,174 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 08:08:40,174 - root - INFO - resuming False
2023-07-25 08:08:40,174 - root - INFO - local_rank 0
2023-07-25 08:08:40,174 - root - INFO - ---------------------------------------------------
2023-07-25 08:08:40,174 - root - INFO - Inference for 1 initial conditions
2023-07-25 08:08:40,528 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 08:08:40,529 - root - INFO - Number of samples per year: 1460
2023-07-25 08:08:40,529 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 08:08:40,529 - root - INFO - Delta t: 6 hours
2023-07-25 08:08:40,529 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 08:08:40,532 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 08:10:06,850 - root - INFO - Loading inference data
2023-07-25 08:10:06,851 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 08:10:07,208 - root - INFO - Initial condition 1 of 1
2023-07-25 08:10:08,143 - root - INFO - Extracting valid data from the first year
2023-07-25 08:13:19,974 - root - INFO - Standardizing data
2023-07-25 08:13:28,279 - root - INFO - Loading time means
2023-07-25 08:13:47,081 - root - INFO - Begin autoregressive inference
2023-07-25 08:13:59,904 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 08:14:12,011 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 1.8580023050308228, ACC: 0.9812412261962891
2023-07-25 08:14:24,854 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 6.982386112213135, ACC: 0.7978302240371704
2023-07-25 08:14:37,706 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 48.98941421508789, ACC: 0.18228958547115326
2023-07-25 08:14:50,674 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 97.64820098876953, ACC: 0.09310656785964966
2023-07-25 08:15:03,902 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 139.96029663085938, ACC: 0.06239556521177292
2023-07-25 08:15:16,665 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 175.05389404296875, ACC: 0.04637699946761131
2023-07-25 08:15:28,157 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 204.42430114746094, ACC: 0.03442644327878952
2023-07-25 08:15:40,315 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 230.7014617919922, ACC: 0.02933649905025959
2023-07-25 08:15:52,270 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 253.2578125, ACC: 0.02466052584350109
2023-07-25 08:16:04,365 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 274.2851867675781, ACC: 0.02368558570742607
2023-07-25 08:16:15,689 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 295.41412353515625, ACC: 0.020392391830682755
2023-07-25 08:16:27,023 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 317.3968811035156, ACC: 0.015167675912380219
2023-07-25 08:16:38,587 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 340.47406005859375, ACC: 0.00481499545276165
2023-07-25 08:16:49,829 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 364.3834533691406, ACC: -0.003413228550925851
2023-07-25 08:17:01,593 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 388.8197937011719, ACC: -0.013113630004227161
2023-07-25 08:17:13,431 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 412.67877197265625, ACC: -0.019345149397850037
2023-07-25 08:17:25,038 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 436.3458557128906, ACC: -0.030535506084561348
2023-07-25 08:17:35,743 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 461.9360046386719, ACC: -0.03431011736392975
2023-07-25 08:17:46,783 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 489.66705322265625, ACC: -0.04004468023777008
2023-07-25 08:17:58,866 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 518.3644409179688, ACC: -0.04142950102686882
2023-07-25 08:18:11,158 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 547.7430419921875, ACC: -0.046569082885980606
2023-07-25 08:18:23,082 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 577.7974853515625, ACC: -0.04267668351531029
2023-07-25 08:18:35,238 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 609.1415405273438, ACC: -0.04669932648539543
2023-07-25 08:18:46,976 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 641.8695678710938, ACC: -0.049253303557634354
2023-07-25 08:18:59,605 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 675.048583984375, ACC: -0.05989248678088188
2023-07-25 08:19:10,781 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 709.8519897460938, ACC: -0.05648006871342659
2023-07-25 08:19:21,860 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 747.5429077148438, ACC: -0.07423814386129379
2023-07-25 08:19:33,772 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 787.3267822265625, ACC: -0.08903194963932037
2023-07-25 08:19:45,686 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 828.5164184570312, ACC: -0.11247505247592926
2023-07-25 08:19:45,774 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-U10_30-timesteps_vis.h5
2023-07-25 08:20:39,180 - root - INFO - ------------------ Configuration ------------------
2023-07-25 08:20:39,181 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 08:20:39,181 - root - INFO - Configuration name: afno_backbone
2023-07-25 08:20:39,181 - root - INFO - log_to_wandb True
2023-07-25 08:20:39,181 - root - INFO - lr 0.0005
2023-07-25 08:20:39,181 - root - INFO - batch_size 64
2023-07-25 08:20:39,181 - root - INFO - max_epochs 150
2023-07-25 08:20:39,181 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 08:20:39,181 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 08:20:39,181 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 08:20:39,181 - root - INFO - orography False
2023-07-25 08:20:39,181 - root - INFO - orography_path None
2023-07-25 08:20:39,181 - root - INFO - exp_dir FourCastNet/results
2023-07-25 08:20:39,181 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 08:20:39,181 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 08:20:39,181 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 08:20:39,181 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 08:20:39,182 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 08:20:39,182 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 08:20:39,182 - root - INFO - loss l2
2023-07-25 08:20:39,182 - root - INFO - num_data_workers 4
2023-07-25 08:20:39,182 - root - INFO - dt 1
2023-07-25 08:20:39,182 - root - INFO - n_history 0
2023-07-25 08:20:39,182 - root - INFO - prediction_type iterative
2023-07-25 08:20:39,182 - root - INFO - prediction_length 30
2023-07-25 08:20:39,182 - root - INFO - n_initial_conditions 5
2023-07-25 08:20:39,182 - root - INFO - ics_type default
2023-07-25 08:20:39,182 - root - INFO - save_raw_forecasts True
2023-07-25 08:20:39,182 - root - INFO - save_channel False
2023-07-25 08:20:39,182 - root - INFO - masked_acc False
2023-07-25 08:20:39,182 - root - INFO - maskpath None
2023-07-25 08:20:39,182 - root - INFO - perturb False
2023-07-25 08:20:39,182 - root - INFO - add_grid False
2023-07-25 08:20:39,182 - root - INFO - N_grid_channels 0
2023-07-25 08:20:39,182 - root - INFO - gridtype sinusoidal
2023-07-25 08:20:39,182 - root - INFO - roll False
2023-07-25 08:20:39,182 - root - INFO - num_blocks 8
2023-07-25 08:20:39,182 - root - INFO - nettype afno
2023-07-25 08:20:39,182 - root - INFO - patch_size 8
2023-07-25 08:20:39,182 - root - INFO - width 56
2023-07-25 08:20:39,183 - root - INFO - modes 32
2023-07-25 08:20:39,183 - root - INFO - target T2m
2023-07-25 08:20:39,183 - root - INFO - normalization zscore
2023-07-25 08:20:39,183 - root - INFO - log_to_screen True
2023-07-25 08:20:39,183 - root - INFO - save_checkpoint True
2023-07-25 08:20:39,183 - root - INFO - enable_nhwc False
2023-07-25 08:20:39,183 - root - INFO - optimizer_type FusedAdam
2023-07-25 08:20:39,183 - root - INFO - crop_size_x None
2023-07-25 08:20:39,183 - root - INFO - crop_size_y None
2023-07-25 08:20:39,183 - root - INFO - two_step_training False
2023-07-25 08:20:39,183 - root - INFO - plot_animations False
2023-07-25 08:20:39,183 - root - INFO - add_noise False
2023-07-25 08:20:39,183 - root - INFO - noise_std 0
2023-07-25 08:20:39,183 - root - INFO - world_size 1
2023-07-25 08:20:39,183 - root - INFO - interp 0
2023-07-25 08:20:39,183 - root - INFO - use_daily_climatology False
2023-07-25 08:20:39,183 - root - INFO - global_batch_size 64
2023-07-25 08:20:39,183 - root - INFO - ablate V10
2023-07-25 08:20:39,183 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 08:20:39,183 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 08:20:39,183 - root - INFO - resuming False
2023-07-25 08:20:39,184 - root - INFO - local_rank 0
2023-07-25 08:20:39,184 - root - INFO - ---------------------------------------------------
2023-07-25 08:20:39,184 - root - INFO - Inference for 1 initial conditions
2023-07-25 08:20:39,566 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 08:20:39,567 - root - INFO - Number of samples per year: 1460
2023-07-25 08:20:39,567 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 08:20:39,567 - root - INFO - Delta t: 6 hours
2023-07-25 08:20:39,567 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 08:20:39,567 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 08:22:12,269 - root - INFO - Loading inference data
2023-07-25 08:22:12,270 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 08:22:12,644 - root - INFO - Initial condition 1 of 1
2023-07-25 08:22:13,618 - root - INFO - Extracting valid data from the first year
2023-07-25 08:25:16,449 - root - INFO - Standardizing data
2023-07-25 08:25:24,965 - root - INFO - Loading time means
2023-07-25 08:25:45,368 - root - INFO - Begin autoregressive inference
2023-07-25 08:25:57,379 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 08:26:08,968 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 1.021877408027649, ACC: 0.9943052530288696
2023-07-25 08:26:21,228 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 1.1974375247955322, ACC: 0.9919472336769104
2023-07-25 08:26:32,722 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 1.2665702104568481, ACC: 0.9908514022827148
2023-07-25 08:26:43,738 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 1.299109935760498, ACC: 0.9910045266151428
2023-07-25 08:26:56,297 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 1.3241608142852783, ACC: 0.9901853799819946
2023-07-25 08:27:07,190 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 1.3342006206512451, ACC: 0.9894802570343018
2023-07-25 08:27:18,838 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 1.3538216352462769, ACC: 0.9890914559364319
2023-07-25 08:27:30,103 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 1.371735692024231, ACC: 0.9897785186767578
2023-07-25 08:27:41,282 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 1.3901399374008179, ACC: 0.9890850782394409
2023-07-25 08:27:52,596 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 1.4504132270812988, ACC: 0.9876445531845093
2023-07-25 08:28:04,032 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 1.4796595573425293, ACC: 0.9874141812324524
2023-07-25 08:28:15,519 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 1.5291836261749268, ACC: 0.9878524541854858
2023-07-25 08:28:26,439 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 1.56389319896698, ACC: 0.98678058385849
2023-07-25 08:28:37,349 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 1.6232868432998657, ACC: 0.9851939678192139
2023-07-25 08:28:48,710 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 1.649926781654358, ACC: 0.9849323034286499
2023-07-25 08:29:00,292 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 1.7403315305709839, ACC: 0.9846395254135132
2023-07-25 08:29:11,455 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 1.7521610260009766, ACC: 0.9837547540664673
2023-07-25 08:29:22,081 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 1.8060427904129028, ACC: 0.9815477132797241
2023-07-25 08:29:33,083 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 1.9015392065048218, ACC: 0.9797280430793762
2023-07-25 08:29:43,854 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 2.0045366287231445, ACC: 0.9794650077819824
2023-07-25 08:29:55,449 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 2.0603950023651123, ACC: 0.9771531820297241
2023-07-25 08:30:08,560 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 2.161069869995117, ACC: 0.9732539653778076
2023-07-25 08:30:20,234 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 2.227576494216919, ACC: 0.9720284938812256
2023-07-25 08:30:31,463 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 2.323439121246338, ACC: 0.9722614884376526
2023-07-25 08:30:43,735 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 2.3784587383270264, ACC: 0.9690321087837219
2023-07-25 08:30:55,470 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 2.4474542140960693, ACC: 0.965474009513855
2023-07-25 08:31:06,978 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 2.4886929988861084, ACC: 0.9656982421875
2023-07-25 08:31:17,889 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 2.6142020225524902, ACC: 0.9649512767791748
2023-07-25 08:31:29,083 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 2.625997543334961, ACC: 0.9620757699012756
2023-07-25 08:31:29,193 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-V10_30-timesteps_vis.h5
2023-07-25 08:32:22,651 - root - INFO - ------------------ Configuration ------------------
2023-07-25 08:32:22,651 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 08:32:22,651 - root - INFO - Configuration name: afno_backbone
2023-07-25 08:32:22,651 - root - INFO - log_to_wandb True
2023-07-25 08:32:22,651 - root - INFO - lr 0.0005
2023-07-25 08:32:22,651 - root - INFO - batch_size 64
2023-07-25 08:32:22,652 - root - INFO - max_epochs 150
2023-07-25 08:32:22,652 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 08:32:22,652 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 08:32:22,652 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 08:32:22,652 - root - INFO - orography False
2023-07-25 08:32:22,652 - root - INFO - orography_path None
2023-07-25 08:32:22,652 - root - INFO - exp_dir FourCastNet/results
2023-07-25 08:32:22,652 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 08:32:22,652 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 08:32:22,652 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 08:32:22,652 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 08:32:22,652 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 08:32:22,652 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 08:32:22,652 - root - INFO - loss l2
2023-07-25 08:32:22,652 - root - INFO - num_data_workers 4
2023-07-25 08:32:22,652 - root - INFO - dt 1
2023-07-25 08:32:22,653 - root - INFO - n_history 0
2023-07-25 08:32:22,653 - root - INFO - prediction_type iterative
2023-07-25 08:32:22,653 - root - INFO - prediction_length 30
2023-07-25 08:32:22,653 - root - INFO - n_initial_conditions 5
2023-07-25 08:32:22,653 - root - INFO - ics_type default
2023-07-25 08:32:22,653 - root - INFO - save_raw_forecasts True
2023-07-25 08:32:22,653 - root - INFO - save_channel False
2023-07-25 08:32:22,653 - root - INFO - masked_acc False
2023-07-25 08:32:22,653 - root - INFO - maskpath None
2023-07-25 08:32:22,653 - root - INFO - perturb False
2023-07-25 08:32:22,653 - root - INFO - add_grid False
2023-07-25 08:32:22,653 - root - INFO - N_grid_channels 0
2023-07-25 08:32:22,653 - root - INFO - gridtype sinusoidal
2023-07-25 08:32:22,653 - root - INFO - roll False
2023-07-25 08:32:22,653 - root - INFO - num_blocks 8
2023-07-25 08:32:22,653 - root - INFO - nettype afno
2023-07-25 08:32:22,654 - root - INFO - patch_size 8
2023-07-25 08:32:22,654 - root - INFO - width 56
2023-07-25 08:32:22,654 - root - INFO - modes 32
2023-07-25 08:32:22,654 - root - INFO - target T2m
2023-07-25 08:32:22,654 - root - INFO - normalization zscore
2023-07-25 08:32:22,654 - root - INFO - log_to_screen True
2023-07-25 08:32:22,654 - root - INFO - save_checkpoint True
2023-07-25 08:32:22,654 - root - INFO - enable_nhwc False
2023-07-25 08:32:22,654 - root - INFO - optimizer_type FusedAdam
2023-07-25 08:32:22,654 - root - INFO - crop_size_x None
2023-07-25 08:32:22,654 - root - INFO - crop_size_y None
2023-07-25 08:32:22,654 - root - INFO - two_step_training False
2023-07-25 08:32:22,654 - root - INFO - plot_animations False
2023-07-25 08:32:22,654 - root - INFO - add_noise False
2023-07-25 08:32:22,654 - root - INFO - noise_std 0
2023-07-25 08:32:22,654 - root - INFO - world_size 1
2023-07-25 08:32:22,654 - root - INFO - interp 0
2023-07-25 08:32:22,654 - root - INFO - use_daily_climatology False
2023-07-25 08:32:22,654 - root - INFO - global_batch_size 64
2023-07-25 08:32:22,655 - root - INFO - ablate sp
2023-07-25 08:32:22,655 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 08:32:22,655 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 08:32:22,655 - root - INFO - resuming False
2023-07-25 08:32:22,655 - root - INFO - local_rank 0
2023-07-25 08:32:22,655 - root - INFO - ---------------------------------------------------
2023-07-25 08:32:22,655 - root - INFO - Inference for 1 initial conditions
2023-07-25 08:32:23,115 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 08:32:23,116 - root - INFO - Number of samples per year: 1460
2023-07-25 08:32:23,116 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 08:32:23,116 - root - INFO - Delta t: 6 hours
2023-07-25 08:32:23,116 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 08:32:23,116 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 08:34:05,175 - root - INFO - Loading inference data
2023-07-25 08:34:05,176 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 08:34:05,584 - root - INFO - Initial condition 1 of 1
2023-07-25 08:34:06,445 - root - INFO - Extracting valid data from the first year
2023-07-25 08:37:30,743 - root - INFO - Standardizing data
2023-07-25 08:37:38,375 - root - INFO - Loading time means
2023-07-25 08:37:58,927 - root - INFO - Begin autoregressive inference
2023-07-25 08:38:09,954 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 08:38:20,813 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 1.792136549949646, ACC: 0.9832849502563477
2023-07-25 08:38:32,287 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 2.875810146331787, ACC: 0.9563736915588379
2023-07-25 08:38:43,475 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 14.619596481323242, ACC: 0.5235971212387085
2023-07-25 08:38:55,726 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 29.28021240234375, ACC: 0.2847890555858612
2023-07-25 08:39:06,735 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 42.817386627197266, ACC: 0.19846780598163605
2023-07-25 08:39:17,393 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 53.932701110839844, ACC: 0.14645959436893463
2023-07-25 08:39:27,980 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 62.336849212646484, ACC: 0.11206535249948502
2023-07-25 08:39:38,795 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 68.5096206665039, ACC: 0.10181305557489395
2023-07-25 08:39:48,850 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 73.26512145996094, ACC: 0.10686547309160233
2023-07-25 08:40:00,303 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 78.6435775756836, ACC: 0.09010729938745499
2023-07-25 08:40:12,315 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 85.75177764892578, ACC: 0.0655285194516182
2023-07-25 08:40:23,454 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 93.44021606445312, ACC: 0.05460430681705475
2023-07-25 08:40:34,477 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 100.81690216064453, ACC: 0.06965788453817368
2023-07-25 08:40:45,629 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 108.040771484375, ACC: 0.052472103387117386
2023-07-25 08:40:57,332 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 114.67352294921875, ACC: 0.03581686317920685
2023-07-25 08:41:10,385 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 121.10310363769531, ACC: 0.027951397001743317
2023-07-25 08:41:20,831 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 127.20764923095703, ACC: 0.04316731169819832
2023-07-25 08:41:31,465 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 134.25180053710938, ACC: 0.027988091111183167
2023-07-25 08:41:42,270 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 141.11734008789062, ACC: 0.011384500190615654
2023-07-25 08:41:53,691 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 146.92489624023438, ACC: 0.0072004785761237144
2023-07-25 08:42:04,547 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 151.31072998046875, ACC: 0.028907639905810356
2023-07-25 08:42:15,078 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 155.0608367919922, ACC: 0.01724226213991642
2023-07-25 08:42:25,839 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 158.33091735839844, ACC: 0.0033223628997802734
2023-07-25 08:42:36,479 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 161.6187286376953, ACC: -0.0020906429272145033
2023-07-25 08:42:46,885 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 165.96575927734375, ACC: 0.018573451787233353
2023-07-25 08:42:58,112 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 171.9755096435547, ACC: 0.003099411027505994
2023-07-25 08:43:09,020 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 178.39755249023438, ACC: -0.014732670038938522
2023-07-25 08:43:19,522 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 184.24192810058594, ACC: -0.019766783341765404
2023-07-25 08:43:29,785 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 188.94073486328125, ACC: 0.014849530532956123
2023-07-25 08:43:29,883 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-sp_30-timesteps_vis.h5
2023-07-25 08:44:23,244 - root - INFO - ------------------ Configuration ------------------
2023-07-25 08:44:23,244 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 08:44:23,244 - root - INFO - Configuration name: afno_backbone
2023-07-25 08:44:23,244 - root - INFO - log_to_wandb True
2023-07-25 08:44:23,245 - root - INFO - lr 0.0005
2023-07-25 08:44:23,245 - root - INFO - batch_size 64
2023-07-25 08:44:23,245 - root - INFO - max_epochs 150
2023-07-25 08:44:23,245 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 08:44:23,245 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 08:44:23,245 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 08:44:23,245 - root - INFO - orography False
2023-07-25 08:44:23,245 - root - INFO - orography_path None
2023-07-25 08:44:23,245 - root - INFO - exp_dir FourCastNet/results
2023-07-25 08:44:23,245 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 08:44:23,246 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 08:44:23,246 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 08:44:23,246 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 08:44:23,246 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 08:44:23,246 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 08:44:23,246 - root - INFO - loss l2
2023-07-25 08:44:23,246 - root - INFO - num_data_workers 4
2023-07-25 08:44:23,246 - root - INFO - dt 1
2023-07-25 08:44:23,246 - root - INFO - n_history 0
2023-07-25 08:44:23,246 - root - INFO - prediction_type iterative
2023-07-25 08:44:23,246 - root - INFO - prediction_length 30
2023-07-25 08:44:23,246 - root - INFO - n_initial_conditions 5
2023-07-25 08:44:23,246 - root - INFO - ics_type default
2023-07-25 08:44:23,246 - root - INFO - save_raw_forecasts True
2023-07-25 08:44:23,246 - root - INFO - save_channel False
2023-07-25 08:44:23,246 - root - INFO - masked_acc False
2023-07-25 08:44:23,246 - root - INFO - maskpath None
2023-07-25 08:44:23,246 - root - INFO - perturb False
2023-07-25 08:44:23,246 - root - INFO - add_grid False
2023-07-25 08:44:23,247 - root - INFO - N_grid_channels 0
2023-07-25 08:44:23,247 - root - INFO - gridtype sinusoidal
2023-07-25 08:44:23,247 - root - INFO - roll False
2023-07-25 08:44:23,248 - root - INFO - num_blocks 8
2023-07-25 08:44:23,250 - root - INFO - nettype afno
2023-07-25 08:44:23,251 - root - INFO - patch_size 8
2023-07-25 08:44:23,251 - root - INFO - width 56
2023-07-25 08:44:23,251 - root - INFO - modes 32
2023-07-25 08:44:23,251 - root - INFO - target T2m
2023-07-25 08:44:23,251 - root - INFO - normalization zscore
2023-07-25 08:44:23,251 - root - INFO - log_to_screen True
2023-07-25 08:44:23,251 - root - INFO - save_checkpoint True
2023-07-25 08:44:23,251 - root - INFO - enable_nhwc False
2023-07-25 08:44:23,252 - root - INFO - optimizer_type FusedAdam
2023-07-25 08:44:23,252 - root - INFO - crop_size_x None
2023-07-25 08:44:23,252 - root - INFO - crop_size_y None
2023-07-25 08:44:23,252 - root - INFO - two_step_training False
2023-07-25 08:44:23,252 - root - INFO - plot_animations False
2023-07-25 08:44:23,252 - root - INFO - add_noise False
2023-07-25 08:44:23,252 - root - INFO - noise_std 0
2023-07-25 08:44:23,252 - root - INFO - world_size 1
2023-07-25 08:44:23,252 - root - INFO - interp 0
2023-07-25 08:44:23,252 - root - INFO - use_daily_climatology False
2023-07-25 08:44:23,252 - root - INFO - global_batch_size 64
2023-07-25 08:44:23,252 - root - INFO - ablate mslp
2023-07-25 08:44:23,252 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 08:44:23,252 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 08:44:23,252 - root - INFO - resuming False
2023-07-25 08:44:23,252 - root - INFO - local_rank 0
2023-07-25 08:44:23,252 - root - INFO - ---------------------------------------------------
2023-07-25 08:44:23,252 - root - INFO - Inference for 1 initial conditions
2023-07-25 08:44:23,601 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 08:44:23,602 - root - INFO - Number of samples per year: 1460
2023-07-25 08:44:23,602 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 08:44:23,602 - root - INFO - Delta t: 6 hours
2023-07-25 08:44:23,602 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 08:44:23,603 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 08:45:55,272 - root - INFO - Loading inference data
2023-07-25 08:45:55,272 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 08:45:55,636 - root - INFO - Initial condition 1 of 1
2023-07-25 08:45:56,365 - root - INFO - Extracting valid data from the first year
2023-07-25 08:48:55,768 - root - INFO - Standardizing data
2023-07-25 08:49:03,640 - root - INFO - Loading time means
2023-07-25 08:49:20,502 - root - INFO - Begin autoregressive inference
2023-07-25 08:49:31,127 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 08:49:41,857 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 4.625657558441162, ACC: 0.8885629773139954
2023-07-25 08:49:51,804 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 42.00310134887695, ACC: -0.13834629952907562
2023-07-25 08:50:02,576 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 173.28054809570312, ACC: -0.3424946069717407
2023-07-25 08:50:13,223 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 316.8857116699219, ACC: -0.36991873383522034
2023-07-25 08:50:23,690 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 445.17437744140625, ACC: -0.36688247323036194
2023-07-25 08:50:34,064 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 552.2673950195312, ACC: -0.410349577665329
2023-07-25 08:50:45,079 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 640.7040405273438, ACC: -0.4089410603046417
2023-07-25 08:50:55,460 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 716.6804809570312, ACC: -0.41739705204963684
2023-07-25 08:51:06,287 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 784.2511596679688, ACC: -0.41964858770370483
2023-07-25 08:51:16,584 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 846.9151611328125, ACC: -0.4778263568878174
2023-07-25 08:51:27,093 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 904.208251953125, ACC: -0.46234196424484253
2023-07-25 08:51:37,848 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 958.3383178710938, ACC: -0.4692855477333069
2023-07-25 08:51:48,496 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 1010.6575927734375, ACC: -0.4717467129230499
2023-07-25 08:51:59,349 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 1063.6241455078125, ACC: -0.5339378118515015
2023-07-25 08:52:10,526 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 1116.7861328125, ACC: -0.5157040357589722
2023-07-25 08:52:20,552 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 1172.7835693359375, ACC: -0.5161327123641968
2023-07-25 08:52:31,120 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 1234.3775634765625, ACC: -0.5164412260055542
2023-07-25 08:52:41,096 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 1306.118408203125, ACC: -0.5712845921516418
2023-07-25 08:52:51,539 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 1390.248779296875, ACC: -0.5417354106903076
2023-07-25 08:53:01,829 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 1488.2940673828125, ACC: -0.5257295370101929
2023-07-25 08:53:11,434 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 1608.1973876953125, ACC: -0.5090438723564148
2023-07-25 08:53:21,526 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 1788.279052734375, ACC: -0.5045680403709412
2023-07-25 08:53:31,432 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 2090.9775390625, ACC: -0.4276626706123352
2023-07-25 08:53:41,785 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 2529.301513671875, ACC: -0.3802200257778168
2023-07-25 08:53:50,900 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 3029.606689453125, ACC: -0.31728652119636536
2023-07-25 08:54:00,757 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 3504.24560546875, ACC: -0.24287423491477966
2023-07-25 08:54:11,781 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 3906.978759765625, ACC: -0.23876814544200897
2023-07-25 08:54:20,869 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 4228.9365234375, ACC: -0.2567763328552246
2023-07-25 08:54:31,894 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 4478.021484375, ACC: -0.22394078969955444
2023-07-25 08:54:31,987 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-mslp_30-timesteps_vis.h5
2023-07-25 08:55:25,249 - root - INFO - ------------------ Configuration ------------------
2023-07-25 08:55:25,249 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 08:55:25,249 - root - INFO - Configuration name: afno_backbone
2023-07-25 08:55:25,249 - root - INFO - log_to_wandb True
2023-07-25 08:55:25,249 - root - INFO - lr 0.0005
2023-07-25 08:55:25,249 - root - INFO - batch_size 64
2023-07-25 08:55:25,249 - root - INFO - max_epochs 150
2023-07-25 08:55:25,249 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 08:55:25,249 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 08:55:25,249 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 08:55:25,250 - root - INFO - orography False
2023-07-25 08:55:25,250 - root - INFO - orography_path None
2023-07-25 08:55:25,250 - root - INFO - exp_dir FourCastNet/results
2023-07-25 08:55:25,250 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 08:55:25,250 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 08:55:25,250 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 08:55:25,250 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 08:55:25,250 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 08:55:25,250 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 08:55:25,250 - root - INFO - loss l2
2023-07-25 08:55:25,250 - root - INFO - num_data_workers 4
2023-07-25 08:55:25,250 - root - INFO - dt 1
2023-07-25 08:55:25,250 - root - INFO - n_history 0
2023-07-25 08:55:25,250 - root - INFO - prediction_type iterative
2023-07-25 08:55:25,250 - root - INFO - prediction_length 30
2023-07-25 08:55:25,250 - root - INFO - n_initial_conditions 5
2023-07-25 08:55:25,251 - root - INFO - ics_type default
2023-07-25 08:55:25,251 - root - INFO - save_raw_forecasts True
2023-07-25 08:55:25,251 - root - INFO - save_channel False
2023-07-25 08:55:25,251 - root - INFO - masked_acc False
2023-07-25 08:55:25,251 - root - INFO - maskpath None
2023-07-25 08:55:25,251 - root - INFO - perturb False
2023-07-25 08:55:25,251 - root - INFO - add_grid False
2023-07-25 08:55:25,251 - root - INFO - N_grid_channels 0
2023-07-25 08:55:25,251 - root - INFO - gridtype sinusoidal
2023-07-25 08:55:25,251 - root - INFO - roll False
2023-07-25 08:55:25,251 - root - INFO - num_blocks 8
2023-07-25 08:55:25,251 - root - INFO - nettype afno
2023-07-25 08:55:25,251 - root - INFO - patch_size 8
2023-07-25 08:55:25,252 - root - INFO - width 56
2023-07-25 08:55:25,252 - root - INFO - modes 32
2023-07-25 08:55:25,252 - root - INFO - target T2m
2023-07-25 08:55:25,252 - root - INFO - normalization zscore
2023-07-25 08:55:25,252 - root - INFO - log_to_screen True
2023-07-25 08:55:25,253 - root - INFO - save_checkpoint True
2023-07-25 08:55:25,253 - root - INFO - enable_nhwc False
2023-07-25 08:55:25,253 - root - INFO - optimizer_type FusedAdam
2023-07-25 08:55:25,253 - root - INFO - crop_size_x None
2023-07-25 08:55:25,253 - root - INFO - crop_size_y None
2023-07-25 08:55:25,253 - root - INFO - two_step_training False
2023-07-25 08:55:25,253 - root - INFO - plot_animations False
2023-07-25 08:55:25,253 - root - INFO - add_noise False
2023-07-25 08:55:25,253 - root - INFO - noise_std 0
2023-07-25 08:55:25,253 - root - INFO - world_size 1
2023-07-25 08:55:25,253 - root - INFO - interp 0
2023-07-25 08:55:25,253 - root - INFO - use_daily_climatology False
2023-07-25 08:55:25,253 - root - INFO - global_batch_size 64
2023-07-25 08:55:25,253 - root - INFO - ablate U1000
2023-07-25 08:55:25,253 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 08:55:25,254 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 08:55:25,254 - root - INFO - resuming False
2023-07-25 08:55:25,254 - root - INFO - local_rank 0
2023-07-25 08:55:25,254 - root - INFO - ---------------------------------------------------
2023-07-25 08:55:25,254 - root - INFO - Inference for 1 initial conditions
2023-07-25 08:55:25,494 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 08:55:25,495 - root - INFO - Number of samples per year: 1460
2023-07-25 08:55:25,495 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 08:55:25,495 - root - INFO - Delta t: 6 hours
2023-07-25 08:55:25,495 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 08:55:25,496 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 08:56:55,597 - root - INFO - Loading inference data
2023-07-25 08:56:55,598 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 08:56:55,874 - root - INFO - Initial condition 1 of 1
2023-07-25 08:56:56,699 - root - INFO - Extracting valid data from the first year
2023-07-25 08:59:50,697 - root - INFO - Standardizing data
2023-07-25 08:59:58,566 - root - INFO - Loading time means
2023-07-25 09:00:17,815 - root - INFO - Begin autoregressive inference
2023-07-25 09:00:29,403 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 09:00:40,443 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 22.061460494995117, ACC: 0.4217557907104492
2023-07-25 09:00:51,490 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 176.0658721923828, ACC: 0.07139060646295547
2023-07-25 09:01:02,290 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 426.70941162109375, ACC: -0.015078031457960606
2023-07-25 09:01:13,142 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 734.3530883789062, ACC: -0.028516659513115883
2023-07-25 09:01:25,100 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 1035.4180908203125, ACC: -0.030830366536974907
2023-07-25 09:01:35,629 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 1355.210205078125, ACC: -0.0751737505197525
2023-07-25 09:01:46,902 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 1777.6527099609375, ACC: -0.15888161957263947
2023-07-25 09:01:58,223 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 2316.894287109375, ACC: -0.2354457974433899
2023-07-25 09:02:08,986 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 2900.01904296875, ACC: -0.23243550956249237
2023-07-25 09:02:19,462 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 3438.805419921875, ACC: -0.1919325441122055
2023-07-25 09:02:29,693 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 3882.191650390625, ACC: -0.2189081609249115
2023-07-25 09:02:40,587 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 4222.1015625, ACC: -0.25570547580718994
2023-07-25 09:02:52,083 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 4473.630859375, ACC: -0.22985030710697174
2023-07-25 09:03:02,689 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 4657.751953125, ACC: -0.18399827182292938
2023-07-25 09:03:13,145 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 4792.82763671875, ACC: -0.20902900397777557
2023-07-25 09:03:23,833 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 4891.48876953125, ACC: -0.24144241213798523
2023-07-25 09:03:34,503 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 4962.44775390625, ACC: -0.21929101645946503
2023-07-25 09:03:44,947 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 5012.84619140625, ACC: -0.17418348789215088
2023-07-25 09:03:55,561 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 5048.708984375, ACC: -0.19870392978191376
2023-07-25 09:04:06,547 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 5073.6328125, ACC: -0.23568236827850342
2023-07-25 09:04:17,626 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 5090.01220703125, ACC: -0.2139432728290558
2023-07-25 09:04:28,476 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 5100.8525390625, ACC: -0.16948269307613373
2023-07-25 09:04:39,364 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 5108.837890625, ACC: -0.19837671518325806
2023-07-25 09:04:51,076 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 5114.591796875, ACC: -0.2362930327653885
2023-07-25 09:05:02,318 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 5117.9716796875, ACC: -0.21436285972595215
2023-07-25 09:05:14,104 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 5119.97607421875, ACC: -0.16295500099658966
2023-07-25 09:05:24,281 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 5122.052734375, ACC: -0.19361411035060883
2023-07-25 09:05:35,631 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 5123.76806640625, ACC: -0.2332821935415268
2023-07-25 09:05:46,779 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 5124.3408203125, ACC: -0.2097957581281662
2023-07-25 09:05:46,868 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-U1000_30-timesteps_vis.h5
2023-07-25 09:06:40,259 - root - INFO - ------------------ Configuration ------------------
2023-07-25 09:06:40,259 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 09:06:40,259 - root - INFO - Configuration name: afno_backbone
2023-07-25 09:06:40,260 - root - INFO - log_to_wandb True
2023-07-25 09:06:40,260 - root - INFO - lr 0.0005
2023-07-25 09:06:40,260 - root - INFO - batch_size 64
2023-07-25 09:06:40,260 - root - INFO - max_epochs 150
2023-07-25 09:06:40,260 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 09:06:40,260 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 09:06:40,260 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 09:06:40,260 - root - INFO - orography False
2023-07-25 09:06:40,260 - root - INFO - orography_path None
2023-07-25 09:06:40,260 - root - INFO - exp_dir FourCastNet/results
2023-07-25 09:06:40,260 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 09:06:40,260 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 09:06:40,260 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 09:06:40,260 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 09:06:40,260 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 09:06:40,260 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 09:06:40,260 - root - INFO - loss l2
2023-07-25 09:06:40,260 - root - INFO - num_data_workers 4
2023-07-25 09:06:40,260 - root - INFO - dt 1
2023-07-25 09:06:40,261 - root - INFO - n_history 0
2023-07-25 09:06:40,261 - root - INFO - prediction_type iterative
2023-07-25 09:06:40,261 - root - INFO - prediction_length 30
2023-07-25 09:06:40,261 - root - INFO - n_initial_conditions 5
2023-07-25 09:06:40,261 - root - INFO - ics_type default
2023-07-25 09:06:40,261 - root - INFO - save_raw_forecasts True
2023-07-25 09:06:40,261 - root - INFO - save_channel False
2023-07-25 09:06:40,261 - root - INFO - masked_acc False
2023-07-25 09:06:40,261 - root - INFO - maskpath None
2023-07-25 09:06:40,261 - root - INFO - perturb False
2023-07-25 09:06:40,261 - root - INFO - add_grid False
2023-07-25 09:06:40,261 - root - INFO - N_grid_channels 0
2023-07-25 09:06:40,261 - root - INFO - gridtype sinusoidal
2023-07-25 09:06:40,261 - root - INFO - roll False
2023-07-25 09:06:40,261 - root - INFO - num_blocks 8
2023-07-25 09:06:40,261 - root - INFO - nettype afno
2023-07-25 09:06:40,261 - root - INFO - patch_size 8
2023-07-25 09:06:40,261 - root - INFO - width 56
2023-07-25 09:06:40,261 - root - INFO - modes 32
2023-07-25 09:06:40,261 - root - INFO - target T2m
2023-07-25 09:06:40,262 - root - INFO - normalization zscore
2023-07-25 09:06:40,262 - root - INFO - log_to_screen True
2023-07-25 09:06:40,262 - root - INFO - save_checkpoint True
2023-07-25 09:06:40,262 - root - INFO - enable_nhwc False
2023-07-25 09:06:40,262 - root - INFO - optimizer_type FusedAdam
2023-07-25 09:06:40,262 - root - INFO - crop_size_x None
2023-07-25 09:06:40,262 - root - INFO - crop_size_y None
2023-07-25 09:06:40,262 - root - INFO - two_step_training False
2023-07-25 09:06:40,262 - root - INFO - plot_animations False
2023-07-25 09:06:40,262 - root - INFO - add_noise False
2023-07-25 09:06:40,262 - root - INFO - noise_std 0
2023-07-25 09:06:40,262 - root - INFO - world_size 1
2023-07-25 09:06:40,262 - root - INFO - interp 0
2023-07-25 09:06:40,262 - root - INFO - use_daily_climatology False
2023-07-25 09:06:40,262 - root - INFO - global_batch_size 64
2023-07-25 09:06:40,262 - root - INFO - ablate V1000
2023-07-25 09:06:40,262 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 09:06:40,262 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 09:06:40,262 - root - INFO - resuming False
2023-07-25 09:06:40,262 - root - INFO - local_rank 0
2023-07-25 09:06:40,263 - root - INFO - ---------------------------------------------------
2023-07-25 09:06:40,263 - root - INFO - Inference for 1 initial conditions
2023-07-25 09:06:40,653 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 09:06:40,654 - root - INFO - Number of samples per year: 1460
2023-07-25 09:06:40,654 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 09:06:40,654 - root - INFO - Delta t: 6 hours
2023-07-25 09:06:40,654 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 09:06:40,654 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 09:08:08,499 - root - INFO - Loading inference data
2023-07-25 09:08:08,499 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 09:08:08,777 - root - INFO - Initial condition 1 of 1
2023-07-25 09:08:09,569 - root - INFO - Extracting valid data from the first year
2023-07-25 09:11:10,066 - root - INFO - Standardizing data
2023-07-25 09:11:17,924 - root - INFO - Loading time means
2023-07-25 09:11:35,325 - root - INFO - Begin autoregressive inference
2023-07-25 09:11:46,296 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 09:11:57,438 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 1.2791861295700073, ACC: 0.9911821484565735
2023-07-25 09:12:08,048 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 1.301234245300293, ACC: 0.9905556440353394
2023-07-25 09:12:18,484 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 1.3468559980392456, ACC: 0.9897308349609375
2023-07-25 09:12:29,340 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 1.3426281213760376, ACC: 0.9906140565872192
2023-07-25 09:12:39,995 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 1.3630579710006714, ACC: 0.9899059534072876
2023-07-25 09:12:50,003 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 1.3759336471557617, ACC: 0.9890403151512146
2023-07-25 09:13:01,125 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 1.402001976966858, ACC: 0.9885238409042358
2023-07-25 09:13:11,128 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 1.422305703163147, ACC: 0.9892855286598206
2023-07-25 09:13:21,776 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 1.4621284008026123, ACC: 0.9883919358253479
2023-07-25 09:13:32,287 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 1.5241352319717407, ACC: 0.9868052005767822
2023-07-25 09:13:42,826 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 1.541959524154663, ACC: 0.9868021011352539
2023-07-25 09:13:53,521 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 1.5976002216339111, ACC: 0.9872667789459229
2023-07-25 09:14:04,027 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 1.6597493886947632, ACC: 0.9857587814331055
2023-07-25 09:14:16,204 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 1.7390339374542236, ACC: 0.983587920665741
2023-07-25 09:14:26,795 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 1.7586230039596558, ACC: 0.9835373759269714
2023-07-25 09:14:36,742 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 1.8417972326278687, ACC: 0.9833626747131348
2023-07-25 09:14:46,791 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 1.8969886302947998, ACC: 0.9815238118171692
2023-07-25 09:14:57,606 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 1.9630197286605835, ACC: 0.9784817099571228
2023-07-25 09:15:08,961 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 2.045182228088379, ACC: 0.976803719997406
2023-07-25 09:15:20,136 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 2.1599419116973877, ACC: 0.9762969613075256
2023-07-25 09:15:30,628 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 2.281755208969116, ACC: 0.9718941450119019
2023-07-25 09:15:40,535 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 2.4374403953552246, ACC: 0.965549111366272
2023-07-25 09:15:50,523 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 2.4813616275787354, ACC: 0.963889479637146
2023-07-25 09:16:01,083 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 2.6443467140197754, ACC: 0.962547779083252
2023-07-25 09:16:12,001 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 2.793957233428955, ACC: 0.9554557204246521
2023-07-25 09:16:22,378 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 2.9473700523376465, ACC: 0.9469934701919556
2023-07-25 09:16:32,715 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 3.024334669113159, ACC: 0.9456547498703003
2023-07-25 09:16:43,610 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 3.1636130809783936, ACC: 0.9456660747528076
2023-07-25 09:16:54,292 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 3.147928237915039, ACC: 0.941785454750061
2023-07-25 09:16:54,384 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-V1000_30-timesteps_vis.h5
2023-07-25 09:17:47,623 - root - INFO - ------------------ Configuration ------------------
2023-07-25 09:17:47,623 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 09:17:47,623 - root - INFO - Configuration name: afno_backbone
2023-07-25 09:17:47,623 - root - INFO - log_to_wandb True
2023-07-25 09:17:47,623 - root - INFO - lr 0.0005
2023-07-25 09:17:47,623 - root - INFO - batch_size 64
2023-07-25 09:17:47,623 - root - INFO - max_epochs 150
2023-07-25 09:17:47,623 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 09:17:47,623 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 09:17:47,623 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 09:17:47,623 - root - INFO - orography False
2023-07-25 09:17:47,623 - root - INFO - orography_path None
2023-07-25 09:17:47,623 - root - INFO - exp_dir FourCastNet/results
2023-07-25 09:17:47,624 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 09:17:47,624 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 09:17:47,624 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 09:17:47,624 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 09:17:47,624 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 09:17:47,624 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 09:17:47,624 - root - INFO - loss l2
2023-07-25 09:17:47,624 - root - INFO - num_data_workers 4
2023-07-25 09:17:47,624 - root - INFO - dt 1
2023-07-25 09:17:47,624 - root - INFO - n_history 0
2023-07-25 09:17:47,624 - root - INFO - prediction_type iterative
2023-07-25 09:17:47,624 - root - INFO - prediction_length 30
2023-07-25 09:17:47,624 - root - INFO - n_initial_conditions 5
2023-07-25 09:17:47,624 - root - INFO - ics_type default
2023-07-25 09:17:47,624 - root - INFO - save_raw_forecasts True
2023-07-25 09:17:47,624 - root - INFO - save_channel False
2023-07-25 09:17:47,624 - root - INFO - masked_acc False
2023-07-25 09:17:47,625 - root - INFO - maskpath None
2023-07-25 09:17:47,625 - root - INFO - perturb False
2023-07-25 09:17:47,625 - root - INFO - add_grid False
2023-07-25 09:17:47,625 - root - INFO - N_grid_channels 0
2023-07-25 09:17:47,625 - root - INFO - gridtype sinusoidal
2023-07-25 09:17:47,625 - root - INFO - roll False
2023-07-25 09:17:47,625 - root - INFO - num_blocks 8
2023-07-25 09:17:47,625 - root - INFO - nettype afno
2023-07-25 09:17:47,625 - root - INFO - patch_size 8
2023-07-25 09:17:47,625 - root - INFO - width 56
2023-07-25 09:17:47,625 - root - INFO - modes 32
2023-07-25 09:17:47,625 - root - INFO - target T2m
2023-07-25 09:17:47,625 - root - INFO - normalization zscore
2023-07-25 09:17:47,625 - root - INFO - log_to_screen True
2023-07-25 09:17:47,625 - root - INFO - save_checkpoint True
2023-07-25 09:17:47,625 - root - INFO - enable_nhwc False
2023-07-25 09:17:47,625 - root - INFO - optimizer_type FusedAdam
2023-07-25 09:17:47,625 - root - INFO - crop_size_x None
2023-07-25 09:17:47,625 - root - INFO - crop_size_y None
2023-07-25 09:17:47,625 - root - INFO - two_step_training False
2023-07-25 09:17:47,626 - root - INFO - plot_animations False
2023-07-25 09:17:47,626 - root - INFO - add_noise False
2023-07-25 09:17:47,626 - root - INFO - noise_std 0
2023-07-25 09:17:47,626 - root - INFO - world_size 1
2023-07-25 09:17:47,626 - root - INFO - interp 0
2023-07-25 09:17:47,626 - root - INFO - use_daily_climatology False
2023-07-25 09:17:47,626 - root - INFO - global_batch_size 64
2023-07-25 09:17:47,626 - root - INFO - ablate Z1000
2023-07-25 09:17:47,626 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 09:17:47,626 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 09:17:47,626 - root - INFO - resuming False
2023-07-25 09:17:47,626 - root - INFO - local_rank 0
2023-07-25 09:17:47,626 - root - INFO - ---------------------------------------------------
2023-07-25 09:17:47,627 - root - INFO - Inference for 1 initial conditions
2023-07-25 09:17:47,898 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 09:17:47,900 - root - INFO - Number of samples per year: 1460
2023-07-25 09:17:47,900 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 09:17:47,900 - root - INFO - Delta t: 6 hours
2023-07-25 09:17:47,900 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 09:17:47,900 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 09:19:04,765 - root - INFO - Loading inference data
2023-07-25 09:19:04,766 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 09:19:05,031 - root - INFO - Initial condition 1 of 1
2023-07-25 09:19:05,796 - root - INFO - Extracting valid data from the first year
2023-07-25 09:21:53,701 - root - INFO - Standardizing data
2023-07-25 09:22:01,457 - root - INFO - Loading time means
2023-07-25 09:22:20,475 - root - INFO - Begin autoregressive inference
2023-07-25 09:22:31,378 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 09:22:43,404 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 0.882480800151825, ACC: 0.9957926869392395
2023-07-25 09:22:55,050 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 0.9950763583183289, ACC: 0.9945481419563293
2023-07-25 09:23:05,312 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 1.036566138267517, ACC: 0.9939940571784973
2023-07-25 09:23:16,485 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 1.07068932056427, ACC: 0.994114100933075
2023-07-25 09:23:27,095 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 1.1171389818191528, ACC: 0.9933164119720459
2023-07-25 09:23:37,131 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 1.1435034275054932, ACC: 0.9925419092178345
2023-07-25 09:23:48,382 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 1.1765556335449219, ACC: 0.9919857978820801
2023-07-25 09:23:59,194 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 1.2238397598266602, ACC: 0.9920873045921326
2023-07-25 09:24:10,700 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 1.2560875415802002, ACC: 0.9914422631263733
2023-07-25 09:24:21,363 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 1.3136171102523804, ACC: 0.990248441696167
2023-07-25 09:24:32,949 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 1.3501442670822144, ACC: 0.9898262619972229
2023-07-25 09:24:43,350 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 1.409063458442688, ACC: 0.9900435209274292
2023-07-25 09:24:53,401 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 1.4576029777526855, ACC: 0.9889471530914307
2023-07-25 09:25:03,586 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 1.5198005437850952, ACC: 0.9874526262283325
2023-07-25 09:25:14,485 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 1.538373589515686, ACC: 0.9873182773590088
2023-07-25 09:25:24,520 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 1.6315701007843018, ACC: 0.9868497848510742
2023-07-25 09:25:34,622 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 1.6690433025360107, ACC: 0.9855589866638184
2023-07-25 09:25:45,617 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 1.7133185863494873, ACC: 0.9835590720176697
2023-07-25 09:25:56,951 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 1.7858879566192627, ACC: 0.9823047518730164
2023-07-25 09:26:08,956 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 1.8967324495315552, ACC: 0.9817477464675903
2023-07-25 09:26:19,365 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 1.9599201679229736, ACC: 0.9793184399604797
2023-07-25 09:26:30,588 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 2.0443084239959717, ACC: 0.9759066700935364
2023-07-25 09:26:40,719 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 2.0705299377441406, ACC: 0.9750180244445801
2023-07-25 09:26:52,139 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 2.185985803604126, ACC: 0.9745852947235107
2023-07-25 09:27:02,825 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 2.259145736694336, ACC: 0.9711140990257263
2023-07-25 09:27:13,373 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 2.327535390853882, ACC: 0.9672970771789551
2023-07-25 09:27:24,165 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 2.442023992538452, ACC: 0.9651808142662048
2023-07-25 09:27:35,110 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 2.5952060222625732, ACC: 0.963917076587677
2023-07-25 09:27:45,109 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 2.621744155883789, ACC: 0.9601417779922485
2023-07-25 09:27:45,207 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-Z1000_30-timesteps_vis.h5
2023-07-25 09:28:39,885 - root - INFO - ------------------ Configuration ------------------
2023-07-25 09:28:39,885 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 09:28:39,885 - root - INFO - Configuration name: afno_backbone
2023-07-25 09:28:39,885 - root - INFO - log_to_wandb True
2023-07-25 09:28:39,885 - root - INFO - lr 0.0005
2023-07-25 09:28:39,885 - root - INFO - batch_size 64
2023-07-25 09:28:39,885 - root - INFO - max_epochs 150
2023-07-25 09:28:39,885 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 09:28:39,885 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 09:28:39,885 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 09:28:39,886 - root - INFO - orography False
2023-07-25 09:28:39,886 - root - INFO - orography_path None
2023-07-25 09:28:39,886 - root - INFO - exp_dir FourCastNet/results
2023-07-25 09:28:39,886 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 09:28:39,886 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 09:28:39,886 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 09:28:39,886 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 09:28:39,886 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 09:28:39,886 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 09:28:39,887 - root - INFO - loss l2
2023-07-25 09:28:39,887 - root - INFO - num_data_workers 4
2023-07-25 09:28:39,887 - root - INFO - dt 1
2023-07-25 09:28:39,887 - root - INFO - n_history 0
2023-07-25 09:28:39,887 - root - INFO - prediction_type iterative
2023-07-25 09:28:39,887 - root - INFO - prediction_length 30
2023-07-25 09:28:39,887 - root - INFO - n_initial_conditions 5
2023-07-25 09:28:39,887 - root - INFO - ics_type default
2023-07-25 09:28:39,887 - root - INFO - save_raw_forecasts True
2023-07-25 09:28:39,887 - root - INFO - save_channel False
2023-07-25 09:28:39,888 - root - INFO - masked_acc False
2023-07-25 09:28:39,888 - root - INFO - maskpath None
2023-07-25 09:28:39,888 - root - INFO - perturb False
2023-07-25 09:28:39,888 - root - INFO - add_grid False
2023-07-25 09:28:39,888 - root - INFO - N_grid_channels 0
2023-07-25 09:28:39,888 - root - INFO - gridtype sinusoidal
2023-07-25 09:28:39,888 - root - INFO - roll False
2023-07-25 09:28:39,888 - root - INFO - num_blocks 8
2023-07-25 09:28:39,888 - root - INFO - nettype afno
2023-07-25 09:28:39,888 - root - INFO - patch_size 8
2023-07-25 09:28:39,888 - root - INFO - width 56
2023-07-25 09:28:39,888 - root - INFO - modes 32
2023-07-25 09:28:39,888 - root - INFO - target T2m
2023-07-25 09:28:39,888 - root - INFO - normalization zscore
2023-07-25 09:28:39,888 - root - INFO - log_to_screen True
2023-07-25 09:28:39,888 - root - INFO - save_checkpoint True
2023-07-25 09:28:39,888 - root - INFO - enable_nhwc False
2023-07-25 09:28:39,889 - root - INFO - optimizer_type FusedAdam
2023-07-25 09:28:39,889 - root - INFO - crop_size_x None
2023-07-25 09:28:39,889 - root - INFO - crop_size_y None
2023-07-25 09:28:39,889 - root - INFO - two_step_training False
2023-07-25 09:28:39,889 - root - INFO - plot_animations False
2023-07-25 09:28:39,889 - root - INFO - add_noise False
2023-07-25 09:28:39,889 - root - INFO - noise_std 0
2023-07-25 09:28:39,889 - root - INFO - world_size 1
2023-07-25 09:28:39,889 - root - INFO - interp 0
2023-07-25 09:28:39,889 - root - INFO - use_daily_climatology False
2023-07-25 09:28:39,889 - root - INFO - global_batch_size 64
2023-07-25 09:28:39,889 - root - INFO - ablate T850
2023-07-25 09:28:39,889 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 09:28:39,889 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 09:28:39,889 - root - INFO - resuming False
2023-07-25 09:28:39,889 - root - INFO - local_rank 0
2023-07-25 09:28:39,889 - root - INFO - ---------------------------------------------------
2023-07-25 09:28:39,889 - root - INFO - Inference for 1 initial conditions
2023-07-25 09:28:40,183 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 09:28:40,184 - root - INFO - Number of samples per year: 1460
2023-07-25 09:28:40,184 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 09:28:40,184 - root - INFO - Delta t: 6 hours
2023-07-25 09:28:40,184 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 09:28:40,184 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 09:30:00,869 - root - INFO - Loading inference data
2023-07-25 09:30:00,870 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 09:30:01,335 - root - INFO - Initial condition 1 of 1
2023-07-25 09:30:02,128 - root - INFO - Extracting valid data from the first year
2023-07-25 09:32:58,771 - root - INFO - Standardizing data
2023-07-25 09:33:07,340 - root - INFO - Loading time means
2023-07-25 09:33:24,172 - root - INFO - Begin autoregressive inference
2023-07-25 09:33:36,047 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 09:33:48,164 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 63.77857971191406, ACC: 0.15592990815639496
2023-07-25 09:34:00,019 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 451.1700439453125, ACC: -0.033097680658102036
2023-07-25 09:34:12,740 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 959.4108276367188, ACC: -0.13845834136009216
2023-07-25 09:34:24,168 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 1568.6468505859375, ACC: -0.23896373808383942
2023-07-25 09:34:35,318 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 2265.7841796875, ACC: -0.25447797775268555
2023-07-25 09:34:45,976 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 2934.1494140625, ACC: -0.20297887921333313
2023-07-25 09:34:58,181 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 3499.7763671875, ACC: -0.23010949790477753
2023-07-25 09:35:09,272 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 3941.591064453125, ACC: -0.2686685025691986
2023-07-25 09:35:20,841 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 4274.728515625, ACC: -0.24616307020187378
2023-07-25 09:35:32,590 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 4522.36328125, ACC: -0.19070369005203247
2023-07-25 09:35:44,226 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 4704.30810546875, ACC: -0.20954245328903198
2023-07-25 09:35:55,357 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 4835.05419921875, ACC: -0.24575909972190857
2023-07-25 09:36:07,023 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 4926.04443359375, ACC: -0.22300785779953003
2023-07-25 09:36:18,295 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 4988.45068359375, ACC: -0.1782556176185608
2023-07-25 09:36:29,333 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 5031.658203125, ACC: -0.20379461348056793
2023-07-25 09:36:40,249 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 5061.37548828125, ACC: -0.23795033991336823
2023-07-25 09:36:51,143 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 5081.14111328125, ACC: -0.21765302121639252
2023-07-25 09:37:02,740 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 5094.38720703125, ACC: -0.1733405739068985
2023-07-25 09:37:13,526 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 5104.1064453125, ACC: -0.19783775508403778
2023-07-25 09:37:24,335 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 5111.1455078125, ACC: -0.23505519330501556
2023-07-25 09:37:35,537 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 5115.47265625, ACC: -0.21365058422088623
2023-07-25 09:37:46,372 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 5118.22021484375, ACC: -0.16935071349143982
2023-07-25 09:37:57,617 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 5120.76025390625, ACC: -0.19822444021701813
2023-07-25 09:38:07,996 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 5122.83203125, ACC: -0.23617684841156006
2023-07-25 09:38:19,526 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 5123.70556640625, ACC: -0.21431924402713776
2023-07-25 09:38:30,288 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 5123.9892578125, ACC: -0.16293743252754211
2023-07-25 09:38:41,173 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 5124.87744140625, ACC: -0.19358670711517334
2023-07-25 09:38:51,902 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 5125.76513671875, ACC: -0.2332579493522644
2023-07-25 09:39:03,004 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 5125.7587890625, ACC: -0.20978504419326782
2023-07-25 09:39:03,118 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-T850_30-timesteps_vis.h5
2023-07-25 09:39:56,650 - root - INFO - ------------------ Configuration ------------------
2023-07-25 09:39:56,650 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 09:39:56,651 - root - INFO - Configuration name: afno_backbone
2023-07-25 09:39:56,651 - root - INFO - log_to_wandb True
2023-07-25 09:39:56,651 - root - INFO - lr 0.0005
2023-07-25 09:39:56,651 - root - INFO - batch_size 64
2023-07-25 09:39:56,651 - root - INFO - max_epochs 150
2023-07-25 09:39:56,651 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 09:39:56,651 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 09:39:56,651 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 09:39:56,651 - root - INFO - orography False
2023-07-25 09:39:56,651 - root - INFO - orography_path None
2023-07-25 09:39:56,651 - root - INFO - exp_dir FourCastNet/results
2023-07-25 09:39:56,651 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 09:39:56,651 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 09:39:56,651 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 09:39:56,651 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 09:39:56,651 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 09:39:56,651 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 09:39:56,651 - root - INFO - loss l2
2023-07-25 09:39:56,651 - root - INFO - num_data_workers 4
2023-07-25 09:39:56,652 - root - INFO - dt 1
2023-07-25 09:39:56,652 - root - INFO - n_history 0
2023-07-25 09:39:56,652 - root - INFO - prediction_type iterative
2023-07-25 09:39:56,652 - root - INFO - prediction_length 30
2023-07-25 09:39:56,652 - root - INFO - n_initial_conditions 5
2023-07-25 09:39:56,652 - root - INFO - ics_type default
2023-07-25 09:39:56,652 - root - INFO - save_raw_forecasts True
2023-07-25 09:39:56,652 - root - INFO - save_channel False
2023-07-25 09:39:56,652 - root - INFO - masked_acc False
2023-07-25 09:39:56,652 - root - INFO - maskpath None
2023-07-25 09:39:56,652 - root - INFO - perturb False
2023-07-25 09:39:56,652 - root - INFO - add_grid False
2023-07-25 09:39:56,652 - root - INFO - N_grid_channels 0
2023-07-25 09:39:56,652 - root - INFO - gridtype sinusoidal
2023-07-25 09:39:56,652 - root - INFO - roll False
2023-07-25 09:39:56,652 - root - INFO - num_blocks 8
2023-07-25 09:39:56,652 - root - INFO - nettype afno
2023-07-25 09:39:56,652 - root - INFO - patch_size 8
2023-07-25 09:39:56,652 - root - INFO - width 56
2023-07-25 09:39:56,653 - root - INFO - modes 32
2023-07-25 09:39:56,653 - root - INFO - target T2m
2023-07-25 09:39:56,653 - root - INFO - normalization zscore
2023-07-25 09:39:56,653 - root - INFO - log_to_screen True
2023-07-25 09:39:56,653 - root - INFO - save_checkpoint True
2023-07-25 09:39:56,653 - root - INFO - enable_nhwc False
2023-07-25 09:39:56,653 - root - INFO - optimizer_type FusedAdam
2023-07-25 09:39:56,653 - root - INFO - crop_size_x None
2023-07-25 09:39:56,653 - root - INFO - crop_size_y None
2023-07-25 09:39:56,653 - root - INFO - two_step_training False
2023-07-25 09:39:56,653 - root - INFO - plot_animations False
2023-07-25 09:39:56,653 - root - INFO - add_noise False
2023-07-25 09:39:56,653 - root - INFO - noise_std 0
2023-07-25 09:39:56,653 - root - INFO - world_size 1
2023-07-25 09:39:56,653 - root - INFO - interp 0
2023-07-25 09:39:56,653 - root - INFO - use_daily_climatology False
2023-07-25 09:39:56,653 - root - INFO - global_batch_size 64
2023-07-25 09:39:56,654 - root - INFO - ablate U850
2023-07-25 09:39:56,654 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 09:39:56,654 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 09:39:56,654 - root - INFO - resuming False
2023-07-25 09:39:56,654 - root - INFO - local_rank 0
2023-07-25 09:39:56,654 - root - INFO - ---------------------------------------------------
2023-07-25 09:39:56,654 - root - INFO - Inference for 1 initial conditions
2023-07-25 09:39:56,948 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 09:39:56,949 - root - INFO - Number of samples per year: 1460
2023-07-25 09:39:56,949 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 09:39:56,949 - root - INFO - Delta t: 6 hours
2023-07-25 09:39:56,949 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 09:39:56,950 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 09:41:18,600 - root - INFO - Loading inference data
2023-07-25 09:41:18,600 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 09:41:18,794 - root - INFO - Initial condition 1 of 1
2023-07-25 09:41:19,684 - root - INFO - Extracting valid data from the first year
2023-07-25 09:44:02,208 - root - INFO - Standardizing data
2023-07-25 09:44:10,139 - root - INFO - Loading time means
2023-07-25 09:44:26,118 - root - INFO - Begin autoregressive inference
2023-07-25 09:44:36,897 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 09:44:49,131 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 0.8631215691566467, ACC: 0.9959209561347961
2023-07-25 09:45:00,966 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 0.9789904356002808, ACC: 0.994573175907135
2023-07-25 09:45:14,425 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 1.048559546470642, ACC: 0.9936701059341431
2023-07-25 09:45:24,960 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 1.0796555280685425, ACC: 0.9937683939933777
2023-07-25 09:45:36,482 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 1.1033997535705566, ACC: 0.9931897521018982
2023-07-25 09:45:47,434 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 1.1310749053955078, ACC: 0.992430567741394
2023-07-25 09:45:58,868 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 1.155131459236145, ACC: 0.9920386672019958
2023-07-25 09:46:09,496 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 1.2054582834243774, ACC: 0.9920948147773743
2023-07-25 09:46:20,436 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 1.2559295892715454, ACC: 0.991114616394043
2023-07-25 09:46:30,839 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 1.3294965028762817, ACC: 0.9896743893623352
2023-07-25 09:46:41,801 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 1.4029028415679932, ACC: 0.9887343645095825
2023-07-25 09:46:52,252 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 1.46330988407135, ACC: 0.9889493584632874
2023-07-25 09:47:03,634 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 1.528814673423767, ACC: 0.9875001311302185
2023-07-25 09:47:15,002 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 1.6143335103988647, ACC: 0.9855079054832458
2023-07-25 09:47:25,387 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 1.6412853002548218, ACC: 0.9852088689804077
2023-07-25 09:47:37,049 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 1.7582604885101318, ACC: 0.9843920469284058
2023-07-25 09:47:47,502 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 1.7989226579666138, ACC: 0.9829367399215698
2023-07-25 09:47:58,657 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 1.8621400594711304, ACC: 0.9803558588027954
2023-07-25 09:48:09,169 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 1.961367130279541, ACC: 0.9783822894096375
2023-07-25 09:48:20,224 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 2.08345890045166, ACC: 0.977734386920929
2023-07-25 09:48:30,442 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 2.134524345397949, ACC: 0.9753289818763733
2023-07-25 09:48:40,878 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 2.24273681640625, ACC: 0.9709408283233643
2023-07-25 09:48:52,252 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 2.3069636821746826, ACC: 0.9692639708518982
2023-07-25 09:49:03,080 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 2.3922007083892822, ACC: 0.9698166847229004
2023-07-25 09:49:14,399 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 2.456970453262329, ACC: 0.9660443663597107
2023-07-25 09:49:24,851 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 2.5391430854797363, ACC: 0.9613390564918518
2023-07-25 09:49:35,479 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 2.648618698120117, ACC: 0.9591506719589233
2023-07-25 09:49:46,643 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 2.773071527481079, ACC: 0.9590615034103394
2023-07-25 09:49:57,255 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 2.7876551151275635, ACC: 0.9553881883621216
2023-07-25 09:49:57,342 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-U850_30-timesteps_vis.h5
2023-07-25 09:50:50,547 - root - INFO - ------------------ Configuration ------------------
2023-07-25 09:50:50,548 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 09:50:50,548 - root - INFO - Configuration name: afno_backbone
2023-07-25 09:50:50,548 - root - INFO - log_to_wandb True
2023-07-25 09:50:50,548 - root - INFO - lr 0.0005
2023-07-25 09:50:50,548 - root - INFO - batch_size 64
2023-07-25 09:50:50,548 - root - INFO - max_epochs 150
2023-07-25 09:50:50,548 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 09:50:50,548 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 09:50:50,548 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 09:50:50,548 - root - INFO - orography False
2023-07-25 09:50:50,548 - root - INFO - orography_path None
2023-07-25 09:50:50,548 - root - INFO - exp_dir FourCastNet/results
2023-07-25 09:50:50,548 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 09:50:50,548 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 09:50:50,548 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 09:50:50,548 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 09:50:50,548 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 09:50:50,549 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 09:50:50,549 - root - INFO - loss l2
2023-07-25 09:50:50,549 - root - INFO - num_data_workers 4
2023-07-25 09:50:50,549 - root - INFO - dt 1
2023-07-25 09:50:50,549 - root - INFO - n_history 0
2023-07-25 09:50:50,549 - root - INFO - prediction_type iterative
2023-07-25 09:50:50,549 - root - INFO - prediction_length 30
2023-07-25 09:50:50,549 - root - INFO - n_initial_conditions 5
2023-07-25 09:50:50,549 - root - INFO - ics_type default
2023-07-25 09:50:50,549 - root - INFO - save_raw_forecasts True
2023-07-25 09:50:50,549 - root - INFO - save_channel False
2023-07-25 09:50:50,549 - root - INFO - masked_acc False
2023-07-25 09:50:50,549 - root - INFO - maskpath None
2023-07-25 09:50:50,549 - root - INFO - perturb False
2023-07-25 09:50:50,549 - root - INFO - add_grid False
2023-07-25 09:50:50,549 - root - INFO - N_grid_channels 0
2023-07-25 09:50:50,549 - root - INFO - gridtype sinusoidal
2023-07-25 09:50:50,549 - root - INFO - roll False
2023-07-25 09:50:50,549 - root - INFO - num_blocks 8
2023-07-25 09:50:50,550 - root - INFO - nettype afno
2023-07-25 09:50:50,550 - root - INFO - patch_size 8
2023-07-25 09:50:50,550 - root - INFO - width 56
2023-07-25 09:50:50,550 - root - INFO - modes 32
2023-07-25 09:50:50,550 - root - INFO - target T2m
2023-07-25 09:50:50,550 - root - INFO - normalization zscore
2023-07-25 09:50:50,550 - root - INFO - log_to_screen True
2023-07-25 09:50:50,550 - root - INFO - save_checkpoint True
2023-07-25 09:50:50,550 - root - INFO - enable_nhwc False
2023-07-25 09:50:50,550 - root - INFO - optimizer_type FusedAdam
2023-07-25 09:50:50,550 - root - INFO - crop_size_x None
2023-07-25 09:50:50,550 - root - INFO - crop_size_y None
2023-07-25 09:50:50,550 - root - INFO - two_step_training False
2023-07-25 09:50:50,550 - root - INFO - plot_animations False
2023-07-25 09:50:50,550 - root - INFO - add_noise False
2023-07-25 09:50:50,550 - root - INFO - noise_std 0
2023-07-25 09:50:50,550 - root - INFO - world_size 1
2023-07-25 09:50:50,550 - root - INFO - interp 0
2023-07-25 09:50:50,550 - root - INFO - use_daily_climatology False
2023-07-25 09:50:50,550 - root - INFO - global_batch_size 64
2023-07-25 09:50:50,550 - root - INFO - ablate V850
2023-07-25 09:50:50,551 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 09:50:50,551 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 09:50:50,551 - root - INFO - resuming False
2023-07-25 09:50:50,551 - root - INFO - local_rank 0
2023-07-25 09:50:50,551 - root - INFO - ---------------------------------------------------
2023-07-25 09:50:50,551 - root - INFO - Inference for 1 initial conditions
2023-07-25 09:50:50,870 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 09:50:50,871 - root - INFO - Number of samples per year: 1460
2023-07-25 09:50:50,871 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 09:50:50,872 - root - INFO - Delta t: 6 hours
2023-07-25 09:50:50,872 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 09:50:50,872 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 09:52:03,600 - root - INFO - Loading inference data
2023-07-25 09:52:03,602 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 09:52:03,818 - root - INFO - Initial condition 1 of 1
2023-07-25 09:52:04,642 - root - INFO - Extracting valid data from the first year
2023-07-25 09:54:28,836 - root - INFO - Standardizing data
2023-07-25 09:54:36,675 - root - INFO - Loading time means
2023-07-25 09:54:50,102 - root - INFO - Begin autoregressive inference
2023-07-25 09:55:01,507 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 09:55:12,930 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 0.7965891361236572, ACC: 0.9965296387672424
2023-07-25 09:55:23,799 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 0.9173351526260376, ACC: 0.9952300786972046
2023-07-25 09:55:33,817 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 0.9659328460693359, ACC: 0.994641125202179
2023-07-25 09:55:44,732 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 0.9997291564941406, ACC: 0.9946905970573425
2023-07-25 09:55:55,153 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 1.0637578964233398, ACC: 0.9937390089035034
2023-07-25 09:56:06,280 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 1.1116113662719727, ACC: 0.9927240014076233
2023-07-25 09:56:17,408 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 1.1421207189559937, ACC: 0.992259681224823
2023-07-25 09:56:28,382 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 1.1884549856185913, ACC: 0.9923741817474365
2023-07-25 09:56:39,111 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 1.2495607137680054, ACC: 0.9912959337234497
2023-07-25 09:56:50,163 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 1.3230133056640625, ACC: 0.9898318648338318
2023-07-25 09:57:01,561 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 1.3611695766448975, ACC: 0.9894394874572754
2023-07-25 09:57:13,011 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 1.408601999282837, ACC: 0.9898290634155273
2023-07-25 09:57:24,263 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 1.4680789709091187, ACC: 0.9885157942771912
2023-07-25 09:57:34,298 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 1.5401957035064697, ACC: 0.9868345260620117
2023-07-25 09:57:45,126 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 1.5580390691757202, ACC: 0.9867275953292847
2023-07-25 09:57:56,294 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 1.6593295335769653, ACC: 0.9861782789230347
2023-07-25 09:58:06,989 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 1.703796148300171, ACC: 0.9847480058670044
2023-07-25 09:58:18,412 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 1.7602232694625854, ACC: 0.9825091361999512
2023-07-25 09:58:29,254 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 1.8519116640090942, ACC: 0.980813205242157
2023-07-25 09:58:40,789 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 1.9671673774719238, ACC: 0.9802160263061523
2023-07-25 09:58:51,114 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 1.9967193603515625, ACC: 0.9784300327301025
2023-07-25 09:59:03,284 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 2.0376014709472656, ACC: 0.9759998321533203
2023-07-25 09:59:14,270 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 2.052072286605835, ACC: 0.9755919575691223
2023-07-25 09:59:24,352 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 2.117828369140625, ACC: 0.9763050675392151
2023-07-25 09:59:35,317 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 2.1444365978240967, ACC: 0.9741531610488892
2023-07-25 09:59:46,559 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 2.197178840637207, ACC: 0.9711952209472656
2023-07-25 09:59:57,604 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 2.314997673034668, ACC: 0.9691467881202698
2023-07-25 10:00:10,612 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 2.454038143157959, ACC: 0.9681462049484253
2023-07-25 10:00:22,680 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 2.4984757900238037, ACC: 0.9642700552940369
2023-07-25 10:00:22,781 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-V850_30-timesteps_vis.h5
2023-07-25 10:01:16,116 - root - INFO - ------------------ Configuration ------------------
2023-07-25 10:01:16,116 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 10:01:16,116 - root - INFO - Configuration name: afno_backbone
2023-07-25 10:01:16,116 - root - INFO - log_to_wandb True
2023-07-25 10:01:16,116 - root - INFO - lr 0.0005
2023-07-25 10:01:16,116 - root - INFO - batch_size 64
2023-07-25 10:01:16,116 - root - INFO - max_epochs 150
2023-07-25 10:01:16,116 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 10:01:16,116 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 10:01:16,116 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 10:01:16,116 - root - INFO - orography False
2023-07-25 10:01:16,116 - root - INFO - orography_path None
2023-07-25 10:01:16,116 - root - INFO - exp_dir FourCastNet/results
2023-07-25 10:01:16,116 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 10:01:16,116 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 10:01:16,116 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 10:01:16,117 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 10:01:16,117 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 10:01:16,117 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 10:01:16,117 - root - INFO - loss l2
2023-07-25 10:01:16,117 - root - INFO - num_data_workers 4
2023-07-25 10:01:16,117 - root - INFO - dt 1
2023-07-25 10:01:16,117 - root - INFO - n_history 0
2023-07-25 10:01:16,117 - root - INFO - prediction_type iterative
2023-07-25 10:01:16,117 - root - INFO - prediction_length 30
2023-07-25 10:01:16,117 - root - INFO - n_initial_conditions 5
2023-07-25 10:01:16,117 - root - INFO - ics_type default
2023-07-25 10:01:16,117 - root - INFO - save_raw_forecasts True
2023-07-25 10:01:16,117 - root - INFO - save_channel False
2023-07-25 10:01:16,117 - root - INFO - masked_acc False
2023-07-25 10:01:16,117 - root - INFO - maskpath None
2023-07-25 10:01:16,117 - root - INFO - perturb False
2023-07-25 10:01:16,117 - root - INFO - add_grid False
2023-07-25 10:01:16,117 - root - INFO - N_grid_channels 0
2023-07-25 10:01:16,117 - root - INFO - gridtype sinusoidal
2023-07-25 10:01:16,117 - root - INFO - roll False
2023-07-25 10:01:16,117 - root - INFO - num_blocks 8
2023-07-25 10:01:16,118 - root - INFO - nettype afno
2023-07-25 10:01:16,118 - root - INFO - patch_size 8
2023-07-25 10:01:16,118 - root - INFO - width 56
2023-07-25 10:01:16,118 - root - INFO - modes 32
2023-07-25 10:01:16,118 - root - INFO - target T2m
2023-07-25 10:01:16,118 - root - INFO - normalization zscore
2023-07-25 10:01:16,118 - root - INFO - log_to_screen True
2023-07-25 10:01:16,118 - root - INFO - save_checkpoint True
2023-07-25 10:01:16,118 - root - INFO - enable_nhwc False
2023-07-25 10:01:16,118 - root - INFO - optimizer_type FusedAdam
2023-07-25 10:01:16,118 - root - INFO - crop_size_x None
2023-07-25 10:01:16,118 - root - INFO - crop_size_y None
2023-07-25 10:01:16,118 - root - INFO - two_step_training False
2023-07-25 10:01:16,118 - root - INFO - plot_animations False
2023-07-25 10:01:16,118 - root - INFO - add_noise False
2023-07-25 10:01:16,118 - root - INFO - noise_std 0
2023-07-25 10:01:16,118 - root - INFO - world_size 1
2023-07-25 10:01:16,118 - root - INFO - interp 0
2023-07-25 10:01:16,118 - root - INFO - use_daily_climatology False
2023-07-25 10:01:16,118 - root - INFO - global_batch_size 64
2023-07-25 10:01:16,118 - root - INFO - ablate Z850
2023-07-25 10:01:16,118 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 10:01:16,118 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 10:01:16,118 - root - INFO - resuming False
2023-07-25 10:01:16,118 - root - INFO - local_rank 0
2023-07-25 10:01:16,118 - root - INFO - ---------------------------------------------------
2023-07-25 10:01:16,119 - root - INFO - Inference for 1 initial conditions
2023-07-25 10:01:16,391 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 10:01:16,392 - root - INFO - Number of samples per year: 1460
2023-07-25 10:01:16,392 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 10:01:16,392 - root - INFO - Delta t: 6 hours
2023-07-25 10:01:16,392 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 10:01:16,392 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 10:02:25,722 - root - INFO - Loading inference data
2023-07-25 10:02:25,723 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 10:02:25,935 - root - INFO - Initial condition 1 of 1
2023-07-25 10:02:26,804 - root - INFO - Extracting valid data from the first year
2023-07-25 10:05:00,244 - root - INFO - Standardizing data
2023-07-25 10:05:08,418 - root - INFO - Loading time means
2023-07-25 10:05:23,696 - root - INFO - Begin autoregressive inference
2023-07-25 10:05:36,336 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 10:05:47,549 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 69.18968200683594, ACC: 0.014190557412803173
2023-07-25 10:05:59,538 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 731.3707885742188, ACC: -0.09283676743507385
2023-07-25 10:06:11,461 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 1670.8709716796875, ACC: -0.15686263144016266
2023-07-25 10:06:22,769 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 2557.780517578125, ACC: -0.21419139206409454
2023-07-25 10:06:33,446 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 3281.24169921875, ACC: -0.20175158977508545
2023-07-25 10:06:45,453 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 3820.759033203125, ACC: -0.16327622532844543
2023-07-25 10:06:57,022 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 4212.6767578125, ACC: -0.1992298662662506
2023-07-25 10:07:08,166 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 4494.35009765625, ACC: -0.23910760879516602
2023-07-25 10:07:19,663 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 4692.34716796875, ACC: -0.22181937098503113
2023-07-25 10:07:30,877 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 4829.05908203125, ACC: -0.1796201914548874
2023-07-25 10:07:41,532 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 4923.02392578125, ACC: -0.20217417180538177
2023-07-25 10:07:53,237 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 4987.21630859375, ACC: -0.23826561868190765
2023-07-25 10:08:05,099 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 5030.29345703125, ACC: -0.21722549200057983
2023-07-25 10:08:16,708 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 5059.39111328125, ACC: -0.17563554644584656
2023-07-25 10:08:27,888 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 5079.87744140625, ACC: -0.20196431875228882
2023-07-25 10:08:39,015 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 5094.236328125, ACC: -0.2362399399280548
2023-07-25 10:08:50,314 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 5103.6484375, ACC: -0.2164175808429718
2023-07-25 10:09:00,972 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 5109.89892578125, ACC: -0.17274866998195648
2023-07-25 10:09:11,942 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 5114.86279296875, ACC: -0.19739143550395966
2023-07-25 10:09:23,363 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 5118.64990234375, ACC: -0.2346726506948471
2023-07-25 10:09:35,066 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 5120.7392578125, ACC: -0.21338601410388947
2023-07-25 10:09:45,483 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 5121.93505859375, ACC: -0.16922184824943542
2023-07-25 10:09:56,213 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 5123.39208984375, ACC: -0.198121577501297
2023-07-25 10:10:07,052 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 5124.703125, ACC: -0.23608918488025665
2023-07-25 10:10:17,790 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 5125.0400390625, ACC: -0.2142573744058609
2023-07-25 10:10:27,796 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 5124.943359375, ACC: -0.16290654242038727
2023-07-25 10:10:38,689 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 5125.560546875, ACC: -0.19356103241443634
2023-07-25 10:10:49,703 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 5126.25537109375, ACC: -0.2332359105348587
2023-07-25 10:10:59,682 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 5126.111328125, ACC: -0.2097690999507904
2023-07-25 10:10:59,777 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-Z850_30-timesteps_vis.h5
2023-07-25 10:11:53,031 - root - INFO - ------------------ Configuration ------------------
2023-07-25 10:11:53,031 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 10:11:53,031 - root - INFO - Configuration name: afno_backbone
2023-07-25 10:11:53,031 - root - INFO - log_to_wandb True
2023-07-25 10:11:53,031 - root - INFO - lr 0.0005
2023-07-25 10:11:53,031 - root - INFO - batch_size 64
2023-07-25 10:11:53,031 - root - INFO - max_epochs 150
2023-07-25 10:11:53,031 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 10:11:53,031 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 10:11:53,031 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 10:11:53,031 - root - INFO - orography False
2023-07-25 10:11:53,031 - root - INFO - orography_path None
2023-07-25 10:11:53,032 - root - INFO - exp_dir FourCastNet/results
2023-07-25 10:11:53,032 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 10:11:53,032 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 10:11:53,032 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 10:11:53,032 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 10:11:53,032 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 10:11:53,032 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 10:11:53,032 - root - INFO - loss l2
2023-07-25 10:11:53,032 - root - INFO - num_data_workers 4
2023-07-25 10:11:53,032 - root - INFO - dt 1
2023-07-25 10:11:53,032 - root - INFO - n_history 0
2023-07-25 10:11:53,032 - root - INFO - prediction_type iterative
2023-07-25 10:11:53,032 - root - INFO - prediction_length 30
2023-07-25 10:11:53,032 - root - INFO - n_initial_conditions 5
2023-07-25 10:11:53,032 - root - INFO - ics_type default
2023-07-25 10:11:53,032 - root - INFO - save_raw_forecasts True
2023-07-25 10:11:53,032 - root - INFO - save_channel False
2023-07-25 10:11:53,032 - root - INFO - masked_acc False
2023-07-25 10:11:53,032 - root - INFO - maskpath None
2023-07-25 10:11:53,032 - root - INFO - perturb False
2023-07-25 10:11:53,033 - root - INFO - add_grid False
2023-07-25 10:11:53,033 - root - INFO - N_grid_channels 0
2023-07-25 10:11:53,033 - root - INFO - gridtype sinusoidal
2023-07-25 10:11:53,033 - root - INFO - roll False
2023-07-25 10:11:53,033 - root - INFO - num_blocks 8
2023-07-25 10:11:53,033 - root - INFO - nettype afno
2023-07-25 10:11:53,033 - root - INFO - patch_size 8
2023-07-25 10:11:53,033 - root - INFO - width 56
2023-07-25 10:11:53,033 - root - INFO - modes 32
2023-07-25 10:11:53,033 - root - INFO - target T2m
2023-07-25 10:11:53,033 - root - INFO - normalization zscore
2023-07-25 10:11:53,033 - root - INFO - log_to_screen True
2023-07-25 10:11:53,033 - root - INFO - save_checkpoint True
2023-07-25 10:11:53,033 - root - INFO - enable_nhwc False
2023-07-25 10:11:53,033 - root - INFO - optimizer_type FusedAdam
2023-07-25 10:11:53,033 - root - INFO - crop_size_x None
2023-07-25 10:11:53,033 - root - INFO - crop_size_y None
2023-07-25 10:11:53,033 - root - INFO - two_step_training False
2023-07-25 10:11:53,033 - root - INFO - plot_animations False
2023-07-25 10:11:53,034 - root - INFO - add_noise False
2023-07-25 10:11:53,034 - root - INFO - noise_std 0
2023-07-25 10:11:53,034 - root - INFO - world_size 1
2023-07-25 10:11:53,034 - root - INFO - interp 0
2023-07-25 10:11:53,034 - root - INFO - use_daily_climatology False
2023-07-25 10:11:53,034 - root - INFO - global_batch_size 64
2023-07-25 10:11:53,034 - root - INFO - ablate RH850
2023-07-25 10:11:53,034 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 10:11:53,034 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 10:11:53,034 - root - INFO - resuming False
2023-07-25 10:11:53,034 - root - INFO - local_rank 0
2023-07-25 10:11:53,034 - root - INFO - ---------------------------------------------------
2023-07-25 10:11:53,034 - root - INFO - Inference for 1 initial conditions
2023-07-25 10:11:53,283 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 10:11:53,284 - root - INFO - Number of samples per year: 1460
2023-07-25 10:11:53,284 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 10:11:53,284 - root - INFO - Delta t: 6 hours
2023-07-25 10:11:53,285 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 10:11:53,285 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 10:13:07,053 - root - INFO - Loading inference data
2023-07-25 10:13:07,054 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 10:13:07,434 - root - INFO - Initial condition 1 of 1
2023-07-25 10:13:08,252 - root - INFO - Extracting valid data from the first year
2023-07-25 10:15:44,640 - root - INFO - Standardizing data
2023-07-25 10:15:53,109 - root - INFO - Loading time means
2023-07-25 10:16:09,306 - root - INFO - Begin autoregressive inference
2023-07-25 10:16:20,557 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 10:16:33,146 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 0.8309902548789978, ACC: 0.9963181018829346
2023-07-25 10:16:45,081 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 0.9611038565635681, ACC: 0.9948753714561462
2023-07-25 10:16:57,257 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 1.0435508489608765, ACC: 0.9938942790031433
2023-07-25 10:17:09,494 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 1.0821655988693237, ACC: 0.9939103722572327
2023-07-25 10:17:20,787 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 1.1507662534713745, ACC: 0.9927836060523987
2023-07-25 10:17:32,851 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 1.1786799430847168, ACC: 0.9918943643569946
2023-07-25 10:17:44,870 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 1.2233473062515259, ACC: 0.9912155270576477
2023-07-25 10:17:56,471 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 1.3209123611450195, ACC: 0.9906679391860962
2023-07-25 10:18:08,363 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 1.4327173233032227, ACC: 0.9886777400970459
2023-07-25 10:18:19,623 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 1.5660320520401, ACC: 0.9858586192131042
2023-07-25 10:18:30,823 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 1.6095921993255615, ACC: 0.985419511795044
2023-07-25 10:18:42,638 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 1.6974296569824219, ACC: 0.9853873252868652
2023-07-25 10:18:54,115 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 1.7359040975570679, ACC: 0.9841393828392029
2023-07-25 10:19:05,536 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 1.8020026683807373, ACC: 0.982138454914093
2023-07-25 10:19:17,635 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 1.807096242904663, ACC: 0.9823066592216492
2023-07-25 10:19:29,478 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 1.9039263725280762, ACC: 0.9818841814994812
2023-07-25 10:19:40,800 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 1.945037603378296, ACC: 0.9802300333976746
2023-07-25 10:19:52,700 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 2.022185802459717, ACC: 0.9768940210342407
2023-07-25 10:20:05,368 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 2.1514177322387695, ACC: 0.9739754796028137
2023-07-25 10:20:18,116 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 2.334301710128784, ACC: 0.9719866514205933
2023-07-25 10:20:29,693 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 2.418243885040283, ACC: 0.9681817293167114
2023-07-25 10:20:41,864 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 2.539377450942993, ACC: 0.9624905586242676
2023-07-25 10:20:53,546 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 2.6282243728637695, ACC: 0.9596657156944275
2023-07-25 10:21:05,210 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 2.770364284515381, ACC: 0.9589930772781372
2023-07-25 10:21:16,825 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 2.8703486919403076, ACC: 0.9530175924301147
2023-07-25 10:21:28,541 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 2.9889109134674072, ACC: 0.9457286596298218
2023-07-25 10:21:40,737 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 3.094543218612671, ACC: 0.9435047507286072
2023-07-25 10:21:52,938 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 3.2035813331604004, ACC: 0.9444528818130493
2023-07-25 10:22:05,462 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 3.2284748554229736, ACC: 0.9387539625167847
2023-07-25 10:22:05,561 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-RH850_30-timesteps_vis.h5
2023-07-25 10:22:59,061 - root - INFO - ------------------ Configuration ------------------
2023-07-25 10:22:59,061 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 10:22:59,061 - root - INFO - Configuration name: afno_backbone
2023-07-25 10:22:59,061 - root - INFO - log_to_wandb True
2023-07-25 10:22:59,061 - root - INFO - lr 0.0005
2023-07-25 10:22:59,061 - root - INFO - batch_size 64
2023-07-25 10:22:59,061 - root - INFO - max_epochs 150
2023-07-25 10:22:59,061 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 10:22:59,061 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 10:22:59,061 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 10:22:59,061 - root - INFO - orography False
2023-07-25 10:22:59,062 - root - INFO - orography_path None
2023-07-25 10:22:59,062 - root - INFO - exp_dir FourCastNet/results
2023-07-25 10:22:59,062 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 10:22:59,062 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 10:22:59,062 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 10:22:59,062 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 10:22:59,062 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 10:22:59,062 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 10:22:59,062 - root - INFO - loss l2
2023-07-25 10:22:59,062 - root - INFO - num_data_workers 4
2023-07-25 10:22:59,062 - root - INFO - dt 1
2023-07-25 10:22:59,062 - root - INFO - n_history 0
2023-07-25 10:22:59,062 - root - INFO - prediction_type iterative
2023-07-25 10:22:59,062 - root - INFO - prediction_length 30
2023-07-25 10:22:59,062 - root - INFO - n_initial_conditions 5
2023-07-25 10:22:59,062 - root - INFO - ics_type default
2023-07-25 10:22:59,062 - root - INFO - save_raw_forecasts True
2023-07-25 10:22:59,062 - root - INFO - save_channel False
2023-07-25 10:22:59,062 - root - INFO - masked_acc False
2023-07-25 10:22:59,062 - root - INFO - maskpath None
2023-07-25 10:22:59,062 - root - INFO - perturb False
2023-07-25 10:22:59,062 - root - INFO - add_grid False
2023-07-25 10:22:59,063 - root - INFO - N_grid_channels 0
2023-07-25 10:22:59,063 - root - INFO - gridtype sinusoidal
2023-07-25 10:22:59,063 - root - INFO - roll False
2023-07-25 10:22:59,063 - root - INFO - num_blocks 8
2023-07-25 10:22:59,063 - root - INFO - nettype afno
2023-07-25 10:22:59,063 - root - INFO - patch_size 8
2023-07-25 10:22:59,063 - root - INFO - width 56
2023-07-25 10:22:59,063 - root - INFO - modes 32
2023-07-25 10:22:59,063 - root - INFO - target T2m
2023-07-25 10:22:59,063 - root - INFO - normalization zscore
2023-07-25 10:22:59,064 - root - INFO - log_to_screen True
2023-07-25 10:22:59,064 - root - INFO - save_checkpoint True
2023-07-25 10:22:59,064 - root - INFO - enable_nhwc False
2023-07-25 10:22:59,064 - root - INFO - optimizer_type FusedAdam
2023-07-25 10:22:59,064 - root - INFO - crop_size_x None
2023-07-25 10:22:59,064 - root - INFO - crop_size_y None
2023-07-25 10:22:59,064 - root - INFO - two_step_training False
2023-07-25 10:22:59,064 - root - INFO - plot_animations False
2023-07-25 10:22:59,064 - root - INFO - add_noise False
2023-07-25 10:22:59,064 - root - INFO - noise_std 0
2023-07-25 10:22:59,064 - root - INFO - world_size 1
2023-07-25 10:22:59,064 - root - INFO - interp 0
2023-07-25 10:22:59,064 - root - INFO - use_daily_climatology False
2023-07-25 10:22:59,064 - root - INFO - global_batch_size 64
2023-07-25 10:22:59,064 - root - INFO - ablate T500
2023-07-25 10:22:59,065 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 10:22:59,065 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 10:22:59,065 - root - INFO - resuming False
2023-07-25 10:22:59,065 - root - INFO - local_rank 0
2023-07-25 10:22:59,065 - root - INFO - ---------------------------------------------------
2023-07-25 10:22:59,065 - root - INFO - Inference for 1 initial conditions
2023-07-25 10:22:59,343 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 10:22:59,344 - root - INFO - Number of samples per year: 1460
2023-07-25 10:22:59,344 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 10:22:59,344 - root - INFO - Delta t: 6 hours
2023-07-25 10:22:59,345 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 10:22:59,345 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 10:24:10,625 - root - INFO - Loading inference data
2023-07-25 10:24:10,626 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 10:24:10,876 - root - INFO - Initial condition 1 of 1
2023-07-25 10:24:11,816 - root - INFO - Extracting valid data from the first year
2023-07-25 10:26:40,559 - root - INFO - Standardizing data
2023-07-25 10:26:48,759 - root - INFO - Loading time means
2023-07-25 10:27:02,353 - root - INFO - Begin autoregressive inference
2023-07-25 10:27:13,899 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 10:27:24,693 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 0.779388964176178, ACC: 0.9966660737991333
2023-07-25 10:27:36,045 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 0.9062638878822327, ACC: 0.9953402280807495
2023-07-25 10:27:46,794 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 0.9757721424102783, ACC: 0.9945206046104431
2023-07-25 10:27:58,543 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 1.0265799760818481, ACC: 0.9943660497665405
2023-07-25 10:28:09,947 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 1.0754262208938599, ACC: 0.9935466647148132
2023-07-25 10:28:21,343 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 1.1186861991882324, ACC: 0.9926012754440308
2023-07-25 10:28:33,227 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 1.167849063873291, ACC: 0.9918595552444458
2023-07-25 10:28:45,491 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 1.2086070775985718, ACC: 0.9920560717582703
2023-07-25 10:28:56,573 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 1.271942138671875, ACC: 0.9909055233001709
2023-07-25 10:29:07,086 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 1.3400574922561646, ACC: 0.9894991517066956
2023-07-25 10:29:19,131 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 1.376514196395874, ACC: 0.9891369342803955
2023-07-25 10:29:30,333 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 1.4397437572479248, ACC: 0.9892808794975281
2023-07-25 10:29:40,957 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 1.4827646017074585, ACC: 0.9881682991981506
2023-07-25 10:29:51,769 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 1.537229061126709, ACC: 0.986771285533905
2023-07-25 10:30:03,341 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 1.5949773788452148, ACC: 0.9859806299209595
2023-07-25 10:30:15,841 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 1.7118638753890991, ACC: 0.9851744174957275
2023-07-25 10:30:28,553 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 1.7363104820251465, ACC: 0.9840559959411621
2023-07-25 10:30:40,471 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 1.8033620119094849, ACC: 0.9815874695777893
2023-07-25 10:30:52,128 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 1.924058437347412, ACC: 0.9792097806930542
2023-07-25 10:31:02,821 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 2.0576207637786865, ACC: 0.9782978892326355
2023-07-25 10:31:14,298 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 2.1065804958343506, ACC: 0.9759789109230042
2023-07-25 10:31:25,458 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 2.1776323318481445, ACC: 0.9725956916809082
2023-07-25 10:31:36,475 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 2.2147045135498047, ACC: 0.9716817736625671
2023-07-25 10:31:46,769 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 2.3158531188964844, ACC: 0.9717440605163574
2023-07-25 10:31:58,400 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 2.359461784362793, ACC: 0.968687891960144
2023-07-25 10:32:09,308 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 2.431504726409912, ACC: 0.9647642970085144
2023-07-25 10:32:20,322 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 2.504023313522339, ACC: 0.9639792442321777
2023-07-25 10:32:31,346 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 2.6164562702178955, ACC: 0.9638128280639648
2023-07-25 10:32:42,243 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 2.624530076980591, ACC: 0.960414469242096
2023-07-25 10:32:42,343 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-T500_30-timesteps_vis.h5
2023-07-25 10:33:35,992 - root - INFO - ------------------ Configuration ------------------
2023-07-25 10:33:35,992 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 10:33:35,992 - root - INFO - Configuration name: afno_backbone
2023-07-25 10:33:35,992 - root - INFO - log_to_wandb True
2023-07-25 10:33:35,992 - root - INFO - lr 0.0005
2023-07-25 10:33:35,992 - root - INFO - batch_size 64
2023-07-25 10:33:35,992 - root - INFO - max_epochs 150
2023-07-25 10:33:35,992 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 10:33:35,992 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 10:33:35,992 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 10:33:35,992 - root - INFO - orography False
2023-07-25 10:33:35,992 - root - INFO - orography_path None
2023-07-25 10:33:35,992 - root - INFO - exp_dir FourCastNet/results
2023-07-25 10:33:35,992 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 10:33:35,992 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 10:33:35,992 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 10:33:35,992 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 10:33:35,992 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 10:33:35,992 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 10:33:35,993 - root - INFO - loss l2
2023-07-25 10:33:35,993 - root - INFO - num_data_workers 4
2023-07-25 10:33:35,993 - root - INFO - dt 1
2023-07-25 10:33:35,993 - root - INFO - n_history 0
2023-07-25 10:33:35,993 - root - INFO - prediction_type iterative
2023-07-25 10:33:35,993 - root - INFO - prediction_length 30
2023-07-25 10:33:35,993 - root - INFO - n_initial_conditions 5
2023-07-25 10:33:35,993 - root - INFO - ics_type default
2023-07-25 10:33:35,993 - root - INFO - save_raw_forecasts True
2023-07-25 10:33:35,993 - root - INFO - save_channel False
2023-07-25 10:33:35,993 - root - INFO - masked_acc False
2023-07-25 10:33:35,993 - root - INFO - maskpath None
2023-07-25 10:33:35,993 - root - INFO - perturb False
2023-07-25 10:33:35,993 - root - INFO - add_grid False
2023-07-25 10:33:35,993 - root - INFO - N_grid_channels 0
2023-07-25 10:33:35,993 - root - INFO - gridtype sinusoidal
2023-07-25 10:33:35,993 - root - INFO - roll False
2023-07-25 10:33:35,993 - root - INFO - num_blocks 8
2023-07-25 10:33:35,993 - root - INFO - nettype afno
2023-07-25 10:33:35,993 - root - INFO - patch_size 8
2023-07-25 10:33:35,993 - root - INFO - width 56
2023-07-25 10:33:35,993 - root - INFO - modes 32
2023-07-25 10:33:35,993 - root - INFO - target T2m
2023-07-25 10:33:35,993 - root - INFO - normalization zscore
2023-07-25 10:33:35,993 - root - INFO - log_to_screen True
2023-07-25 10:33:35,993 - root - INFO - save_checkpoint True
2023-07-25 10:33:35,993 - root - INFO - enable_nhwc False
2023-07-25 10:33:35,993 - root - INFO - optimizer_type FusedAdam
2023-07-25 10:33:35,993 - root - INFO - crop_size_x None
2023-07-25 10:33:35,993 - root - INFO - crop_size_y None
2023-07-25 10:33:35,994 - root - INFO - two_step_training False
2023-07-25 10:33:35,994 - root - INFO - plot_animations False
2023-07-25 10:33:35,994 - root - INFO - add_noise False
2023-07-25 10:33:35,994 - root - INFO - noise_std 0
2023-07-25 10:33:35,994 - root - INFO - world_size 1
2023-07-25 10:33:35,994 - root - INFO - interp 0
2023-07-25 10:33:35,994 - root - INFO - use_daily_climatology False
2023-07-25 10:33:35,994 - root - INFO - global_batch_size 64
2023-07-25 10:33:35,994 - root - INFO - ablate U500
2023-07-25 10:33:35,994 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 10:33:35,994 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 10:33:35,994 - root - INFO - resuming False
2023-07-25 10:33:35,994 - root - INFO - local_rank 0
2023-07-25 10:33:35,994 - root - INFO - ---------------------------------------------------
2023-07-25 10:33:35,994 - root - INFO - Inference for 1 initial conditions
2023-07-25 10:33:36,303 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 10:33:36,304 - root - INFO - Number of samples per year: 1460
2023-07-25 10:33:36,304 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 10:33:36,304 - root - INFO - Delta t: 6 hours
2023-07-25 10:33:36,304 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 10:33:36,304 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 10:34:47,379 - root - INFO - Loading inference data
2023-07-25 10:34:47,380 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 10:34:47,611 - root - INFO - Initial condition 1 of 1
2023-07-25 10:34:48,513 - root - INFO - Extracting valid data from the first year
2023-07-25 10:37:16,850 - root - INFO - Standardizing data
2023-07-25 10:37:24,753 - root - INFO - Loading time means
2023-07-25 10:37:38,116 - root - INFO - Begin autoregressive inference
2023-07-25 10:37:48,438 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 10:37:59,717 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 101.47621154785156, ACC: 0.10946546494960785
2023-07-25 10:38:10,782 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 905.645263671875, ACC: -0.04893526807427406
2023-07-25 10:38:21,647 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 1960.2100830078125, ACC: -0.12228775024414062
2023-07-25 10:38:32,115 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 2872.28125, ACC: -0.1850222498178482
2023-07-25 10:38:43,027 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 3564.72900390625, ACC: -0.17587272822856903
2023-07-25 10:38:54,218 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 4051.843994140625, ACC: -0.13931706547737122
2023-07-25 10:39:04,798 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 4389.41162109375, ACC: -0.18013663589954376
2023-07-25 10:39:15,088 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 4623.353515625, ACC: -0.22511456906795502
2023-07-25 10:39:26,171 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 4784.26953125, ACC: -0.21190786361694336
2023-07-25 10:39:37,288 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 4893.8203125, ACC: -0.17198923230171204
2023-07-25 10:39:48,399 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 4968.4384765625, ACC: -0.19701477885246277
2023-07-25 10:39:59,039 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 5018.98388671875, ACC: -0.2348262071609497
2023-07-25 10:40:10,307 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 5052.49951171875, ACC: -0.21491214632987976
2023-07-25 10:40:20,625 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 5074.92578125, ACC: -0.17389868199825287
2023-07-25 10:40:31,171 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 5090.7705078125, ACC: -0.20076696574687958
2023-07-25 10:40:42,325 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 5101.89599609375, ACC: -0.2354060709476471
2023-07-25 10:40:53,677 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 5109.05224609375, ACC: -0.2158506065607071
2023-07-25 10:41:04,938 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 5113.72314453125, ACC: -0.17231832444667816
2023-07-25 10:41:15,338 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 5117.5771484375, ACC: -0.19709506630897522
2023-07-25 10:41:26,621 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 5120.58203125, ACC: -0.23446357250213623
2023-07-25 10:41:37,518 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 5122.1171875, ACC: -0.21324273943901062
2023-07-25 10:41:48,621 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 5122.92041015625, ACC: -0.1691141426563263
2023-07-25 10:41:59,510 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 5124.09716796875, ACC: -0.19804580509662628
2023-07-25 10:42:10,765 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 5125.20849609375, ACC: -0.23603412508964539
2023-07-25 10:42:21,877 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 5125.40283203125, ACC: -0.21421942114830017
2023-07-25 10:42:32,727 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 5125.2041015625, ACC: -0.16287724673748016
2023-07-25 10:42:42,616 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 5125.748046875, ACC: -0.1935400664806366
2023-07-25 10:42:53,389 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 5126.39013671875, ACC: -0.23322072625160217
2023-07-25 10:43:04,247 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 5126.2080078125, ACC: -0.2097584307193756
2023-07-25 10:43:04,337 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-U500_30-timesteps_vis.h5
2023-07-25 10:43:57,720 - root - INFO - ------------------ Configuration ------------------
2023-07-25 10:43:57,720 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 10:43:57,721 - root - INFO - Configuration name: afno_backbone
2023-07-25 10:43:57,721 - root - INFO - log_to_wandb True
2023-07-25 10:43:57,721 - root - INFO - lr 0.0005
2023-07-25 10:43:57,721 - root - INFO - batch_size 64
2023-07-25 10:43:57,721 - root - INFO - max_epochs 150
2023-07-25 10:43:57,721 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 10:43:57,721 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 10:43:57,721 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 10:43:57,721 - root - INFO - orography False
2023-07-25 10:43:57,721 - root - INFO - orography_path None
2023-07-25 10:43:57,721 - root - INFO - exp_dir FourCastNet/results
2023-07-25 10:43:57,721 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 10:43:57,721 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 10:43:57,721 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 10:43:57,721 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 10:43:57,721 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 10:43:57,721 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 10:43:57,721 - root - INFO - loss l2
2023-07-25 10:43:57,721 - root - INFO - num_data_workers 4
2023-07-25 10:43:57,721 - root - INFO - dt 1
2023-07-25 10:43:57,722 - root - INFO - n_history 0
2023-07-25 10:43:57,722 - root - INFO - prediction_type iterative
2023-07-25 10:43:57,722 - root - INFO - prediction_length 30
2023-07-25 10:43:57,722 - root - INFO - n_initial_conditions 5
2023-07-25 10:43:57,722 - root - INFO - ics_type default
2023-07-25 10:43:57,722 - root - INFO - save_raw_forecasts True
2023-07-25 10:43:57,722 - root - INFO - save_channel False
2023-07-25 10:43:57,722 - root - INFO - masked_acc False
2023-07-25 10:43:57,722 - root - INFO - maskpath None
2023-07-25 10:43:57,722 - root - INFO - perturb False
2023-07-25 10:43:57,722 - root - INFO - add_grid False
2023-07-25 10:43:57,722 - root - INFO - N_grid_channels 0
2023-07-25 10:43:57,722 - root - INFO - gridtype sinusoidal
2023-07-25 10:43:57,722 - root - INFO - roll False
2023-07-25 10:43:57,722 - root - INFO - num_blocks 8
2023-07-25 10:43:57,722 - root - INFO - nettype afno
2023-07-25 10:43:57,722 - root - INFO - patch_size 8
2023-07-25 10:43:57,722 - root - INFO - width 56
2023-07-25 10:43:57,722 - root - INFO - modes 32
2023-07-25 10:43:57,722 - root - INFO - target T2m
2023-07-25 10:43:57,722 - root - INFO - normalization zscore
2023-07-25 10:43:57,722 - root - INFO - log_to_screen True
2023-07-25 10:43:57,722 - root - INFO - save_checkpoint True
2023-07-25 10:43:57,722 - root - INFO - enable_nhwc False
2023-07-25 10:43:57,722 - root - INFO - optimizer_type FusedAdam
2023-07-25 10:43:57,722 - root - INFO - crop_size_x None
2023-07-25 10:43:57,722 - root - INFO - crop_size_y None
2023-07-25 10:43:57,722 - root - INFO - two_step_training False
2023-07-25 10:43:57,722 - root - INFO - plot_animations False
2023-07-25 10:43:57,723 - root - INFO - add_noise False
2023-07-25 10:43:57,723 - root - INFO - noise_std 0
2023-07-25 10:43:57,723 - root - INFO - world_size 1
2023-07-25 10:43:57,723 - root - INFO - interp 0
2023-07-25 10:43:57,723 - root - INFO - use_daily_climatology False
2023-07-25 10:43:57,723 - root - INFO - global_batch_size 64
2023-07-25 10:43:57,723 - root - INFO - ablate V500
2023-07-25 10:43:57,723 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 10:43:57,723 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 10:43:57,723 - root - INFO - resuming False
2023-07-25 10:43:57,723 - root - INFO - local_rank 0
2023-07-25 10:43:57,723 - root - INFO - ---------------------------------------------------
2023-07-25 10:43:57,723 - root - INFO - Inference for 1 initial conditions
2023-07-25 10:43:57,968 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 10:43:57,969 - root - INFO - Number of samples per year: 1460
2023-07-25 10:43:57,969 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 10:43:57,969 - root - INFO - Delta t: 6 hours
2023-07-25 10:43:57,969 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 10:43:57,970 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 10:44:59,950 - root - INFO - Loading inference data
2023-07-25 10:44:59,951 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 10:45:00,113 - root - INFO - Initial condition 1 of 1
2023-07-25 10:45:00,940 - root - INFO - Extracting valid data from the first year
2023-07-25 10:47:14,421 - root - INFO - Standardizing data
2023-07-25 10:47:22,610 - root - INFO - Loading time means
2023-07-25 10:47:35,919 - root - INFO - Begin autoregressive inference
2023-07-25 10:47:46,488 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 10:47:57,121 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 537.2086791992188, ACC: -0.31311923265457153
2023-07-25 10:48:08,504 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 1462.9285888671875, ACC: -0.2547449469566345
2023-07-25 10:48:19,441 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 2406.783935546875, ACC: -0.25797826051712036
2023-07-25 10:48:29,633 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 3192.82275390625, ACC: -0.27836722135543823
2023-07-25 10:48:39,685 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 3778.34130859375, ACC: -0.24095724523067474
2023-07-25 10:48:50,170 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 4193.2607421875, ACC: -0.18416690826416016
2023-07-25 10:49:01,093 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 4482.0087890625, ACC: -0.21099910140037537
2023-07-25 10:49:13,047 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 4680.51318359375, ACC: -0.24336837232112885
2023-07-25 10:49:23,417 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 4815.56396484375, ACC: -0.22071929275989532
2023-07-25 10:49:33,223 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 4907.724609375, ACC: -0.17552119493484497
2023-07-25 10:49:43,835 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 4971.708984375, ACC: -0.19817420840263367
2023-07-25 10:49:54,075 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 5016.83447265625, ACC: -0.23562423884868622
2023-07-25 10:50:04,776 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 5049.06884765625, ACC: -0.21543031930923462
2023-07-25 10:50:16,021 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 5072.07177734375, ACC: -0.1743212193250656
2023-07-25 10:50:26,236 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 5088.83740234375, ACC: -0.2013741433620453
2023-07-25 10:50:36,774 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 5100.705078125, ACC: -0.23598268628120422
2023-07-25 10:50:46,592 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 5108.361328125, ACC: -0.21627876162528992
2023-07-25 10:50:58,313 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 5113.34619140625, ACC: -0.1726253181695938
2023-07-25 10:51:09,438 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 5117.3876953125, ACC: -0.19735956192016602
2023-07-25 10:51:20,059 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 5120.4990234375, ACC: -0.23467089235782623
2023-07-25 10:51:29,981 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 5122.09228515625, ACC: -0.2133895605802536
2023-07-25 10:51:40,698 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 5122.923828125, ACC: -0.16921564936637878
2023-07-25 10:51:52,528 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 5124.11328125, ACC: -0.19812697172164917
2023-07-25 10:52:03,899 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 5125.228515625, ACC: -0.2360956072807312
2023-07-25 10:52:14,308 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 5125.421875, ACC: -0.21426327526569366
2023-07-25 10:52:24,390 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 5125.220703125, ACC: -0.1629084348678589
2023-07-25 10:52:33,819 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 5125.76220703125, ACC: -0.19356490671634674
2023-07-25 10:52:44,385 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 5126.4013671875, ACC: -0.2332395315170288
2023-07-25 10:52:55,073 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 5126.216796875, ACC: -0.20977210998535156
2023-07-25 10:52:55,158 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-V500_30-timesteps_vis.h5
2023-07-25 10:53:48,287 - root - INFO - ------------------ Configuration ------------------
2023-07-25 10:53:48,287 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 10:53:48,287 - root - INFO - Configuration name: afno_backbone
2023-07-25 10:53:48,287 - root - INFO - log_to_wandb True
2023-07-25 10:53:48,287 - root - INFO - lr 0.0005
2023-07-25 10:53:48,287 - root - INFO - batch_size 64
2023-07-25 10:53:48,287 - root - INFO - max_epochs 150
2023-07-25 10:53:48,287 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 10:53:48,287 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 10:53:48,287 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 10:53:48,287 - root - INFO - orography False
2023-07-25 10:53:48,287 - root - INFO - orography_path None
2023-07-25 10:53:48,287 - root - INFO - exp_dir FourCastNet/results
2023-07-25 10:53:48,287 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 10:53:48,288 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 10:53:48,288 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 10:53:48,288 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 10:53:48,288 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 10:53:48,288 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 10:53:48,288 - root - INFO - loss l2
2023-07-25 10:53:48,288 - root - INFO - num_data_workers 4
2023-07-25 10:53:48,288 - root - INFO - dt 1
2023-07-25 10:53:48,288 - root - INFO - n_history 0
2023-07-25 10:53:48,288 - root - INFO - prediction_type iterative
2023-07-25 10:53:48,288 - root - INFO - prediction_length 30
2023-07-25 10:53:48,288 - root - INFO - n_initial_conditions 5
2023-07-25 10:53:48,288 - root - INFO - ics_type default
2023-07-25 10:53:48,288 - root - INFO - save_raw_forecasts True
2023-07-25 10:53:48,288 - root - INFO - save_channel False
2023-07-25 10:53:48,288 - root - INFO - masked_acc False
2023-07-25 10:53:48,288 - root - INFO - maskpath None
2023-07-25 10:53:48,288 - root - INFO - perturb False
2023-07-25 10:53:48,288 - root - INFO - add_grid False
2023-07-25 10:53:48,288 - root - INFO - N_grid_channels 0
2023-07-25 10:53:48,288 - root - INFO - gridtype sinusoidal
2023-07-25 10:53:48,288 - root - INFO - roll False
2023-07-25 10:53:48,288 - root - INFO - num_blocks 8
2023-07-25 10:53:48,288 - root - INFO - nettype afno
2023-07-25 10:53:48,288 - root - INFO - patch_size 8
2023-07-25 10:53:48,289 - root - INFO - width 56
2023-07-25 10:53:48,289 - root - INFO - modes 32
2023-07-25 10:53:48,289 - root - INFO - target T2m
2023-07-25 10:53:48,289 - root - INFO - normalization zscore
2023-07-25 10:53:48,289 - root - INFO - log_to_screen True
2023-07-25 10:53:48,289 - root - INFO - save_checkpoint True
2023-07-25 10:53:48,289 - root - INFO - enable_nhwc False
2023-07-25 10:53:48,289 - root - INFO - optimizer_type FusedAdam
2023-07-25 10:53:48,289 - root - INFO - crop_size_x None
2023-07-25 10:53:48,289 - root - INFO - crop_size_y None
2023-07-25 10:53:48,289 - root - INFO - two_step_training False
2023-07-25 10:53:48,289 - root - INFO - plot_animations False
2023-07-25 10:53:48,289 - root - INFO - add_noise False
2023-07-25 10:53:48,289 - root - INFO - noise_std 0
2023-07-25 10:53:48,289 - root - INFO - world_size 1
2023-07-25 10:53:48,289 - root - INFO - interp 0
2023-07-25 10:53:48,289 - root - INFO - use_daily_climatology False
2023-07-25 10:53:48,289 - root - INFO - global_batch_size 64
2023-07-25 10:53:48,289 - root - INFO - ablate Z500
2023-07-25 10:53:48,289 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 10:53:48,289 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 10:53:48,289 - root - INFO - resuming False
2023-07-25 10:53:48,289 - root - INFO - local_rank 0
2023-07-25 10:53:48,289 - root - INFO - ---------------------------------------------------
2023-07-25 10:53:48,289 - root - INFO - Inference for 1 initial conditions
2023-07-25 10:53:48,538 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 10:53:48,539 - root - INFO - Number of samples per year: 1460
2023-07-25 10:53:48,539 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 10:53:48,539 - root - INFO - Delta t: 6 hours
2023-07-25 10:53:48,539 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 10:53:48,539 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 10:54:51,856 - root - INFO - Loading inference data
2023-07-25 10:54:51,858 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 10:54:52,084 - root - INFO - Initial condition 1 of 1
2023-07-25 10:54:52,952 - root - INFO - Extracting valid data from the first year
2023-07-25 10:57:06,658 - root - INFO - Standardizing data
2023-07-25 10:57:14,674 - root - INFO - Loading time means
2023-07-25 10:57:25,640 - root - INFO - Begin autoregressive inference
2023-07-25 10:57:36,767 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 10:57:47,648 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 0.8076149821281433, ACC: 0.9965729713439941
2023-07-25 10:57:59,026 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 0.9822613596916199, ACC: 0.9948763251304626
2023-07-25 10:58:10,390 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 1.0551159381866455, ACC: 0.9943861365318298
2023-07-25 10:58:21,384 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 1.146068811416626, ACC: 0.9941396117210388
2023-07-25 10:58:32,403 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 1.2560131549835205, ACC: 0.9930213689804077
2023-07-25 10:58:43,133 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 1.3093435764312744, ACC: 0.9915939569473267
2023-07-25 10:58:53,890 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 1.3941819667816162, ACC: 0.9903563261032104
2023-07-25 10:59:04,827 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 1.4726053476333618, ACC: 0.9901800155639648
2023-07-25 10:59:16,351 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 1.5653917789459229, ACC: 0.9890775680541992
2023-07-25 10:59:26,968 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 1.6368755102157593, ACC: 0.9871507883071899
2023-07-25 10:59:38,624 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 1.7043904066085815, ACC: 0.9862673878669739
2023-07-25 10:59:50,059 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 1.8267648220062256, ACC: 0.9856327772140503
2023-07-25 11:00:01,595 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 1.9045368432998657, ACC: 0.9841496348381042
2023-07-25 11:00:13,428 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 2.016188383102417, ACC: 0.9807149767875671
2023-07-25 11:00:24,587 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 2.1397323608398438, ACC: 0.978229820728302
2023-07-25 11:00:36,531 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 2.256056547164917, ACC: 0.9772843718528748
2023-07-25 11:00:47,779 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 2.2623047828674316, ACC: 0.9763138294219971
2023-07-25 11:00:58,728 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 2.328653335571289, ACC: 0.97207111120224
2023-07-25 11:01:09,919 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 2.4363675117492676, ACC: 0.9691462516784668
2023-07-25 11:01:20,765 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 2.5259175300598145, ACC: 0.9692172408103943
2023-07-25 11:01:31,728 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 2.613820791244507, ACC: 0.9647794961929321
2023-07-25 11:01:42,539 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 2.6811046600341797, ACC: 0.9597656726837158
2023-07-25 11:01:53,430 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 2.6833317279815674, ACC: 0.9582508206367493
2023-07-25 11:02:04,274 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 2.7615957260131836, ACC: 0.9594704508781433
2023-07-25 11:02:14,987 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 2.9320907592773438, ACC: 0.9514789581298828
2023-07-25 11:02:25,691 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 3.041689157485962, ACC: 0.9435635209083557
2023-07-25 11:02:35,820 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 3.0810275077819824, ACC: 0.9432513117790222
2023-07-25 11:02:46,034 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 3.156259298324585, ACC: 0.9456270933151245
2023-07-25 11:02:56,049 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 3.2005982398986816, ACC: 0.9393250346183777
2023-07-25 11:02:56,146 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-Z500_30-timesteps_vis.h5
2023-07-25 11:03:49,159 - root - INFO - ------------------ Configuration ------------------
2023-07-25 11:03:49,159 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 11:03:49,159 - root - INFO - Configuration name: afno_backbone
2023-07-25 11:03:49,159 - root - INFO - log_to_wandb True
2023-07-25 11:03:49,159 - root - INFO - lr 0.0005
2023-07-25 11:03:49,159 - root - INFO - batch_size 64
2023-07-25 11:03:49,159 - root - INFO - max_epochs 150
2023-07-25 11:03:49,159 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 11:03:49,159 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 11:03:49,159 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 11:03:49,159 - root - INFO - orography False
2023-07-25 11:03:49,160 - root - INFO - orography_path None
2023-07-25 11:03:49,160 - root - INFO - exp_dir FourCastNet/results
2023-07-25 11:03:49,160 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 11:03:49,160 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 11:03:49,160 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 11:03:49,160 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 11:03:49,160 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 11:03:49,160 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 11:03:49,160 - root - INFO - loss l2
2023-07-25 11:03:49,160 - root - INFO - num_data_workers 4
2023-07-25 11:03:49,160 - root - INFO - dt 1
2023-07-25 11:03:49,160 - root - INFO - n_history 0
2023-07-25 11:03:49,160 - root - INFO - prediction_type iterative
2023-07-25 11:03:49,160 - root - INFO - prediction_length 30
2023-07-25 11:03:49,160 - root - INFO - n_initial_conditions 5
2023-07-25 11:03:49,160 - root - INFO - ics_type default
2023-07-25 11:03:49,160 - root - INFO - save_raw_forecasts True
2023-07-25 11:03:49,160 - root - INFO - save_channel False
2023-07-25 11:03:49,161 - root - INFO - masked_acc False
2023-07-25 11:03:49,161 - root - INFO - maskpath None
2023-07-25 11:03:49,161 - root - INFO - perturb False
2023-07-25 11:03:49,161 - root - INFO - add_grid False
2023-07-25 11:03:49,161 - root - INFO - N_grid_channels 0
2023-07-25 11:03:49,161 - root - INFO - gridtype sinusoidal
2023-07-25 11:03:49,161 - root - INFO - roll False
2023-07-25 11:03:49,161 - root - INFO - num_blocks 8
2023-07-25 11:03:49,161 - root - INFO - nettype afno
2023-07-25 11:03:49,161 - root - INFO - patch_size 8
2023-07-25 11:03:49,161 - root - INFO - width 56
2023-07-25 11:03:49,161 - root - INFO - modes 32
2023-07-25 11:03:49,161 - root - INFO - target T2m
2023-07-25 11:03:49,161 - root - INFO - normalization zscore
2023-07-25 11:03:49,161 - root - INFO - log_to_screen True
2023-07-25 11:03:49,161 - root - INFO - save_checkpoint True
2023-07-25 11:03:49,161 - root - INFO - enable_nhwc False
2023-07-25 11:03:49,161 - root - INFO - optimizer_type FusedAdam
2023-07-25 11:03:49,161 - root - INFO - crop_size_x None
2023-07-25 11:03:49,162 - root - INFO - crop_size_y None
2023-07-25 11:03:49,162 - root - INFO - two_step_training False
2023-07-25 11:03:49,162 - root - INFO - plot_animations False
2023-07-25 11:03:49,162 - root - INFO - add_noise False
2023-07-25 11:03:49,162 - root - INFO - noise_std 0
2023-07-25 11:03:49,162 - root - INFO - world_size 1
2023-07-25 11:03:49,162 - root - INFO - interp 0
2023-07-25 11:03:49,162 - root - INFO - use_daily_climatology False
2023-07-25 11:03:49,162 - root - INFO - global_batch_size 64
2023-07-25 11:03:49,162 - root - INFO - ablate RH500
2023-07-25 11:03:49,162 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 11:03:49,162 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 11:03:49,162 - root - INFO - resuming False
2023-07-25 11:03:49,162 - root - INFO - local_rank 0
2023-07-25 11:03:49,162 - root - INFO - ---------------------------------------------------
2023-07-25 11:03:49,162 - root - INFO - Inference for 1 initial conditions
2023-07-25 11:03:49,386 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 11:03:49,386 - root - INFO - Number of samples per year: 1460
2023-07-25 11:03:49,387 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 11:03:49,387 - root - INFO - Delta t: 6 hours
2023-07-25 11:03:49,387 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 11:03:49,387 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 11:04:54,569 - root - INFO - Loading inference data
2023-07-25 11:04:54,570 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 11:04:54,805 - root - INFO - Initial condition 1 of 1
2023-07-25 11:04:55,772 - root - INFO - Extracting valid data from the first year
2023-07-25 11:07:16,657 - root - INFO - Standardizing data
2023-07-25 11:07:24,486 - root - INFO - Loading time means
2023-07-25 11:07:38,529 - root - INFO - Begin autoregressive inference
2023-07-25 11:07:49,617 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 11:08:01,219 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 0.7588375806808472, ACC: 0.9968413710594177
2023-07-25 11:08:11,965 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 0.8790536522865295, ACC: 0.9956305623054504
2023-07-25 11:08:23,601 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 0.9429574012756348, ACC: 0.9949086308479309
2023-07-25 11:08:34,590 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 0.9915041327476501, ACC: 0.9948074221611023
2023-07-25 11:08:45,596 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 1.053689956665039, ACC: 0.9938742518424988
2023-07-25 11:08:56,031 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 1.0794042348861694, ACC: 0.9931662082672119
2023-07-25 11:09:07,016 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 1.1282024383544922, ACC: 0.9924748539924622
2023-07-25 11:09:17,446 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 1.1694368124008179, ACC: 0.9926511645317078
2023-07-25 11:09:27,921 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 1.201744556427002, ACC: 0.9919703006744385
2023-07-25 11:09:38,845 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 1.2667279243469238, ACC: 0.9906907677650452
2023-07-25 11:09:49,680 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 1.3134779930114746, ACC: 0.9902018904685974
2023-07-25 11:10:00,458 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 1.3748300075531006, ACC: 0.9903929233551025
2023-07-25 11:10:11,034 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 1.4332163333892822, ACC: 0.9891117811203003
2023-07-25 11:10:21,052 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 1.5079803466796875, ACC: 0.987406849861145
2023-07-25 11:10:31,906 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 1.5523738861083984, ACC: 0.9868810772895813
2023-07-25 11:10:42,519 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 1.6248613595962524, ACC: 0.9868360757827759
2023-07-25 11:10:53,613 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 1.662528157234192, ACC: 0.9855085015296936
2023-07-25 11:11:04,909 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 1.7206170558929443, ACC: 0.9832763671875
2023-07-25 11:11:15,802 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 1.8252397775650024, ACC: 0.9813567996025085
2023-07-25 11:11:25,829 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 1.9418792724609375, ACC: 0.9807375073432922
2023-07-25 11:11:36,729 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 2.002216339111328, ACC: 0.9783024787902832
2023-07-25 11:11:46,770 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 2.1126625537872314, ACC: 0.974177896976471
2023-07-25 11:11:57,367 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 2.1746606826782227, ACC: 0.9725472927093506
2023-07-25 11:12:08,771 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 2.3023526668548584, ACC: 0.9718869924545288
2023-07-25 11:12:19,108 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 2.397669792175293, ACC: 0.9675701260566711
2023-07-25 11:12:29,343 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 2.531242847442627, ACC: 0.9616681337356567
2023-07-25 11:12:39,901 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 2.608358383178711, ACC: 0.9605985283851624
2023-07-25 11:12:51,055 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 2.7516496181488037, ACC: 0.9596277475357056
2023-07-25 11:13:01,746 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 2.826528310775757, ACC: 0.9541208744049072
2023-07-25 11:13:01,837 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-RH500_30-timesteps_vis.h5
2023-07-25 11:13:55,381 - root - INFO - ------------------ Configuration ------------------
2023-07-25 11:13:55,381 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 11:13:55,381 - root - INFO - Configuration name: afno_backbone
2023-07-25 11:13:55,381 - root - INFO - log_to_wandb True
2023-07-25 11:13:55,381 - root - INFO - lr 0.0005
2023-07-25 11:13:55,381 - root - INFO - batch_size 64
2023-07-25 11:13:55,381 - root - INFO - max_epochs 150
2023-07-25 11:13:55,381 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 11:13:55,381 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 11:13:55,381 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 11:13:55,381 - root - INFO - orography False
2023-07-25 11:13:55,381 - root - INFO - orography_path None
2023-07-25 11:13:55,381 - root - INFO - exp_dir FourCastNet/results
2023-07-25 11:13:55,381 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 11:13:55,381 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 11:13:55,381 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 11:13:55,381 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 11:13:55,381 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 11:13:55,381 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 11:13:55,381 - root - INFO - loss l2
2023-07-25 11:13:55,381 - root - INFO - num_data_workers 4
2023-07-25 11:13:55,381 - root - INFO - dt 1
2023-07-25 11:13:55,382 - root - INFO - n_history 0
2023-07-25 11:13:55,382 - root - INFO - prediction_type iterative
2023-07-25 11:13:55,382 - root - INFO - prediction_length 30
2023-07-25 11:13:55,382 - root - INFO - n_initial_conditions 5
2023-07-25 11:13:55,382 - root - INFO - ics_type default
2023-07-25 11:13:55,382 - root - INFO - save_raw_forecasts True
2023-07-25 11:13:55,382 - root - INFO - save_channel False
2023-07-25 11:13:55,382 - root - INFO - masked_acc False
2023-07-25 11:13:55,382 - root - INFO - maskpath None
2023-07-25 11:13:55,382 - root - INFO - perturb False
2023-07-25 11:13:55,382 - root - INFO - add_grid False
2023-07-25 11:13:55,382 - root - INFO - N_grid_channels 0
2023-07-25 11:13:55,382 - root - INFO - gridtype sinusoidal
2023-07-25 11:13:55,382 - root - INFO - roll False
2023-07-25 11:13:55,382 - root - INFO - num_blocks 8
2023-07-25 11:13:55,382 - root - INFO - nettype afno
2023-07-25 11:13:55,382 - root - INFO - patch_size 8
2023-07-25 11:13:55,382 - root - INFO - width 56
2023-07-25 11:13:55,382 - root - INFO - modes 32
2023-07-25 11:13:55,382 - root - INFO - target T2m
2023-07-25 11:13:55,382 - root - INFO - normalization zscore
2023-07-25 11:13:55,382 - root - INFO - log_to_screen True
2023-07-25 11:13:55,382 - root - INFO - save_checkpoint True
2023-07-25 11:13:55,382 - root - INFO - enable_nhwc False
2023-07-25 11:13:55,382 - root - INFO - optimizer_type FusedAdam
2023-07-25 11:13:55,382 - root - INFO - crop_size_x None
2023-07-25 11:13:55,382 - root - INFO - crop_size_y None
2023-07-25 11:13:55,382 - root - INFO - two_step_training False
2023-07-25 11:13:55,382 - root - INFO - plot_animations False
2023-07-25 11:13:55,383 - root - INFO - add_noise False
2023-07-25 11:13:55,383 - root - INFO - noise_std 0
2023-07-25 11:13:55,383 - root - INFO - world_size 1
2023-07-25 11:13:55,383 - root - INFO - interp 0
2023-07-25 11:13:55,383 - root - INFO - use_daily_climatology False
2023-07-25 11:13:55,383 - root - INFO - global_batch_size 64
2023-07-25 11:13:55,383 - root - INFO - ablate Z50
2023-07-25 11:13:55,383 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 11:13:55,383 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 11:13:55,383 - root - INFO - resuming False
2023-07-25 11:13:55,383 - root - INFO - local_rank 0
2023-07-25 11:13:55,383 - root - INFO - ---------------------------------------------------
2023-07-25 11:13:55,383 - root - INFO - Inference for 1 initial conditions
2023-07-25 11:13:55,718 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 11:13:55,719 - root - INFO - Number of samples per year: 1460
2023-07-25 11:13:55,719 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 11:13:55,719 - root - INFO - Delta t: 6 hours
2023-07-25 11:13:55,719 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 11:13:55,719 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 11:15:04,831 - root - INFO - Loading inference data
2023-07-25 11:15:04,832 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 11:15:05,065 - root - INFO - Initial condition 1 of 1
2023-07-25 11:15:05,804 - root - INFO - Extracting valid data from the first year
2023-07-25 11:17:31,314 - root - INFO - Standardizing data
2023-07-25 11:17:39,602 - root - INFO - Loading time means
2023-07-25 11:17:52,773 - root - INFO - Begin autoregressive inference
2023-07-25 11:18:03,446 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 11:18:15,418 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 0.882129967212677, ACC: 0.9957635998725891
2023-07-25 11:18:26,507 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 0.9506196975708008, ACC: 0.9949191808700562
2023-07-25 11:18:36,850 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 1.0239590406417847, ACC: 0.9939929842948914
2023-07-25 11:18:47,292 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 1.0653142929077148, ACC: 0.9939756393432617
2023-07-25 11:18:58,421 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 1.100250244140625, ACC: 0.9932968020439148
2023-07-25 11:19:09,644 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 1.133157730102539, ACC: 0.9924595952033997
2023-07-25 11:19:19,936 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 1.1865177154541016, ACC: 0.9916202425956726
2023-07-25 11:19:30,557 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 1.2334245443344116, ACC: 0.9917428493499756
2023-07-25 11:19:40,860 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 1.2489821910858154, ACC: 0.9912467002868652
2023-07-25 11:19:51,437 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 1.3251533508300781, ACC: 0.9897566437721252
2023-07-25 11:20:02,568 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 1.3743940591812134, ACC: 0.9891795516014099
2023-07-25 11:20:14,062 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 1.4339852333068848, ACC: 0.9893695116043091
2023-07-25 11:20:25,463 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 1.4637458324432373, ACC: 0.9884750843048096
2023-07-25 11:20:36,331 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 1.5333735942840576, ACC: 0.9868655204772949
2023-07-25 11:20:47,864 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 1.5650659799575806, ACC: 0.9865249395370483
2023-07-25 11:20:58,853 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 1.6444288492202759, ACC: 0.9863415360450745
2023-07-25 11:21:09,326 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 1.6493643522262573, ACC: 0.9856337308883667
2023-07-25 11:21:19,789 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 1.7175451517105103, ACC: 0.9833042621612549
2023-07-25 11:21:31,177 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 1.8020192384719849, ACC: 0.9817862510681152
2023-07-25 11:21:40,996 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 1.929398775100708, ACC: 0.9809352159500122
2023-07-25 11:21:51,776 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 1.9826728105545044, ACC: 0.9787557721138
2023-07-25 11:22:01,592 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 2.081160306930542, ACC: 0.9749988913536072
2023-07-25 11:22:12,947 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 2.119152069091797, ACC: 0.9741272926330566
2023-07-25 11:22:23,912 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 2.2272677421569824, ACC: 0.9739049077033997
2023-07-25 11:22:34,724 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 2.2874903678894043, ACC: 0.9706904292106628
2023-07-25 11:22:44,507 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 2.3905177116394043, ACC: 0.9658681154251099
2023-07-25 11:22:54,625 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 2.5300495624542236, ACC: 0.9630985260009766
2023-07-25 11:23:04,783 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 2.7210569381713867, ACC: 0.9607843160629272
2023-07-25 11:23:15,243 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 2.8067333698272705, ACC: 0.9549139142036438
2023-07-25 11:23:15,342 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-Z50_30-timesteps_vis.h5
2023-07-25 11:24:08,856 - root - INFO - ------------------ Configuration ------------------
2023-07-25 11:24:08,856 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 11:24:08,857 - root - INFO - Configuration name: afno_backbone
2023-07-25 11:24:08,857 - root - INFO - log_to_wandb True
2023-07-25 11:24:08,857 - root - INFO - lr 0.0005
2023-07-25 11:24:08,857 - root - INFO - batch_size 64
2023-07-25 11:24:08,858 - root - INFO - max_epochs 150
2023-07-25 11:24:08,858 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 11:24:08,858 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 11:24:08,858 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 11:24:08,858 - root - INFO - orography False
2023-07-25 11:24:08,858 - root - INFO - orography_path None
2023-07-25 11:24:08,859 - root - INFO - exp_dir FourCastNet/results
2023-07-25 11:24:08,859 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 11:24:08,859 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 11:24:08,859 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 11:24:08,860 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 11:24:08,860 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 11:24:08,860 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 11:24:08,860 - root - INFO - loss l2
2023-07-25 11:24:08,860 - root - INFO - num_data_workers 4
2023-07-25 11:24:08,861 - root - INFO - dt 1
2023-07-25 11:24:08,861 - root - INFO - n_history 0
2023-07-25 11:24:08,861 - root - INFO - prediction_type iterative
2023-07-25 11:24:08,861 - root - INFO - prediction_length 30
2023-07-25 11:24:08,861 - root - INFO - n_initial_conditions 5
2023-07-25 11:24:08,861 - root - INFO - ics_type default
2023-07-25 11:24:08,861 - root - INFO - save_raw_forecasts True
2023-07-25 11:24:08,862 - root - INFO - save_channel False
2023-07-25 11:24:08,862 - root - INFO - masked_acc False
2023-07-25 11:24:08,862 - root - INFO - maskpath None
2023-07-25 11:24:08,862 - root - INFO - perturb False
2023-07-25 11:24:08,862 - root - INFO - add_grid False
2023-07-25 11:24:08,862 - root - INFO - N_grid_channels 0
2023-07-25 11:24:08,862 - root - INFO - gridtype sinusoidal
2023-07-25 11:24:08,862 - root - INFO - roll False
2023-07-25 11:24:08,863 - root - INFO - num_blocks 8
2023-07-25 11:24:08,863 - root - INFO - nettype afno
2023-07-25 11:24:08,863 - root - INFO - patch_size 8
2023-07-25 11:24:08,863 - root - INFO - width 56
2023-07-25 11:24:08,863 - root - INFO - modes 32
2023-07-25 11:24:08,863 - root - INFO - target T2m
2023-07-25 11:24:08,863 - root - INFO - normalization zscore
2023-07-25 11:24:08,863 - root - INFO - log_to_screen True
2023-07-25 11:24:08,864 - root - INFO - save_checkpoint True
2023-07-25 11:24:08,864 - root - INFO - enable_nhwc False
2023-07-25 11:24:08,864 - root - INFO - optimizer_type FusedAdam
2023-07-25 11:24:08,864 - root - INFO - crop_size_x None
2023-07-25 11:24:08,864 - root - INFO - crop_size_y None
2023-07-25 11:24:08,864 - root - INFO - two_step_training False
2023-07-25 11:24:08,865 - root - INFO - plot_animations False
2023-07-25 11:24:08,865 - root - INFO - add_noise False
2023-07-25 11:24:08,865 - root - INFO - noise_std 0
2023-07-25 11:24:08,866 - root - INFO - world_size 1
2023-07-25 11:24:08,866 - root - INFO - interp 0
2023-07-25 11:24:08,867 - root - INFO - use_daily_climatology False
2023-07-25 11:24:08,867 - root - INFO - global_batch_size 64
2023-07-25 11:24:08,867 - root - INFO - ablate TCWV
2023-07-25 11:24:08,867 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 11:24:08,867 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 11:24:08,867 - root - INFO - resuming False
2023-07-25 11:24:08,867 - root - INFO - local_rank 0
2023-07-25 11:24:08,867 - root - INFO - ---------------------------------------------------
2023-07-25 11:24:08,867 - root - INFO - Inference for 1 initial conditions
2023-07-25 11:24:09,117 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 11:24:09,118 - root - INFO - Number of samples per year: 1460
2023-07-25 11:24:09,118 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 11:24:09,118 - root - INFO - Delta t: 6 hours
2023-07-25 11:24:09,118 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 11:24:09,119 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 11:25:12,946 - root - INFO - Loading inference data
2023-07-25 11:25:12,947 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 11:25:13,117 - root - INFO - Initial condition 1 of 1
2023-07-25 11:25:13,918 - root - INFO - Extracting valid data from the first year
2023-07-25 11:27:33,433 - root - INFO - Standardizing data
2023-07-25 11:27:41,308 - root - INFO - Loading time means
2023-07-25 11:27:55,918 - root - INFO - Begin autoregressive inference
2023-07-25 11:28:07,077 - root - INFO - Predicted timestep 0 of 30. T2m RMS Error: 0.0, ACC: 1.0
2023-07-25 11:28:17,124 - root - INFO - Predicted timestep 1 of 30. T2m RMS Error: 2.8637821674346924, ACC: 0.9545919299125671
2023-07-25 11:28:27,444 - root - INFO - Predicted timestep 2 of 30. T2m RMS Error: 22.252300262451172, ACC: 0.3952329158782959
2023-07-25 11:28:37,506 - root - INFO - Predicted timestep 3 of 30. T2m RMS Error: 110.97159576416016, ACC: 0.10753525048494339
2023-07-25 11:28:47,689 - root - INFO - Predicted timestep 4 of 30. T2m RMS Error: 200.68434143066406, ACC: 0.06799818575382233
2023-07-25 11:28:57,514 - root - INFO - Predicted timestep 5 of 30. T2m RMS Error: 271.0179748535156, ACC: 0.05713648721575737
2023-07-25 11:29:07,942 - root - INFO - Predicted timestep 6 of 30. T2m RMS Error: 322.7300109863281, ACC: 0.04783707857131958
2023-07-25 11:29:19,095 - root - INFO - Predicted timestep 7 of 30. T2m RMS Error: 361.84844970703125, ACC: 0.04590804502367973
2023-07-25 11:29:29,710 - root - INFO - Predicted timestep 8 of 30. T2m RMS Error: 394.37823486328125, ACC: 0.04474407434463501
2023-07-25 11:29:40,479 - root - INFO - Predicted timestep 9 of 30. T2m RMS Error: 425.6461486816406, ACC: 0.04645921662449837
2023-07-25 11:29:51,173 - root - INFO - Predicted timestep 10 of 30. T2m RMS Error: 459.38861083984375, ACC: 0.03828063979744911
2023-07-25 11:30:01,342 - root - INFO - Predicted timestep 11 of 30. T2m RMS Error: 495.64788818359375, ACC: 0.035246480256319046
2023-07-25 11:30:13,418 - root - INFO - Predicted timestep 12 of 30. T2m RMS Error: 533.3804321289062, ACC: 0.03206179663538933
2023-07-25 11:30:24,182 - root - INFO - Predicted timestep 13 of 30. T2m RMS Error: 571.3925170898438, ACC: 0.03393739089369774
2023-07-25 11:30:34,873 - root - INFO - Predicted timestep 14 of 30. T2m RMS Error: 610.7362670898438, ACC: 0.02270001731812954
2023-07-25 11:30:45,978 - root - INFO - Predicted timestep 15 of 30. T2m RMS Error: 651.8843994140625, ACC: 0.014977852813899517
2023-07-25 11:30:57,264 - root - INFO - Predicted timestep 16 of 30. T2m RMS Error: 695.301025390625, ACC: 0.0072164046578109264
2023-07-25 11:31:08,841 - root - INFO - Predicted timestep 17 of 30. T2m RMS Error: 741.7763061523438, ACC: 0.004589121788740158
2023-07-25 11:31:19,377 - root - INFO - Predicted timestep 18 of 30. T2m RMS Error: 791.4102783203125, ACC: -0.011627069674432278
2023-07-25 11:31:29,652 - root - INFO - Predicted timestep 19 of 30. T2m RMS Error: 844.5371704101562, ACC: -0.028095891699194908
2023-07-25 11:31:40,619 - root - INFO - Predicted timestep 20 of 30. T2m RMS Error: 902.0106201171875, ACC: -0.04627814143896103
2023-07-25 11:31:51,148 - root - INFO - Predicted timestep 21 of 30. T2m RMS Error: 967.9039916992188, ACC: -0.05710765719413757
2023-07-25 11:32:01,904 - root - INFO - Predicted timestep 22 of 30. T2m RMS Error: 1053.336181640625, ACC: -0.09409163147211075
2023-07-25 11:32:12,596 - root - INFO - Predicted timestep 23 of 30. T2m RMS Error: 1187.4893798828125, ACC: -0.1333034783601761
2023-07-25 11:32:23,132 - root - INFO - Predicted timestep 24 of 30. T2m RMS Error: 1461.8258056640625, ACC: -0.1833755373954773
2023-07-25 11:32:34,034 - root - INFO - Predicted timestep 25 of 30. T2m RMS Error: 1932.870849609375, ACC: -0.19675099849700928
2023-07-25 11:32:44,499 - root - INFO - Predicted timestep 26 of 30. T2m RMS Error: 2517.07373046875, ACC: -0.18161641061306
2023-07-25 11:32:55,205 - root - INFO - Predicted timestep 27 of 30. T2m RMS Error: 3099.9794921875, ACC: -0.20480433106422424
2023-07-25 11:33:05,772 - root - INFO - Predicted timestep 28 of 30. T2m RMS Error: 3606.595947265625, ACC: -0.23355495929718018
2023-07-25 11:33:15,737 - root - INFO - Predicted timestep 29 of 30. T2m RMS Error: 4014.250244140625, ACC: -0.2078457474708557
2023-07-25 11:33:15,831 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-T2m_ablate-TCWV_30-timesteps_vis.h5
2023-07-25 11:34:09,037 - root - INFO - ------------------ Configuration ------------------
2023-07-25 11:34:09,037 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 11:34:09,037 - root - INFO - Configuration name: afno_backbone
2023-07-25 11:34:09,037 - root - INFO - log_to_wandb True
2023-07-25 11:34:09,037 - root - INFO - lr 0.0005
2023-07-25 11:34:09,037 - root - INFO - batch_size 64
2023-07-25 11:34:09,037 - root - INFO - max_epochs 150
2023-07-25 11:34:09,037 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 11:34:09,037 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 11:34:09,037 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 11:34:09,037 - root - INFO - orography False
2023-07-25 11:34:09,037 - root - INFO - orography_path None
2023-07-25 11:34:09,037 - root - INFO - exp_dir FourCastNet/results
2023-07-25 11:34:09,037 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 11:34:09,038 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 11:34:09,038 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 11:34:09,038 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 11:34:09,038 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 11:34:09,038 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 11:34:09,038 - root - INFO - loss l2
2023-07-25 11:34:09,038 - root - INFO - num_data_workers 4
2023-07-25 11:34:09,038 - root - INFO - dt 1
2023-07-25 11:34:09,038 - root - INFO - n_history 0
2023-07-25 11:34:09,038 - root - INFO - prediction_type iterative
2023-07-25 11:34:09,038 - root - INFO - prediction_length 30
2023-07-25 11:34:09,038 - root - INFO - n_initial_conditions 5
2023-07-25 11:34:09,038 - root - INFO - ics_type default
2023-07-25 11:34:09,038 - root - INFO - save_raw_forecasts True
2023-07-25 11:34:09,038 - root - INFO - save_channel False
2023-07-25 11:34:09,038 - root - INFO - masked_acc False
2023-07-25 11:34:09,038 - root - INFO - maskpath None
2023-07-25 11:34:09,038 - root - INFO - perturb False
2023-07-25 11:34:09,039 - root - INFO - add_grid False
2023-07-25 11:34:09,039 - root - INFO - N_grid_channels 0
2023-07-25 11:34:09,039 - root - INFO - gridtype sinusoidal
2023-07-25 11:34:09,039 - root - INFO - roll False
2023-07-25 11:34:09,039 - root - INFO - num_blocks 8
2023-07-25 11:34:09,039 - root - INFO - nettype afno
2023-07-25 11:34:09,039 - root - INFO - patch_size 8
2023-07-25 11:34:09,039 - root - INFO - width 56
2023-07-25 11:34:09,039 - root - INFO - modes 32
2023-07-25 11:34:09,039 - root - INFO - target sp
2023-07-25 11:34:09,039 - root - INFO - normalization zscore
2023-07-25 11:34:09,039 - root - INFO - log_to_screen True
2023-07-25 11:34:09,039 - root - INFO - save_checkpoint True
2023-07-25 11:34:09,039 - root - INFO - enable_nhwc False
2023-07-25 11:34:09,040 - root - INFO - optimizer_type FusedAdam
2023-07-25 11:34:09,040 - root - INFO - crop_size_x None
2023-07-25 11:34:09,040 - root - INFO - crop_size_y None
2023-07-25 11:34:09,040 - root - INFO - two_step_training False
2023-07-25 11:34:09,040 - root - INFO - plot_animations False
2023-07-25 11:34:09,040 - root - INFO - add_noise False
2023-07-25 11:34:09,040 - root - INFO - noise_std 0
2023-07-25 11:34:09,040 - root - INFO - world_size 1
2023-07-25 11:34:09,040 - root - INFO - interp 0
2023-07-25 11:34:09,040 - root - INFO - use_daily_climatology False
2023-07-25 11:34:09,040 - root - INFO - global_batch_size 64
2023-07-25 11:34:09,040 - root - INFO - ablate U10
2023-07-25 11:34:09,040 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 11:34:09,040 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 11:34:09,040 - root - INFO - resuming False
2023-07-25 11:34:09,040 - root - INFO - local_rank 0
2023-07-25 11:34:09,040 - root - INFO - ---------------------------------------------------
2023-07-25 11:34:09,040 - root - INFO - Inference for 1 initial conditions
2023-07-25 11:34:09,348 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 11:34:09,349 - root - INFO - Number of samples per year: 1460
2023-07-25 11:34:09,350 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 11:34:09,350 - root - INFO - Delta t: 6 hours
2023-07-25 11:34:09,350 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 11:34:09,352 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 11:35:14,058 - root - INFO - Loading inference data
2023-07-25 11:35:14,059 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 11:35:14,364 - root - INFO - Initial condition 1 of 1
2023-07-25 11:35:15,232 - root - INFO - Extracting valid data from the first year
2023-07-25 11:37:35,238 - root - INFO - Standardizing data
2023-07-25 11:37:43,528 - root - INFO - Loading time means
2023-07-25 11:37:58,717 - root - INFO - Begin autoregressive inference
2023-07-25 11:38:09,820 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 11:38:20,979 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 513.7286987304688, ACC: 0.8439184427261353
2023-07-25 11:38:31,354 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 665.4561767578125, ACC: 0.7700660824775696
2023-07-25 11:38:42,411 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 2815.24951171875, ACC: 0.26680421829223633
2023-07-25 11:38:53,189 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 4514.94287109375, ACC: 0.16392353177070618
2023-07-25 11:39:04,575 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 5288.54248046875, ACC: 0.13580049574375153
2023-07-25 11:39:16,578 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 5603.0634765625, ACC: 0.12308421730995178
2023-07-25 11:39:27,139 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 5903.63232421875, ACC: 0.11715564876794815
2023-07-25 11:39:38,343 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 6292.8095703125, ACC: 0.11168809980154037
2023-07-25 11:39:48,770 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 6564.4873046875, ACC: 0.10300354659557343
2023-07-25 11:39:59,263 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 6993.39501953125, ACC: 0.08879827708005905
2023-07-25 11:40:10,602 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 7562.3603515625, ACC: 0.07163337618112564
2023-07-25 11:40:22,177 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 8139.49072265625, ACC: 0.05798869580030441
2023-07-25 11:40:32,113 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 8723.2509765625, ACC: 0.0464845634996891
2023-07-25 11:40:41,763 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 9298.4326171875, ACC: 0.03465155139565468
2023-07-25 11:40:52,073 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 9861.658203125, ACC: 0.023426542058587074
2023-07-25 11:41:02,131 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 10343.3525390625, ACC: 0.014047820121049881
2023-07-25 11:41:12,768 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 10964.66015625, ACC: 0.00034269544994458556
2023-07-25 11:41:23,001 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 11760.8740234375, ACC: -0.008873862214386463
2023-07-25 11:41:32,654 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 12561.55078125, ACC: -0.0191018208861351
2023-07-25 11:41:42,230 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 13213.9111328125, ACC: -0.019811006262898445
2023-07-25 11:41:52,405 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 13909.103515625, ACC: -0.02427530847489834
2023-07-25 11:42:02,686 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 14663.7353515625, ACC: -0.019844364374876022
2023-07-25 11:42:13,145 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 15493.525390625, ACC: -0.014215675182640553
2023-07-25 11:42:23,886 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 16319.8310546875, ACC: -0.00868863146752119
2023-07-25 11:42:34,297 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 17038.61328125, ACC: -0.00791337713599205
2023-07-25 11:42:45,017 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 18087.60546875, ACC: -0.002938853343948722
2023-07-25 11:42:54,634 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 19151.416015625, ACC: -0.0031493643764406443
2023-07-25 11:43:04,570 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 20154.1328125, ACC: -0.00509888818487525
2023-07-25 11:43:15,228 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 21119.869140625, ACC: -0.0022701381240040064
2023-07-25 11:43:15,339 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-U10_30-timesteps_vis.h5
2023-07-25 11:44:08,579 - root - INFO - ------------------ Configuration ------------------
2023-07-25 11:44:08,579 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 11:44:08,579 - root - INFO - Configuration name: afno_backbone
2023-07-25 11:44:08,579 - root - INFO - log_to_wandb True
2023-07-25 11:44:08,579 - root - INFO - lr 0.0005
2023-07-25 11:44:08,579 - root - INFO - batch_size 64
2023-07-25 11:44:08,579 - root - INFO - max_epochs 150
2023-07-25 11:44:08,579 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 11:44:08,580 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 11:44:08,580 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 11:44:08,580 - root - INFO - orography False
2023-07-25 11:44:08,580 - root - INFO - orography_path None
2023-07-25 11:44:08,580 - root - INFO - exp_dir FourCastNet/results
2023-07-25 11:44:08,580 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 11:44:08,580 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 11:44:08,580 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 11:44:08,580 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 11:44:08,580 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 11:44:08,580 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 11:44:08,580 - root - INFO - loss l2
2023-07-25 11:44:08,580 - root - INFO - num_data_workers 4
2023-07-25 11:44:08,580 - root - INFO - dt 1
2023-07-25 11:44:08,580 - root - INFO - n_history 0
2023-07-25 11:44:08,580 - root - INFO - prediction_type iterative
2023-07-25 11:44:08,581 - root - INFO - prediction_length 30
2023-07-25 11:44:08,581 - root - INFO - n_initial_conditions 5
2023-07-25 11:44:08,581 - root - INFO - ics_type default
2023-07-25 11:44:08,581 - root - INFO - save_raw_forecasts True
2023-07-25 11:44:08,581 - root - INFO - save_channel False
2023-07-25 11:44:08,581 - root - INFO - masked_acc False
2023-07-25 11:44:08,581 - root - INFO - maskpath None
2023-07-25 11:44:08,581 - root - INFO - perturb False
2023-07-25 11:44:08,581 - root - INFO - add_grid False
2023-07-25 11:44:08,581 - root - INFO - N_grid_channels 0
2023-07-25 11:44:08,581 - root - INFO - gridtype sinusoidal
2023-07-25 11:44:08,581 - root - INFO - roll False
2023-07-25 11:44:08,581 - root - INFO - num_blocks 8
2023-07-25 11:44:08,581 - root - INFO - nettype afno
2023-07-25 11:44:08,581 - root - INFO - patch_size 8
2023-07-25 11:44:08,581 - root - INFO - width 56
2023-07-25 11:44:08,581 - root - INFO - modes 32
2023-07-25 11:44:08,582 - root - INFO - target sp
2023-07-25 11:44:08,582 - root - INFO - normalization zscore
2023-07-25 11:44:08,582 - root - INFO - log_to_screen True
2023-07-25 11:44:08,582 - root - INFO - save_checkpoint True
2023-07-25 11:44:08,582 - root - INFO - enable_nhwc False
2023-07-25 11:44:08,582 - root - INFO - optimizer_type FusedAdam
2023-07-25 11:44:08,582 - root - INFO - crop_size_x None
2023-07-25 11:44:08,582 - root - INFO - crop_size_y None
2023-07-25 11:44:08,582 - root - INFO - two_step_training False
2023-07-25 11:44:08,582 - root - INFO - plot_animations False
2023-07-25 11:44:08,582 - root - INFO - add_noise False
2023-07-25 11:44:08,582 - root - INFO - noise_std 0
2023-07-25 11:44:08,582 - root - INFO - world_size 1
2023-07-25 11:44:08,582 - root - INFO - interp 0
2023-07-25 11:44:08,582 - root - INFO - use_daily_climatology False
2023-07-25 11:44:08,582 - root - INFO - global_batch_size 64
2023-07-25 11:44:08,582 - root - INFO - ablate V10
2023-07-25 11:44:08,583 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 11:44:08,583 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 11:44:08,583 - root - INFO - resuming False
2023-07-25 11:44:08,583 - root - INFO - local_rank 0
2023-07-25 11:44:08,583 - root - INFO - ---------------------------------------------------
2023-07-25 11:44:08,583 - root - INFO - Inference for 1 initial conditions
2023-07-25 11:44:08,788 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 11:44:08,793 - root - INFO - Number of samples per year: 1460
2023-07-25 11:44:08,793 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 11:44:08,793 - root - INFO - Delta t: 6 hours
2023-07-25 11:44:08,793 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 11:44:08,794 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 11:45:02,299 - root - INFO - Loading inference data
2023-07-25 11:45:02,301 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 11:45:02,538 - root - INFO - Initial condition 1 of 1
2023-07-25 11:45:03,401 - root - INFO - Extracting valid data from the first year
2023-07-25 11:47:01,292 - root - INFO - Standardizing data
2023-07-25 11:47:09,160 - root - INFO - Loading time means
2023-07-25 11:47:20,809 - root - INFO - Begin autoregressive inference
2023-07-25 11:47:32,047 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 11:47:42,540 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 177.18138122558594, ACC: 0.9762644171714783
2023-07-25 11:47:53,947 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 166.05328369140625, ACC: 0.978552520275116
2023-07-25 11:48:03,985 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 171.7635040283203, ACC: 0.977094829082489
2023-07-25 11:48:15,024 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 184.75140380859375, ACC: 0.9723851680755615
2023-07-25 11:48:25,506 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 198.1923828125, ACC: 0.9687521457672119
2023-07-25 11:48:35,922 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 213.1076202392578, ACC: 0.9638092517852783
2023-07-25 11:48:45,965 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 223.29554748535156, ACC: 0.9615716934204102
2023-07-25 11:48:56,281 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 234.63589477539062, ACC: 0.957306981086731
2023-07-25 11:49:06,664 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 246.10037231445312, ACC: 0.9549404978752136
2023-07-25 11:49:16,305 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 259.9363708496094, ACC: 0.9500595331192017
2023-07-25 11:49:26,309 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 271.79803466796875, ACC: 0.9458054304122925
2023-07-25 11:49:36,048 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 290.533935546875, ACC: 0.936942458152771
2023-07-25 11:49:46,443 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 314.8921203613281, ACC: 0.9262570738792419
2023-07-25 11:49:57,383 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 339.754638671875, ACC: 0.9130169749259949
2023-07-25 11:50:07,697 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 359.2442321777344, ACC: 0.9030637145042419
2023-07-25 11:50:18,165 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 381.90032958984375, ACC: 0.8895098567008972
2023-07-25 11:50:28,051 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 403.6506652832031, ACC: 0.8761752247810364
2023-07-25 11:50:39,194 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 424.1024169921875, ACC: 0.8594306707382202
2023-07-25 11:50:49,451 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 439.1044921875, ACC: 0.8450031280517578
2023-07-25 11:51:00,064 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 455.35589599609375, ACC: 0.8251606822013855
2023-07-25 11:51:10,735 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 472.36328125, ACC: 0.8090810775756836
2023-07-25 11:51:21,255 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 494.4344787597656, ACC: 0.7855099439620972
2023-07-25 11:51:31,603 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 514.2846069335938, ACC: 0.77078777551651
2023-07-25 11:51:41,891 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 537.9519653320312, ACC: 0.7464829683303833
2023-07-25 11:51:52,084 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 565.1127319335938, ACC: 0.7311089038848877
2023-07-25 11:52:02,111 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 592.2311401367188, ACC: 0.7073527574539185
2023-07-25 11:52:12,715 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 619.0350341796875, ACC: 0.689136266708374
2023-07-25 11:52:22,743 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 654.8651123046875, ACC: 0.660129725933075
2023-07-25 11:52:33,613 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 693.0391845703125, ACC: 0.6280400156974792
2023-07-25 11:52:33,710 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-V10_30-timesteps_vis.h5
2023-07-25 11:53:27,094 - root - INFO - ------------------ Configuration ------------------
2023-07-25 11:53:27,094 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 11:53:27,094 - root - INFO - Configuration name: afno_backbone
2023-07-25 11:53:27,094 - root - INFO - log_to_wandb True
2023-07-25 11:53:27,094 - root - INFO - lr 0.0005
2023-07-25 11:53:27,094 - root - INFO - batch_size 64
2023-07-25 11:53:27,094 - root - INFO - max_epochs 150
2023-07-25 11:53:27,094 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 11:53:27,095 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 11:53:27,095 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 11:53:27,095 - root - INFO - orography False
2023-07-25 11:53:27,095 - root - INFO - orography_path None
2023-07-25 11:53:27,095 - root - INFO - exp_dir FourCastNet/results
2023-07-25 11:53:27,095 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 11:53:27,095 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 11:53:27,095 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 11:53:27,095 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 11:53:27,095 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 11:53:27,095 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 11:53:27,095 - root - INFO - loss l2
2023-07-25 11:53:27,095 - root - INFO - num_data_workers 4
2023-07-25 11:53:27,095 - root - INFO - dt 1
2023-07-25 11:53:27,095 - root - INFO - n_history 0
2023-07-25 11:53:27,095 - root - INFO - prediction_type iterative
2023-07-25 11:53:27,096 - root - INFO - prediction_length 30
2023-07-25 11:53:27,096 - root - INFO - n_initial_conditions 5
2023-07-25 11:53:27,096 - root - INFO - ics_type default
2023-07-25 11:53:27,096 - root - INFO - save_raw_forecasts True
2023-07-25 11:53:27,096 - root - INFO - save_channel False
2023-07-25 11:53:27,096 - root - INFO - masked_acc False
2023-07-25 11:53:27,096 - root - INFO - maskpath None
2023-07-25 11:53:27,096 - root - INFO - perturb False
2023-07-25 11:53:27,096 - root - INFO - add_grid False
2023-07-25 11:53:27,096 - root - INFO - N_grid_channels 0
2023-07-25 11:53:27,096 - root - INFO - gridtype sinusoidal
2023-07-25 11:53:27,096 - root - INFO - roll False
2023-07-25 11:53:27,096 - root - INFO - num_blocks 8
2023-07-25 11:53:27,096 - root - INFO - nettype afno
2023-07-25 11:53:27,096 - root - INFO - patch_size 8
2023-07-25 11:53:27,096 - root - INFO - width 56
2023-07-25 11:53:27,096 - root - INFO - modes 32
2023-07-25 11:53:27,096 - root - INFO - target sp
2023-07-25 11:53:27,097 - root - INFO - normalization zscore
2023-07-25 11:53:27,097 - root - INFO - log_to_screen True
2023-07-25 11:53:27,097 - root - INFO - save_checkpoint True
2023-07-25 11:53:27,097 - root - INFO - enable_nhwc False
2023-07-25 11:53:27,097 - root - INFO - optimizer_type FusedAdam
2023-07-25 11:53:27,097 - root - INFO - crop_size_x None
2023-07-25 11:53:27,097 - root - INFO - crop_size_y None
2023-07-25 11:53:27,097 - root - INFO - two_step_training False
2023-07-25 11:53:27,097 - root - INFO - plot_animations False
2023-07-25 11:53:27,097 - root - INFO - add_noise False
2023-07-25 11:53:27,097 - root - INFO - noise_std 0
2023-07-25 11:53:27,097 - root - INFO - world_size 1
2023-07-25 11:53:27,097 - root - INFO - interp 0
2023-07-25 11:53:27,097 - root - INFO - use_daily_climatology False
2023-07-25 11:53:27,097 - root - INFO - global_batch_size 64
2023-07-25 11:53:27,097 - root - INFO - ablate T2m
2023-07-25 11:53:27,097 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 11:53:27,097 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 11:53:27,098 - root - INFO - resuming False
2023-07-25 11:53:27,098 - root - INFO - local_rank 0
2023-07-25 11:53:27,098 - root - INFO - ---------------------------------------------------
2023-07-25 11:53:27,098 - root - INFO - Inference for 1 initial conditions
2023-07-25 11:53:27,328 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 11:53:27,329 - root - INFO - Number of samples per year: 1460
2023-07-25 11:53:27,329 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 11:53:27,329 - root - INFO - Delta t: 6 hours
2023-07-25 11:53:27,329 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 11:53:27,330 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 11:54:19,148 - root - INFO - Loading inference data
2023-07-25 11:54:19,149 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 11:54:19,282 - root - INFO - Initial condition 1 of 1
2023-07-25 11:54:20,098 - root - INFO - Extracting valid data from the first year
2023-07-25 11:56:11,161 - root - INFO - Standardizing data
2023-07-25 11:56:19,267 - root - INFO - Loading time means
2023-07-25 11:56:29,854 - root - INFO - Begin autoregressive inference
2023-07-25 11:56:40,302 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 11:56:51,380 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 9977.328125, ACC: 0.1241004541516304
2023-07-25 11:57:03,240 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 53878.70703125, ACC: 0.13325801491737366
2023-07-25 11:57:14,317 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 93589.09375, ACC: 0.09359008073806763
2023-07-25 11:57:25,097 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 111741.7890625, ACC: 0.05292294919490814
2023-07-25 11:57:36,114 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 114196.2421875, ACC: 0.030264846980571747
2023-07-25 11:57:47,017 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 111266.4140625, ACC: 0.012695787474513054
2023-07-25 11:57:57,597 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 109450.9609375, ACC: 0.008417090401053429
2023-07-25 11:58:08,839 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 109606.5546875, ACC: 0.0073040262795984745
2023-07-25 11:58:20,201 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 110604.0625, ACC: 0.007842261344194412
2023-07-25 11:58:30,772 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 111732.7421875, ACC: 0.007646752521395683
2023-07-25 11:58:42,558 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 112799.2109375, ACC: 0.00786865595728159
2023-07-25 11:58:53,650 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 113741.2421875, ACC: 0.007014076691120863
2023-07-25 11:59:05,064 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 114521.625, ACC: 0.007207433693110943
2023-07-25 11:59:16,471 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 115140.1484375, ACC: 0.0062892846763134
2023-07-25 11:59:27,066 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 115613.515625, ACC: 0.005887315142899752
2023-07-25 11:59:37,824 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 115969.015625, ACC: 0.004459081217646599
2023-07-25 11:59:49,285 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 116230.7734375, ACC: 0.004089639987796545
2023-07-25 12:00:00,844 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 116423.125, ACC: 0.0024963757023215294
2023-07-25 12:00:12,683 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 116562.078125, ACC: 0.0022534732706844807
2023-07-25 12:00:25,273 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 116663.078125, ACC: 0.0014621742302551866
2023-07-25 12:00:37,137 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 116735.6171875, ACC: 0.0013623056001961231
2023-07-25 12:00:48,495 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 116788.28125, ACC: 0.000763016170822084
2023-07-25 12:00:59,235 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 116825.5546875, ACC: 0.0012416914105415344
2023-07-25 12:01:11,618 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 116852.6875, ACC: 0.0011455180356279016
2023-07-25 12:01:22,792 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 116871.3046875, ACC: 0.00241647707298398
2023-07-25 12:01:33,580 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 116885.078125, ACC: 0.002800375921651721
2023-07-25 12:01:44,404 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 116894.375, ACC: 0.0038262128364294767
2023-07-25 12:01:55,493 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 116901.9375, ACC: 0.0035541497636586428
2023-07-25 12:02:07,465 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 116906.3359375, ACC: 0.0045863487757742405
2023-07-25 12:02:07,556 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-T2m_30-timesteps_vis.h5
2023-07-25 12:03:00,796 - root - INFO - ------------------ Configuration ------------------
2023-07-25 12:03:00,797 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 12:03:00,797 - root - INFO - Configuration name: afno_backbone
2023-07-25 12:03:00,797 - root - INFO - log_to_wandb True
2023-07-25 12:03:00,797 - root - INFO - lr 0.0005
2023-07-25 12:03:00,797 - root - INFO - batch_size 64
2023-07-25 12:03:00,797 - root - INFO - max_epochs 150
2023-07-25 12:03:00,797 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 12:03:00,797 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 12:03:00,797 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 12:03:00,797 - root - INFO - orography False
2023-07-25 12:03:00,797 - root - INFO - orography_path None
2023-07-25 12:03:00,797 - root - INFO - exp_dir FourCastNet/results
2023-07-25 12:03:00,797 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 12:03:00,797 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 12:03:00,798 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 12:03:00,798 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 12:03:00,798 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 12:03:00,798 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 12:03:00,798 - root - INFO - loss l2
2023-07-25 12:03:00,798 - root - INFO - num_data_workers 4
2023-07-25 12:03:00,798 - root - INFO - dt 1
2023-07-25 12:03:00,798 - root - INFO - n_history 0
2023-07-25 12:03:00,798 - root - INFO - prediction_type iterative
2023-07-25 12:03:00,798 - root - INFO - prediction_length 30
2023-07-25 12:03:00,798 - root - INFO - n_initial_conditions 5
2023-07-25 12:03:00,798 - root - INFO - ics_type default
2023-07-25 12:03:00,798 - root - INFO - save_raw_forecasts True
2023-07-25 12:03:00,798 - root - INFO - save_channel False
2023-07-25 12:03:00,798 - root - INFO - masked_acc False
2023-07-25 12:03:00,798 - root - INFO - maskpath None
2023-07-25 12:03:00,798 - root - INFO - perturb False
2023-07-25 12:03:00,799 - root - INFO - add_grid False
2023-07-25 12:03:00,799 - root - INFO - N_grid_channels 0
2023-07-25 12:03:00,799 - root - INFO - gridtype sinusoidal
2023-07-25 12:03:00,799 - root - INFO - roll False
2023-07-25 12:03:00,799 - root - INFO - num_blocks 8
2023-07-25 12:03:00,799 - root - INFO - nettype afno
2023-07-25 12:03:00,799 - root - INFO - patch_size 8
2023-07-25 12:03:00,799 - root - INFO - width 56
2023-07-25 12:03:00,799 - root - INFO - modes 32
2023-07-25 12:03:00,799 - root - INFO - target sp
2023-07-25 12:03:00,799 - root - INFO - normalization zscore
2023-07-25 12:03:00,799 - root - INFO - log_to_screen True
2023-07-25 12:03:00,799 - root - INFO - save_checkpoint True
2023-07-25 12:03:00,800 - root - INFO - enable_nhwc False
2023-07-25 12:03:00,800 - root - INFO - optimizer_type FusedAdam
2023-07-25 12:03:00,800 - root - INFO - crop_size_x None
2023-07-25 12:03:00,800 - root - INFO - crop_size_y None
2023-07-25 12:03:00,800 - root - INFO - two_step_training False
2023-07-25 12:03:00,800 - root - INFO - plot_animations False
2023-07-25 12:03:00,800 - root - INFO - add_noise False
2023-07-25 12:03:00,800 - root - INFO - noise_std 0
2023-07-25 12:03:00,800 - root - INFO - world_size 1
2023-07-25 12:03:00,800 - root - INFO - interp 0
2023-07-25 12:03:00,800 - root - INFO - use_daily_climatology False
2023-07-25 12:03:00,800 - root - INFO - global_batch_size 64
2023-07-25 12:03:00,801 - root - INFO - ablate mslp
2023-07-25 12:03:00,801 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 12:03:00,801 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 12:03:00,801 - root - INFO - resuming False
2023-07-25 12:03:00,801 - root - INFO - local_rank 0
2023-07-25 12:03:00,801 - root - INFO - ---------------------------------------------------
2023-07-25 12:03:00,801 - root - INFO - Inference for 1 initial conditions
2023-07-25 12:03:01,137 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 12:03:01,138 - root - INFO - Number of samples per year: 1460
2023-07-25 12:03:01,138 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 12:03:01,138 - root - INFO - Delta t: 6 hours
2023-07-25 12:03:01,138 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 12:03:01,139 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 12:04:03,548 - root - INFO - Loading inference data
2023-07-25 12:04:03,548 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 12:04:03,823 - root - INFO - Initial condition 1 of 1
2023-07-25 12:04:04,770 - root - INFO - Extracting valid data from the first year
2023-07-25 12:06:17,456 - root - INFO - Standardizing data
2023-07-25 12:06:25,630 - root - INFO - Loading time means
2023-07-25 12:06:38,720 - root - INFO - Begin autoregressive inference
2023-07-25 12:06:49,965 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 12:07:02,658 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 1284.0721435546875, ACC: 0.5257362723350525
2023-07-25 12:07:14,278 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 6747.59033203125, ACC: 0.3015631139278412
2023-07-25 12:07:26,318 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 13990.2421875, ACC: 0.2752556800842285
2023-07-25 12:07:38,104 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 17247.595703125, ACC: 0.2582368552684784
2023-07-25 12:07:49,551 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 18009.818359375, ACC: 0.23426900804042816
2023-07-25 12:08:01,469 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 18312.048828125, ACC: 0.20964503288269043
2023-07-25 12:08:12,785 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 19073.568359375, ACC: 0.18300072848796844
2023-07-25 12:08:24,249 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 20205.203125, ACC: 0.16101016104221344
2023-07-25 12:08:35,283 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 21440.267578125, ACC: 0.14459194242954254
2023-07-25 12:08:46,568 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 22658.626953125, ACC: 0.13346967101097107
2023-07-25 12:08:57,165 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 23777.189453125, ACC: 0.12106283009052277
2023-07-25 12:09:07,899 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 24895.859375, ACC: 0.10480285435914993
2023-07-25 12:09:18,930 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 26179.861328125, ACC: 0.0912046879529953
2023-07-25 12:09:29,952 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 27463.66796875, ACC: 0.08133744448423386
2023-07-25 12:09:41,124 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 28795.48046875, ACC: 0.06749100983142853
2023-07-25 12:09:52,047 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 30437.27734375, ACC: 0.0559304840862751
2023-07-25 12:10:02,185 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 32532.912109375, ACC: 0.04659029096364975
2023-07-25 12:10:12,994 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 35012.8203125, ACC: 0.043831463903188705
2023-07-25 12:10:23,614 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 38033.90625, ACC: 0.034641921520233154
2023-07-25 12:10:35,042 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 41577.1484375, ACC: 0.026492420583963394
2023-07-25 12:10:44,915 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 47866.12890625, ACC: -0.0025921675842255354
2023-07-25 12:10:55,457 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 62041.64453125, ACC: -0.004987528081983328
2023-07-25 12:11:06,469 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 80940.8203125, ACC: -0.017327751964330673
2023-07-25 12:11:16,644 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 95438.2421875, ACC: 0.0013116950867697597
2023-07-25 12:11:26,988 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 103097.40625, ACC: 0.00394074060022831
2023-07-25 12:11:38,332 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 105606.6328125, ACC: 0.0070880078710615635
2023-07-25 12:11:49,040 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 106575.1640625, ACC: 0.008367275819182396
2023-07-25 12:12:00,638 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 108002.8359375, ACC: 0.009561260230839252
2023-07-25 12:12:11,843 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 109873.5859375, ACC: 0.010157227516174316
2023-07-25 12:12:11,929 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-mslp_30-timesteps_vis.h5
2023-07-25 12:13:05,146 - root - INFO - ------------------ Configuration ------------------
2023-07-25 12:13:05,146 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 12:13:05,146 - root - INFO - Configuration name: afno_backbone
2023-07-25 12:13:05,146 - root - INFO - log_to_wandb True
2023-07-25 12:13:05,146 - root - INFO - lr 0.0005
2023-07-25 12:13:05,147 - root - INFO - batch_size 64
2023-07-25 12:13:05,147 - root - INFO - max_epochs 150
2023-07-25 12:13:05,147 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 12:13:05,147 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 12:13:05,147 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 12:13:05,147 - root - INFO - orography False
2023-07-25 12:13:05,147 - root - INFO - orography_path None
2023-07-25 12:13:05,147 - root - INFO - exp_dir FourCastNet/results
2023-07-25 12:13:05,147 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 12:13:05,147 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 12:13:05,147 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 12:13:05,147 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 12:13:05,147 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 12:13:05,147 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 12:13:05,147 - root - INFO - loss l2
2023-07-25 12:13:05,147 - root - INFO - num_data_workers 4
2023-07-25 12:13:05,147 - root - INFO - dt 1
2023-07-25 12:13:05,148 - root - INFO - n_history 0
2023-07-25 12:13:05,148 - root - INFO - prediction_type iterative
2023-07-25 12:13:05,148 - root - INFO - prediction_length 30
2023-07-25 12:13:05,148 - root - INFO - n_initial_conditions 5
2023-07-25 12:13:05,148 - root - INFO - ics_type default
2023-07-25 12:13:05,148 - root - INFO - save_raw_forecasts True
2023-07-25 12:13:05,148 - root - INFO - save_channel False
2023-07-25 12:13:05,148 - root - INFO - masked_acc False
2023-07-25 12:13:05,148 - root - INFO - maskpath None
2023-07-25 12:13:05,148 - root - INFO - perturb False
2023-07-25 12:13:05,148 - root - INFO - add_grid False
2023-07-25 12:13:05,148 - root - INFO - N_grid_channels 0
2023-07-25 12:13:05,148 - root - INFO - gridtype sinusoidal
2023-07-25 12:13:05,148 - root - INFO - roll False
2023-07-25 12:13:05,148 - root - INFO - num_blocks 8
2023-07-25 12:13:05,148 - root - INFO - nettype afno
2023-07-25 12:13:05,149 - root - INFO - patch_size 8
2023-07-25 12:13:05,149 - root - INFO - width 56
2023-07-25 12:13:05,149 - root - INFO - modes 32
2023-07-25 12:13:05,149 - root - INFO - target sp
2023-07-25 12:13:05,149 - root - INFO - normalization zscore
2023-07-25 12:13:05,149 - root - INFO - log_to_screen True
2023-07-25 12:13:05,149 - root - INFO - save_checkpoint True
2023-07-25 12:13:05,149 - root - INFO - enable_nhwc False
2023-07-25 12:13:05,149 - root - INFO - optimizer_type FusedAdam
2023-07-25 12:13:05,149 - root - INFO - crop_size_x None
2023-07-25 12:13:05,149 - root - INFO - crop_size_y None
2023-07-25 12:13:05,149 - root - INFO - two_step_training False
2023-07-25 12:13:05,149 - root - INFO - plot_animations False
2023-07-25 12:13:05,149 - root - INFO - add_noise False
2023-07-25 12:13:05,149 - root - INFO - noise_std 0
2023-07-25 12:13:05,149 - root - INFO - world_size 1
2023-07-25 12:13:05,149 - root - INFO - interp 0
2023-07-25 12:13:05,149 - root - INFO - use_daily_climatology False
2023-07-25 12:13:05,149 - root - INFO - global_batch_size 64
2023-07-25 12:13:05,149 - root - INFO - ablate U1000
2023-07-25 12:13:05,149 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 12:13:05,149 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 12:13:05,149 - root - INFO - resuming False
2023-07-25 12:13:05,149 - root - INFO - local_rank 0
2023-07-25 12:13:05,149 - root - INFO - ---------------------------------------------------
2023-07-25 12:13:05,150 - root - INFO - Inference for 1 initial conditions
2023-07-25 12:13:05,413 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 12:13:05,415 - root - INFO - Number of samples per year: 1460
2023-07-25 12:13:05,416 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 12:13:05,416 - root - INFO - Delta t: 6 hours
2023-07-25 12:13:05,416 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 12:13:05,416 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 12:14:07,561 - root - INFO - Loading inference data
2023-07-25 12:14:07,562 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 12:14:07,809 - root - INFO - Initial condition 1 of 1
2023-07-25 12:14:08,625 - root - INFO - Extracting valid data from the first year
2023-07-25 12:16:22,170 - root - INFO - Standardizing data
2023-07-25 12:16:30,120 - root - INFO - Loading time means
2023-07-25 12:16:42,904 - root - INFO - Begin autoregressive inference
2023-07-25 12:16:53,615 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 12:17:05,024 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 3530.02490234375, ACC: 0.17665421962738037
2023-07-25 12:17:16,578 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 12151.0966796875, ACC: 0.022122519090771675
2023-07-25 12:17:28,342 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 23721.169921875, ACC: -0.002878054976463318
2023-07-25 12:17:39,460 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 33774.38671875, ACC: -0.0040055434219539165
2023-07-25 12:17:51,410 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 41223.95703125, ACC: -0.02042435109615326
2023-07-25 12:18:02,397 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 52501.55078125, ACC: 0.009111747145652771
2023-07-25 12:18:13,391 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 75894.203125, ACC: 0.03782634064555168
2023-07-25 12:18:24,970 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 97606.8671875, ACC: 0.014079366810619831
2023-07-25 12:18:36,319 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 109132.3984375, ACC: -0.0051345666870474815
2023-07-25 12:18:48,155 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 111733.3828125, ACC: -0.017210088670253754
2023-07-25 12:19:00,763 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 110730.3046875, ACC: -0.011256749741733074
2023-07-25 12:19:11,963 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 110048.9140625, ACC: -0.0038507578428834677
2023-07-25 12:19:23,715 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 110539.109375, ACC: 0.0033054666128009558
2023-07-25 12:19:35,411 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 111660.953125, ACC: 0.007897526025772095
2023-07-25 12:19:45,720 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 112880.0625, ACC: 0.011182164773344994
2023-07-25 12:19:57,072 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 113915.140625, ACC: 0.012296680361032486
2023-07-25 12:20:08,144 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 114696.1796875, ACC: 0.011207817122340202
2023-07-25 12:20:18,603 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 115230.203125, ACC: 0.008502477779984474
2023-07-25 12:20:29,547 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 115606.5, ACC: 0.00600044010207057
2023-07-25 12:20:41,133 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 115900.53125, ACC: 0.0037566558457911015
2023-07-25 12:20:52,706 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 116143.7421875, ACC: 0.0023140273988246918
2023-07-25 12:21:03,635 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 116342.3515625, ACC: 0.0011743620270863175
2023-07-25 12:21:14,519 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 116497.0703125, ACC: 0.0013183015398681164
2023-07-25 12:21:25,503 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 116613.984375, ACC: 0.0011421478120610118
2023-07-25 12:21:37,416 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 116699.2421875, ACC: 0.0023521319963037968
2023-07-25 12:21:48,579 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 116761.640625, ACC: 0.0027426753658801317
2023-07-25 12:22:00,355 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 116806.0625, ACC: 0.003765309229493141
2023-07-25 12:22:11,793 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 116838.7578125, ACC: 0.0035068970173597336
2023-07-25 12:22:22,700 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 116861.1328125, ACC: 0.004544355906546116
2023-07-25 12:22:22,788 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-U1000_30-timesteps_vis.h5
2023-07-25 12:23:16,058 - root - INFO - ------------------ Configuration ------------------
2023-07-25 12:23:16,058 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 12:23:16,058 - root - INFO - Configuration name: afno_backbone
2023-07-25 12:23:16,058 - root - INFO - log_to_wandb True
2023-07-25 12:23:16,058 - root - INFO - lr 0.0005
2023-07-25 12:23:16,059 - root - INFO - batch_size 64
2023-07-25 12:23:16,059 - root - INFO - max_epochs 150
2023-07-25 12:23:16,059 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 12:23:16,059 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 12:23:16,059 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 12:23:16,059 - root - INFO - orography False
2023-07-25 12:23:16,059 - root - INFO - orography_path None
2023-07-25 12:23:16,059 - root - INFO - exp_dir FourCastNet/results
2023-07-25 12:23:16,059 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 12:23:16,059 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 12:23:16,059 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 12:23:16,059 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 12:23:16,059 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 12:23:16,059 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 12:23:16,059 - root - INFO - loss l2
2023-07-25 12:23:16,060 - root - INFO - num_data_workers 4
2023-07-25 12:23:16,060 - root - INFO - dt 1
2023-07-25 12:23:16,060 - root - INFO - n_history 0
2023-07-25 12:23:16,060 - root - INFO - prediction_type iterative
2023-07-25 12:23:16,060 - root - INFO - prediction_length 30
2023-07-25 12:23:16,060 - root - INFO - n_initial_conditions 5
2023-07-25 12:23:16,060 - root - INFO - ics_type default
2023-07-25 12:23:16,060 - root - INFO - save_raw_forecasts True
2023-07-25 12:23:16,060 - root - INFO - save_channel False
2023-07-25 12:23:16,060 - root - INFO - masked_acc False
2023-07-25 12:23:16,060 - root - INFO - maskpath None
2023-07-25 12:23:16,060 - root - INFO - perturb False
2023-07-25 12:23:16,060 - root - INFO - add_grid False
2023-07-25 12:23:16,060 - root - INFO - N_grid_channels 0
2023-07-25 12:23:16,060 - root - INFO - gridtype sinusoidal
2023-07-25 12:23:16,060 - root - INFO - roll False
2023-07-25 12:23:16,060 - root - INFO - num_blocks 8
2023-07-25 12:23:16,060 - root - INFO - nettype afno
2023-07-25 12:23:16,060 - root - INFO - patch_size 8
2023-07-25 12:23:16,061 - root - INFO - width 56
2023-07-25 12:23:16,061 - root - INFO - modes 32
2023-07-25 12:23:16,061 - root - INFO - target sp
2023-07-25 12:23:16,061 - root - INFO - normalization zscore
2023-07-25 12:23:16,061 - root - INFO - log_to_screen True
2023-07-25 12:23:16,061 - root - INFO - save_checkpoint True
2023-07-25 12:23:16,061 - root - INFO - enable_nhwc False
2023-07-25 12:23:16,061 - root - INFO - optimizer_type FusedAdam
2023-07-25 12:23:16,061 - root - INFO - crop_size_x None
2023-07-25 12:23:16,061 - root - INFO - crop_size_y None
2023-07-25 12:23:16,061 - root - INFO - two_step_training False
2023-07-25 12:23:16,061 - root - INFO - plot_animations False
2023-07-25 12:23:16,061 - root - INFO - add_noise False
2023-07-25 12:23:16,061 - root - INFO - noise_std 0
2023-07-25 12:23:16,061 - root - INFO - world_size 1
2023-07-25 12:23:16,061 - root - INFO - interp 0
2023-07-25 12:23:16,061 - root - INFO - use_daily_climatology False
2023-07-25 12:23:16,061 - root - INFO - global_batch_size 64
2023-07-25 12:23:16,061 - root - INFO - ablate V1000
2023-07-25 12:23:16,061 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 12:23:16,061 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 12:23:16,061 - root - INFO - resuming False
2023-07-25 12:23:16,061 - root - INFO - local_rank 0
2023-07-25 12:23:16,061 - root - INFO - ---------------------------------------------------
2023-07-25 12:23:16,061 - root - INFO - Inference for 1 initial conditions
2023-07-25 12:23:16,320 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 12:23:16,321 - root - INFO - Number of samples per year: 1460
2023-07-25 12:23:16,321 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 12:23:16,322 - root - INFO - Delta t: 6 hours
2023-07-25 12:23:16,322 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 12:23:16,322 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 12:24:22,496 - root - INFO - Loading inference data
2023-07-25 12:24:22,497 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 12:24:22,750 - root - INFO - Initial condition 1 of 1
2023-07-25 12:24:23,633 - root - INFO - Extracting valid data from the first year
2023-07-25 12:26:47,756 - root - INFO - Standardizing data
2023-07-25 12:26:55,920 - root - INFO - Loading time means
2023-07-25 12:27:09,665 - root - INFO - Begin autoregressive inference
2023-07-25 12:27:20,244 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 12:27:31,140 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 305.06109619140625, ACC: 0.9331204295158386
2023-07-25 12:27:42,149 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 214.56295776367188, ACC: 0.9642667770385742
2023-07-25 12:27:53,788 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 209.68968200683594, ACC: 0.9658386707305908
2023-07-25 12:28:04,938 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 212.35205078125, ACC: 0.9636596441268921
2023-07-25 12:28:16,451 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 221.2809600830078, ACC: 0.9612879157066345
2023-07-25 12:28:27,699 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 230.36935424804688, ACC: 0.9581535458564758
2023-07-25 12:28:38,181 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 243.524169921875, ACC: 0.9548838138580322
2023-07-25 12:28:48,440 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 262.9955749511719, ACC: 0.9475257992744446
2023-07-25 12:28:58,626 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 285.7251892089844, ACC: 0.9408482313156128
2023-07-25 12:29:09,220 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 302.9355773925781, ACC: 0.934374988079071
2023-07-25 12:29:20,258 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 313.9781494140625, ACC: 0.9309154152870178
2023-07-25 12:29:31,416 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 331.8787841796875, ACC: 0.9219086170196533
2023-07-25 12:29:41,793 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 356.65625, ACC: 0.9094617366790771
2023-07-25 12:29:52,240 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 387.9155578613281, ACC: 0.8902748227119446
2023-07-25 12:30:03,158 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 417.54376220703125, ACC: 0.8719634413719177
2023-07-25 12:30:14,618 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 450.58251953125, ACC: 0.8492412567138672
2023-07-25 12:30:27,316 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 479.4708557128906, ACC: 0.8270617723464966
2023-07-25 12:30:39,589 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 503.615966796875, ACC: 0.8038232326507568
2023-07-25 12:30:50,594 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 517.6630859375, ACC: 0.7851327061653137
2023-07-25 12:31:01,330 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 531.458984375, ACC: 0.7634556889533997
2023-07-25 12:31:13,302 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 547.3431396484375, ACC: 0.7417927980422974
2023-07-25 12:31:25,215 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 573.3446044921875, ACC: 0.7099437117576599
2023-07-25 12:31:36,065 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 602.2735595703125, ACC: 0.6800985932350159
2023-07-25 12:31:47,814 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 638.857666015625, ACC: 0.6418533325195312
2023-07-25 12:31:58,845 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 677.908203125, ACC: 0.6143205761909485
2023-07-25 12:32:10,142 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 714.3623046875, ACC: 0.5835840106010437
2023-07-25 12:32:21,798 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 741.5234985351562, ACC: 0.5622590184211731
2023-07-25 12:32:33,249 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 764.5071411132812, ACC: 0.5488322377204895
2023-07-25 12:32:45,342 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 785.5919799804688, ACC: 0.529750406742096
2023-07-25 12:32:45,429 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-V1000_30-timesteps_vis.h5
2023-07-25 12:33:38,769 - root - INFO - ------------------ Configuration ------------------
2023-07-25 12:33:38,769 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 12:33:38,769 - root - INFO - Configuration name: afno_backbone
2023-07-25 12:33:38,769 - root - INFO - log_to_wandb True
2023-07-25 12:33:38,770 - root - INFO - lr 0.0005
2023-07-25 12:33:38,770 - root - INFO - batch_size 64
2023-07-25 12:33:38,770 - root - INFO - max_epochs 150
2023-07-25 12:33:38,770 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 12:33:38,770 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 12:33:38,770 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 12:33:38,770 - root - INFO - orography False
2023-07-25 12:33:38,770 - root - INFO - orography_path None
2023-07-25 12:33:38,770 - root - INFO - exp_dir FourCastNet/results
2023-07-25 12:33:38,770 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 12:33:38,770 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 12:33:38,770 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 12:33:38,770 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 12:33:38,770 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 12:33:38,770 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 12:33:38,770 - root - INFO - loss l2
2023-07-25 12:33:38,770 - root - INFO - num_data_workers 4
2023-07-25 12:33:38,770 - root - INFO - dt 1
2023-07-25 12:33:38,770 - root - INFO - n_history 0
2023-07-25 12:33:38,770 - root - INFO - prediction_type iterative
2023-07-25 12:33:38,770 - root - INFO - prediction_length 30
2023-07-25 12:33:38,770 - root - INFO - n_initial_conditions 5
2023-07-25 12:33:38,770 - root - INFO - ics_type default
2023-07-25 12:33:38,771 - root - INFO - save_raw_forecasts True
2023-07-25 12:33:38,771 - root - INFO - save_channel False
2023-07-25 12:33:38,771 - root - INFO - masked_acc False
2023-07-25 12:33:38,771 - root - INFO - maskpath None
2023-07-25 12:33:38,771 - root - INFO - perturb False
2023-07-25 12:33:38,771 - root - INFO - add_grid False
2023-07-25 12:33:38,771 - root - INFO - N_grid_channels 0
2023-07-25 12:33:38,771 - root - INFO - gridtype sinusoidal
2023-07-25 12:33:38,771 - root - INFO - roll False
2023-07-25 12:33:38,771 - root - INFO - num_blocks 8
2023-07-25 12:33:38,771 - root - INFO - nettype afno
2023-07-25 12:33:38,771 - root - INFO - patch_size 8
2023-07-25 12:33:38,771 - root - INFO - width 56
2023-07-25 12:33:38,771 - root - INFO - modes 32
2023-07-25 12:33:38,772 - root - INFO - target sp
2023-07-25 12:33:38,772 - root - INFO - normalization zscore
2023-07-25 12:33:38,772 - root - INFO - log_to_screen True
2023-07-25 12:33:38,772 - root - INFO - save_checkpoint True
2023-07-25 12:33:38,772 - root - INFO - enable_nhwc False
2023-07-25 12:33:38,772 - root - INFO - optimizer_type FusedAdam
2023-07-25 12:33:38,772 - root - INFO - crop_size_x None
2023-07-25 12:33:38,772 - root - INFO - crop_size_y None
2023-07-25 12:33:38,772 - root - INFO - two_step_training False
2023-07-25 12:33:38,772 - root - INFO - plot_animations False
2023-07-25 12:33:38,772 - root - INFO - add_noise False
2023-07-25 12:33:38,772 - root - INFO - noise_std 0
2023-07-25 12:33:38,772 - root - INFO - world_size 1
2023-07-25 12:33:38,772 - root - INFO - interp 0
2023-07-25 12:33:38,772 - root - INFO - use_daily_climatology False
2023-07-25 12:33:38,772 - root - INFO - global_batch_size 64
2023-07-25 12:33:38,772 - root - INFO - ablate Z1000
2023-07-25 12:33:38,772 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 12:33:38,772 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 12:33:38,772 - root - INFO - resuming False
2023-07-25 12:33:38,772 - root - INFO - local_rank 0
2023-07-25 12:33:38,773 - root - INFO - ---------------------------------------------------
2023-07-25 12:33:38,773 - root - INFO - Inference for 1 initial conditions
2023-07-25 12:33:39,031 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 12:33:39,033 - root - INFO - Number of samples per year: 1460
2023-07-25 12:33:39,033 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 12:33:39,033 - root - INFO - Delta t: 6 hours
2023-07-25 12:33:39,033 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 12:33:39,034 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 12:34:42,812 - root - INFO - Loading inference data
2023-07-25 12:34:42,813 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 12:34:43,120 - root - INFO - Initial condition 1 of 1
2023-07-25 12:34:44,089 - root - INFO - Extracting valid data from the first year
2023-07-25 12:36:58,032 - root - INFO - Standardizing data
2023-07-25 12:37:06,350 - root - INFO - Loading time means
2023-07-25 12:37:20,081 - root - INFO - Begin autoregressive inference
2023-07-25 12:37:30,818 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 12:37:42,232 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 175.16017150878906, ACC: 0.9766872525215149
2023-07-25 12:37:54,525 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 165.0469207763672, ACC: 0.9790792465209961
2023-07-25 12:38:06,791 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 169.48995971679688, ACC: 0.9780957698822021
2023-07-25 12:38:18,261 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 179.96397399902344, ACC: 0.974323034286499
2023-07-25 12:38:29,293 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 190.835205078125, ACC: 0.9716757535934448
2023-07-25 12:38:41,173 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 205.08865356445312, ACC: 0.9671262502670288
2023-07-25 12:38:52,527 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 218.6360626220703, ACC: 0.9638993144035339
2023-07-25 12:39:04,483 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 236.99122619628906, ACC: 0.9572184085845947
2023-07-25 12:39:15,685 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 254.57513427734375, ACC: 0.9526093006134033
2023-07-25 12:39:26,306 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 270.78704833984375, ACC: 0.9464672803878784
2023-07-25 12:39:36,875 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 283.1466064453125, ACC: 0.9418240785598755
2023-07-25 12:39:47,819 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 301.8741760253906, ACC: 0.9321288466453552
2023-07-25 12:39:58,576 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 325.1307067871094, ACC: 0.9213530421257019
2023-07-25 12:40:09,433 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 350.14239501953125, ACC: 0.9073179364204407
2023-07-25 12:40:20,779 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 372.8291015625, ACC: 0.8950595259666443
2023-07-25 12:40:32,292 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 398.7770690917969, ACC: 0.878589928150177
2023-07-25 12:40:43,445 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 424.5216064453125, ACC: 0.8612484335899353
2023-07-25 12:40:54,191 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 451.6156005859375, ACC: 0.8378610014915466
2023-07-25 12:41:05,652 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 469.513916015625, ACC: 0.8187911510467529
2023-07-25 12:41:17,195 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 488.0300598144531, ACC: 0.7939863801002502
2023-07-25 12:41:28,300 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 504.9885559082031, ACC: 0.7759538292884827
2023-07-25 12:41:39,059 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 527.5475463867188, ACC: 0.7503127455711365
2023-07-25 12:41:49,684 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 545.7644653320312, ACC: 0.7371206283569336
2023-07-25 12:42:00,732 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 569.8931884765625, ACC: 0.7146094441413879
2023-07-25 12:42:11,719 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 594.9940185546875, ACC: 0.7061865925788879
2023-07-25 12:42:22,594 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 618.7666625976562, ACC: 0.6915121674537659
2023-07-25 12:42:32,692 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 637.90087890625, ACC: 0.6863950490951538
2023-07-25 12:42:43,280 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 657.580322265625, ACC: 0.6788501739501953
2023-07-25 12:42:53,387 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 677.7920532226562, ACC: 0.6681293845176697
2023-07-25 12:42:53,495 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-Z1000_30-timesteps_vis.h5
2023-07-25 12:43:46,986 - root - INFO - ------------------ Configuration ------------------
2023-07-25 12:43:46,986 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 12:43:46,987 - root - INFO - Configuration name: afno_backbone
2023-07-25 12:43:46,987 - root - INFO - log_to_wandb True
2023-07-25 12:43:46,987 - root - INFO - lr 0.0005
2023-07-25 12:43:46,987 - root - INFO - batch_size 64
2023-07-25 12:43:46,987 - root - INFO - max_epochs 150
2023-07-25 12:43:46,987 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 12:43:46,987 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 12:43:46,987 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 12:43:46,987 - root - INFO - orography False
2023-07-25 12:43:46,987 - root - INFO - orography_path None
2023-07-25 12:43:46,987 - root - INFO - exp_dir FourCastNet/results
2023-07-25 12:43:46,987 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 12:43:46,987 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 12:43:46,988 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 12:43:46,988 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 12:43:46,988 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 12:43:46,988 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 12:43:46,988 - root - INFO - loss l2
2023-07-25 12:43:46,988 - root - INFO - num_data_workers 4
2023-07-25 12:43:46,988 - root - INFO - dt 1
2023-07-25 12:43:46,988 - root - INFO - n_history 0
2023-07-25 12:43:46,988 - root - INFO - prediction_type iterative
2023-07-25 12:43:46,988 - root - INFO - prediction_length 30
2023-07-25 12:43:46,988 - root - INFO - n_initial_conditions 5
2023-07-25 12:43:46,988 - root - INFO - ics_type default
2023-07-25 12:43:46,988 - root - INFO - save_raw_forecasts True
2023-07-25 12:43:46,989 - root - INFO - save_channel False
2023-07-25 12:43:46,989 - root - INFO - masked_acc False
2023-07-25 12:43:46,989 - root - INFO - maskpath None
2023-07-25 12:43:46,989 - root - INFO - perturb False
2023-07-25 12:43:46,989 - root - INFO - add_grid False
2023-07-25 12:43:46,989 - root - INFO - N_grid_channels 0
2023-07-25 12:43:46,989 - root - INFO - gridtype sinusoidal
2023-07-25 12:43:46,989 - root - INFO - roll False
2023-07-25 12:43:46,989 - root - INFO - num_blocks 8
2023-07-25 12:43:46,989 - root - INFO - nettype afno
2023-07-25 12:43:46,989 - root - INFO - patch_size 8
2023-07-25 12:43:46,989 - root - INFO - width 56
2023-07-25 12:43:46,989 - root - INFO - modes 32
2023-07-25 12:43:46,989 - root - INFO - target sp
2023-07-25 12:43:46,989 - root - INFO - normalization zscore
2023-07-25 12:43:46,989 - root - INFO - log_to_screen True
2023-07-25 12:43:46,990 - root - INFO - save_checkpoint True
2023-07-25 12:43:46,990 - root - INFO - enable_nhwc False
2023-07-25 12:43:46,990 - root - INFO - optimizer_type FusedAdam
2023-07-25 12:43:46,990 - root - INFO - crop_size_x None
2023-07-25 12:43:46,990 - root - INFO - crop_size_y None
2023-07-25 12:43:46,990 - root - INFO - two_step_training False
2023-07-25 12:43:46,990 - root - INFO - plot_animations False
2023-07-25 12:43:46,990 - root - INFO - add_noise False
2023-07-25 12:43:46,990 - root - INFO - noise_std 0
2023-07-25 12:43:46,990 - root - INFO - world_size 1
2023-07-25 12:43:46,990 - root - INFO - interp 0
2023-07-25 12:43:46,990 - root - INFO - use_daily_climatology False
2023-07-25 12:43:46,990 - root - INFO - global_batch_size 64
2023-07-25 12:43:46,990 - root - INFO - ablate T850
2023-07-25 12:43:46,990 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 12:43:46,990 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 12:43:46,990 - root - INFO - resuming False
2023-07-25 12:43:46,990 - root - INFO - local_rank 0
2023-07-25 12:43:46,990 - root - INFO - ---------------------------------------------------
2023-07-25 12:43:46,991 - root - INFO - Inference for 1 initial conditions
2023-07-25 12:43:47,250 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 12:43:47,252 - root - INFO - Number of samples per year: 1460
2023-07-25 12:43:47,252 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 12:43:47,252 - root - INFO - Delta t: 6 hours
2023-07-25 12:43:47,252 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 12:43:47,252 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 12:44:44,182 - root - INFO - Loading inference data
2023-07-25 12:44:44,183 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 12:44:44,324 - root - INFO - Initial condition 1 of 1
2023-07-25 12:44:45,193 - root - INFO - Extracting valid data from the first year
2023-07-25 12:46:54,285 - root - INFO - Standardizing data
2023-07-25 12:47:02,328 - root - INFO - Loading time means
2023-07-25 12:47:14,416 - root - INFO - Begin autoregressive inference
2023-07-25 12:47:24,329 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 12:47:34,204 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 8629.751953125, ACC: -0.03058362752199173
2023-07-25 12:47:44,325 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 34633.859375, ACC: 0.042687803506851196
2023-07-25 12:47:55,387 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 56589.66796875, ACC: 0.10557351261377335
2023-07-25 12:48:05,777 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 83901.234375, ACC: 0.08228983730077744
2023-07-25 12:48:16,606 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 101202.3359375, ACC: 0.04238678142428398
2023-07-25 12:48:27,027 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 108075.140625, ACC: 0.012614183127880096
2023-07-25 12:48:37,539 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 108615.234375, ACC: 0.0049656350165605545
2023-07-25 12:48:48,654 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 108206.3984375, ACC: 0.00488534988835454
2023-07-25 12:48:59,602 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 108998.140625, ACC: 0.008664131164550781
2023-07-25 12:49:10,003 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 110489.3828125, ACC: 0.006890879478305578
2023-07-25 12:49:19,893 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 111871.3671875, ACC: 0.0070603154599666595
2023-07-25 12:49:30,079 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 112920.1328125, ACC: 0.005625562742352486
2023-07-25 12:49:40,733 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 113731.25, ACC: 0.006121884565800428
2023-07-25 12:49:51,286 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 114419.8984375, ACC: 0.0058159418404102325
2023-07-25 12:50:02,016 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 115009.6171875, ACC: 0.005706580821424723
2023-07-25 12:50:12,148 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 115493.515625, ACC: 0.004412891808897257
2023-07-25 12:50:22,945 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 115871.1171875, ACC: 0.00401290925219655
2023-07-25 12:50:33,791 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 116157.5703125, ACC: 0.0024602203629910946
2023-07-25 12:50:43,491 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 116368.796875, ACC: 0.0021969766821712255
2023-07-25 12:50:53,210 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 116523.5, ACC: 0.0014345799572765827
2023-07-25 12:51:03,746 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 116635.3046875, ACC: 0.00133139593526721
2023-07-25 12:51:13,875 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 116716.375, ACC: 0.0007500165957026184
2023-07-25 12:51:24,392 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 116774.078125, ACC: 0.0012251936132088304
2023-07-25 12:51:34,498 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 116815.84375, ACC: 0.001144810696132481
2023-07-25 12:51:45,241 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 116844.8984375, ACC: 0.0024179324973374605
2023-07-25 12:51:55,929 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 116866.1640625, ACC: 0.0028051394037902355
2023-07-25 12:52:06,940 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 116880.828125, ACC: 0.0038269429933279753
2023-07-25 12:52:17,668 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 116892.203125, ACC: 0.003556179814040661
2023-07-25 12:52:27,403 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 116899.3359375, ACC: 0.004587387666106224
2023-07-25 12:52:27,486 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-T850_30-timesteps_vis.h5
2023-07-25 12:53:20,669 - root - INFO - ------------------ Configuration ------------------
2023-07-25 12:53:20,670 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 12:53:20,670 - root - INFO - Configuration name: afno_backbone
2023-07-25 12:53:20,670 - root - INFO - log_to_wandb True
2023-07-25 12:53:20,670 - root - INFO - lr 0.0005
2023-07-25 12:53:20,670 - root - INFO - batch_size 64
2023-07-25 12:53:20,670 - root - INFO - max_epochs 150
2023-07-25 12:53:20,670 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 12:53:20,670 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 12:53:20,670 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 12:53:20,670 - root - INFO - orography False
2023-07-25 12:53:20,670 - root - INFO - orography_path None
2023-07-25 12:53:20,670 - root - INFO - exp_dir FourCastNet/results
2023-07-25 12:53:20,670 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 12:53:20,670 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 12:53:20,670 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 12:53:20,670 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 12:53:20,671 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 12:53:20,671 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 12:53:20,671 - root - INFO - loss l2
2023-07-25 12:53:20,671 - root - INFO - num_data_workers 4
2023-07-25 12:53:20,671 - root - INFO - dt 1
2023-07-25 12:53:20,671 - root - INFO - n_history 0
2023-07-25 12:53:20,671 - root - INFO - prediction_type iterative
2023-07-25 12:53:20,671 - root - INFO - prediction_length 30
2023-07-25 12:53:20,671 - root - INFO - n_initial_conditions 5
2023-07-25 12:53:20,671 - root - INFO - ics_type default
2023-07-25 12:53:20,671 - root - INFO - save_raw_forecasts True
2023-07-25 12:53:20,671 - root - INFO - save_channel False
2023-07-25 12:53:20,671 - root - INFO - masked_acc False
2023-07-25 12:53:20,671 - root - INFO - maskpath None
2023-07-25 12:53:20,671 - root - INFO - perturb False
2023-07-25 12:53:20,671 - root - INFO - add_grid False
2023-07-25 12:53:20,671 - root - INFO - N_grid_channels 0
2023-07-25 12:53:20,671 - root - INFO - gridtype sinusoidal
2023-07-25 12:53:20,671 - root - INFO - roll False
2023-07-25 12:53:20,671 - root - INFO - num_blocks 8
2023-07-25 12:53:20,671 - root - INFO - nettype afno
2023-07-25 12:53:20,671 - root - INFO - patch_size 8
2023-07-25 12:53:20,671 - root - INFO - width 56
2023-07-25 12:53:20,672 - root - INFO - modes 32
2023-07-25 12:53:20,672 - root - INFO - target sp
2023-07-25 12:53:20,672 - root - INFO - normalization zscore
2023-07-25 12:53:20,672 - root - INFO - log_to_screen True
2023-07-25 12:53:20,672 - root - INFO - save_checkpoint True
2023-07-25 12:53:20,672 - root - INFO - enable_nhwc False
2023-07-25 12:53:20,672 - root - INFO - optimizer_type FusedAdam
2023-07-25 12:53:20,672 - root - INFO - crop_size_x None
2023-07-25 12:53:20,672 - root - INFO - crop_size_y None
2023-07-25 12:53:20,672 - root - INFO - two_step_training False
2023-07-25 12:53:20,672 - root - INFO - plot_animations False
2023-07-25 12:53:20,672 - root - INFO - add_noise False
2023-07-25 12:53:20,672 - root - INFO - noise_std 0
2023-07-25 12:53:20,672 - root - INFO - world_size 1
2023-07-25 12:53:20,672 - root - INFO - interp 0
2023-07-25 12:53:20,672 - root - INFO - use_daily_climatology False
2023-07-25 12:53:20,672 - root - INFO - global_batch_size 64
2023-07-25 12:53:20,672 - root - INFO - ablate U850
2023-07-25 12:53:20,672 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 12:53:20,672 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 12:53:20,672 - root - INFO - resuming False
2023-07-25 12:53:20,672 - root - INFO - local_rank 0
2023-07-25 12:53:20,672 - root - INFO - ---------------------------------------------------
2023-07-25 12:53:20,672 - root - INFO - Inference for 1 initial conditions
2023-07-25 12:53:20,889 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 12:53:20,890 - root - INFO - Number of samples per year: 1460
2023-07-25 12:53:20,890 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 12:53:20,890 - root - INFO - Delta t: 6 hours
2023-07-25 12:53:20,890 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 12:53:20,890 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 12:54:16,892 - root - INFO - Loading inference data
2023-07-25 12:54:16,893 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 12:54:17,063 - root - INFO - Initial condition 1 of 1
2023-07-25 12:54:17,844 - root - INFO - Extracting valid data from the first year
2023-07-25 12:56:11,281 - root - INFO - Standardizing data
2023-07-25 12:56:19,067 - root - INFO - Loading time means
2023-07-25 12:56:28,524 - root - INFO - Begin autoregressive inference
2023-07-25 12:56:39,925 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 12:56:51,683 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 206.43978881835938, ACC: 0.9668830037117004
2023-07-25 12:57:02,524 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 201.70654296875, ACC: 0.9676769375801086
2023-07-25 12:57:13,702 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 198.88897705078125, ACC: 0.9688893556594849
2023-07-25 12:57:25,306 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 205.24220275878906, ACC: 0.9656095504760742
2023-07-25 12:57:36,407 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 215.01348876953125, ACC: 0.9631395936012268
2023-07-25 12:57:47,889 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 226.1640167236328, ACC: 0.9593383073806763
2023-07-25 12:57:59,489 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 237.30348205566406, ACC: 0.9568988084793091
2023-07-25 12:58:09,360 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 252.0431365966797, ACC: 0.9514767527580261
2023-07-25 12:58:20,417 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 271.8680725097656, ACC: 0.9463101625442505
2023-07-25 12:58:31,356 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 291.25640869140625, ACC: 0.9393213987350464
2023-07-25 12:58:41,603 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 303.65631103515625, ACC: 0.9358245730400085
2023-07-25 12:58:51,425 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 321.7278747558594, ACC: 0.9275179505348206
2023-07-25 12:59:01,705 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 346.5561828613281, ACC: 0.9167897701263428
2023-07-25 12:59:12,562 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 378.27880859375, ACC: 0.8984911441802979
2023-07-25 12:59:23,024 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 406.7591247558594, ACC: 0.8825521469116211
2023-07-25 12:59:33,309 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 436.64215087890625, ACC: 0.8620615005493164
2023-07-25 12:59:43,764 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 463.7140197753906, ACC: 0.8425956964492798
2023-07-25 12:59:54,139 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 489.3917236328125, ACC: 0.8175125122070312
2023-07-25 13:00:04,465 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 508.8428039550781, ACC: 0.7969309687614441
2023-07-25 13:00:15,895 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 529.5582885742188, ACC: 0.7676825523376465
2023-07-25 13:00:27,450 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 547.9531860351562, ACC: 0.7469608783721924
2023-07-25 13:00:38,175 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 568.7164916992188, ACC: 0.7184759378433228
2023-07-25 13:00:48,642 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 583.265380859375, ACC: 0.7095109224319458
2023-07-25 13:00:59,230 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 603.0393676757812, ACC: 0.6855531930923462
2023-07-25 13:01:09,911 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 621.009033203125, ACC: 0.6845080852508545
2023-07-25 13:01:20,348 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 644.8926391601562, ACC: 0.6658434271812439
2023-07-25 13:01:31,984 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 662.5296020507812, ACC: 0.6631394028663635
2023-07-25 13:01:42,401 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 684.603515625, ACC: 0.6500269174575806
2023-07-25 13:01:52,888 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 701.060791015625, ACC: 0.6444348096847534
2023-07-25 13:01:52,976 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-U850_30-timesteps_vis.h5
2023-07-25 13:02:46,297 - root - INFO - ------------------ Configuration ------------------
2023-07-25 13:02:46,297 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 13:02:46,298 - root - INFO - Configuration name: afno_backbone
2023-07-25 13:02:46,298 - root - INFO - log_to_wandb True
2023-07-25 13:02:46,298 - root - INFO - lr 0.0005
2023-07-25 13:02:46,298 - root - INFO - batch_size 64
2023-07-25 13:02:46,298 - root - INFO - max_epochs 150
2023-07-25 13:02:46,298 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 13:02:46,298 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 13:02:46,298 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 13:02:46,298 - root - INFO - orography False
2023-07-25 13:02:46,298 - root - INFO - orography_path None
2023-07-25 13:02:46,298 - root - INFO - exp_dir FourCastNet/results
2023-07-25 13:02:46,298 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 13:02:46,298 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 13:02:46,298 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 13:02:46,298 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 13:02:46,298 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 13:02:46,298 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 13:02:46,298 - root - INFO - loss l2
2023-07-25 13:02:46,298 - root - INFO - num_data_workers 4
2023-07-25 13:02:46,298 - root - INFO - dt 1
2023-07-25 13:02:46,298 - root - INFO - n_history 0
2023-07-25 13:02:46,298 - root - INFO - prediction_type iterative
2023-07-25 13:02:46,298 - root - INFO - prediction_length 30
2023-07-25 13:02:46,298 - root - INFO - n_initial_conditions 5
2023-07-25 13:02:46,298 - root - INFO - ics_type default
2023-07-25 13:02:46,298 - root - INFO - save_raw_forecasts True
2023-07-25 13:02:46,299 - root - INFO - save_channel False
2023-07-25 13:02:46,299 - root - INFO - masked_acc False
2023-07-25 13:02:46,299 - root - INFO - maskpath None
2023-07-25 13:02:46,299 - root - INFO - perturb False
2023-07-25 13:02:46,299 - root - INFO - add_grid False
2023-07-25 13:02:46,299 - root - INFO - N_grid_channels 0
2023-07-25 13:02:46,299 - root - INFO - gridtype sinusoidal
2023-07-25 13:02:46,299 - root - INFO - roll False
2023-07-25 13:02:46,299 - root - INFO - num_blocks 8
2023-07-25 13:02:46,299 - root - INFO - nettype afno
2023-07-25 13:02:46,299 - root - INFO - patch_size 8
2023-07-25 13:02:46,299 - root - INFO - width 56
2023-07-25 13:02:46,299 - root - INFO - modes 32
2023-07-25 13:02:46,299 - root - INFO - target sp
2023-07-25 13:02:46,299 - root - INFO - normalization zscore
2023-07-25 13:02:46,299 - root - INFO - log_to_screen True
2023-07-25 13:02:46,299 - root - INFO - save_checkpoint True
2023-07-25 13:02:46,299 - root - INFO - enable_nhwc False
2023-07-25 13:02:46,299 - root - INFO - optimizer_type FusedAdam
2023-07-25 13:02:46,299 - root - INFO - crop_size_x None
2023-07-25 13:02:46,299 - root - INFO - crop_size_y None
2023-07-25 13:02:46,299 - root - INFO - two_step_training False
2023-07-25 13:02:46,299 - root - INFO - plot_animations False
2023-07-25 13:02:46,299 - root - INFO - add_noise False
2023-07-25 13:02:46,299 - root - INFO - noise_std 0
2023-07-25 13:02:46,299 - root - INFO - world_size 1
2023-07-25 13:02:46,300 - root - INFO - interp 0
2023-07-25 13:02:46,300 - root - INFO - use_daily_climatology False
2023-07-25 13:02:46,300 - root - INFO - global_batch_size 64
2023-07-25 13:02:46,300 - root - INFO - ablate V850
2023-07-25 13:02:46,300 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 13:02:46,300 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 13:02:46,300 - root - INFO - resuming False
2023-07-25 13:02:46,300 - root - INFO - local_rank 0
2023-07-25 13:02:46,300 - root - INFO - ---------------------------------------------------
2023-07-25 13:02:46,300 - root - INFO - Inference for 1 initial conditions
2023-07-25 13:02:46,551 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 13:02:46,552 - root - INFO - Number of samples per year: 1460
2023-07-25 13:02:46,552 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 13:02:46,552 - root - INFO - Delta t: 6 hours
2023-07-25 13:02:46,554 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 13:02:46,554 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 13:03:47,423 - root - INFO - Loading inference data
2023-07-25 13:03:47,424 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 13:03:47,582 - root - INFO - Initial condition 1 of 1
2023-07-25 13:03:48,430 - root - INFO - Extracting valid data from the first year
2023-07-25 13:06:02,064 - root - INFO - Standardizing data
2023-07-25 13:06:10,008 - root - INFO - Loading time means
2023-07-25 13:06:22,601 - root - INFO - Begin autoregressive inference
2023-07-25 13:06:33,631 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 13:06:45,269 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 177.54893493652344, ACC: 0.9757992029190063
2023-07-25 13:06:57,254 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 170.53298950195312, ACC: 0.977013349533081
2023-07-25 13:07:09,164 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 176.7814483642578, ACC: 0.9754468202590942
2023-07-25 13:07:20,213 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 185.72119140625, ACC: 0.9718334078788757
2023-07-25 13:07:30,893 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 197.70993041992188, ACC: 0.9687519669532776
2023-07-25 13:07:42,658 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 209.37429809570312, ACC: 0.9650444984436035
2023-07-25 13:07:54,256 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 220.72120666503906, ACC: 0.9625734686851501
2023-07-25 13:08:06,400 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 233.63619995117188, ACC: 0.9579073190689087
2023-07-25 13:08:17,605 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 250.88552856445312, ACC: 0.953547477722168
2023-07-25 13:08:28,834 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 265.1869812011719, ACC: 0.9485762119293213
2023-07-25 13:08:39,365 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 274.88385009765625, ACC: 0.9454801082611084
2023-07-25 13:08:50,387 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 290.24322509765625, ACC: 0.9382215142250061
2023-07-25 13:09:02,103 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 313.3324890136719, ACC: 0.927998960018158
2023-07-25 13:09:13,047 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 338.1480407714844, ACC: 0.9147791862487793
2023-07-25 13:09:24,273 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 360.9149169921875, ACC: 0.9029532074928284
2023-07-25 13:09:35,748 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 384.6250305175781, ACC: 0.8890309929847717
2023-07-25 13:09:46,823 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 409.6960754394531, ACC: 0.8730826377868652
2023-07-25 13:09:57,309 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 430.6122741699219, ACC: 0.8557544946670532
2023-07-25 13:10:08,298 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 448.5838928222656, ACC: 0.8383408784866333
2023-07-25 13:10:19,620 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 469.91400146484375, ACC: 0.81421959400177
2023-07-25 13:10:30,184 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 493.261962890625, ACC: 0.7910681366920471
2023-07-25 13:10:40,722 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 513.442138671875, ACC: 0.7675767540931702
2023-07-25 13:10:51,711 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 528.9030151367188, ACC: 0.7559384703636169
2023-07-25 13:11:02,804 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 545.3999633789062, ACC: 0.7387933731079102
2023-07-25 13:11:13,109 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 558.3984375, ACC: 0.7372103929519653
2023-07-25 13:11:23,833 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 567.0567016601562, ACC: 0.7337765097618103
2023-07-25 13:11:34,886 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 572.5255126953125, ACC: 0.7377490997314453
2023-07-25 13:11:45,314 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 583.0308227539062, ACC: 0.7376481294631958
2023-07-25 13:11:56,667 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 598.0386352539062, ACC: 0.7322778701782227
2023-07-25 13:11:56,765 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-V850_30-timesteps_vis.h5
2023-07-25 13:12:50,018 - root - INFO - ------------------ Configuration ------------------
2023-07-25 13:12:50,018 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 13:12:50,019 - root - INFO - Configuration name: afno_backbone
2023-07-25 13:12:50,019 - root - INFO - log_to_wandb True
2023-07-25 13:12:50,019 - root - INFO - lr 0.0005
2023-07-25 13:12:50,019 - root - INFO - batch_size 64
2023-07-25 13:12:50,019 - root - INFO - max_epochs 150
2023-07-25 13:12:50,020 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 13:12:50,020 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 13:12:50,021 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 13:12:50,021 - root - INFO - orography False
2023-07-25 13:12:50,021 - root - INFO - orography_path None
2023-07-25 13:12:50,021 - root - INFO - exp_dir FourCastNet/results
2023-07-25 13:12:50,021 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 13:12:50,021 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 13:12:50,021 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 13:12:50,021 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 13:12:50,021 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 13:12:50,021 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 13:12:50,021 - root - INFO - loss l2
2023-07-25 13:12:50,021 - root - INFO - num_data_workers 4
2023-07-25 13:12:50,022 - root - INFO - dt 1
2023-07-25 13:12:50,022 - root - INFO - n_history 0
2023-07-25 13:12:50,022 - root - INFO - prediction_type iterative
2023-07-25 13:12:50,022 - root - INFO - prediction_length 30
2023-07-25 13:12:50,022 - root - INFO - n_initial_conditions 5
2023-07-25 13:12:50,022 - root - INFO - ics_type default
2023-07-25 13:12:50,022 - root - INFO - save_raw_forecasts True
2023-07-25 13:12:50,022 - root - INFO - save_channel False
2023-07-25 13:12:50,022 - root - INFO - masked_acc False
2023-07-25 13:12:50,022 - root - INFO - maskpath None
2023-07-25 13:12:50,022 - root - INFO - perturb False
2023-07-25 13:12:50,022 - root - INFO - add_grid False
2023-07-25 13:12:50,022 - root - INFO - N_grid_channels 0
2023-07-25 13:12:50,022 - root - INFO - gridtype sinusoidal
2023-07-25 13:12:50,022 - root - INFO - roll False
2023-07-25 13:12:50,022 - root - INFO - num_blocks 8
2023-07-25 13:12:50,022 - root - INFO - nettype afno
2023-07-25 13:12:50,022 - root - INFO - patch_size 8
2023-07-25 13:12:50,022 - root - INFO - width 56
2023-07-25 13:12:50,023 - root - INFO - modes 32
2023-07-25 13:12:50,023 - root - INFO - target sp
2023-07-25 13:12:50,023 - root - INFO - normalization zscore
2023-07-25 13:12:50,023 - root - INFO - log_to_screen True
2023-07-25 13:12:50,023 - root - INFO - save_checkpoint True
2023-07-25 13:12:50,023 - root - INFO - enable_nhwc False
2023-07-25 13:12:50,023 - root - INFO - optimizer_type FusedAdam
2023-07-25 13:12:50,023 - root - INFO - crop_size_x None
2023-07-25 13:12:50,023 - root - INFO - crop_size_y None
2023-07-25 13:12:50,023 - root - INFO - two_step_training False
2023-07-25 13:12:50,023 - root - INFO - plot_animations False
2023-07-25 13:12:50,023 - root - INFO - add_noise False
2023-07-25 13:12:50,023 - root - INFO - noise_std 0
2023-07-25 13:12:50,024 - root - INFO - world_size 1
2023-07-25 13:12:50,024 - root - INFO - interp 0
2023-07-25 13:12:50,024 - root - INFO - use_daily_climatology False
2023-07-25 13:12:50,024 - root - INFO - global_batch_size 64
2023-07-25 13:12:50,024 - root - INFO - ablate Z850
2023-07-25 13:12:50,024 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 13:12:50,024 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 13:12:50,024 - root - INFO - resuming False
2023-07-25 13:12:50,024 - root - INFO - local_rank 0
2023-07-25 13:12:50,024 - root - INFO - ---------------------------------------------------
2023-07-25 13:12:50,024 - root - INFO - Inference for 1 initial conditions
2023-07-25 13:12:50,362 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 13:12:50,363 - root - INFO - Number of samples per year: 1460
2023-07-25 13:12:50,363 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 13:12:50,364 - root - INFO - Delta t: 6 hours
2023-07-25 13:12:50,364 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 13:12:50,364 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 13:13:55,894 - root - INFO - Loading inference data
2023-07-25 13:13:55,895 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 13:13:56,088 - root - INFO - Initial condition 1 of 1
2023-07-25 13:13:57,014 - root - INFO - Extracting valid data from the first year
2023-07-25 13:16:13,089 - root - INFO - Standardizing data
2023-07-25 13:16:21,302 - root - INFO - Loading time means
2023-07-25 13:16:34,752 - root - INFO - Begin autoregressive inference
2023-07-25 13:16:45,925 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 13:16:58,112 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 13133.0400390625, ACC: 0.13723158836364746
2023-07-25 13:17:08,738 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 76787.6796875, ACC: 0.05213896557688713
2023-07-25 13:17:19,396 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 107895.3828125, ACC: 0.03287477046251297
2023-07-25 13:17:30,434 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 117650.59375, ACC: 0.017776722088456154
2023-07-25 13:17:41,582 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 114890.109375, ACC: 0.01452571153640747
2023-07-25 13:17:52,344 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 111156.6953125, ACC: 0.009763064794242382
2023-07-25 13:18:03,382 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 110186.140625, ACC: 0.011512486264109612
2023-07-25 13:18:14,078 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 110761.375, ACC: 0.011226925067603588
2023-07-25 13:18:24,733 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 111621.09375, ACC: 0.010367975570261478
2023-07-25 13:18:36,244 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 112515.5859375, ACC: 0.008160027675330639
2023-07-25 13:18:46,995 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 113400.46875, ACC: 0.007422113791108131
2023-07-25 13:18:58,609 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 114207.2578125, ACC: 0.00617558415979147
2023-07-25 13:19:09,413 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 114881.2890625, ACC: 0.006299214903265238
2023-07-25 13:19:20,116 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 115414.15625, ACC: 0.0055216518230736256
2023-07-25 13:19:31,188 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 115819.5859375, ACC: 0.00530845345929265
2023-07-25 13:19:42,577 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 116122.328125, ACC: 0.0040078251622617245
2023-07-25 13:19:53,810 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 116343.875, ACC: 0.003752785036340356
2023-07-25 13:20:04,860 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 116506.0390625, ACC: 0.002277499297633767
2023-07-25 13:20:16,472 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 116622.5703125, ACC: 0.002097216434776783
2023-07-25 13:20:27,268 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 116707.0546875, ACC: 0.0013445047661662102
2023-07-25 13:20:38,094 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 116767.5078125, ACC: 0.0012885259930044413
2023-07-25 13:20:49,678 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 116811.34375, ACC: 0.0007283827872015536
2023-07-25 13:21:00,487 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 116842.2265625, ACC: 0.0012170614209026098
2023-07-25 13:21:11,005 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 116864.734375, ACC: 0.0011248659575358033
2023-07-25 13:21:22,030 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 116879.984375, ACC: 0.002399114426225424
2023-07-25 13:21:33,302 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 116891.3515625, ACC: 0.0027895637322217226
2023-07-25 13:21:44,814 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 116898.8984375, ACC: 0.0038181322161108255
2023-07-25 13:21:57,067 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 116905.1796875, ACC: 0.003547853324562311
2023-07-25 13:22:08,756 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 116908.671875, ACC: 0.004581102170050144
2023-07-25 13:22:08,840 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-Z850_30-timesteps_vis.h5
2023-07-25 13:23:02,206 - root - INFO - ------------------ Configuration ------------------
2023-07-25 13:23:02,206 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 13:23:02,206 - root - INFO - Configuration name: afno_backbone
2023-07-25 13:23:02,206 - root - INFO - log_to_wandb True
2023-07-25 13:23:02,206 - root - INFO - lr 0.0005
2023-07-25 13:23:02,206 - root - INFO - batch_size 64
2023-07-25 13:23:02,206 - root - INFO - max_epochs 150
2023-07-25 13:23:02,206 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 13:23:02,206 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 13:23:02,207 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 13:23:02,207 - root - INFO - orography False
2023-07-25 13:23:02,207 - root - INFO - orography_path None
2023-07-25 13:23:02,207 - root - INFO - exp_dir FourCastNet/results
2023-07-25 13:23:02,207 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 13:23:02,207 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 13:23:02,207 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 13:23:02,207 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 13:23:02,207 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 13:23:02,207 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 13:23:02,207 - root - INFO - loss l2
2023-07-25 13:23:02,207 - root - INFO - num_data_workers 4
2023-07-25 13:23:02,207 - root - INFO - dt 1
2023-07-25 13:23:02,207 - root - INFO - n_history 0
2023-07-25 13:23:02,207 - root - INFO - prediction_type iterative
2023-07-25 13:23:02,207 - root - INFO - prediction_length 30
2023-07-25 13:23:02,208 - root - INFO - n_initial_conditions 5
2023-07-25 13:23:02,208 - root - INFO - ics_type default
2023-07-25 13:23:02,208 - root - INFO - save_raw_forecasts True
2023-07-25 13:23:02,208 - root - INFO - save_channel False
2023-07-25 13:23:02,208 - root - INFO - masked_acc False
2023-07-25 13:23:02,208 - root - INFO - maskpath None
2023-07-25 13:23:02,208 - root - INFO - perturb False
2023-07-25 13:23:02,208 - root - INFO - add_grid False
2023-07-25 13:23:02,208 - root - INFO - N_grid_channels 0
2023-07-25 13:23:02,208 - root - INFO - gridtype sinusoidal
2023-07-25 13:23:02,208 - root - INFO - roll False
2023-07-25 13:23:02,208 - root - INFO - num_blocks 8
2023-07-25 13:23:02,208 - root - INFO - nettype afno
2023-07-25 13:23:02,208 - root - INFO - patch_size 8
2023-07-25 13:23:02,208 - root - INFO - width 56
2023-07-25 13:23:02,208 - root - INFO - modes 32
2023-07-25 13:23:02,208 - root - INFO - target sp
2023-07-25 13:23:02,208 - root - INFO - normalization zscore
2023-07-25 13:23:02,209 - root - INFO - log_to_screen True
2023-07-25 13:23:02,209 - root - INFO - save_checkpoint True
2023-07-25 13:23:02,209 - root - INFO - enable_nhwc False
2023-07-25 13:23:02,209 - root - INFO - optimizer_type FusedAdam
2023-07-25 13:23:02,209 - root - INFO - crop_size_x None
2023-07-25 13:23:02,209 - root - INFO - crop_size_y None
2023-07-25 13:23:02,209 - root - INFO - two_step_training False
2023-07-25 13:23:02,209 - root - INFO - plot_animations False
2023-07-25 13:23:02,209 - root - INFO - add_noise False
2023-07-25 13:23:02,209 - root - INFO - noise_std 0
2023-07-25 13:23:02,209 - root - INFO - world_size 1
2023-07-25 13:23:02,209 - root - INFO - interp 0
2023-07-25 13:23:02,209 - root - INFO - use_daily_climatology False
2023-07-25 13:23:02,209 - root - INFO - global_batch_size 64
2023-07-25 13:23:02,209 - root - INFO - ablate RH850
2023-07-25 13:23:02,209 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 13:23:02,209 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 13:23:02,209 - root - INFO - resuming False
2023-07-25 13:23:02,209 - root - INFO - local_rank 0
2023-07-25 13:23:02,209 - root - INFO - ---------------------------------------------------
2023-07-25 13:23:02,209 - root - INFO - Inference for 1 initial conditions
2023-07-25 13:23:02,498 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 13:23:02,499 - root - INFO - Number of samples per year: 1460
2023-07-25 13:23:02,499 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 13:23:02,499 - root - INFO - Delta t: 6 hours
2023-07-25 13:23:02,499 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 13:23:02,500 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 13:24:04,891 - root - INFO - Loading inference data
2023-07-25 13:24:04,892 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 13:24:05,111 - root - INFO - Initial condition 1 of 1
2023-07-25 13:24:05,959 - root - INFO - Extracting valid data from the first year
2023-07-25 13:26:31,676 - root - INFO - Standardizing data
2023-07-25 13:26:39,588 - root - INFO - Loading time means
2023-07-25 13:26:54,357 - root - INFO - Begin autoregressive inference
2023-07-25 13:27:05,156 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 13:27:15,714 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 184.78924560546875, ACC: 0.9736048579216003
2023-07-25 13:27:26,462 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 186.51304626464844, ACC: 0.9725044369697571
2023-07-25 13:27:37,082 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 198.91639709472656, ACC: 0.9688845872879028
2023-07-25 13:27:48,105 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 218.5699462890625, ACC: 0.9609487652778625
2023-07-25 13:27:58,797 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 243.59779357910156, ACC: 0.9522362947463989
2023-07-25 13:28:09,773 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 262.9931640625, ACC: 0.9442030787467957
2023-07-25 13:28:20,429 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 282.18218994140625, ACC: 0.9375729560852051
2023-07-25 13:28:31,442 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 305.4056091308594, ACC: 0.9259869456291199
2023-07-25 13:28:42,171 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 328.22930908203125, ACC: 0.9176916480064392
2023-07-25 13:28:52,511 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 347.998779296875, ACC: 0.9077868461608887
2023-07-25 13:29:03,538 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 365.0462341308594, ACC: 0.8995057344436646
2023-07-25 13:29:14,381 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 383.64703369140625, ACC: 0.8876160383224487
2023-07-25 13:29:25,205 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 409.3250427246094, ACC: 0.8739086985588074
2023-07-25 13:29:36,564 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 438.3523254394531, ACC: 0.8542492985725403
2023-07-25 13:29:47,774 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 461.865234375, ACC: 0.839678943157196
2023-07-25 13:29:58,443 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 488.7667236328125, ACC: 0.819277286529541
2023-07-25 13:30:09,637 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 517.2413940429688, ACC: 0.7974348664283752
2023-07-25 13:30:20,877 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 547.2329711914062, ACC: 0.7669556736946106
2023-07-25 13:30:32,596 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 573.5000610351562, ACC: 0.7388693690299988
2023-07-25 13:30:45,496 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 601.0875244140625, ACC: 0.7022943496704102
2023-07-25 13:30:57,919 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 625.770263671875, ACC: 0.6744046807289124
2023-07-25 13:31:10,148 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 648.6687622070312, ACC: 0.6389902234077454
2023-07-25 13:31:21,665 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 665.5913696289062, ACC: 0.6220504641532898
2023-07-25 13:31:32,921 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 686.6866455078125, ACC: 0.5913375020027161
2023-07-25 13:31:44,830 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 705.7139892578125, ACC: 0.5856637954711914
2023-07-25 13:31:57,749 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 722.8560180664062, ACC: 0.5702272057533264
2023-07-25 13:32:09,564 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 734.6436767578125, ACC: 0.5739889144897461
2023-07-25 13:32:21,079 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 747.9461059570312, ACC: 0.5740827322006226
2023-07-25 13:32:33,508 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 763.4037475585938, ACC: 0.5729351043701172
2023-07-25 13:32:33,603 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-RH850_30-timesteps_vis.h5
2023-07-25 13:33:27,082 - root - INFO - ------------------ Configuration ------------------
2023-07-25 13:33:27,082 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 13:33:27,082 - root - INFO - Configuration name: afno_backbone
2023-07-25 13:33:27,082 - root - INFO - log_to_wandb True
2023-07-25 13:33:27,082 - root - INFO - lr 0.0005
2023-07-25 13:33:27,082 - root - INFO - batch_size 64
2023-07-25 13:33:27,082 - root - INFO - max_epochs 150
2023-07-25 13:33:27,082 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 13:33:27,082 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 13:33:27,082 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 13:33:27,082 - root - INFO - orography False
2023-07-25 13:33:27,082 - root - INFO - orography_path None
2023-07-25 13:33:27,082 - root - INFO - exp_dir FourCastNet/results
2023-07-25 13:33:27,083 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 13:33:27,083 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 13:33:27,083 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 13:33:27,083 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 13:33:27,083 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 13:33:27,083 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 13:33:27,083 - root - INFO - loss l2
2023-07-25 13:33:27,083 - root - INFO - num_data_workers 4
2023-07-25 13:33:27,083 - root - INFO - dt 1
2023-07-25 13:33:27,083 - root - INFO - n_history 0
2023-07-25 13:33:27,083 - root - INFO - prediction_type iterative
2023-07-25 13:33:27,083 - root - INFO - prediction_length 30
2023-07-25 13:33:27,083 - root - INFO - n_initial_conditions 5
2023-07-25 13:33:27,083 - root - INFO - ics_type default
2023-07-25 13:33:27,083 - root - INFO - save_raw_forecasts True
2023-07-25 13:33:27,083 - root - INFO - save_channel False
2023-07-25 13:33:27,084 - root - INFO - masked_acc False
2023-07-25 13:33:27,084 - root - INFO - maskpath None
2023-07-25 13:33:27,084 - root - INFO - perturb False
2023-07-25 13:33:27,084 - root - INFO - add_grid False
2023-07-25 13:33:27,084 - root - INFO - N_grid_channels 0
2023-07-25 13:33:27,084 - root - INFO - gridtype sinusoidal
2023-07-25 13:33:27,084 - root - INFO - roll False
2023-07-25 13:33:27,084 - root - INFO - num_blocks 8
2023-07-25 13:33:27,084 - root - INFO - nettype afno
2023-07-25 13:33:27,084 - root - INFO - patch_size 8
2023-07-25 13:33:27,084 - root - INFO - width 56
2023-07-25 13:33:27,084 - root - INFO - modes 32
2023-07-25 13:33:27,084 - root - INFO - target sp
2023-07-25 13:33:27,084 - root - INFO - normalization zscore
2023-07-25 13:33:27,084 - root - INFO - log_to_screen True
2023-07-25 13:33:27,084 - root - INFO - save_checkpoint True
2023-07-25 13:33:27,084 - root - INFO - enable_nhwc False
2023-07-25 13:33:27,085 - root - INFO - optimizer_type FusedAdam
2023-07-25 13:33:27,085 - root - INFO - crop_size_x None
2023-07-25 13:33:27,085 - root - INFO - crop_size_y None
2023-07-25 13:33:27,085 - root - INFO - two_step_training False
2023-07-25 13:33:27,085 - root - INFO - plot_animations False
2023-07-25 13:33:27,085 - root - INFO - add_noise False
2023-07-25 13:33:27,085 - root - INFO - noise_std 0
2023-07-25 13:33:27,085 - root - INFO - world_size 1
2023-07-25 13:33:27,085 - root - INFO - interp 0
2023-07-25 13:33:27,085 - root - INFO - use_daily_climatology False
2023-07-25 13:33:27,085 - root - INFO - global_batch_size 64
2023-07-25 13:33:27,085 - root - INFO - ablate T500
2023-07-25 13:33:27,085 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 13:33:27,085 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 13:33:27,085 - root - INFO - resuming False
2023-07-25 13:33:27,085 - root - INFO - local_rank 0
2023-07-25 13:33:27,085 - root - INFO - ---------------------------------------------------
2023-07-25 13:33:27,085 - root - INFO - Inference for 1 initial conditions
2023-07-25 13:33:27,347 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 13:33:27,348 - root - INFO - Number of samples per year: 1460
2023-07-25 13:33:27,348 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 13:33:27,348 - root - INFO - Delta t: 6 hours
2023-07-25 13:33:27,348 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 13:33:27,349 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 13:34:39,826 - root - INFO - Loading inference data
2023-07-25 13:34:39,828 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 13:34:40,080 - root - INFO - Initial condition 1 of 1
2023-07-25 13:34:41,011 - root - INFO - Extracting valid data from the first year
2023-07-25 13:37:11,401 - root - INFO - Standardizing data
2023-07-25 13:37:19,583 - root - INFO - Loading time means
2023-07-25 13:37:35,901 - root - INFO - Begin autoregressive inference
2023-07-25 13:37:47,092 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 13:37:58,740 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 178.39920043945312, ACC: 0.9752896428108215
2023-07-25 13:38:09,917 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 171.25686645507812, ACC: 0.9768890738487244
2023-07-25 13:38:21,570 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 176.92628479003906, ACC: 0.9754455089569092
2023-07-25 13:38:32,465 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 189.83120727539062, ACC: 0.9707097411155701
2023-07-25 13:38:43,643 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 201.18690490722656, ACC: 0.9677467942237854
2023-07-25 13:38:54,876 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 214.13124084472656, ACC: 0.9634266495704651
2023-07-25 13:39:06,335 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 223.67491149902344, ACC: 0.9614718556404114
2023-07-25 13:39:18,306 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 236.90438842773438, ACC: 0.9565404653549194
2023-07-25 13:39:29,501 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 252.11224365234375, ACC: 0.9528346657752991
2023-07-25 13:39:40,368 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 266.9880065917969, ACC: 0.9474911689758301
2023-07-25 13:39:50,793 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 280.3743591308594, ACC: 0.9426732063293457
2023-07-25 13:40:02,998 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 301.03790283203125, ACC: 0.93293297290802
2023-07-25 13:40:14,878 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 329.0080261230469, ACC: 0.9200524091720581
2023-07-25 13:40:25,952 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 359.7978515625, ACC: 0.9031752347946167
2023-07-25 13:40:37,256 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 389.20623779296875, ACC: 0.8866752982139587
2023-07-25 13:40:47,968 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 414.14404296875, ACC: 0.8708462119102478
2023-07-25 13:40:59,107 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 435.16583251953125, ACC: 0.8561415076255798
2023-07-25 13:41:10,287 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 445.0663146972656, ACC: 0.845150887966156
2023-07-25 13:41:21,361 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 453.5168151855469, ACC: 0.833917498588562
2023-07-25 13:41:32,616 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 467.42364501953125, ACC: 0.8149958848953247
2023-07-25 13:41:44,606 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 485.0343017578125, ACC: 0.796674907207489
2023-07-25 13:41:55,137 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 503.0850830078125, ACC: 0.7751232981681824
2023-07-25 13:42:06,841 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 521.4260864257812, ACC: 0.7603499889373779
2023-07-25 13:42:17,736 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 543.8712158203125, ACC: 0.7375994920730591
2023-07-25 13:42:28,200 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 572.1014404296875, ACC: 0.7216967940330505
2023-07-25 13:42:39,463 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 599.7718505859375, ACC: 0.6987825036048889
2023-07-25 13:42:51,852 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 624.4991455078125, ACC: 0.6830320954322815
2023-07-25 13:43:03,819 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 648.2613525390625, ACC: 0.6699662208557129
2023-07-25 13:43:15,883 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 671.656494140625, ACC: 0.656335711479187
2023-07-25 13:43:15,975 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-T500_30-timesteps_vis.h5
2023-07-25 13:44:09,410 - root - INFO - ------------------ Configuration ------------------
2023-07-25 13:44:09,411 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 13:44:09,411 - root - INFO - Configuration name: afno_backbone
2023-07-25 13:44:09,411 - root - INFO - log_to_wandb True
2023-07-25 13:44:09,411 - root - INFO - lr 0.0005
2023-07-25 13:44:09,411 - root - INFO - batch_size 64
2023-07-25 13:44:09,411 - root - INFO - max_epochs 150
2023-07-25 13:44:09,411 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 13:44:09,411 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 13:44:09,411 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 13:44:09,411 - root - INFO - orography False
2023-07-25 13:44:09,411 - root - INFO - orography_path None
2023-07-25 13:44:09,411 - root - INFO - exp_dir FourCastNet/results
2023-07-25 13:44:09,411 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 13:44:09,411 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 13:44:09,411 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 13:44:09,412 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 13:44:09,412 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 13:44:09,412 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 13:44:09,412 - root - INFO - loss l2
2023-07-25 13:44:09,412 - root - INFO - num_data_workers 4
2023-07-25 13:44:09,412 - root - INFO - dt 1
2023-07-25 13:44:09,412 - root - INFO - n_history 0
2023-07-25 13:44:09,412 - root - INFO - prediction_type iterative
2023-07-25 13:44:09,412 - root - INFO - prediction_length 30
2023-07-25 13:44:09,412 - root - INFO - n_initial_conditions 5
2023-07-25 13:44:09,412 - root - INFO - ics_type default
2023-07-25 13:44:09,412 - root - INFO - save_raw_forecasts True
2023-07-25 13:44:09,412 - root - INFO - save_channel False
2023-07-25 13:44:09,412 - root - INFO - masked_acc False
2023-07-25 13:44:09,412 - root - INFO - maskpath None
2023-07-25 13:44:09,412 - root - INFO - perturb False
2023-07-25 13:44:09,412 - root - INFO - add_grid False
2023-07-25 13:44:09,412 - root - INFO - N_grid_channels 0
2023-07-25 13:44:09,413 - root - INFO - gridtype sinusoidal
2023-07-25 13:44:09,413 - root - INFO - roll False
2023-07-25 13:44:09,413 - root - INFO - num_blocks 8
2023-07-25 13:44:09,413 - root - INFO - nettype afno
2023-07-25 13:44:09,413 - root - INFO - patch_size 8
2023-07-25 13:44:09,413 - root - INFO - width 56
2023-07-25 13:44:09,413 - root - INFO - modes 32
2023-07-25 13:44:09,413 - root - INFO - target sp
2023-07-25 13:44:09,413 - root - INFO - normalization zscore
2023-07-25 13:44:09,413 - root - INFO - log_to_screen True
2023-07-25 13:44:09,413 - root - INFO - save_checkpoint True
2023-07-25 13:44:09,413 - root - INFO - enable_nhwc False
2023-07-25 13:44:09,413 - root - INFO - optimizer_type FusedAdam
2023-07-25 13:44:09,413 - root - INFO - crop_size_x None
2023-07-25 13:44:09,413 - root - INFO - crop_size_y None
2023-07-25 13:44:09,413 - root - INFO - two_step_training False
2023-07-25 13:44:09,413 - root - INFO - plot_animations False
2023-07-25 13:44:09,413 - root - INFO - add_noise False
2023-07-25 13:44:09,413 - root - INFO - noise_std 0
2023-07-25 13:44:09,414 - root - INFO - world_size 1
2023-07-25 13:44:09,414 - root - INFO - interp 0
2023-07-25 13:44:09,414 - root - INFO - use_daily_climatology False
2023-07-25 13:44:09,414 - root - INFO - global_batch_size 64
2023-07-25 13:44:09,414 - root - INFO - ablate U500
2023-07-25 13:44:09,414 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 13:44:09,414 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 13:44:09,414 - root - INFO - resuming False
2023-07-25 13:44:09,414 - root - INFO - local_rank 0
2023-07-25 13:44:09,414 - root - INFO - ---------------------------------------------------
2023-07-25 13:44:09,414 - root - INFO - Inference for 1 initial conditions
2023-07-25 13:44:09,686 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 13:44:09,687 - root - INFO - Number of samples per year: 1460
2023-07-25 13:44:09,687 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 13:44:09,687 - root - INFO - Delta t: 6 hours
2023-07-25 13:44:09,687 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 13:44:09,687 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 13:45:13,727 - root - INFO - Loading inference data
2023-07-25 13:45:13,728 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 13:45:13,944 - root - INFO - Initial condition 1 of 1
2023-07-25 13:45:14,831 - root - INFO - Extracting valid data from the first year
2023-07-25 13:47:33,295 - root - INFO - Standardizing data
2023-07-25 13:47:41,417 - root - INFO - Loading time means
2023-07-25 13:47:54,987 - root - INFO - Begin autoregressive inference
2023-07-25 13:48:06,092 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 13:48:17,176 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 14154.52734375, ACC: 0.006230330094695091
2023-07-25 13:48:28,724 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 87176.484375, ACC: -0.03996088728308678
2023-07-25 13:48:40,440 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 113883.4921875, ACC: -0.02507118694484234
2023-07-25 13:48:52,105 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 120041.7265625, ACC: -0.017845751717686653
2023-07-25 13:49:03,706 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 115405.8359375, ACC: -0.006426658481359482
2023-07-25 13:49:15,306 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 111489.234375, ACC: -0.00011677588918246329
2023-07-25 13:49:26,597 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 110678.7265625, ACC: 0.009039378724992275
2023-07-25 13:49:38,250 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 111434.1328125, ACC: 0.013871653005480766
2023-07-25 13:49:50,614 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 112429.359375, ACC: 0.014024707488715649
2023-07-25 13:50:02,198 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 113298.3828125, ACC: 0.011075343936681747
2023-07-25 13:50:14,257 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 114059.375, ACC: 0.009000553749501705
2023-07-25 13:50:26,240 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 114725.8828125, ACC: 0.006706163752824068
2023-07-25 13:50:37,613 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 115278.3359375, ACC: 0.006402147933840752
2023-07-25 13:50:48,798 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 115713.8046875, ACC: 0.005441564600914717
2023-07-25 13:50:59,849 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 116043.375, ACC: 0.0051774634048342705
2023-07-25 13:51:12,209 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 116287.921875, ACC: 0.0038892512675374746
2023-07-25 13:51:23,982 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 116465.5625, ACC: 0.0036634921561926603
2023-07-25 13:51:37,144 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 116595.0, ACC: 0.002209158381447196
2023-07-25 13:51:48,998 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 116687.3671875, ACC: 0.0020454374607652426
2023-07-25 13:52:01,054 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 116754.0859375, ACC: 0.0013179914094507694
2023-07-25 13:52:14,227 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 116801.5625, ACC: 0.0012715613702312112
2023-07-25 13:52:25,214 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 116835.9765625, ACC: 0.0007161060348153114
2023-07-25 13:52:37,099 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 116860.015625, ACC: 0.0012025232426822186
2023-07-25 13:52:49,222 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 116877.5703125, ACC: 0.001114610000513494
2023-07-25 13:53:02,027 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 116889.234375, ACC: 0.002390341367572546
2023-07-25 13:53:14,288 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 116898.0078125, ACC: 0.002782110357657075
2023-07-25 13:53:25,706 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 116903.703125, ACC: 0.0038118036463856697
2023-07-25 13:53:37,618 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 116908.640625, ACC: 0.0035441715735942125
2023-07-25 13:53:49,331 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 116911.1640625, ACC: 0.00457813311368227
2023-07-25 13:53:49,417 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-U500_30-timesteps_vis.h5
2023-07-25 13:54:42,763 - root - INFO - ------------------ Configuration ------------------
2023-07-25 13:54:42,763 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 13:54:42,763 - root - INFO - Configuration name: afno_backbone
2023-07-25 13:54:42,763 - root - INFO - log_to_wandb True
2023-07-25 13:54:42,763 - root - INFO - lr 0.0005
2023-07-25 13:54:42,763 - root - INFO - batch_size 64
2023-07-25 13:54:42,763 - root - INFO - max_epochs 150
2023-07-25 13:54:42,763 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 13:54:42,763 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 13:54:42,763 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 13:54:42,763 - root - INFO - orography False
2023-07-25 13:54:42,763 - root - INFO - orography_path None
2023-07-25 13:54:42,763 - root - INFO - exp_dir FourCastNet/results
2023-07-25 13:54:42,763 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 13:54:42,763 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 13:54:42,764 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 13:54:42,764 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 13:54:42,764 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 13:54:42,764 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 13:54:42,764 - root - INFO - loss l2
2023-07-25 13:54:42,764 - root - INFO - num_data_workers 4
2023-07-25 13:54:42,764 - root - INFO - dt 1
2023-07-25 13:54:42,764 - root - INFO - n_history 0
2023-07-25 13:54:42,764 - root - INFO - prediction_type iterative
2023-07-25 13:54:42,764 - root - INFO - prediction_length 30
2023-07-25 13:54:42,764 - root - INFO - n_initial_conditions 5
2023-07-25 13:54:42,764 - root - INFO - ics_type default
2023-07-25 13:54:42,764 - root - INFO - save_raw_forecasts True
2023-07-25 13:54:42,764 - root - INFO - save_channel False
2023-07-25 13:54:42,764 - root - INFO - masked_acc False
2023-07-25 13:54:42,764 - root - INFO - maskpath None
2023-07-25 13:54:42,764 - root - INFO - perturb False
2023-07-25 13:54:42,765 - root - INFO - add_grid False
2023-07-25 13:54:42,765 - root - INFO - N_grid_channels 0
2023-07-25 13:54:42,765 - root - INFO - gridtype sinusoidal
2023-07-25 13:54:42,765 - root - INFO - roll False
2023-07-25 13:54:42,765 - root - INFO - num_blocks 8
2023-07-25 13:54:42,765 - root - INFO - nettype afno
2023-07-25 13:54:42,765 - root - INFO - patch_size 8
2023-07-25 13:54:42,765 - root - INFO - width 56
2023-07-25 13:54:42,765 - root - INFO - modes 32
2023-07-25 13:54:42,765 - root - INFO - target sp
2023-07-25 13:54:42,765 - root - INFO - normalization zscore
2023-07-25 13:54:42,765 - root - INFO - log_to_screen True
2023-07-25 13:54:42,765 - root - INFO - save_checkpoint True
2023-07-25 13:54:42,765 - root - INFO - enable_nhwc False
2023-07-25 13:54:42,765 - root - INFO - optimizer_type FusedAdam
2023-07-25 13:54:42,765 - root - INFO - crop_size_x None
2023-07-25 13:54:42,765 - root - INFO - crop_size_y None
2023-07-25 13:54:42,765 - root - INFO - two_step_training False
2023-07-25 13:54:42,766 - root - INFO - plot_animations False
2023-07-25 13:54:42,766 - root - INFO - add_noise False
2023-07-25 13:54:42,766 - root - INFO - noise_std 0
2023-07-25 13:54:42,766 - root - INFO - world_size 1
2023-07-25 13:54:42,766 - root - INFO - interp 0
2023-07-25 13:54:42,766 - root - INFO - use_daily_climatology False
2023-07-25 13:54:42,766 - root - INFO - global_batch_size 64
2023-07-25 13:54:42,766 - root - INFO - ablate V500
2023-07-25 13:54:42,766 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 13:54:42,766 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 13:54:42,766 - root - INFO - resuming False
2023-07-25 13:54:42,766 - root - INFO - local_rank 0
2023-07-25 13:54:42,766 - root - INFO - ---------------------------------------------------
2023-07-25 13:54:42,766 - root - INFO - Inference for 1 initial conditions
2023-07-25 13:54:43,040 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 13:54:43,042 - root - INFO - Number of samples per year: 1460
2023-07-25 13:54:43,042 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 13:54:43,042 - root - INFO - Delta t: 6 hours
2023-07-25 13:54:43,042 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 13:54:43,042 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 13:55:43,010 - root - INFO - Loading inference data
2023-07-25 13:55:43,011 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 13:55:43,159 - root - INFO - Initial condition 1 of 1
2023-07-25 13:55:44,039 - root - INFO - Extracting valid data from the first year
2023-07-25 13:58:01,988 - root - INFO - Standardizing data
2023-07-25 13:58:10,232 - root - INFO - Loading time means
2023-07-25 13:58:24,701 - root - INFO - Begin autoregressive inference
2023-07-25 13:58:36,172 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 13:58:48,231 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 78422.71875, ACC: 0.009165245108306408
2023-07-25 13:58:59,546 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 102063.375, ACC: 0.04376016557216644
2023-07-25 13:59:10,016 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 116238.6640625, ACC: 0.037803564220666885
2023-07-25 13:59:20,422 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 115969.3046875, ACC: 0.03068316914141178
2023-07-25 13:59:30,768 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 111913.5390625, ACC: 0.02530023828148842
2023-07-25 13:59:41,967 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 109758.6875, ACC: 0.017581872642040253
2023-07-25 13:59:53,120 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 109706.0078125, ACC: 0.013913671486079693
2023-07-25 14:00:04,415 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 110680.4140625, ACC: 0.011143169365823269
2023-07-25 14:00:16,057 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 111900.8046875, ACC: 0.009733275510370731
2023-07-25 14:00:27,967 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 113076.1484375, ACC: 0.007940354757010937
2023-07-25 14:00:39,282 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 114040.0703125, ACC: 0.0073999324813485146
2023-07-25 14:00:51,014 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 114878.28125, ACC: 0.007184783462435007
2023-07-25 14:01:02,211 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 115495.3125, ACC: 0.008348062634468079
2023-07-25 14:01:12,924 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 115891.125, ACC: 0.007779583800584078
2023-07-25 14:01:23,929 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 116147.6875, ACC: 0.006990516092628241
2023-07-25 14:01:34,443 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 116338.9609375, ACC: 0.005152721423655748
2023-07-25 14:01:45,493 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 116488.546875, ACC: 0.004360446240752935
2023-07-25 14:01:57,733 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 116605.1796875, ACC: 0.002574378624558449
2023-07-25 14:02:10,023 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 116692.0625, ACC: 0.0022053904831409454
2023-07-25 14:02:21,010 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 116756.5390625, ACC: 0.0013800233136862516
2023-07-25 14:02:32,522 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 116803.0859375, ACC: 0.0012838253751397133
2023-07-25 14:02:43,438 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 116837.09375, ACC: 0.0007095079636201262
2023-07-25 14:02:54,909 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 116860.890625, ACC: 0.0011961918789893389
2023-07-25 14:03:07,625 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 116878.2734375, ACC: 0.001111667021177709
2023-07-25 14:03:19,414 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 116889.8046875, ACC: 0.002391108311712742
2023-07-25 14:03:30,521 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 116898.46875, ACC: 0.002784944837912917
2023-07-25 14:03:41,974 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 116904.0625, ACC: 0.0038154011126607656
2023-07-25 14:03:52,811 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 116908.9296875, ACC: 0.003547250758856535
2023-07-25 14:04:03,834 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 116911.3828125, ACC: 0.004580906126648188
2023-07-25 14:04:03,922 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-V500_30-timesteps_vis.h5
2023-07-25 14:04:57,173 - root - INFO - ------------------ Configuration ------------------
2023-07-25 14:04:57,173 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 14:04:57,173 - root - INFO - Configuration name: afno_backbone
2023-07-25 14:04:57,173 - root - INFO - log_to_wandb True
2023-07-25 14:04:57,173 - root - INFO - lr 0.0005
2023-07-25 14:04:57,173 - root - INFO - batch_size 64
2023-07-25 14:04:57,173 - root - INFO - max_epochs 150
2023-07-25 14:04:57,173 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 14:04:57,173 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 14:04:57,173 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 14:04:57,173 - root - INFO - orography False
2023-07-25 14:04:57,173 - root - INFO - orography_path None
2023-07-25 14:04:57,173 - root - INFO - exp_dir FourCastNet/results
2023-07-25 14:04:57,173 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 14:04:57,173 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 14:04:57,174 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 14:04:57,174 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 14:04:57,174 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 14:04:57,174 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 14:04:57,174 - root - INFO - loss l2
2023-07-25 14:04:57,174 - root - INFO - num_data_workers 4
2023-07-25 14:04:57,174 - root - INFO - dt 1
2023-07-25 14:04:57,174 - root - INFO - n_history 0
2023-07-25 14:04:57,174 - root - INFO - prediction_type iterative
2023-07-25 14:04:57,174 - root - INFO - prediction_length 30
2023-07-25 14:04:57,174 - root - INFO - n_initial_conditions 5
2023-07-25 14:04:57,174 - root - INFO - ics_type default
2023-07-25 14:04:57,174 - root - INFO - save_raw_forecasts True
2023-07-25 14:04:57,174 - root - INFO - save_channel False
2023-07-25 14:04:57,174 - root - INFO - masked_acc False
2023-07-25 14:04:57,174 - root - INFO - maskpath None
2023-07-25 14:04:57,174 - root - INFO - perturb False
2023-07-25 14:04:57,174 - root - INFO - add_grid False
2023-07-25 14:04:57,174 - root - INFO - N_grid_channels 0
2023-07-25 14:04:57,174 - root - INFO - gridtype sinusoidal
2023-07-25 14:04:57,174 - root - INFO - roll False
2023-07-25 14:04:57,175 - root - INFO - num_blocks 8
2023-07-25 14:04:57,175 - root - INFO - nettype afno
2023-07-25 14:04:57,175 - root - INFO - patch_size 8
2023-07-25 14:04:57,175 - root - INFO - width 56
2023-07-25 14:04:57,175 - root - INFO - modes 32
2023-07-25 14:04:57,175 - root - INFO - target sp
2023-07-25 14:04:57,175 - root - INFO - normalization zscore
2023-07-25 14:04:57,175 - root - INFO - log_to_screen True
2023-07-25 14:04:57,175 - root - INFO - save_checkpoint True
2023-07-25 14:04:57,175 - root - INFO - enable_nhwc False
2023-07-25 14:04:57,175 - root - INFO - optimizer_type FusedAdam
2023-07-25 14:04:57,175 - root - INFO - crop_size_x None
2023-07-25 14:04:57,175 - root - INFO - crop_size_y None
2023-07-25 14:04:57,175 - root - INFO - two_step_training False
2023-07-25 14:04:57,175 - root - INFO - plot_animations False
2023-07-25 14:04:57,175 - root - INFO - add_noise False
2023-07-25 14:04:57,175 - root - INFO - noise_std 0
2023-07-25 14:04:57,176 - root - INFO - world_size 1
2023-07-25 14:04:57,176 - root - INFO - interp 0
2023-07-25 14:04:57,176 - root - INFO - use_daily_climatology False
2023-07-25 14:04:57,176 - root - INFO - global_batch_size 64
2023-07-25 14:04:57,176 - root - INFO - ablate Z500
2023-07-25 14:04:57,176 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 14:04:57,176 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 14:04:57,176 - root - INFO - resuming False
2023-07-25 14:04:57,176 - root - INFO - local_rank 0
2023-07-25 14:04:57,176 - root - INFO - ---------------------------------------------------
2023-07-25 14:04:57,176 - root - INFO - Inference for 1 initial conditions
2023-07-25 14:04:57,456 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 14:04:57,457 - root - INFO - Number of samples per year: 1460
2023-07-25 14:04:57,457 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 14:04:57,457 - root - INFO - Delta t: 6 hours
2023-07-25 14:04:57,457 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 14:04:57,457 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 14:06:06,398 - root - INFO - Loading inference data
2023-07-25 14:06:06,398 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 14:06:06,620 - root - INFO - Initial condition 1 of 1
2023-07-25 14:06:07,465 - root - INFO - Extracting valid data from the first year
2023-07-25 14:08:28,116 - root - INFO - Standardizing data
2023-07-25 14:08:36,106 - root - INFO - Loading time means
2023-07-25 14:08:51,248 - root - INFO - Begin autoregressive inference
2023-07-25 14:09:02,039 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 14:09:13,014 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 146.82669067382812, ACC: 0.9839147329330444
2023-07-25 14:09:23,354 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 161.815185546875, ACC: 0.9799860715866089
2023-07-25 14:09:33,997 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 176.3280029296875, ACC: 0.9762641787528992
2023-07-25 14:09:45,310 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 193.94300842285156, ACC: 0.9701725840568542
2023-07-25 14:09:56,177 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 206.95260620117188, ACC: 0.966676652431488
2023-07-25 14:10:07,842 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 228.38299560546875, ACC: 0.9593347907066345
2023-07-25 14:10:19,417 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 246.07472229003906, ACC: 0.954444408416748
2023-07-25 14:10:31,017 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 270.03887939453125, ACC: 0.944983184337616
2023-07-25 14:10:41,932 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 291.08416748046875, ACC: 0.9391145706176758
2023-07-25 14:10:52,918 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 312.49371337890625, ACC: 0.9303973317146301
2023-07-25 14:11:04,224 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 328.41650390625, ACC: 0.9238851070404053
2023-07-25 14:11:16,377 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 349.7384948730469, ACC: 0.9120422005653381
2023-07-25 14:11:27,686 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 369.661376953125, ACC: 0.901951789855957
2023-07-25 14:11:39,713 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 392.2978820800781, ACC: 0.8877007961273193
2023-07-25 14:11:49,952 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 417.5580749511719, ACC: 0.872675359249115
2023-07-25 14:12:00,969 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 444.7832336425781, ACC: 0.8546786308288574
2023-07-25 14:12:12,736 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 469.3579406738281, ACC: 0.8365168571472168
2023-07-25 14:12:23,829 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 498.1797180175781, ACC: 0.8109863996505737
2023-07-25 14:12:35,719 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 524.8443603515625, ACC: 0.7832480669021606
2023-07-25 14:12:46,534 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 554.96630859375, ACC: 0.749346911907196
2023-07-25 14:12:58,640 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 590.4393310546875, ACC: 0.7120882868766785
2023-07-25 14:13:10,450 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 633.1973266601562, ACC: 0.6652910113334656
2023-07-25 14:13:22,084 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 677.4400024414062, ACC: 0.6202454566955566
2023-07-25 14:13:33,732 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 727.4401245117188, ACC: 0.5631540417671204
2023-07-25 14:13:44,381 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 775.3726196289062, ACC: 0.5177857875823975
2023-07-25 14:13:55,608 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 809.7125854492188, ACC: 0.47813716530799866
2023-07-25 14:14:06,693 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 831.2496337890625, ACC: 0.4561733305454254
2023-07-25 14:14:17,488 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 849.77294921875, ACC: 0.4451810419559479
2023-07-25 14:14:28,176 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 863.0841064453125, ACC: 0.435666561126709
2023-07-25 14:14:28,273 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-Z500_30-timesteps_vis.h5
2023-07-25 14:15:21,669 - root - INFO - ------------------ Configuration ------------------
2023-07-25 14:15:21,669 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 14:15:21,669 - root - INFO - Configuration name: afno_backbone
2023-07-25 14:15:21,669 - root - INFO - log_to_wandb True
2023-07-25 14:15:21,669 - root - INFO - lr 0.0005
2023-07-25 14:15:21,669 - root - INFO - batch_size 64
2023-07-25 14:15:21,669 - root - INFO - max_epochs 150
2023-07-25 14:15:21,669 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 14:15:21,669 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 14:15:21,670 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 14:15:21,670 - root - INFO - orography False
2023-07-25 14:15:21,670 - root - INFO - orography_path None
2023-07-25 14:15:21,670 - root - INFO - exp_dir FourCastNet/results
2023-07-25 14:15:21,670 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 14:15:21,670 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 14:15:21,670 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 14:15:21,670 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 14:15:21,670 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 14:15:21,670 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 14:15:21,670 - root - INFO - loss l2
2023-07-25 14:15:21,670 - root - INFO - num_data_workers 4
2023-07-25 14:15:21,670 - root - INFO - dt 1
2023-07-25 14:15:21,670 - root - INFO - n_history 0
2023-07-25 14:15:21,670 - root - INFO - prediction_type iterative
2023-07-25 14:15:21,671 - root - INFO - prediction_length 30
2023-07-25 14:15:21,671 - root - INFO - n_initial_conditions 5
2023-07-25 14:15:21,671 - root - INFO - ics_type default
2023-07-25 14:15:21,671 - root - INFO - save_raw_forecasts True
2023-07-25 14:15:21,671 - root - INFO - save_channel False
2023-07-25 14:15:21,671 - root - INFO - masked_acc False
2023-07-25 14:15:21,671 - root - INFO - maskpath None
2023-07-25 14:15:21,671 - root - INFO - perturb False
2023-07-25 14:15:21,671 - root - INFO - add_grid False
2023-07-25 14:15:21,671 - root - INFO - N_grid_channels 0
2023-07-25 14:15:21,672 - root - INFO - gridtype sinusoidal
2023-07-25 14:15:21,672 - root - INFO - roll False
2023-07-25 14:15:21,672 - root - INFO - num_blocks 8
2023-07-25 14:15:21,672 - root - INFO - nettype afno
2023-07-25 14:15:21,672 - root - INFO - patch_size 8
2023-07-25 14:15:21,672 - root - INFO - width 56
2023-07-25 14:15:21,672 - root - INFO - modes 32
2023-07-25 14:15:21,672 - root - INFO - target sp
2023-07-25 14:15:21,672 - root - INFO - normalization zscore
2023-07-25 14:15:21,672 - root - INFO - log_to_screen True
2023-07-25 14:15:21,672 - root - INFO - save_checkpoint True
2023-07-25 14:15:21,672 - root - INFO - enable_nhwc False
2023-07-25 14:15:21,672 - root - INFO - optimizer_type FusedAdam
2023-07-25 14:15:21,672 - root - INFO - crop_size_x None
2023-07-25 14:15:21,672 - root - INFO - crop_size_y None
2023-07-25 14:15:21,672 - root - INFO - two_step_training False
2023-07-25 14:15:21,672 - root - INFO - plot_animations False
2023-07-25 14:15:21,672 - root - INFO - add_noise False
2023-07-25 14:15:21,672 - root - INFO - noise_std 0
2023-07-25 14:15:21,672 - root - INFO - world_size 1
2023-07-25 14:15:21,672 - root - INFO - interp 0
2023-07-25 14:15:21,673 - root - INFO - use_daily_climatology False
2023-07-25 14:15:21,673 - root - INFO - global_batch_size 64
2023-07-25 14:15:21,673 - root - INFO - ablate RH500
2023-07-25 14:15:21,673 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 14:15:21,673 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 14:15:21,673 - root - INFO - resuming False
2023-07-25 14:15:21,673 - root - INFO - local_rank 0
2023-07-25 14:15:21,673 - root - INFO - ---------------------------------------------------
2023-07-25 14:15:21,673 - root - INFO - Inference for 1 initial conditions
2023-07-25 14:15:22,009 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 14:15:22,010 - root - INFO - Number of samples per year: 1460
2023-07-25 14:15:22,010 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 14:15:22,011 - root - INFO - Delta t: 6 hours
2023-07-25 14:15:22,011 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 14:15:22,011 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 14:16:27,615 - root - INFO - Loading inference data
2023-07-25 14:16:27,616 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 14:16:27,846 - root - INFO - Initial condition 1 of 1
2023-07-25 14:16:28,679 - root - INFO - Extracting valid data from the first year
2023-07-25 14:18:52,358 - root - INFO - Standardizing data
2023-07-25 14:19:00,497 - root - INFO - Loading time means
2023-07-25 14:19:15,611 - root - INFO - Begin autoregressive inference
2023-07-25 14:19:26,580 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 14:19:39,250 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 144.09002685546875, ACC: 0.9844273924827576
2023-07-25 14:19:50,735 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 154.0198211669922, ACC: 0.9818806648254395
2023-07-25 14:20:01,774 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 164.29736328125, ACC: 0.9795160889625549
2023-07-25 14:20:13,281 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 177.6573944091797, ACC: 0.9753222465515137
2023-07-25 14:20:24,522 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 192.15823364257812, ACC: 0.9716320037841797
2023-07-25 14:20:35,770 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 205.31289672851562, ACC: 0.9676365852355957
2023-07-25 14:20:47,100 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 216.6106719970703, ACC: 0.9652085900306702
2023-07-25 14:20:57,754 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 232.63558959960938, ACC: 0.9598332643508911
2023-07-25 14:21:09,275 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 249.4147186279297, ACC: 0.9556166529655457
2023-07-25 14:21:19,518 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 267.06744384765625, ACC: 0.9492388963699341
2023-07-25 14:21:30,279 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 284.38128662109375, ACC: 0.9429557919502258
2023-07-25 14:21:40,914 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 307.6061706542969, ACC: 0.9319859743118286
2023-07-25 14:21:52,204 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 335.4693298339844, ACC: 0.919067919254303
2023-07-25 14:22:03,705 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 362.4411926269531, ACC: 0.9035942554473877
2023-07-25 14:22:15,141 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 389.52435302734375, ACC: 0.8889024257659912
2023-07-25 14:22:25,903 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 419.3811340332031, ACC: 0.8699877262115479
2023-07-25 14:22:36,769 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 447.20880126953125, ACC: 0.8499243855476379
2023-07-25 14:22:47,468 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 467.93670654296875, ACC: 0.8295964598655701
2023-07-25 14:22:58,404 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 483.8179626464844, ACC: 0.8115630745887756
2023-07-25 14:23:09,026 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 503.1817321777344, ACC: 0.7870307564735413
2023-07-25 14:23:19,425 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 524.97705078125, ACC: 0.7653798460960388
2023-07-25 14:23:29,914 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 550.996826171875, ACC: 0.7372657060623169
2023-07-25 14:23:40,612 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 575.8758544921875, ACC: 0.718610405921936
2023-07-25 14:23:51,968 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 602.984619140625, ACC: 0.6939775347709656
2023-07-25 14:24:02,561 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 625.5745849609375, ACC: 0.6851891875267029
2023-07-25 14:24:13,448 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 642.0358276367188, ACC: 0.6750994920730591
2023-07-25 14:24:25,613 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 662.9392700195312, ACC: 0.6634329557418823
2023-07-25 14:24:35,873 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 691.3846435546875, ACC: 0.6453951597213745
2023-07-25 14:24:47,076 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 721.8486938476562, ACC: 0.6195955872535706
2023-07-25 14:24:47,169 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-RH500_30-timesteps_vis.h5
2023-07-25 14:25:40,622 - root - INFO - ------------------ Configuration ------------------
2023-07-25 14:25:40,622 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 14:25:40,622 - root - INFO - Configuration name: afno_backbone
2023-07-25 14:25:40,622 - root - INFO - log_to_wandb True
2023-07-25 14:25:40,622 - root - INFO - lr 0.0005
2023-07-25 14:25:40,622 - root - INFO - batch_size 64
2023-07-25 14:25:40,622 - root - INFO - max_epochs 150
2023-07-25 14:25:40,622 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 14:25:40,622 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 14:25:40,622 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 14:25:40,622 - root - INFO - orography False
2023-07-25 14:25:40,622 - root - INFO - orography_path None
2023-07-25 14:25:40,623 - root - INFO - exp_dir FourCastNet/results
2023-07-25 14:25:40,623 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 14:25:40,623 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 14:25:40,623 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 14:25:40,623 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 14:25:40,623 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 14:25:40,623 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 14:25:40,623 - root - INFO - loss l2
2023-07-25 14:25:40,623 - root - INFO - num_data_workers 4
2023-07-25 14:25:40,623 - root - INFO - dt 1
2023-07-25 14:25:40,623 - root - INFO - n_history 0
2023-07-25 14:25:40,623 - root - INFO - prediction_type iterative
2023-07-25 14:25:40,623 - root - INFO - prediction_length 30
2023-07-25 14:25:40,623 - root - INFO - n_initial_conditions 5
2023-07-25 14:25:40,623 - root - INFO - ics_type default
2023-07-25 14:25:40,623 - root - INFO - save_raw_forecasts True
2023-07-25 14:25:40,623 - root - INFO - save_channel False
2023-07-25 14:25:40,623 - root - INFO - masked_acc False
2023-07-25 14:25:40,623 - root - INFO - maskpath None
2023-07-25 14:25:40,623 - root - INFO - perturb False
2023-07-25 14:25:40,623 - root - INFO - add_grid False
2023-07-25 14:25:40,623 - root - INFO - N_grid_channels 0
2023-07-25 14:25:40,623 - root - INFO - gridtype sinusoidal
2023-07-25 14:25:40,623 - root - INFO - roll False
2023-07-25 14:25:40,623 - root - INFO - num_blocks 8
2023-07-25 14:25:40,623 - root - INFO - nettype afno
2023-07-25 14:25:40,623 - root - INFO - patch_size 8
2023-07-25 14:25:40,624 - root - INFO - width 56
2023-07-25 14:25:40,624 - root - INFO - modes 32
2023-07-25 14:25:40,624 - root - INFO - target sp
2023-07-25 14:25:40,624 - root - INFO - normalization zscore
2023-07-25 14:25:40,624 - root - INFO - log_to_screen True
2023-07-25 14:25:40,624 - root - INFO - save_checkpoint True
2023-07-25 14:25:40,624 - root - INFO - enable_nhwc False
2023-07-25 14:25:40,624 - root - INFO - optimizer_type FusedAdam
2023-07-25 14:25:40,624 - root - INFO - crop_size_x None
2023-07-25 14:25:40,624 - root - INFO - crop_size_y None
2023-07-25 14:25:40,624 - root - INFO - two_step_training False
2023-07-25 14:25:40,624 - root - INFO - plot_animations False
2023-07-25 14:25:40,624 - root - INFO - add_noise False
2023-07-25 14:25:40,624 - root - INFO - noise_std 0
2023-07-25 14:25:40,624 - root - INFO - world_size 1
2023-07-25 14:25:40,624 - root - INFO - interp 0
2023-07-25 14:25:40,624 - root - INFO - use_daily_climatology False
2023-07-25 14:25:40,624 - root - INFO - global_batch_size 64
2023-07-25 14:25:40,624 - root - INFO - ablate Z50
2023-07-25 14:25:40,624 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 14:25:40,624 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 14:25:40,624 - root - INFO - resuming False
2023-07-25 14:25:40,624 - root - INFO - local_rank 0
2023-07-25 14:25:40,624 - root - INFO - ---------------------------------------------------
2023-07-25 14:25:40,624 - root - INFO - Inference for 1 initial conditions
2023-07-25 14:25:40,986 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 14:25:40,993 - root - INFO - Number of samples per year: 1460
2023-07-25 14:25:40,993 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 14:25:40,993 - root - INFO - Delta t: 6 hours
2023-07-25 14:25:40,993 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 14:25:40,994 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 14:26:54,855 - root - INFO - Loading inference data
2023-07-25 14:26:54,857 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 14:26:55,076 - root - INFO - Initial condition 1 of 1
2023-07-25 14:26:56,057 - root - INFO - Extracting valid data from the first year
2023-07-25 14:29:33,419 - root - INFO - Standardizing data
2023-07-25 14:29:41,623 - root - INFO - Loading time means
2023-07-25 14:29:57,319 - root - INFO - Begin autoregressive inference
2023-07-25 14:30:09,885 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 14:30:21,822 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 154.093994140625, ACC: 0.98237544298172
2023-07-25 14:30:32,737 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 159.6279754638672, ACC: 0.9806454181671143
2023-07-25 14:30:44,785 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 167.18263244628906, ACC: 0.9788609743118286
2023-07-25 14:30:56,378 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 178.2715301513672, ACC: 0.9750931859016418
2023-07-25 14:31:08,096 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 188.9230194091797, ACC: 0.9726088047027588
2023-07-25 14:31:19,240 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 202.9386749267578, ACC: 0.9684582352638245
2023-07-25 14:31:30,098 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 214.38479614257812, ACC: 0.9660018086433411
2023-07-25 14:31:41,686 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 229.679931640625, ACC: 0.9606953859329224
2023-07-25 14:31:52,754 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 246.57838439941406, ACC: 0.9567636251449585
2023-07-25 14:32:04,400 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 265.4283447265625, ACC: 0.9501898288726807
2023-07-25 14:32:16,437 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 277.5287170410156, ACC: 0.9460320472717285
2023-07-25 14:32:27,202 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 294.560546875, ACC: 0.9373748302459717
2023-07-25 14:32:38,014 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 317.6383056640625, ACC: 0.9271467924118042
2023-07-25 14:32:48,281 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 342.9286193847656, ACC: 0.9132855534553528
2023-07-25 14:32:58,065 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 365.8973388671875, ACC: 0.9011912941932678
2023-07-25 14:33:09,243 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 391.5857849121094, ACC: 0.8851787447929382
2023-07-25 14:33:19,784 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 414.94183349609375, ACC: 0.8697013258934021
2023-07-25 14:33:31,970 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 436.2978210449219, ACC: 0.8512172698974609
2023-07-25 14:33:43,240 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 448.7037658691406, ACC: 0.8371862173080444
2023-07-25 14:33:54,832 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 466.68585205078125, ACC: 0.814570426940918
2023-07-25 14:34:05,947 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 488.61151123046875, ACC: 0.7929133176803589
2023-07-25 14:34:16,778 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 518.3868408203125, ACC: 0.7611653208732605
2023-07-25 14:34:27,931 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 545.5587158203125, ACC: 0.7374019026756287
2023-07-25 14:34:39,452 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 579.1156005859375, ACC: 0.701376736164093
2023-07-25 14:34:49,931 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 611.0330200195312, ACC: 0.6822100281715393
2023-07-25 14:35:01,320 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 642.8719482421875, ACC: 0.654731035232544
2023-07-25 14:35:11,527 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 673.1652221679688, ACC: 0.6330754160881042
2023-07-25 14:35:23,372 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 705.0111083984375, ACC: 0.6090796589851379
2023-07-25 14:35:34,010 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 730.7553100585938, ACC: 0.5914233326911926
2023-07-25 14:35:34,096 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-Z50_30-timesteps_vis.h5
2023-07-25 14:36:27,262 - root - INFO - ------------------ Configuration ------------------
2023-07-25 14:36:27,262 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 14:36:27,262 - root - INFO - Configuration name: afno_backbone
2023-07-25 14:36:27,262 - root - INFO - log_to_wandb True
2023-07-25 14:36:27,262 - root - INFO - lr 0.0005
2023-07-25 14:36:27,262 - root - INFO - batch_size 64
2023-07-25 14:36:27,262 - root - INFO - max_epochs 150
2023-07-25 14:36:27,262 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 14:36:27,262 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 14:36:27,262 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 14:36:27,262 - root - INFO - orography False
2023-07-25 14:36:27,262 - root - INFO - orography_path None
2023-07-25 14:36:27,262 - root - INFO - exp_dir FourCastNet/results
2023-07-25 14:36:27,262 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 14:36:27,263 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 14:36:27,263 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 14:36:27,263 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 14:36:27,263 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 14:36:27,263 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 14:36:27,263 - root - INFO - loss l2
2023-07-25 14:36:27,263 - root - INFO - num_data_workers 4
2023-07-25 14:36:27,263 - root - INFO - dt 1
2023-07-25 14:36:27,263 - root - INFO - n_history 0
2023-07-25 14:36:27,263 - root - INFO - prediction_type iterative
2023-07-25 14:36:27,264 - root - INFO - prediction_length 30
2023-07-25 14:36:27,264 - root - INFO - n_initial_conditions 5
2023-07-25 14:36:27,267 - root - INFO - ics_type default
2023-07-25 14:36:27,268 - root - INFO - save_raw_forecasts True
2023-07-25 14:36:27,268 - root - INFO - save_channel False
2023-07-25 14:36:27,268 - root - INFO - masked_acc False
2023-07-25 14:36:27,268 - root - INFO - maskpath None
2023-07-25 14:36:27,270 - root - INFO - perturb False
2023-07-25 14:36:27,270 - root - INFO - add_grid False
2023-07-25 14:36:27,271 - root - INFO - N_grid_channels 0
2023-07-25 14:36:27,271 - root - INFO - gridtype sinusoidal
2023-07-25 14:36:27,271 - root - INFO - roll False
2023-07-25 14:36:27,271 - root - INFO - num_blocks 8
2023-07-25 14:36:27,271 - root - INFO - nettype afno
2023-07-25 14:36:27,271 - root - INFO - patch_size 8
2023-07-25 14:36:27,271 - root - INFO - width 56
2023-07-25 14:36:27,271 - root - INFO - modes 32
2023-07-25 14:36:27,271 - root - INFO - target sp
2023-07-25 14:36:27,271 - root - INFO - normalization zscore
2023-07-25 14:36:27,271 - root - INFO - log_to_screen True
2023-07-25 14:36:27,271 - root - INFO - save_checkpoint True
2023-07-25 14:36:27,271 - root - INFO - enable_nhwc False
2023-07-25 14:36:27,271 - root - INFO - optimizer_type FusedAdam
2023-07-25 14:36:27,271 - root - INFO - crop_size_x None
2023-07-25 14:36:27,271 - root - INFO - crop_size_y None
2023-07-25 14:36:27,271 - root - INFO - two_step_training False
2023-07-25 14:36:27,271 - root - INFO - plot_animations False
2023-07-25 14:36:27,271 - root - INFO - add_noise False
2023-07-25 14:36:27,271 - root - INFO - noise_std 0
2023-07-25 14:36:27,271 - root - INFO - world_size 1
2023-07-25 14:36:27,271 - root - INFO - interp 0
2023-07-25 14:36:27,271 - root - INFO - use_daily_climatology False
2023-07-25 14:36:27,271 - root - INFO - global_batch_size 64
2023-07-25 14:36:27,271 - root - INFO - ablate TCWV
2023-07-25 14:36:27,271 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 14:36:27,271 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 14:36:27,272 - root - INFO - resuming False
2023-07-25 14:36:27,272 - root - INFO - local_rank 0
2023-07-25 14:36:27,272 - root - INFO - ---------------------------------------------------
2023-07-25 14:36:27,272 - root - INFO - Inference for 1 initial conditions
2023-07-25 14:36:27,566 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 14:36:27,568 - root - INFO - Number of samples per year: 1460
2023-07-25 14:36:27,568 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 14:36:27,568 - root - INFO - Delta t: 6 hours
2023-07-25 14:36:27,568 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 14:36:27,569 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 14:37:33,608 - root - INFO - Loading inference data
2023-07-25 14:37:33,608 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 14:37:33,817 - root - INFO - Initial condition 1 of 1
2023-07-25 14:37:34,664 - root - INFO - Extracting valid data from the first year
2023-07-25 14:39:54,038 - root - INFO - Standardizing data
2023-07-25 14:40:02,069 - root - INFO - Loading time means
2023-07-25 14:40:19,606 - root - INFO - Begin autoregressive inference
2023-07-25 14:40:30,754 - root - INFO - Predicted timestep 0 of 30. sp RMS Error: 0.0, ACC: 1.0
2023-07-25 14:40:42,556 - root - INFO - Predicted timestep 1 of 30. sp RMS Error: 713.594970703125, ACC: 0.7288540601730347
2023-07-25 14:40:54,212 - root - INFO - Predicted timestep 2 of 30. sp RMS Error: 1768.3450927734375, ACC: 0.35861748456954956
2023-07-25 14:41:06,107 - root - INFO - Predicted timestep 3 of 30. sp RMS Error: 6187.53466796875, ACC: 0.11750460416078568
2023-07-25 14:41:18,705 - root - INFO - Predicted timestep 4 of 30. sp RMS Error: 9036.49609375, ACC: 0.09261836856603622
2023-07-25 14:41:30,482 - root - INFO - Predicted timestep 5 of 30. sp RMS Error: 9842.048828125, ACC: 0.08502314239740372
2023-07-25 14:41:42,089 - root - INFO - Predicted timestep 6 of 30. sp RMS Error: 9913.4501953125, ACC: 0.07920344173908234
2023-07-25 14:41:53,718 - root - INFO - Predicted timestep 7 of 30. sp RMS Error: 10165.884765625, ACC: 0.0720842182636261
2023-07-25 14:42:05,386 - root - INFO - Predicted timestep 8 of 30. sp RMS Error: 10717.1416015625, ACC: 0.06766845285892487
2023-07-25 14:42:16,988 - root - INFO - Predicted timestep 9 of 30. sp RMS Error: 11574.951171875, ACC: 0.05525752902030945
2023-07-25 14:42:29,655 - root - INFO - Predicted timestep 10 of 30. sp RMS Error: 12607.9482421875, ACC: 0.044069502502679825
2023-07-25 14:42:41,855 - root - INFO - Predicted timestep 11 of 30. sp RMS Error: 13603.537109375, ACC: 0.03191712126135826
2023-07-25 14:42:54,484 - root - INFO - Predicted timestep 12 of 30. sp RMS Error: 14509.0419921875, ACC: 0.023436930030584335
2023-07-25 14:43:06,107 - root - INFO - Predicted timestep 13 of 30. sp RMS Error: 15438.1015625, ACC: 0.020915890112519264
2023-07-25 14:43:17,499 - root - INFO - Predicted timestep 14 of 30. sp RMS Error: 16507.271484375, ACC: 0.02750411443412304
2023-07-25 14:43:28,975 - root - INFO - Predicted timestep 15 of 30. sp RMS Error: 17610.208984375, ACC: 0.029674585908651352
2023-07-25 14:43:40,848 - root - INFO - Predicted timestep 16 of 30. sp RMS Error: 18778.78515625, ACC: 0.0414503775537014
2023-07-25 14:43:52,174 - root - INFO - Predicted timestep 17 of 30. sp RMS Error: 20099.951171875, ACC: 0.04042244330048561
2023-07-25 14:44:03,016 - root - INFO - Predicted timestep 18 of 30. sp RMS Error: 21539.849609375, ACC: 0.04878831282258034
2023-07-25 14:44:14,383 - root - INFO - Predicted timestep 19 of 30. sp RMS Error: 23068.291015625, ACC: 0.04630305618047714
2023-07-25 14:44:26,001 - root - INFO - Predicted timestep 20 of 30. sp RMS Error: 24961.11328125, ACC: 0.04413921386003494
2023-07-25 14:44:37,151 - root - INFO - Predicted timestep 21 of 30. sp RMS Error: 27960.919921875, ACC: 0.016892433166503906
2023-07-25 14:44:48,414 - root - INFO - Predicted timestep 22 of 30. sp RMS Error: 32794.8203125, ACC: 0.0017043176339939237
2023-07-25 14:44:59,753 - root - INFO - Predicted timestep 23 of 30. sp RMS Error: 42769.41015625, ACC: -0.019734906032681465
2023-07-25 14:45:11,584 - root - INFO - Predicted timestep 24 of 30. sp RMS Error: 64028.24609375, ACC: -0.013715378008782864
2023-07-25 14:45:22,709 - root - INFO - Predicted timestep 25 of 30. sp RMS Error: 85088.6875, ACC: -0.013205242343246937
2023-07-25 14:45:33,830 - root - INFO - Predicted timestep 26 of 30. sp RMS Error: 97831.1171875, ACC: -0.006512902677059174
2023-07-25 14:45:44,626 - root - INFO - Predicted timestep 27 of 30. sp RMS Error: 103507.46875, ACC: -0.003493397729471326
2023-07-25 14:45:55,686 - root - INFO - Predicted timestep 28 of 30. sp RMS Error: 105555.703125, ACC: -0.0010403534397482872
2023-07-25 14:46:06,600 - root - INFO - Predicted timestep 29 of 30. sp RMS Error: 107046.265625, ACC: 0.0029674468096345663
2023-07-25 14:46:06,700 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-sp_ablate-TCWV_30-timesteps_vis.h5
2023-07-25 14:47:00,094 - root - INFO - ------------------ Configuration ------------------
2023-07-25 14:47:00,094 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 14:47:00,095 - root - INFO - Configuration name: afno_backbone
2023-07-25 14:47:00,095 - root - INFO - log_to_wandb True
2023-07-25 14:47:00,095 - root - INFO - lr 0.0005
2023-07-25 14:47:00,095 - root - INFO - batch_size 64
2023-07-25 14:47:00,095 - root - INFO - max_epochs 150
2023-07-25 14:47:00,095 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 14:47:00,096 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 14:47:00,096 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 14:47:00,096 - root - INFO - orography False
2023-07-25 14:47:00,096 - root - INFO - orography_path None
2023-07-25 14:47:00,096 - root - INFO - exp_dir FourCastNet/results
2023-07-25 14:47:00,097 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 14:47:00,097 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 14:47:00,097 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 14:47:00,097 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 14:47:00,098 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 14:47:00,099 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 14:47:00,099 - root - INFO - loss l2
2023-07-25 14:47:00,099 - root - INFO - num_data_workers 4
2023-07-25 14:47:00,099 - root - INFO - dt 1
2023-07-25 14:47:00,100 - root - INFO - n_history 0
2023-07-25 14:47:00,100 - root - INFO - prediction_type iterative
2023-07-25 14:47:00,100 - root - INFO - prediction_length 30
2023-07-25 14:47:00,100 - root - INFO - n_initial_conditions 5
2023-07-25 14:47:00,100 - root - INFO - ics_type default
2023-07-25 14:47:00,101 - root - INFO - save_raw_forecasts True
2023-07-25 14:47:00,101 - root - INFO - save_channel False
2023-07-25 14:47:00,101 - root - INFO - masked_acc False
2023-07-25 14:47:00,101 - root - INFO - maskpath None
2023-07-25 14:47:00,101 - root - INFO - perturb False
2023-07-25 14:47:00,101 - root - INFO - add_grid False
2023-07-25 14:47:00,102 - root - INFO - N_grid_channels 0
2023-07-25 14:47:00,102 - root - INFO - gridtype sinusoidal
2023-07-25 14:47:00,102 - root - INFO - roll False
2023-07-25 14:47:00,102 - root - INFO - num_blocks 8
2023-07-25 14:47:00,102 - root - INFO - nettype afno
2023-07-25 14:47:00,103 - root - INFO - patch_size 8
2023-07-25 14:47:00,103 - root - INFO - width 56
2023-07-25 14:47:00,103 - root - INFO - modes 32
2023-07-25 14:47:00,103 - root - INFO - target mslp
2023-07-25 14:47:00,103 - root - INFO - normalization zscore
2023-07-25 14:47:00,104 - root - INFO - log_to_screen True
2023-07-25 14:47:00,104 - root - INFO - save_checkpoint True
2023-07-25 14:47:00,104 - root - INFO - enable_nhwc False
2023-07-25 14:47:00,104 - root - INFO - optimizer_type FusedAdam
2023-07-25 14:47:00,104 - root - INFO - crop_size_x None
2023-07-25 14:47:00,104 - root - INFO - crop_size_y None
2023-07-25 14:47:00,105 - root - INFO - two_step_training False
2023-07-25 14:47:00,105 - root - INFO - plot_animations False
2023-07-25 14:47:00,105 - root - INFO - add_noise False
2023-07-25 14:47:00,105 - root - INFO - noise_std 0
2023-07-25 14:47:00,105 - root - INFO - world_size 1
2023-07-25 14:47:00,106 - root - INFO - interp 0
2023-07-25 14:47:00,106 - root - INFO - use_daily_climatology False
2023-07-25 14:47:00,106 - root - INFO - global_batch_size 64
2023-07-25 14:47:00,106 - root - INFO - ablate U10
2023-07-25 14:47:00,106 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 14:47:00,107 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 14:47:00,107 - root - INFO - resuming False
2023-07-25 14:47:00,107 - root - INFO - local_rank 0
2023-07-25 14:47:00,107 - root - INFO - ---------------------------------------------------
2023-07-25 14:47:00,109 - root - INFO - Inference for 1 initial conditions
2023-07-25 14:47:00,420 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 14:47:00,422 - root - INFO - Number of samples per year: 1460
2023-07-25 14:47:00,422 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 14:47:00,422 - root - INFO - Delta t: 6 hours
2023-07-25 14:47:00,422 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 14:47:00,423 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 14:48:07,534 - root - INFO - Loading inference data
2023-07-25 14:48:07,534 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 14:48:07,827 - root - INFO - Initial condition 1 of 1
2023-07-25 14:48:08,604 - root - INFO - Extracting valid data from the first year
2023-07-25 14:50:39,746 - root - INFO - Standardizing data
2023-07-25 14:50:48,233 - root - INFO - Loading time means
2023-07-25 14:51:03,704 - root - INFO - Begin autoregressive inference
2023-07-25 14:51:15,136 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 14:51:27,556 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 135.87232971191406, ACC: 0.9881458878517151
2023-07-25 14:51:41,307 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 245.9027862548828, ACC: 0.961867094039917
2023-07-25 14:51:54,573 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 923.4368896484375, ACC: 0.6904746890068054
2023-07-25 14:52:08,939 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 1388.6151123046875, ACC: 0.5223950147628784
2023-07-25 14:52:22,395 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 1735.7728271484375, ACC: 0.44720658659935
2023-07-25 14:52:36,776 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 1999.9705810546875, ACC: 0.3927348554134369
2023-07-25 14:52:49,291 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 2263.958984375, ACC: 0.34804558753967285
2023-07-25 14:53:01,695 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 2482.9267578125, ACC: 0.2961854338645935
2023-07-25 14:53:14,472 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 2654.699462890625, ACC: 0.2744637131690979
2023-07-25 14:53:27,642 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 2843.9853515625, ACC: 0.25535449385643005
2023-07-25 14:53:38,844 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 3024.800048828125, ACC: 0.2526291012763977
2023-07-25 14:53:50,978 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 3227.9462890625, ACC: 0.23336713016033173
2023-07-25 14:54:03,307 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 3463.314453125, ACC: 0.21808351576328278
2023-07-25 14:54:16,251 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 3684.635986328125, ACC: 0.19681686162948608
2023-07-25 14:54:28,077 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 3907.875244140625, ACC: 0.1886032670736313
2023-07-25 14:54:39,651 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 4120.06201171875, ACC: 0.171383336186409
2023-07-25 14:54:52,442 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 4344.68212890625, ACC: 0.16454748809337616
2023-07-25 14:55:05,311 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 4616.388671875, ACC: 0.14228852093219757
2023-07-25 14:55:17,649 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 4872.3564453125, ACC: 0.137268528342247
2023-07-25 14:55:29,706 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 5141.1728515625, ACC: 0.1188361793756485
2023-07-25 14:55:41,534 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 5438.3974609375, ACC: 0.10429813712835312
2023-07-25 14:55:52,955 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 5732.05126953125, ACC: 0.06896714866161346
2023-07-25 14:56:04,611 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 6037.0986328125, ACC: 0.04922783374786377
2023-07-25 14:56:16,495 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 6342.68798828125, ACC: 0.03714870288968086
2023-07-25 14:56:27,439 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 6648.833984375, ACC: 0.03508365526795387
2023-07-25 14:56:38,893 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 6992.458984375, ACC: 0.0241819117218256
2023-07-25 14:56:50,818 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 7354.28515625, ACC: 0.027765881270170212
2023-07-25 14:57:01,947 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 7723.7197265625, ACC: 0.034303709864616394
2023-07-25 14:57:13,705 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 8110.2578125, ACC: 0.03401455655694008
2023-07-25 14:57:13,790 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-U10_30-timesteps_vis.h5
2023-07-25 14:58:07,221 - root - INFO - ------------------ Configuration ------------------
2023-07-25 14:58:07,222 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 14:58:07,222 - root - INFO - Configuration name: afno_backbone
2023-07-25 14:58:07,222 - root - INFO - log_to_wandb True
2023-07-25 14:58:07,222 - root - INFO - lr 0.0005
2023-07-25 14:58:07,222 - root - INFO - batch_size 64
2023-07-25 14:58:07,222 - root - INFO - max_epochs 150
2023-07-25 14:58:07,222 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 14:58:07,222 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 14:58:07,222 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 14:58:07,222 - root - INFO - orography False
2023-07-25 14:58:07,222 - root - INFO - orography_path None
2023-07-25 14:58:07,223 - root - INFO - exp_dir FourCastNet/results
2023-07-25 14:58:07,223 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 14:58:07,223 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 14:58:07,223 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 14:58:07,223 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 14:58:07,223 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 14:58:07,223 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 14:58:07,223 - root - INFO - loss l2
2023-07-25 14:58:07,223 - root - INFO - num_data_workers 4
2023-07-25 14:58:07,223 - root - INFO - dt 1
2023-07-25 14:58:07,223 - root - INFO - n_history 0
2023-07-25 14:58:07,223 - root - INFO - prediction_type iterative
2023-07-25 14:58:07,223 - root - INFO - prediction_length 30
2023-07-25 14:58:07,223 - root - INFO - n_initial_conditions 5
2023-07-25 14:58:07,223 - root - INFO - ics_type default
2023-07-25 14:58:07,223 - root - INFO - save_raw_forecasts True
2023-07-25 14:58:07,224 - root - INFO - save_channel False
2023-07-25 14:58:07,224 - root - INFO - masked_acc False
2023-07-25 14:58:07,224 - root - INFO - maskpath None
2023-07-25 14:58:07,224 - root - INFO - perturb False
2023-07-25 14:58:07,224 - root - INFO - add_grid False
2023-07-25 14:58:07,224 - root - INFO - N_grid_channels 0
2023-07-25 14:58:07,224 - root - INFO - gridtype sinusoidal
2023-07-25 14:58:07,224 - root - INFO - roll False
2023-07-25 14:58:07,224 - root - INFO - num_blocks 8
2023-07-25 14:58:07,224 - root - INFO - nettype afno
2023-07-25 14:58:07,225 - root - INFO - patch_size 8
2023-07-25 14:58:07,225 - root - INFO - width 56
2023-07-25 14:58:07,225 - root - INFO - modes 32
2023-07-25 14:58:07,225 - root - INFO - target mslp
2023-07-25 14:58:07,225 - root - INFO - normalization zscore
2023-07-25 14:58:07,225 - root - INFO - log_to_screen True
2023-07-25 14:58:07,225 - root - INFO - save_checkpoint True
2023-07-25 14:58:07,225 - root - INFO - enable_nhwc False
2023-07-25 14:58:07,225 - root - INFO - optimizer_type FusedAdam
2023-07-25 14:58:07,225 - root - INFO - crop_size_x None
2023-07-25 14:58:07,225 - root - INFO - crop_size_y None
2023-07-25 14:58:07,226 - root - INFO - two_step_training False
2023-07-25 14:58:07,226 - root - INFO - plot_animations False
2023-07-25 14:58:07,226 - root - INFO - add_noise False
2023-07-25 14:58:07,226 - root - INFO - noise_std 0
2023-07-25 14:58:07,226 - root - INFO - world_size 1
2023-07-25 14:58:07,226 - root - INFO - interp 0
2023-07-25 14:58:07,226 - root - INFO - use_daily_climatology False
2023-07-25 14:58:07,226 - root - INFO - global_batch_size 64
2023-07-25 14:58:07,226 - root - INFO - ablate V10
2023-07-25 14:58:07,226 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 14:58:07,226 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 14:58:07,226 - root - INFO - resuming False
2023-07-25 14:58:07,227 - root - INFO - local_rank 0
2023-07-25 14:58:07,227 - root - INFO - ---------------------------------------------------
2023-07-25 14:58:07,227 - root - INFO - Inference for 1 initial conditions
2023-07-25 14:58:07,516 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 14:58:07,517 - root - INFO - Number of samples per year: 1460
2023-07-25 14:58:07,517 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 14:58:07,517 - root - INFO - Delta t: 6 hours
2023-07-25 14:58:07,517 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 14:58:07,518 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 14:59:13,104 - root - INFO - Loading inference data
2023-07-25 14:59:13,105 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 14:59:13,414 - root - INFO - Initial condition 1 of 1
2023-07-25 14:59:14,265 - root - INFO - Extracting valid data from the first year
2023-07-25 15:01:31,533 - root - INFO - Standardizing data
2023-07-25 15:01:39,603 - root - INFO - Loading time means
2023-07-25 15:01:57,011 - root - INFO - Begin autoregressive inference
2023-07-25 15:02:08,574 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 15:02:20,871 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 59.72563552856445, ACC: 0.9977660179138184
2023-07-25 15:02:32,581 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 71.71466064453125, ACC: 0.9967622756958008
2023-07-25 15:02:44,571 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 80.35240936279297, ACC: 0.9960054159164429
2023-07-25 15:02:55,793 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 99.97834014892578, ACC: 0.9935333728790283
2023-07-25 15:03:08,083 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 115.07386016845703, ACC: 0.9914172887802124
2023-07-25 15:03:19,752 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 133.93997192382812, ACC: 0.9882495403289795
2023-07-25 15:03:31,561 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 140.39248657226562, ACC: 0.9872695207595825
2023-07-25 15:03:43,021 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 153.11856079101562, ACC: 0.9844962954521179
2023-07-25 15:03:54,106 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 167.91421508789062, ACC: 0.9816945195198059
2023-07-25 15:04:05,309 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 182.49172973632812, ACC: 0.9783639311790466
2023-07-25 15:04:16,929 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 191.06910705566406, ACC: 0.976246178150177
2023-07-25 15:04:28,714 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 209.71949768066406, ACC: 0.9706303477287292
2023-07-25 15:04:40,966 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 237.14320373535156, ACC: 0.9622175097465515
2023-07-25 15:04:52,383 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 266.06085205078125, ACC: 0.9520488381385803
2023-07-25 15:05:04,221 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 288.2544250488281, ACC: 0.9433963298797607
2023-07-25 15:05:15,878 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 315.1844787597656, ACC: 0.9311926960945129
2023-07-25 15:05:27,154 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 339.8523254394531, ACC: 0.9189181923866272
2023-07-25 15:05:38,847 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 361.0751037597656, ACC: 0.9055748581886292
2023-07-25 15:05:49,933 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 374.9917907714844, ACC: 0.8940844535827637
2023-07-25 15:06:02,512 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 389.3888244628906, ACC: 0.8786278963088989
2023-07-25 15:06:15,880 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 404.0877685546875, ACC: 0.8654001951217651
2023-07-25 15:06:27,776 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 423.7353515625, ACC: 0.8473196029663086
2023-07-25 15:06:40,484 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 443.4547424316406, ACC: 0.8334279656410217
2023-07-25 15:06:53,516 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 469.1037902832031, ACC: 0.8095794916152954
2023-07-25 15:07:05,537 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 497.8080749511719, ACC: 0.7933568954467773
2023-07-25 15:07:17,245 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 528.8008422851562, ACC: 0.7707332372665405
2023-07-25 15:07:29,200 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 561.1488647460938, ACC: 0.7510656118392944
2023-07-25 15:07:40,943 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 604.3984985351562, ACC: 0.7185973525047302
2023-07-25 15:07:53,820 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 648.4783325195312, ACC: 0.683532178401947
2023-07-25 15:07:53,906 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-V10_30-timesteps_vis.h5
2023-07-25 15:08:47,274 - root - INFO - ------------------ Configuration ------------------
2023-07-25 15:08:47,274 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 15:08:47,274 - root - INFO - Configuration name: afno_backbone
2023-07-25 15:08:47,274 - root - INFO - log_to_wandb True
2023-07-25 15:08:47,274 - root - INFO - lr 0.0005
2023-07-25 15:08:47,274 - root - INFO - batch_size 64
2023-07-25 15:08:47,274 - root - INFO - max_epochs 150
2023-07-25 15:08:47,274 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 15:08:47,274 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 15:08:47,274 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 15:08:47,274 - root - INFO - orography False
2023-07-25 15:08:47,274 - root - INFO - orography_path None
2023-07-25 15:08:47,274 - root - INFO - exp_dir FourCastNet/results
2023-07-25 15:08:47,274 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 15:08:47,274 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 15:08:47,274 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 15:08:47,275 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 15:08:47,275 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 15:08:47,275 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 15:08:47,275 - root - INFO - loss l2
2023-07-25 15:08:47,275 - root - INFO - num_data_workers 4
2023-07-25 15:08:47,275 - root - INFO - dt 1
2023-07-25 15:08:47,275 - root - INFO - n_history 0
2023-07-25 15:08:47,275 - root - INFO - prediction_type iterative
2023-07-25 15:08:47,275 - root - INFO - prediction_length 30
2023-07-25 15:08:47,275 - root - INFO - n_initial_conditions 5
2023-07-25 15:08:47,275 - root - INFO - ics_type default
2023-07-25 15:08:47,275 - root - INFO - save_raw_forecasts True
2023-07-25 15:08:47,275 - root - INFO - save_channel False
2023-07-25 15:08:47,275 - root - INFO - masked_acc False
2023-07-25 15:08:47,275 - root - INFO - maskpath None
2023-07-25 15:08:47,275 - root - INFO - perturb False
2023-07-25 15:08:47,275 - root - INFO - add_grid False
2023-07-25 15:08:47,275 - root - INFO - N_grid_channels 0
2023-07-25 15:08:47,276 - root - INFO - gridtype sinusoidal
2023-07-25 15:08:47,276 - root - INFO - roll False
2023-07-25 15:08:47,276 - root - INFO - num_blocks 8
2023-07-25 15:08:47,276 - root - INFO - nettype afno
2023-07-25 15:08:47,276 - root - INFO - patch_size 8
2023-07-25 15:08:47,276 - root - INFO - width 56
2023-07-25 15:08:47,276 - root - INFO - modes 32
2023-07-25 15:08:47,276 - root - INFO - target mslp
2023-07-25 15:08:47,276 - root - INFO - normalization zscore
2023-07-25 15:08:47,276 - root - INFO - log_to_screen True
2023-07-25 15:08:47,276 - root - INFO - save_checkpoint True
2023-07-25 15:08:47,276 - root - INFO - enable_nhwc False
2023-07-25 15:08:47,276 - root - INFO - optimizer_type FusedAdam
2023-07-25 15:08:47,276 - root - INFO - crop_size_x None
2023-07-25 15:08:47,276 - root - INFO - crop_size_y None
2023-07-25 15:08:47,276 - root - INFO - two_step_training False
2023-07-25 15:08:47,276 - root - INFO - plot_animations False
2023-07-25 15:08:47,277 - root - INFO - add_noise False
2023-07-25 15:08:47,277 - root - INFO - noise_std 0
2023-07-25 15:08:47,277 - root - INFO - world_size 1
2023-07-25 15:08:47,277 - root - INFO - interp 0
2023-07-25 15:08:47,277 - root - INFO - use_daily_climatology False
2023-07-25 15:08:47,277 - root - INFO - global_batch_size 64
2023-07-25 15:08:47,277 - root - INFO - ablate T2m
2023-07-25 15:08:47,277 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 15:08:47,277 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 15:08:47,277 - root - INFO - resuming False
2023-07-25 15:08:47,277 - root - INFO - local_rank 0
2023-07-25 15:08:47,277 - root - INFO - ---------------------------------------------------
2023-07-25 15:08:47,277 - root - INFO - Inference for 1 initial conditions
2023-07-25 15:08:47,563 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 15:08:47,565 - root - INFO - Number of samples per year: 1460
2023-07-25 15:08:47,565 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 15:08:47,565 - root - INFO - Delta t: 6 hours
2023-07-25 15:08:47,565 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 15:08:47,565 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 15:09:53,395 - root - INFO - Loading inference data
2023-07-25 15:09:53,396 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 15:09:53,664 - root - INFO - Initial condition 1 of 1
2023-07-25 15:09:54,546 - root - INFO - Extracting valid data from the first year
2023-07-25 15:12:11,944 - root - INFO - Standardizing data
2023-07-25 15:12:20,244 - root - INFO - Loading time means
2023-07-25 15:12:34,622 - root - INFO - Begin autoregressive inference
2023-07-25 15:12:45,373 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 15:12:57,152 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 3167.8330078125, ACC: -0.023389888927340508
2023-07-25 15:13:08,774 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 10932.1455078125, ACC: -0.2227279543876648
2023-07-25 15:13:19,220 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 18411.037109375, ACC: -0.1731978803873062
2023-07-25 15:13:30,341 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 26036.263671875, ACC: -0.12905822694301605
2023-07-25 15:13:41,744 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 32956.203125, ACC: -0.08833606541156769
2023-07-25 15:13:51,660 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 37880.50390625, ACC: -0.04684658348560333
2023-07-25 15:14:02,449 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 40969.4921875, ACC: -0.034956708550453186
2023-07-25 15:14:14,657 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 42854.69921875, ACC: -0.03131068870425224
2023-07-25 15:14:24,988 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 44010.3203125, ACC: -0.02564769610762596
2023-07-25 15:14:35,592 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 44723.1484375, ACC: -0.016529230400919914
2023-07-25 15:14:46,565 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 45178.76953125, ACC: -0.016072774305939674
2023-07-25 15:14:57,589 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 45475.55078125, ACC: -0.01875114068388939
2023-07-25 15:15:08,432 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 45666.91015625, ACC: -0.01619926653802395
2023-07-25 15:15:19,888 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 45792.26171875, ACC: -0.011329514905810356
2023-07-25 15:15:31,167 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 45881.09765625, ACC: -0.01236694399267435
2023-07-25 15:15:41,944 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 45943.73046875, ACC: -0.015291571617126465
2023-07-25 15:15:52,831 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 45983.84765625, ACC: -0.01352525595575571
2023-07-25 15:16:04,079 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 46008.5390625, ACC: -0.008542301133275032
2023-07-25 15:16:14,421 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 46030.37890625, ACC: -0.010445927269756794
2023-07-25 15:16:26,052 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 46047.984375, ACC: -0.014866061508655548
2023-07-25 15:16:37,677 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 46056.90625, ACC: -0.013384342193603516
2023-07-25 15:16:47,941 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 46060.4765625, ACC: -0.008805005811154842
2023-07-25 15:16:58,387 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 46068.0546875, ACC: -0.011569054797291756
2023-07-25 15:17:10,185 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 46075.21484375, ACC: -0.01594637520611286
2023-07-25 15:17:21,607 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 46077.3984375, ACC: -0.014391344040632248
2023-07-25 15:17:33,268 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 46075.80078125, ACC: -0.009378385730087757
2023-07-25 15:17:43,973 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 46079.74609375, ACC: -0.011723712086677551
2023-07-25 15:17:54,975 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 46083.65625, ACC: -0.014384384267032146
2023-07-25 15:18:06,607 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 46083.6953125, ACC: -0.012998201884329319
2023-07-25 15:18:06,694 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-T2m_30-timesteps_vis.h5
2023-07-25 15:18:59,924 - root - INFO - ------------------ Configuration ------------------
2023-07-25 15:18:59,924 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 15:18:59,924 - root - INFO - Configuration name: afno_backbone
2023-07-25 15:18:59,924 - root - INFO - log_to_wandb True
2023-07-25 15:18:59,924 - root - INFO - lr 0.0005
2023-07-25 15:18:59,924 - root - INFO - batch_size 64
2023-07-25 15:18:59,924 - root - INFO - max_epochs 150
2023-07-25 15:18:59,924 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 15:18:59,924 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 15:18:59,924 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 15:18:59,925 - root - INFO - orography False
2023-07-25 15:18:59,925 - root - INFO - orography_path None
2023-07-25 15:18:59,925 - root - INFO - exp_dir FourCastNet/results
2023-07-25 15:18:59,925 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 15:18:59,925 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 15:18:59,925 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 15:18:59,925 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 15:18:59,925 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 15:18:59,925 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 15:18:59,925 - root - INFO - loss l2
2023-07-25 15:18:59,925 - root - INFO - num_data_workers 4
2023-07-25 15:18:59,925 - root - INFO - dt 1
2023-07-25 15:18:59,925 - root - INFO - n_history 0
2023-07-25 15:18:59,925 - root - INFO - prediction_type iterative
2023-07-25 15:18:59,925 - root - INFO - prediction_length 30
2023-07-25 15:18:59,925 - root - INFO - n_initial_conditions 5
2023-07-25 15:18:59,925 - root - INFO - ics_type default
2023-07-25 15:18:59,925 - root - INFO - save_raw_forecasts True
2023-07-25 15:18:59,926 - root - INFO - save_channel False
2023-07-25 15:18:59,926 - root - INFO - masked_acc False
2023-07-25 15:18:59,926 - root - INFO - maskpath None
2023-07-25 15:18:59,926 - root - INFO - perturb False
2023-07-25 15:18:59,926 - root - INFO - add_grid False
2023-07-25 15:18:59,926 - root - INFO - N_grid_channels 0
2023-07-25 15:18:59,926 - root - INFO - gridtype sinusoidal
2023-07-25 15:18:59,926 - root - INFO - roll False
2023-07-25 15:18:59,926 - root - INFO - num_blocks 8
2023-07-25 15:18:59,926 - root - INFO - nettype afno
2023-07-25 15:18:59,926 - root - INFO - patch_size 8
2023-07-25 15:18:59,926 - root - INFO - width 56
2023-07-25 15:18:59,926 - root - INFO - modes 32
2023-07-25 15:18:59,926 - root - INFO - target mslp
2023-07-25 15:18:59,926 - root - INFO - normalization zscore
2023-07-25 15:18:59,926 - root - INFO - log_to_screen True
2023-07-25 15:18:59,926 - root - INFO - save_checkpoint True
2023-07-25 15:18:59,926 - root - INFO - enable_nhwc False
2023-07-25 15:18:59,927 - root - INFO - optimizer_type FusedAdam
2023-07-25 15:18:59,927 - root - INFO - crop_size_x None
2023-07-25 15:18:59,927 - root - INFO - crop_size_y None
2023-07-25 15:18:59,927 - root - INFO - two_step_training False
2023-07-25 15:18:59,927 - root - INFO - plot_animations False
2023-07-25 15:18:59,927 - root - INFO - add_noise False
2023-07-25 15:18:59,927 - root - INFO - noise_std 0
2023-07-25 15:18:59,927 - root - INFO - world_size 1
2023-07-25 15:18:59,927 - root - INFO - interp 0
2023-07-25 15:18:59,927 - root - INFO - use_daily_climatology False
2023-07-25 15:18:59,927 - root - INFO - global_batch_size 64
2023-07-25 15:18:59,927 - root - INFO - ablate sp
2023-07-25 15:18:59,927 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 15:18:59,927 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 15:18:59,927 - root - INFO - resuming False
2023-07-25 15:18:59,927 - root - INFO - local_rank 0
2023-07-25 15:18:59,927 - root - INFO - ---------------------------------------------------
2023-07-25 15:18:59,928 - root - INFO - Inference for 1 initial conditions
2023-07-25 15:19:00,225 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 15:19:00,226 - root - INFO - Number of samples per year: 1460
2023-07-25 15:19:00,226 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 15:19:00,226 - root - INFO - Delta t: 6 hours
2023-07-25 15:19:00,227 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 15:19:00,227 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 15:20:02,848 - root - INFO - Loading inference data
2023-07-25 15:20:02,849 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 15:20:03,134 - root - INFO - Initial condition 1 of 1
2023-07-25 15:20:04,018 - root - INFO - Extracting valid data from the first year
2023-07-25 15:22:20,500 - root - INFO - Standardizing data
2023-07-25 15:22:28,735 - root - INFO - Loading time means
2023-07-25 15:22:42,441 - root - INFO - Begin autoregressive inference
2023-07-25 15:22:54,142 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 15:23:05,946 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 153.73626708984375, ACC: 0.9851410984992981
2023-07-25 15:23:17,242 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 274.304443359375, ACC: 0.950169026851654
2023-07-25 15:23:28,155 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 410.55914306640625, ACC: 0.8863288164138794
2023-07-25 15:23:39,462 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 535.7738037109375, ACC: 0.8018234968185425
2023-07-25 15:23:50,921 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 673.6583251953125, ACC: 0.704160213470459
2023-07-25 15:24:01,081 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 797.3328857421875, ACC: 0.605836808681488
2023-07-25 15:24:12,774 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 878.9334716796875, ACC: 0.541863203048706
2023-07-25 15:24:23,664 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 939.4262084960938, ACC: 0.4804495573043823
2023-07-25 15:24:34,692 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 1002.5836791992188, ACC: 0.4307020604610443
2023-07-25 15:24:44,948 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 1089.5452880859375, ACC: 0.36456298828125
2023-07-25 15:24:55,207 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 1167.5904541015625, ACC: 0.31600019335746765
2023-07-25 15:25:05,736 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 1239.737060546875, ACC: 0.2666916847229004
2023-07-25 15:25:16,617 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 1315.7828369140625, ACC: 0.2316880226135254
2023-07-25 15:25:27,414 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 1384.9036865234375, ACC: 0.18663112819194794
2023-07-25 15:25:37,872 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 1453.081787109375, ACC: 0.15232674777507782
2023-07-25 15:25:48,336 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 1515.1278076171875, ACC: 0.12182828038930893
2023-07-25 15:25:58,494 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 1564.60693359375, ACC: 0.10945095121860504
2023-07-25 15:26:10,044 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 1634.995849609375, ACC: 0.08461519330739975
2023-07-25 15:26:21,362 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 1680.804443359375, ACC: 0.07020722329616547
2023-07-25 15:26:31,548 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 1706.6341552734375, ACC: 0.0652710348367691
2023-07-25 15:26:41,675 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 1719.26123046875, ACC: 0.07756870985031128
2023-07-25 15:26:52,791 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 1739.822021484375, ACC: 0.07023093104362488
2023-07-25 15:27:04,581 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 1754.353515625, ACC: 0.07949063926935196
2023-07-25 15:27:15,900 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 1773.5599365234375, ACC: 0.08818481117486954
2023-07-25 15:27:26,068 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 1833.8831787109375, ACC: 0.09947296231985092
2023-07-25 15:27:36,918 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 1902.185302734375, ACC: 0.08672813326120377
2023-07-25 15:27:47,635 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 1962.2574462890625, ACC: 0.08121618628501892
2023-07-25 15:27:58,611 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 2007.6495361328125, ACC: 0.08117377012968063
2023-07-25 15:28:10,187 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 2041.6763916015625, ACC: 0.08741289377212524
2023-07-25 15:28:10,281 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-sp_30-timesteps_vis.h5
2023-07-25 15:29:03,739 - root - INFO - ------------------ Configuration ------------------
2023-07-25 15:29:03,739 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 15:29:03,739 - root - INFO - Configuration name: afno_backbone
2023-07-25 15:29:03,739 - root - INFO - log_to_wandb True
2023-07-25 15:29:03,739 - root - INFO - lr 0.0005
2023-07-25 15:29:03,740 - root - INFO - batch_size 64
2023-07-25 15:29:03,740 - root - INFO - max_epochs 150
2023-07-25 15:29:03,740 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 15:29:03,740 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 15:29:03,740 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 15:29:03,740 - root - INFO - orography False
2023-07-25 15:29:03,740 - root - INFO - orography_path None
2023-07-25 15:29:03,740 - root - INFO - exp_dir FourCastNet/results
2023-07-25 15:29:03,740 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 15:29:03,740 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 15:29:03,740 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 15:29:03,740 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 15:29:03,740 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 15:29:03,740 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 15:29:03,740 - root - INFO - loss l2
2023-07-25 15:29:03,741 - root - INFO - num_data_workers 4
2023-07-25 15:29:03,741 - root - INFO - dt 1
2023-07-25 15:29:03,741 - root - INFO - n_history 0
2023-07-25 15:29:03,741 - root - INFO - prediction_type iterative
2023-07-25 15:29:03,741 - root - INFO - prediction_length 30
2023-07-25 15:29:03,741 - root - INFO - n_initial_conditions 5
2023-07-25 15:29:03,741 - root - INFO - ics_type default
2023-07-25 15:29:03,741 - root - INFO - save_raw_forecasts True
2023-07-25 15:29:03,741 - root - INFO - save_channel False
2023-07-25 15:29:03,741 - root - INFO - masked_acc False
2023-07-25 15:29:03,741 - root - INFO - maskpath None
2023-07-25 15:29:03,741 - root - INFO - perturb False
2023-07-25 15:29:03,741 - root - INFO - add_grid False
2023-07-25 15:29:03,741 - root - INFO - N_grid_channels 0
2023-07-25 15:29:03,741 - root - INFO - gridtype sinusoidal
2023-07-25 15:29:03,741 - root - INFO - roll False
2023-07-25 15:29:03,741 - root - INFO - num_blocks 8
2023-07-25 15:29:03,741 - root - INFO - nettype afno
2023-07-25 15:29:03,741 - root - INFO - patch_size 8
2023-07-25 15:29:03,742 - root - INFO - width 56
2023-07-25 15:29:03,742 - root - INFO - modes 32
2023-07-25 15:29:03,742 - root - INFO - target mslp
2023-07-25 15:29:03,742 - root - INFO - normalization zscore
2023-07-25 15:29:03,742 - root - INFO - log_to_screen True
2023-07-25 15:29:03,742 - root - INFO - save_checkpoint True
2023-07-25 15:29:03,742 - root - INFO - enable_nhwc False
2023-07-25 15:29:03,742 - root - INFO - optimizer_type FusedAdam
2023-07-25 15:29:03,742 - root - INFO - crop_size_x None
2023-07-25 15:29:03,742 - root - INFO - crop_size_y None
2023-07-25 15:29:03,742 - root - INFO - two_step_training False
2023-07-25 15:29:03,742 - root - INFO - plot_animations False
2023-07-25 15:29:03,742 - root - INFO - add_noise False
2023-07-25 15:29:03,742 - root - INFO - noise_std 0
2023-07-25 15:29:03,742 - root - INFO - world_size 1
2023-07-25 15:29:03,742 - root - INFO - interp 0
2023-07-25 15:29:03,742 - root - INFO - use_daily_climatology False
2023-07-25 15:29:03,742 - root - INFO - global_batch_size 64
2023-07-25 15:29:03,742 - root - INFO - ablate U1000
2023-07-25 15:29:03,742 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 15:29:03,742 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 15:29:03,742 - root - INFO - resuming False
2023-07-25 15:29:03,742 - root - INFO - local_rank 0
2023-07-25 15:29:03,743 - root - INFO - ---------------------------------------------------
2023-07-25 15:29:03,743 - root - INFO - Inference for 1 initial conditions
2023-07-25 15:29:04,006 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 15:29:04,008 - root - INFO - Number of samples per year: 1460
2023-07-25 15:29:04,008 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 15:29:04,009 - root - INFO - Delta t: 6 hours
2023-07-25 15:29:04,009 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 15:29:04,010 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 15:30:13,365 - root - INFO - Loading inference data
2023-07-25 15:30:13,367 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 15:30:13,611 - root - INFO - Initial condition 1 of 1
2023-07-25 15:30:14,536 - root - INFO - Extracting valid data from the first year
2023-07-25 15:32:36,489 - root - INFO - Standardizing data
2023-07-25 15:32:44,659 - root - INFO - Loading time means
2023-07-25 15:32:59,559 - root - INFO - Begin autoregressive inference
2023-07-25 15:33:10,627 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 15:33:21,763 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 617.7046508789062, ACC: 0.8048685193061829
2023-07-25 15:33:33,358 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 3257.397216796875, ACC: 0.28342771530151367
2023-07-25 15:33:44,840 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 7095.7939453125, ACC: 0.1389380842447281
2023-07-25 15:33:56,521 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 10044.697265625, ACC: 0.08433017879724503
2023-07-25 15:34:08,457 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 12407.5361328125, ACC: 0.09073090553283691
2023-07-25 15:34:20,300 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 15501.23828125, ACC: 0.03376435488462448
2023-07-25 15:34:31,174 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 20147.9140625, ACC: -0.016716936603188515
2023-07-25 15:34:42,754 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 25520.662109375, ACC: -0.04193853959441185
2023-07-25 15:34:54,954 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 30822.26171875, ACC: -0.030405616387724876
2023-07-25 15:35:06,921 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 35462.1328125, ACC: -0.013245928101241589
2023-07-25 15:35:17,710 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 38938.70703125, ACC: -0.013642310164868832
2023-07-25 15:35:28,712 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 41267.3984375, ACC: -0.018585283309221268
2023-07-25 15:35:39,655 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 42787.6015625, ACC: -0.018420569598674774
2023-07-25 15:35:50,308 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 43810.61328125, ACC: -0.013719442300498486
2023-07-25 15:36:01,722 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 44533.59765625, ACC: -0.015422459691762924
2023-07-25 15:36:13,101 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 45049.609375, ACC: -0.019335320219397545
2023-07-25 15:36:24,076 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 45412.4140625, ACC: -0.017151782289147377
2023-07-25 15:36:34,515 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 45654.40234375, ACC: -0.012095698155462742
2023-07-25 15:36:45,716 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 45811.61328125, ACC: -0.013220954686403275
2023-07-25 15:36:57,822 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 45910.88671875, ACC: -0.01722121238708496
2023-07-25 15:37:08,935 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 45968.1484375, ACC: -0.014687446877360344
2023-07-25 15:37:19,717 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 46001.28515625, ACC: -0.009657102636992931
2023-07-25 15:37:31,449 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 46027.46484375, ACC: -0.012047355063259602
2023-07-25 15:37:42,387 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 46046.76171875, ACC: -0.016288163140416145
2023-07-25 15:37:53,669 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 46057.05859375, ACC: -0.01457216963171959
2023-07-25 15:38:05,643 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 46061.13671875, ACC: -0.009510505944490433
2023-07-25 15:38:16,774 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 46069.08984375, ACC: -0.01180210430175066
2023-07-25 15:38:28,226 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 46075.890625, ACC: -0.014437748119235039
2023-07-25 15:38:39,259 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 46078.02734375, ACC: -0.013020825572311878
2023-07-25 15:38:39,347 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-U1000_30-timesteps_vis.h5
2023-07-25 15:39:32,545 - root - INFO - ------------------ Configuration ------------------
2023-07-25 15:39:32,546 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 15:39:32,546 - root - INFO - Configuration name: afno_backbone
2023-07-25 15:39:32,546 - root - INFO - log_to_wandb True
2023-07-25 15:39:32,546 - root - INFO - lr 0.0005
2023-07-25 15:39:32,546 - root - INFO - batch_size 64
2023-07-25 15:39:32,546 - root - INFO - max_epochs 150
2023-07-25 15:39:32,553 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 15:39:32,553 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 15:39:32,553 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 15:39:32,553 - root - INFO - orography False
2023-07-25 15:39:32,553 - root - INFO - orography_path None
2023-07-25 15:39:32,553 - root - INFO - exp_dir FourCastNet/results
2023-07-25 15:39:32,553 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 15:39:32,553 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 15:39:32,553 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 15:39:32,553 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 15:39:32,553 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 15:39:32,553 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 15:39:32,553 - root - INFO - loss l2
2023-07-25 15:39:32,553 - root - INFO - num_data_workers 4
2023-07-25 15:39:32,554 - root - INFO - dt 1
2023-07-25 15:39:32,554 - root - INFO - n_history 0
2023-07-25 15:39:32,554 - root - INFO - prediction_type iterative
2023-07-25 15:39:32,554 - root - INFO - prediction_length 30
2023-07-25 15:39:32,554 - root - INFO - n_initial_conditions 5
2023-07-25 15:39:32,554 - root - INFO - ics_type default
2023-07-25 15:39:32,554 - root - INFO - save_raw_forecasts True
2023-07-25 15:39:32,554 - root - INFO - save_channel False
2023-07-25 15:39:32,554 - root - INFO - masked_acc False
2023-07-25 15:39:32,554 - root - INFO - maskpath None
2023-07-25 15:39:32,554 - root - INFO - perturb False
2023-07-25 15:39:32,554 - root - INFO - add_grid False
2023-07-25 15:39:32,554 - root - INFO - N_grid_channels 0
2023-07-25 15:39:32,554 - root - INFO - gridtype sinusoidal
2023-07-25 15:39:32,554 - root - INFO - roll False
2023-07-25 15:39:32,554 - root - INFO - num_blocks 8
2023-07-25 15:39:32,555 - root - INFO - nettype afno
2023-07-25 15:39:32,555 - root - INFO - patch_size 8
2023-07-25 15:39:32,555 - root - INFO - width 56
2023-07-25 15:39:32,555 - root - INFO - modes 32
2023-07-25 15:39:32,555 - root - INFO - target mslp
2023-07-25 15:39:32,555 - root - INFO - normalization zscore
2023-07-25 15:39:32,555 - root - INFO - log_to_screen True
2023-07-25 15:39:32,555 - root - INFO - save_checkpoint True
2023-07-25 15:39:32,557 - root - INFO - enable_nhwc False
2023-07-25 15:39:32,557 - root - INFO - optimizer_type FusedAdam
2023-07-25 15:39:32,557 - root - INFO - crop_size_x None
2023-07-25 15:39:32,557 - root - INFO - crop_size_y None
2023-07-25 15:39:32,557 - root - INFO - two_step_training False
2023-07-25 15:39:32,557 - root - INFO - plot_animations False
2023-07-25 15:39:32,557 - root - INFO - add_noise False
2023-07-25 15:39:32,557 - root - INFO - noise_std 0
2023-07-25 15:39:32,557 - root - INFO - world_size 1
2023-07-25 15:39:32,557 - root - INFO - interp 0
2023-07-25 15:39:32,557 - root - INFO - use_daily_climatology False
2023-07-25 15:39:32,557 - root - INFO - global_batch_size 64
2023-07-25 15:39:32,557 - root - INFO - ablate V1000
2023-07-25 15:39:32,557 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 15:39:32,557 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 15:39:32,557 - root - INFO - resuming False
2023-07-25 15:39:32,557 - root - INFO - local_rank 0
2023-07-25 15:39:32,557 - root - INFO - ---------------------------------------------------
2023-07-25 15:39:32,557 - root - INFO - Inference for 1 initial conditions
2023-07-25 15:39:32,832 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 15:39:32,833 - root - INFO - Number of samples per year: 1460
2023-07-25 15:39:32,833 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 15:39:32,833 - root - INFO - Delta t: 6 hours
2023-07-25 15:39:32,833 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 15:39:32,833 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 15:40:36,521 - root - INFO - Loading inference data
2023-07-25 15:40:36,523 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 15:40:36,701 - root - INFO - Initial condition 1 of 1
2023-07-25 15:40:37,633 - root - INFO - Extracting valid data from the first year
2023-07-25 15:42:54,378 - root - INFO - Standardizing data
2023-07-25 15:43:02,393 - root - INFO - Loading time means
2023-07-25 15:43:16,278 - root - INFO - Begin autoregressive inference
2023-07-25 15:43:26,696 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 15:43:38,880 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 109.26053619384766, ACC: 0.9923442006111145
2023-07-25 15:43:51,668 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 115.68224334716797, ACC: 0.9913086891174316
2023-07-25 15:44:04,207 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 123.72178649902344, ACC: 0.9901494383811951
2023-07-25 15:44:16,244 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 130.74725341796875, ACC: 0.9885677695274353
2023-07-25 15:44:28,090 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 140.7121124267578, ACC: 0.986854076385498
2023-07-25 15:44:40,595 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 154.28146362304688, ACC: 0.9840905666351318
2023-07-25 15:44:52,787 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 169.889404296875, ACC: 0.9810692071914673
2023-07-25 15:45:05,373 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 193.6053009033203, ACC: 0.9749664664268494
2023-07-25 15:45:18,674 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 220.8754119873047, ACC: 0.9680599570274353
2023-07-25 15:45:31,949 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 241.38958740234375, ACC: 0.9619148969650269
2023-07-25 15:45:45,800 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 250.29881286621094, ACC: 0.9595777988433838
2023-07-25 15:45:58,859 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 266.3462219238281, ACC: 0.9530505537986755
2023-07-25 15:46:12,633 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 291.6968078613281, ACC: 0.9430711269378662
2023-07-25 15:46:26,052 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 326.2420959472656, ACC: 0.9273508787155151
2023-07-25 15:46:39,335 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 357.9495849609375, ACC: 0.9123436212539673
2023-07-25 15:46:52,278 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 393.1563415527344, ACC: 0.8921982645988464
2023-07-25 15:47:05,745 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 422.6728515625, ACC: 0.8734943866729736
2023-07-25 15:47:18,275 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 447.6204833984375, ACC: 0.8535608649253845
2023-07-25 15:47:30,369 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 461.1862487792969, ACC: 0.838291347026825
2023-07-25 15:47:42,688 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 473.217529296875, ACC: 0.819247305393219
2023-07-25 15:47:55,570 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 487.27728271484375, ACC: 0.8013289570808411
2023-07-25 15:48:09,895 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 512.1651000976562, ACC: 0.7734754085540771
2023-07-25 15:48:23,088 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 542.0497436523438, ACC: 0.7451457977294922
2023-07-25 15:48:35,936 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 580.5698852539062, ACC: 0.7041808366775513
2023-07-25 15:48:48,840 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 622.8731689453125, ACC: 0.6725072264671326
2023-07-25 15:49:02,066 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 665.0162963867188, ACC: 0.638171374797821
2023-07-25 15:49:14,936 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 695.8268432617188, ACC: 0.6172758340835571
2023-07-25 15:49:27,384 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 722.2256469726562, ACC: 0.6000567674636841
2023-07-25 15:49:40,250 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 747.85986328125, ACC: 0.5779017806053162
2023-07-25 15:49:40,341 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-V1000_30-timesteps_vis.h5
2023-07-25 15:50:33,441 - root - INFO - ------------------ Configuration ------------------
2023-07-25 15:50:33,441 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 15:50:33,441 - root - INFO - Configuration name: afno_backbone
2023-07-25 15:50:33,441 - root - INFO - log_to_wandb True
2023-07-25 15:50:33,442 - root - INFO - lr 0.0005
2023-07-25 15:50:33,442 - root - INFO - batch_size 64
2023-07-25 15:50:33,442 - root - INFO - max_epochs 150
2023-07-25 15:50:33,442 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 15:50:33,442 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 15:50:33,442 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 15:50:33,442 - root - INFO - orography False
2023-07-25 15:50:33,442 - root - INFO - orography_path None
2023-07-25 15:50:33,442 - root - INFO - exp_dir FourCastNet/results
2023-07-25 15:50:33,442 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 15:50:33,442 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 15:50:33,442 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 15:50:33,442 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 15:50:33,442 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 15:50:33,442 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 15:50:33,442 - root - INFO - loss l2
2023-07-25 15:50:33,442 - root - INFO - num_data_workers 4
2023-07-25 15:50:33,443 - root - INFO - dt 1
2023-07-25 15:50:33,443 - root - INFO - n_history 0
2023-07-25 15:50:33,443 - root - INFO - prediction_type iterative
2023-07-25 15:50:33,443 - root - INFO - prediction_length 30
2023-07-25 15:50:33,443 - root - INFO - n_initial_conditions 5
2023-07-25 15:50:33,443 - root - INFO - ics_type default
2023-07-25 15:50:33,443 - root - INFO - save_raw_forecasts True
2023-07-25 15:50:33,443 - root - INFO - save_channel False
2023-07-25 15:50:33,443 - root - INFO - masked_acc False
2023-07-25 15:50:33,443 - root - INFO - maskpath None
2023-07-25 15:50:33,443 - root - INFO - perturb False
2023-07-25 15:50:33,443 - root - INFO - add_grid False
2023-07-25 15:50:33,443 - root - INFO - N_grid_channels 0
2023-07-25 15:50:33,443 - root - INFO - gridtype sinusoidal
2023-07-25 15:50:33,443 - root - INFO - roll False
2023-07-25 15:50:33,443 - root - INFO - num_blocks 8
2023-07-25 15:50:33,443 - root - INFO - nettype afno
2023-07-25 15:50:33,444 - root - INFO - patch_size 8
2023-07-25 15:50:33,444 - root - INFO - width 56
2023-07-25 15:50:33,444 - root - INFO - modes 32
2023-07-25 15:50:33,444 - root - INFO - target mslp
2023-07-25 15:50:33,444 - root - INFO - normalization zscore
2023-07-25 15:50:33,444 - root - INFO - log_to_screen True
2023-07-25 15:50:33,444 - root - INFO - save_checkpoint True
2023-07-25 15:50:33,444 - root - INFO - enable_nhwc False
2023-07-25 15:50:33,444 - root - INFO - optimizer_type FusedAdam
2023-07-25 15:50:33,444 - root - INFO - crop_size_x None
2023-07-25 15:50:33,444 - root - INFO - crop_size_y None
2023-07-25 15:50:33,444 - root - INFO - two_step_training False
2023-07-25 15:50:33,444 - root - INFO - plot_animations False
2023-07-25 15:50:33,444 - root - INFO - add_noise False
2023-07-25 15:50:33,444 - root - INFO - noise_std 0
2023-07-25 15:50:33,444 - root - INFO - world_size 1
2023-07-25 15:50:33,444 - root - INFO - interp 0
2023-07-25 15:50:33,444 - root - INFO - use_daily_climatology False
2023-07-25 15:50:33,444 - root - INFO - global_batch_size 64
2023-07-25 15:50:33,444 - root - INFO - ablate Z1000
2023-07-25 15:50:33,445 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 15:50:33,445 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 15:50:33,445 - root - INFO - resuming False
2023-07-25 15:50:33,445 - root - INFO - local_rank 0
2023-07-25 15:50:33,445 - root - INFO - ---------------------------------------------------
2023-07-25 15:50:33,445 - root - INFO - Inference for 1 initial conditions
2023-07-25 15:50:33,944 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 15:50:33,945 - root - INFO - Number of samples per year: 1460
2023-07-25 15:50:33,945 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 15:50:33,946 - root - INFO - Delta t: 6 hours
2023-07-25 15:50:33,946 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 15:50:33,946 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 15:51:42,396 - root - INFO - Loading inference data
2023-07-25 15:51:42,397 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 15:51:42,649 - root - INFO - Initial condition 1 of 1
2023-07-25 15:51:43,538 - root - INFO - Extracting valid data from the first year
2023-07-25 15:54:02,837 - root - INFO - Standardizing data
2023-07-25 15:54:10,915 - root - INFO - Loading time means
2023-07-25 15:54:27,022 - root - INFO - Begin autoregressive inference
2023-07-25 15:54:37,993 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 15:54:49,137 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 63.04971694946289, ACC: 0.9975243210792542
2023-07-25 15:54:59,966 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 71.03477478027344, ACC: 0.9967300891876221
2023-07-25 15:55:11,191 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 76.71742248535156, ACC: 0.9962104558944702
2023-07-25 15:55:21,902 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 91.82415771484375, ACC: 0.9943599700927734
2023-07-25 15:55:32,972 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 101.36459350585938, ACC: 0.993191123008728
2023-07-25 15:55:43,960 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 120.40166473388672, ACC: 0.9903307557106018
2023-07-25 15:55:55,589 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 133.2141571044922, ACC: 0.9884066581726074
2023-07-25 15:56:05,988 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 154.0689697265625, ACC: 0.9841918349266052
2023-07-25 15:56:16,131 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 174.4213409423828, ACC: 0.9801278710365295
2023-07-25 15:56:26,110 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 191.0703582763672, ACC: 0.9761339426040649
2023-07-25 15:56:37,093 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 201.9492950439453, ACC: 0.9734086394309998
2023-07-25 15:56:48,206 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 222.07044982910156, ACC: 0.9669371247291565
2023-07-25 15:57:00,132 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 247.97572326660156, ACC: 0.9585278034210205
2023-07-25 15:57:11,430 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 275.990966796875, ACC: 0.9481319785118103
2023-07-25 15:57:22,117 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 301.3758544921875, ACC: 0.9378929734230042
2023-07-25 15:57:33,534 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 331.2822570800781, ACC: 0.9236724972724915
2023-07-25 15:57:44,082 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 359.75067138671875, ACC: 0.908705472946167
2023-07-25 15:57:55,418 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 388.9959411621094, ACC: 0.8895453810691833
2023-07-25 15:58:06,324 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 408.6634216308594, ACC: 0.8728665113449097
2023-07-25 15:58:16,648 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 428.7367858886719, ACC: 0.8506865501403809
2023-07-25 15:58:26,980 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 444.05181884765625, ACC: 0.8351144194602966
2023-07-25 15:58:37,414 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 464.5715026855469, ACC: 0.8140473961830139
2023-07-25 15:58:48,194 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 481.4575500488281, ACC: 0.8011904954910278
2023-07-25 15:58:58,763 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 503.8514099121094, ACC: 0.7786213755607605
2023-07-25 15:59:08,853 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 527.136962890625, ACC: 0.7682307362556458
2023-07-25 15:59:19,200 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 552.624267578125, ACC: 0.7520211935043335
2023-07-25 15:59:30,442 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 575.0340576171875, ACC: 0.7434313893318176
2023-07-25 15:59:40,224 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 598.9606323242188, ACC: 0.7310597896575928
2023-07-25 15:59:51,013 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 622.4197998046875, ACC: 0.7181029915809631
2023-07-25 15:59:51,126 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-Z1000_30-timesteps_vis.h5
2023-07-25 16:00:45,168 - root - INFO - ------------------ Configuration ------------------
2023-07-25 16:00:45,168 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 16:00:45,168 - root - INFO - Configuration name: afno_backbone
2023-07-25 16:00:45,168 - root - INFO - log_to_wandb True
2023-07-25 16:00:45,168 - root - INFO - lr 0.0005
2023-07-25 16:00:45,168 - root - INFO - batch_size 64
2023-07-25 16:00:45,169 - root - INFO - max_epochs 150
2023-07-25 16:00:45,169 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 16:00:45,169 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 16:00:45,169 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 16:00:45,169 - root - INFO - orography False
2023-07-25 16:00:45,169 - root - INFO - orography_path None
2023-07-25 16:00:45,169 - root - INFO - exp_dir FourCastNet/results
2023-07-25 16:00:45,169 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 16:00:45,169 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 16:00:45,169 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 16:00:45,169 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 16:00:45,169 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 16:00:45,169 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 16:00:45,169 - root - INFO - loss l2
2023-07-25 16:00:45,169 - root - INFO - num_data_workers 4
2023-07-25 16:00:45,169 - root - INFO - dt 1
2023-07-25 16:00:45,169 - root - INFO - n_history 0
2023-07-25 16:00:45,169 - root - INFO - prediction_type iterative
2023-07-25 16:00:45,170 - root - INFO - prediction_length 30
2023-07-25 16:00:45,170 - root - INFO - n_initial_conditions 5
2023-07-25 16:00:45,170 - root - INFO - ics_type default
2023-07-25 16:00:45,170 - root - INFO - save_raw_forecasts True
2023-07-25 16:00:45,170 - root - INFO - save_channel False
2023-07-25 16:00:45,170 - root - INFO - masked_acc False
2023-07-25 16:00:45,170 - root - INFO - maskpath None
2023-07-25 16:00:45,170 - root - INFO - perturb False
2023-07-25 16:00:45,170 - root - INFO - add_grid False
2023-07-25 16:00:45,170 - root - INFO - N_grid_channels 0
2023-07-25 16:00:45,170 - root - INFO - gridtype sinusoidal
2023-07-25 16:00:45,170 - root - INFO - roll False
2023-07-25 16:00:45,170 - root - INFO - num_blocks 8
2023-07-25 16:00:45,170 - root - INFO - nettype afno
2023-07-25 16:00:45,170 - root - INFO - patch_size 8
2023-07-25 16:00:45,170 - root - INFO - width 56
2023-07-25 16:00:45,170 - root - INFO - modes 32
2023-07-25 16:00:45,170 - root - INFO - target mslp
2023-07-25 16:00:45,171 - root - INFO - normalization zscore
2023-07-25 16:00:45,171 - root - INFO - log_to_screen True
2023-07-25 16:00:45,171 - root - INFO - save_checkpoint True
2023-07-25 16:00:45,171 - root - INFO - enable_nhwc False
2023-07-25 16:00:45,171 - root - INFO - optimizer_type FusedAdam
2023-07-25 16:00:45,171 - root - INFO - crop_size_x None
2023-07-25 16:00:45,171 - root - INFO - crop_size_y None
2023-07-25 16:00:45,171 - root - INFO - two_step_training False
2023-07-25 16:00:45,171 - root - INFO - plot_animations False
2023-07-25 16:00:45,171 - root - INFO - add_noise False
2023-07-25 16:00:45,171 - root - INFO - noise_std 0
2023-07-25 16:00:45,171 - root - INFO - world_size 1
2023-07-25 16:00:45,171 - root - INFO - interp 0
2023-07-25 16:00:45,171 - root - INFO - use_daily_climatology False
2023-07-25 16:00:45,171 - root - INFO - global_batch_size 64
2023-07-25 16:00:45,171 - root - INFO - ablate T850
2023-07-25 16:00:45,171 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 16:00:45,171 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 16:00:45,171 - root - INFO - resuming False
2023-07-25 16:00:45,171 - root - INFO - local_rank 0
2023-07-25 16:00:45,171 - root - INFO - ---------------------------------------------------
2023-07-25 16:00:45,171 - root - INFO - Inference for 1 initial conditions
2023-07-25 16:00:45,471 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 16:00:45,472 - root - INFO - Number of samples per year: 1460
2023-07-25 16:00:45,472 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 16:00:45,472 - root - INFO - Delta t: 6 hours
2023-07-25 16:00:45,472 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 16:00:45,473 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 16:01:53,419 - root - INFO - Loading inference data
2023-07-25 16:01:53,420 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 16:01:53,636 - root - INFO - Initial condition 1 of 1
2023-07-25 16:01:54,517 - root - INFO - Extracting valid data from the first year
2023-07-25 16:04:21,797 - root - INFO - Standardizing data
2023-07-25 16:04:29,992 - root - INFO - Loading time means
2023-07-25 16:04:46,251 - root - INFO - Begin autoregressive inference
2023-07-25 16:04:58,018 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 16:05:09,890 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 1335.8209228515625, ACC: 0.5774736404418945
2023-07-25 16:05:21,651 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 7232.30419921875, ACC: 0.007159831468015909
2023-07-25 16:05:32,960 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 12566.7099609375, ACC: -0.132331982254982
2023-07-25 16:05:44,427 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 19023.173828125, ACC: -0.14019878208637238
2023-07-25 16:05:57,912 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 25720.224609375, ACC: -0.10072414577007294
2023-07-25 16:06:10,007 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 31797.904296875, ACC: -0.05910199135541916
2023-07-25 16:06:21,690 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 36557.1640625, ACC: -0.03861518204212189
2023-07-25 16:06:32,623 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 39813.41796875, ACC: -0.03533332049846649
2023-07-25 16:06:43,539 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 41965.26953125, ACC: -0.02874915488064289
2023-07-25 16:06:55,454 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 43386.37890625, ACC: -0.01654067263007164
2023-07-25 16:07:06,034 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 44335.45703125, ACC: -0.01551107969135046
2023-07-25 16:07:17,140 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 44955.8671875, ACC: -0.01757187582552433
2023-07-25 16:07:28,474 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 45346.96484375, ACC: -0.014779728837311268
2023-07-25 16:07:39,992 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 45592.8515625, ACC: -0.010166175663471222
2023-07-25 16:07:51,705 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 45754.01953125, ACC: -0.011743373237550259
2023-07-25 16:08:03,133 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 45860.62109375, ACC: -0.01493897009640932
2023-07-25 16:08:14,668 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 45928.23046875, ACC: -0.013252301141619682
2023-07-25 16:08:25,598 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 45970.6328125, ACC: -0.008397011086344719
2023-07-25 16:08:36,417 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 46004.1171875, ACC: -0.01038099080324173
2023-07-25 16:08:47,910 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 46029.53515625, ACC: -0.014839635230600834
2023-07-25 16:08:59,488 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 46043.79296875, ACC: -0.01335164438933134
2023-07-25 16:09:11,189 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 46051.1015625, ACC: -0.008788971230387688
2023-07-25 16:09:22,478 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 46061.3203125, ACC: -0.011555308476090431
2023-07-25 16:09:34,469 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 46070.36328125, ACC: -0.01594015397131443
2023-07-25 16:09:45,788 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 46073.8984375, ACC: -0.014384707435965538
2023-07-25 16:09:57,073 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 46073.26953125, ACC: -0.009376068599522114
2023-07-25 16:10:08,870 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 46077.91796875, ACC: -0.011720336973667145
2023-07-25 16:10:20,075 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 46082.328125, ACC: -0.014382821507751942
2023-07-25 16:10:31,440 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 46082.734375, ACC: -0.012996708042919636
2023-07-25 16:10:31,528 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-T850_30-timesteps_vis.h5
2023-07-25 16:11:25,337 - root - INFO - ------------------ Configuration ------------------
2023-07-25 16:11:25,337 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 16:11:25,337 - root - INFO - Configuration name: afno_backbone
2023-07-25 16:11:25,337 - root - INFO - log_to_wandb True
2023-07-25 16:11:25,337 - root - INFO - lr 0.0005
2023-07-25 16:11:25,337 - root - INFO - batch_size 64
2023-07-25 16:11:25,337 - root - INFO - max_epochs 150
2023-07-25 16:11:25,337 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 16:11:25,337 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 16:11:25,337 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 16:11:25,337 - root - INFO - orography False
2023-07-25 16:11:25,337 - root - INFO - orography_path None
2023-07-25 16:11:25,337 - root - INFO - exp_dir FourCastNet/results
2023-07-25 16:11:25,337 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 16:11:25,338 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 16:11:25,338 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 16:11:25,338 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 16:11:25,338 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 16:11:25,338 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 16:11:25,338 - root - INFO - loss l2
2023-07-25 16:11:25,338 - root - INFO - num_data_workers 4
2023-07-25 16:11:25,338 - root - INFO - dt 1
2023-07-25 16:11:25,338 - root - INFO - n_history 0
2023-07-25 16:11:25,338 - root - INFO - prediction_type iterative
2023-07-25 16:11:25,338 - root - INFO - prediction_length 30
2023-07-25 16:11:25,338 - root - INFO - n_initial_conditions 5
2023-07-25 16:11:25,338 - root - INFO - ics_type default
2023-07-25 16:11:25,338 - root - INFO - save_raw_forecasts True
2023-07-25 16:11:25,338 - root - INFO - save_channel False
2023-07-25 16:11:25,338 - root - INFO - masked_acc False
2023-07-25 16:11:25,338 - root - INFO - maskpath None
2023-07-25 16:11:25,338 - root - INFO - perturb False
2023-07-25 16:11:25,338 - root - INFO - add_grid False
2023-07-25 16:11:25,339 - root - INFO - N_grid_channels 0
2023-07-25 16:11:25,339 - root - INFO - gridtype sinusoidal
2023-07-25 16:11:25,339 - root - INFO - roll False
2023-07-25 16:11:25,339 - root - INFO - num_blocks 8
2023-07-25 16:11:25,339 - root - INFO - nettype afno
2023-07-25 16:11:25,339 - root - INFO - patch_size 8
2023-07-25 16:11:25,339 - root - INFO - width 56
2023-07-25 16:11:25,339 - root - INFO - modes 32
2023-07-25 16:11:25,339 - root - INFO - target mslp
2023-07-25 16:11:25,339 - root - INFO - normalization zscore
2023-07-25 16:11:25,339 - root - INFO - log_to_screen True
2023-07-25 16:11:25,339 - root - INFO - save_checkpoint True
2023-07-25 16:11:25,339 - root - INFO - enable_nhwc False
2023-07-25 16:11:25,339 - root - INFO - optimizer_type FusedAdam
2023-07-25 16:11:25,339 - root - INFO - crop_size_x None
2023-07-25 16:11:25,339 - root - INFO - crop_size_y None
2023-07-25 16:11:25,340 - root - INFO - two_step_training False
2023-07-25 16:11:25,340 - root - INFO - plot_animations False
2023-07-25 16:11:25,340 - root - INFO - add_noise False
2023-07-25 16:11:25,340 - root - INFO - noise_std 0
2023-07-25 16:11:25,340 - root - INFO - world_size 1
2023-07-25 16:11:25,340 - root - INFO - interp 0
2023-07-25 16:11:25,340 - root - INFO - use_daily_climatology False
2023-07-25 16:11:25,340 - root - INFO - global_batch_size 64
2023-07-25 16:11:25,340 - root - INFO - ablate U850
2023-07-25 16:11:25,340 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 16:11:25,340 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 16:11:25,340 - root - INFO - resuming False
2023-07-25 16:11:25,340 - root - INFO - local_rank 0
2023-07-25 16:11:25,340 - root - INFO - ---------------------------------------------------
2023-07-25 16:11:25,340 - root - INFO - Inference for 1 initial conditions
2023-07-25 16:11:25,678 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 16:11:25,679 - root - INFO - Number of samples per year: 1460
2023-07-25 16:11:25,679 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 16:11:25,679 - root - INFO - Delta t: 6 hours
2023-07-25 16:11:25,679 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 16:11:25,679 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 16:12:34,665 - root - INFO - Loading inference data
2023-07-25 16:12:34,666 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 16:12:34,930 - root - INFO - Initial condition 1 of 1
2023-07-25 16:12:35,719 - root - INFO - Extracting valid data from the first year
2023-07-25 16:15:03,341 - root - INFO - Standardizing data
2023-07-25 16:15:11,667 - root - INFO - Loading time means
2023-07-25 16:15:26,588 - root - INFO - Begin autoregressive inference
2023-07-25 16:15:38,077 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 16:15:49,070 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 143.81678771972656, ACC: 0.9868249297142029
2023-07-25 16:16:00,488 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 144.06529235839844, ACC: 0.9867550730705261
2023-07-25 16:16:12,781 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 136.22964477539062, ACC: 0.9882373213768005
2023-07-25 16:16:23,246 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 139.5823974609375, ACC: 0.9871441125869751
2023-07-25 16:16:34,587 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 146.20236206054688, ACC: 0.9858880639076233
2023-07-25 16:16:46,242 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 159.2604217529297, ACC: 0.9831159710884094
2023-07-25 16:16:57,485 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 168.00790405273438, ACC: 0.9815155267715454
2023-07-25 16:17:08,411 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 182.11366271972656, ACC: 0.9778298139572144
2023-07-25 16:17:19,677 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 206.20603942871094, ACC: 0.972146213054657
2023-07-25 16:17:31,078 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 227.10745239257812, ACC: 0.9662962555885315
2023-07-25 16:17:42,774 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 236.9061279296875, ACC: 0.963874340057373
2023-07-25 16:17:55,040 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 254.10267639160156, ACC: 0.9576246738433838
2023-07-25 16:18:06,793 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 279.6705322265625, ACC: 0.9485722184181213
2023-07-25 16:18:18,488 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 314.3428039550781, ACC: 0.933741569519043
2023-07-25 16:18:30,301 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 344.918701171875, ACC: 0.9205211997032166
2023-07-25 16:18:41,753 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 377.0279235839844, ACC: 0.9031230211257935
2023-07-25 16:18:53,289 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 405.64300537109375, ACC: 0.8864419460296631
2023-07-25 16:19:05,449 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 432.5520935058594, ACC: 0.8658648133277893
2023-07-25 16:19:17,543 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 453.3724060058594, ACC: 0.8474937081336975
2023-07-25 16:19:29,401 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 471.6348571777344, ACC: 0.8233368992805481
2023-07-25 16:19:40,936 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 486.8629150390625, ACC: 0.8059877753257751
2023-07-25 16:19:51,509 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 503.2256774902344, ACC: 0.784515917301178
2023-07-25 16:20:02,907 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 514.6198120117188, ACC: 0.776611328125
2023-07-25 16:20:13,337 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 531.8150024414062, ACC: 0.7549893260002136
2023-07-25 16:20:24,928 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 549.5615234375, ACC: 0.7496689558029175
2023-07-25 16:20:35,628 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 576.8973999023438, ACC: 0.729543149471283
2023-07-25 16:20:47,153 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 597.6704711914062, ACC: 0.7235381007194519
2023-07-25 16:20:58,405 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 624.0864868164062, ACC: 0.707505464553833
2023-07-25 16:21:09,785 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 644.3851928710938, ACC: 0.6977804899215698
2023-07-25 16:21:09,891 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-U850_30-timesteps_vis.h5
2023-07-25 16:22:03,226 - root - INFO - ------------------ Configuration ------------------
2023-07-25 16:22:03,227 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 16:22:03,227 - root - INFO - Configuration name: afno_backbone
2023-07-25 16:22:03,227 - root - INFO - log_to_wandb True
2023-07-25 16:22:03,227 - root - INFO - lr 0.0005
2023-07-25 16:22:03,227 - root - INFO - batch_size 64
2023-07-25 16:22:03,227 - root - INFO - max_epochs 150
2023-07-25 16:22:03,227 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 16:22:03,227 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 16:22:03,227 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 16:22:03,227 - root - INFO - orography False
2023-07-25 16:22:03,227 - root - INFO - orography_path None
2023-07-25 16:22:03,227 - root - INFO - exp_dir FourCastNet/results
2023-07-25 16:22:03,227 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 16:22:03,227 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 16:22:03,227 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 16:22:03,228 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 16:22:03,228 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 16:22:03,228 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 16:22:03,228 - root - INFO - loss l2
2023-07-25 16:22:03,228 - root - INFO - num_data_workers 4
2023-07-25 16:22:03,228 - root - INFO - dt 1
2023-07-25 16:22:03,228 - root - INFO - n_history 0
2023-07-25 16:22:03,228 - root - INFO - prediction_type iterative
2023-07-25 16:22:03,228 - root - INFO - prediction_length 30
2023-07-25 16:22:03,228 - root - INFO - n_initial_conditions 5
2023-07-25 16:22:03,228 - root - INFO - ics_type default
2023-07-25 16:22:03,228 - root - INFO - save_raw_forecasts True
2023-07-25 16:22:03,228 - root - INFO - save_channel False
2023-07-25 16:22:03,228 - root - INFO - masked_acc False
2023-07-25 16:22:03,228 - root - INFO - maskpath None
2023-07-25 16:22:03,228 - root - INFO - perturb False
2023-07-25 16:22:03,228 - root - INFO - add_grid False
2023-07-25 16:22:03,228 - root - INFO - N_grid_channels 0
2023-07-25 16:22:03,228 - root - INFO - gridtype sinusoidal
2023-07-25 16:22:03,228 - root - INFO - roll False
2023-07-25 16:22:03,228 - root - INFO - num_blocks 8
2023-07-25 16:22:03,228 - root - INFO - nettype afno
2023-07-25 16:22:03,229 - root - INFO - patch_size 8
2023-07-25 16:22:03,229 - root - INFO - width 56
2023-07-25 16:22:03,229 - root - INFO - modes 32
2023-07-25 16:22:03,229 - root - INFO - target mslp
2023-07-25 16:22:03,229 - root - INFO - normalization zscore
2023-07-25 16:22:03,229 - root - INFO - log_to_screen True
2023-07-25 16:22:03,229 - root - INFO - save_checkpoint True
2023-07-25 16:22:03,229 - root - INFO - enable_nhwc False
2023-07-25 16:22:03,229 - root - INFO - optimizer_type FusedAdam
2023-07-25 16:22:03,229 - root - INFO - crop_size_x None
2023-07-25 16:22:03,229 - root - INFO - crop_size_y None
2023-07-25 16:22:03,229 - root - INFO - two_step_training False
2023-07-25 16:22:03,229 - root - INFO - plot_animations False
2023-07-25 16:22:03,229 - root - INFO - add_noise False
2023-07-25 16:22:03,229 - root - INFO - noise_std 0
2023-07-25 16:22:03,229 - root - INFO - world_size 1
2023-07-25 16:22:03,229 - root - INFO - interp 0
2023-07-25 16:22:03,229 - root - INFO - use_daily_climatology False
2023-07-25 16:22:03,230 - root - INFO - global_batch_size 64
2023-07-25 16:22:03,230 - root - INFO - ablate V850
2023-07-25 16:22:03,230 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 16:22:03,230 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 16:22:03,230 - root - INFO - resuming False
2023-07-25 16:22:03,230 - root - INFO - local_rank 0
2023-07-25 16:22:03,230 - root - INFO - ---------------------------------------------------
2023-07-25 16:22:03,230 - root - INFO - Inference for 1 initial conditions
2023-07-25 16:22:03,491 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 16:22:03,492 - root - INFO - Number of samples per year: 1460
2023-07-25 16:22:03,493 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 16:22:03,493 - root - INFO - Delta t: 6 hours
2023-07-25 16:22:03,493 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 16:22:03,493 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 16:23:12,769 - root - INFO - Loading inference data
2023-07-25 16:23:12,770 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 16:23:13,016 - root - INFO - Initial condition 1 of 1
2023-07-25 16:23:13,777 - root - INFO - Extracting valid data from the first year
2023-07-25 16:25:43,183 - root - INFO - Standardizing data
2023-07-25 16:25:51,425 - root - INFO - Loading time means
2023-07-25 16:26:06,368 - root - INFO - Begin autoregressive inference
2023-07-25 16:26:17,801 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 16:26:30,299 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 102.5582504272461, ACC: 0.9943691492080688
2023-07-25 16:26:41,059 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 92.20161437988281, ACC: 0.9950440526008606
2023-07-25 16:26:52,345 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 97.95882415771484, ACC: 0.9942318201065063
2023-07-25 16:27:04,741 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 108.00542449951172, ACC: 0.9924628138542175
2023-07-25 16:27:16,244 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 120.4695816040039, ACC: 0.9905083775520325
2023-07-25 16:27:29,473 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 135.30345153808594, ACC: 0.9878931641578674
2023-07-25 16:27:40,548 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 143.41554260253906, ACC: 0.9865819811820984
2023-07-25 16:27:52,184 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 154.90049743652344, ACC: 0.9840260148048401
2023-07-25 16:28:04,877 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 174.95938110351562, ACC: 0.979985237121582
2023-07-25 16:28:17,278 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 188.25277709960938, ACC: 0.9768372774124146
2023-07-25 16:28:29,292 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 192.90638732910156, ACC: 0.9757787585258484
2023-07-25 16:28:40,493 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 207.46913146972656, ACC: 0.9712488055229187
2023-07-25 16:28:52,581 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 233.09136962890625, ACC: 0.9634747505187988
2023-07-25 16:29:05,814 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 260.9596252441406, ACC: 0.9536993503570557
2023-07-25 16:29:18,491 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 286.3073425292969, ACC: 0.944155216217041
2023-07-25 16:29:30,305 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 312.0210266113281, ACC: 0.9326936602592468
2023-07-25 16:29:42,865 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 339.5215148925781, ACC: 0.9192749857902527
2023-07-25 16:29:56,336 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 360.6387023925781, ACC: 0.9060502648353577
2023-07-25 16:30:10,459 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 377.9952392578125, ACC: 0.8925243616104126
2023-07-25 16:30:25,291 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 398.3504638671875, ACC: 0.8730040192604065
2023-07-25 16:30:38,377 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 420.4912414550781, ACC: 0.8536707162857056
2023-07-25 16:30:51,914 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 438.05035400390625, ACC: 0.8359314203262329
2023-07-25 16:31:04,258 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 451.17572021484375, ACC: 0.8262332081794739
2023-07-25 16:31:18,553 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 465.9326171875, ACC: 0.810588002204895
2023-07-25 16:31:32,410 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 479.46929931640625, ACC: 0.8069589138031006
2023-07-25 16:31:45,536 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 493.4465026855469, ACC: 0.801115095615387
2023-07-25 16:32:00,241 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 505.68145751953125, ACC: 0.800134539604187
2023-07-25 16:32:14,399 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 524.3151245117188, ACC: 0.7933158874511719
2023-07-25 16:32:28,235 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 544.6315307617188, ACC: 0.7840666174888611
2023-07-25 16:32:28,326 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-V850_30-timesteps_vis.h5
2023-07-25 16:33:21,509 - root - INFO - ------------------ Configuration ------------------
2023-07-25 16:33:21,509 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 16:33:21,509 - root - INFO - Configuration name: afno_backbone
2023-07-25 16:33:21,509 - root - INFO - log_to_wandb True
2023-07-25 16:33:21,509 - root - INFO - lr 0.0005
2023-07-25 16:33:21,509 - root - INFO - batch_size 64
2023-07-25 16:33:21,509 - root - INFO - max_epochs 150
2023-07-25 16:33:21,509 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 16:33:21,509 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 16:33:21,509 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 16:33:21,509 - root - INFO - orography False
2023-07-25 16:33:21,509 - root - INFO - orography_path None
2023-07-25 16:33:21,509 - root - INFO - exp_dir FourCastNet/results
2023-07-25 16:33:21,509 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 16:33:21,509 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 16:33:21,510 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 16:33:21,510 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 16:33:21,510 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 16:33:21,510 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 16:33:21,510 - root - INFO - loss l2
2023-07-25 16:33:21,510 - root - INFO - num_data_workers 4
2023-07-25 16:33:21,510 - root - INFO - dt 1
2023-07-25 16:33:21,510 - root - INFO - n_history 0
2023-07-25 16:33:21,510 - root - INFO - prediction_type iterative
2023-07-25 16:33:21,510 - root - INFO - prediction_length 30
2023-07-25 16:33:21,510 - root - INFO - n_initial_conditions 5
2023-07-25 16:33:21,510 - root - INFO - ics_type default
2023-07-25 16:33:21,510 - root - INFO - save_raw_forecasts True
2023-07-25 16:33:21,510 - root - INFO - save_channel False
2023-07-25 16:33:21,510 - root - INFO - masked_acc False
2023-07-25 16:33:21,510 - root - INFO - maskpath None
2023-07-25 16:33:21,510 - root - INFO - perturb False
2023-07-25 16:33:21,510 - root - INFO - add_grid False
2023-07-25 16:33:21,510 - root - INFO - N_grid_channels 0
2023-07-25 16:33:21,511 - root - INFO - gridtype sinusoidal
2023-07-25 16:33:21,511 - root - INFO - roll False
2023-07-25 16:33:21,511 - root - INFO - num_blocks 8
2023-07-25 16:33:21,511 - root - INFO - nettype afno
2023-07-25 16:33:21,511 - root - INFO - patch_size 8
2023-07-25 16:33:21,511 - root - INFO - width 56
2023-07-25 16:33:21,511 - root - INFO - modes 32
2023-07-25 16:33:21,511 - root - INFO - target mslp
2023-07-25 16:33:21,511 - root - INFO - normalization zscore
2023-07-25 16:33:21,511 - root - INFO - log_to_screen True
2023-07-25 16:33:21,511 - root - INFO - save_checkpoint True
2023-07-25 16:33:21,511 - root - INFO - enable_nhwc False
2023-07-25 16:33:21,511 - root - INFO - optimizer_type FusedAdam
2023-07-25 16:33:21,511 - root - INFO - crop_size_x None
2023-07-25 16:33:21,511 - root - INFO - crop_size_y None
2023-07-25 16:33:21,512 - root - INFO - two_step_training False
2023-07-25 16:33:21,512 - root - INFO - plot_animations False
2023-07-25 16:33:21,512 - root - INFO - add_noise False
2023-07-25 16:33:21,512 - root - INFO - noise_std 0
2023-07-25 16:33:21,512 - root - INFO - world_size 1
2023-07-25 16:33:21,512 - root - INFO - interp 0
2023-07-25 16:33:21,512 - root - INFO - use_daily_climatology False
2023-07-25 16:33:21,512 - root - INFO - global_batch_size 64
2023-07-25 16:33:21,512 - root - INFO - ablate Z850
2023-07-25 16:33:21,512 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 16:33:21,512 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 16:33:21,512 - root - INFO - resuming False
2023-07-25 16:33:21,512 - root - INFO - local_rank 0
2023-07-25 16:33:21,512 - root - INFO - ---------------------------------------------------
2023-07-25 16:33:21,512 - root - INFO - Inference for 1 initial conditions
2023-07-25 16:33:21,806 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 16:33:21,807 - root - INFO - Number of samples per year: 1460
2023-07-25 16:33:21,807 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 16:33:21,807 - root - INFO - Delta t: 6 hours
2023-07-25 16:33:21,807 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 16:33:21,807 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 16:34:39,286 - root - INFO - Loading inference data
2023-07-25 16:34:39,287 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 16:34:39,636 - root - INFO - Initial condition 1 of 1
2023-07-25 16:34:40,516 - root - INFO - Extracting valid data from the first year
2023-07-25 16:37:28,148 - root - INFO - Standardizing data
2023-07-25 16:37:36,175 - root - INFO - Loading time means
2023-07-25 16:37:53,149 - root - INFO - Begin autoregressive inference
2023-07-25 16:38:03,732 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 16:38:15,843 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 1823.767333984375, ACC: 0.2803884446620941
2023-07-25 16:38:27,313 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 11220.66015625, ACC: -0.043186262249946594
2023-07-25 16:38:38,816 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 20676.75390625, ACC: -0.024689583107829094
2023-07-25 16:38:50,874 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 28926.552734375, ACC: -0.032017532736063004
2023-07-25 16:39:02,667 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 35232.671875, ACC: -0.030978860333561897
2023-07-25 16:39:14,585 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 39270.078125, ACC: -0.019560569897294044
2023-07-25 16:39:25,848 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 41779.26171875, ACC: -0.022743090987205505
2023-07-25 16:39:37,468 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 43355.91796875, ACC: -0.02645561471581459
2023-07-25 16:39:48,808 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 44339.1953125, ACC: -0.023426294326782227
2023-07-25 16:40:00,592 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 44952.71484375, ACC: -0.015711737796664238
2023-07-25 16:40:12,893 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 45341.4453125, ACC: -0.015440944582223892
2023-07-25 16:40:24,613 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 45590.12109375, ACC: -0.01809605211019516
2023-07-25 16:40:36,056 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 45747.13671875, ACC: -0.015421681106090546
2023-07-25 16:40:47,606 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 45848.140625, ACC: -0.010686850175261497
2023-07-25 16:40:59,272 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 45920.05859375, ACC: -0.011889172717928886
2023-07-25 16:41:11,508 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 45971.0703125, ACC: -0.014935002662241459
2023-07-25 16:41:22,479 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 46003.18359375, ACC: -0.013256539590656757
2023-07-25 16:41:33,736 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 46022.2734375, ACC: -0.008359710685908794
2023-07-25 16:41:45,246 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 46040.1484375, ACC: -0.010305766016244888
2023-07-25 16:41:57,276 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 46054.93359375, ACC: -0.014754422940313816
2023-07-25 16:42:08,206 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 46061.8671875, ACC: -0.013307962566614151
2023-07-25 16:42:19,830 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 46064.0234375, ACC: -0.008763267658650875
2023-07-25 16:42:31,629 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 46070.59765625, ACC: -0.011538260616362095
2023-07-25 16:42:42,927 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 46077.03515625, ACC: -0.015921801328659058
2023-07-25 16:42:54,039 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 46078.703125, ACC: -0.014372644014656544
2023-07-25 16:43:05,108 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 46076.7421875, ACC: -0.009366837330162525
2023-07-25 16:43:16,250 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 46080.4296875, ACC: -0.011714927852153778
2023-07-25 16:43:27,315 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 46084.13671875, ACC: -0.014377592131495476
2023-07-25 16:43:38,896 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 46084.046875, ACC: -0.012992882169783115
2023-07-25 16:43:38,982 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-Z850_30-timesteps_vis.h5
2023-07-25 16:44:32,064 - root - INFO - ------------------ Configuration ------------------
2023-07-25 16:44:32,065 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 16:44:32,065 - root - INFO - Configuration name: afno_backbone
2023-07-25 16:44:32,065 - root - INFO - log_to_wandb True
2023-07-25 16:44:32,065 - root - INFO - lr 0.0005
2023-07-25 16:44:32,065 - root - INFO - batch_size 64
2023-07-25 16:44:32,065 - root - INFO - max_epochs 150
2023-07-25 16:44:32,065 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 16:44:32,065 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 16:44:32,065 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 16:44:32,065 - root - INFO - orography False
2023-07-25 16:44:32,065 - root - INFO - orography_path None
2023-07-25 16:44:32,065 - root - INFO - exp_dir FourCastNet/results
2023-07-25 16:44:32,065 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 16:44:32,065 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 16:44:32,065 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 16:44:32,066 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 16:44:32,066 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 16:44:32,066 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 16:44:32,066 - root - INFO - loss l2
2023-07-25 16:44:32,066 - root - INFO - num_data_workers 4
2023-07-25 16:44:32,066 - root - INFO - dt 1
2023-07-25 16:44:32,066 - root - INFO - n_history 0
2023-07-25 16:44:32,066 - root - INFO - prediction_type iterative
2023-07-25 16:44:32,066 - root - INFO - prediction_length 30
2023-07-25 16:44:32,066 - root - INFO - n_initial_conditions 5
2023-07-25 16:44:32,066 - root - INFO - ics_type default
2023-07-25 16:44:32,066 - root - INFO - save_raw_forecasts True
2023-07-25 16:44:32,066 - root - INFO - save_channel False
2023-07-25 16:44:32,066 - root - INFO - masked_acc False
2023-07-25 16:44:32,066 - root - INFO - maskpath None
2023-07-25 16:44:32,066 - root - INFO - perturb False
2023-07-25 16:44:32,066 - root - INFO - add_grid False
2023-07-25 16:44:32,066 - root - INFO - N_grid_channels 0
2023-07-25 16:44:32,066 - root - INFO - gridtype sinusoidal
2023-07-25 16:44:32,066 - root - INFO - roll False
2023-07-25 16:44:32,067 - root - INFO - num_blocks 8
2023-07-25 16:44:32,067 - root - INFO - nettype afno
2023-07-25 16:44:32,067 - root - INFO - patch_size 8
2023-07-25 16:44:32,067 - root - INFO - width 56
2023-07-25 16:44:32,067 - root - INFO - modes 32
2023-07-25 16:44:32,067 - root - INFO - target mslp
2023-07-25 16:44:32,067 - root - INFO - normalization zscore
2023-07-25 16:44:32,067 - root - INFO - log_to_screen True
2023-07-25 16:44:32,067 - root - INFO - save_checkpoint True
2023-07-25 16:44:32,067 - root - INFO - enable_nhwc False
2023-07-25 16:44:32,067 - root - INFO - optimizer_type FusedAdam
2023-07-25 16:44:32,067 - root - INFO - crop_size_x None
2023-07-25 16:44:32,067 - root - INFO - crop_size_y None
2023-07-25 16:44:32,067 - root - INFO - two_step_training False
2023-07-25 16:44:32,067 - root - INFO - plot_animations False
2023-07-25 16:44:32,067 - root - INFO - add_noise False
2023-07-25 16:44:32,067 - root - INFO - noise_std 0
2023-07-25 16:44:32,067 - root - INFO - world_size 1
2023-07-25 16:44:32,067 - root - INFO - interp 0
2023-07-25 16:44:32,068 - root - INFO - use_daily_climatology False
2023-07-25 16:44:32,068 - root - INFO - global_batch_size 64
2023-07-25 16:44:32,068 - root - INFO - ablate RH850
2023-07-25 16:44:32,068 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 16:44:32,068 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 16:44:32,068 - root - INFO - resuming False
2023-07-25 16:44:32,068 - root - INFO - local_rank 0
2023-07-25 16:44:32,068 - root - INFO - ---------------------------------------------------
2023-07-25 16:44:32,068 - root - INFO - Inference for 1 initial conditions
2023-07-25 16:44:32,355 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 16:44:32,356 - root - INFO - Number of samples per year: 1460
2023-07-25 16:44:32,356 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 16:44:32,356 - root - INFO - Delta t: 6 hours
2023-07-25 16:44:32,356 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 16:44:32,356 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 16:45:41,935 - root - INFO - Loading inference data
2023-07-25 16:45:41,936 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 16:45:42,245 - root - INFO - Initial condition 1 of 1
2023-07-25 16:45:43,250 - root - INFO - Extracting valid data from the first year
2023-07-25 16:48:12,909 - root - INFO - Standardizing data
2023-07-25 16:48:20,662 - root - INFO - Loading time means
2023-07-25 16:48:36,796 - root - INFO - Begin autoregressive inference
2023-07-25 16:48:47,044 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 16:48:57,786 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 108.68439483642578, ACC: 0.9926179647445679
2023-07-25 16:49:09,353 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 121.7408676147461, ACC: 0.9905977249145508
2023-07-25 16:49:20,507 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 140.33177185058594, ACC: 0.9875332713127136
2023-07-25 16:49:31,542 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 163.69232177734375, ACC: 0.9822027087211609
2023-07-25 16:49:42,280 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 190.1034393310547, ACC: 0.9760918617248535
2023-07-25 16:49:53,527 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 211.9715576171875, ACC: 0.9699550867080688
2023-07-25 16:50:04,962 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 232.12686157226562, ACC: 0.964607834815979
2023-07-25 16:50:15,197 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 256.6152038574219, ACC: 0.9557676911354065
2023-07-25 16:50:25,535 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 282.0243835449219, ACC: 0.9474136829376221
2023-07-25 16:50:36,573 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 303.1990661621094, ACC: 0.939007580280304
2023-07-25 16:50:46,673 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 318.04412841796875, ACC: 0.93258136510849
2023-07-25 16:50:57,771 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 333.4795227050781, ACC: 0.9237903356552124
2023-07-25 16:51:08,895 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 358.1895751953125, ACC: 0.9116138219833374
2023-07-25 16:51:19,526 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 388.240234375, ACC: 0.8948386311531067
2023-07-25 16:51:30,235 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 410.18572998046875, ACC: 0.8832087516784668
2023-07-25 16:51:40,863 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 437.14227294921875, ACC: 0.8653923273086548
2023-07-25 16:51:52,669 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 465.055908203125, ACC: 0.8463972210884094
2023-07-25 16:52:04,537 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 493.66656494140625, ACC: 0.8216421604156494
2023-07-25 16:52:16,528 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 520.9842529296875, ACC: 0.7963402271270752
2023-07-25 16:52:27,337 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 547.8492431640625, ACC: 0.7628312110900879
2023-07-25 16:52:37,990 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 568.9942626953125, ACC: 0.7386137843132019
2023-07-25 16:52:48,409 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 585.9666137695312, ACC: 0.7131670713424683
2023-07-25 16:52:59,171 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 599.90869140625, ACC: 0.6996212005615234
2023-07-25 16:53:09,598 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 618.2139892578125, ACC: 0.6708464026451111
2023-07-25 16:53:19,962 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 636.3170166015625, ACC: 0.6614251732826233
2023-07-25 16:53:29,716 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 656.409912109375, ACC: 0.6446226239204407
2023-07-25 16:53:40,471 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 671.6218872070312, ACC: 0.6449346542358398
2023-07-25 16:53:50,525 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 689.6112060546875, ACC: 0.6388317346572876
2023-07-25 16:54:00,999 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 708.621337890625, ACC: 0.6331161260604858
2023-07-25 16:54:01,120 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-RH850_30-timesteps_vis.h5
2023-07-25 16:54:54,391 - root - INFO - ------------------ Configuration ------------------
2023-07-25 16:54:54,391 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 16:54:54,391 - root - INFO - Configuration name: afno_backbone
2023-07-25 16:54:54,391 - root - INFO - log_to_wandb True
2023-07-25 16:54:54,391 - root - INFO - lr 0.0005
2023-07-25 16:54:54,392 - root - INFO - batch_size 64
2023-07-25 16:54:54,392 - root - INFO - max_epochs 150
2023-07-25 16:54:54,392 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 16:54:54,392 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 16:54:54,392 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 16:54:54,392 - root - INFO - orography False
2023-07-25 16:54:54,392 - root - INFO - orography_path None
2023-07-25 16:54:54,392 - root - INFO - exp_dir FourCastNet/results
2023-07-25 16:54:54,392 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 16:54:54,392 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 16:54:54,392 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 16:54:54,392 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 16:54:54,392 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 16:54:54,392 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 16:54:54,392 - root - INFO - loss l2
2023-07-25 16:54:54,392 - root - INFO - num_data_workers 4
2023-07-25 16:54:54,392 - root - INFO - dt 1
2023-07-25 16:54:54,392 - root - INFO - n_history 0
2023-07-25 16:54:54,393 - root - INFO - prediction_type iterative
2023-07-25 16:54:54,393 - root - INFO - prediction_length 30
2023-07-25 16:54:54,393 - root - INFO - n_initial_conditions 5
2023-07-25 16:54:54,393 - root - INFO - ics_type default
2023-07-25 16:54:54,393 - root - INFO - save_raw_forecasts True
2023-07-25 16:54:54,393 - root - INFO - save_channel False
2023-07-25 16:54:54,393 - root - INFO - masked_acc False
2023-07-25 16:54:54,393 - root - INFO - maskpath None
2023-07-25 16:54:54,393 - root - INFO - perturb False
2023-07-25 16:54:54,393 - root - INFO - add_grid False
2023-07-25 16:54:54,393 - root - INFO - N_grid_channels 0
2023-07-25 16:54:54,393 - root - INFO - gridtype sinusoidal
2023-07-25 16:54:54,393 - root - INFO - roll False
2023-07-25 16:54:54,393 - root - INFO - num_blocks 8
2023-07-25 16:54:54,393 - root - INFO - nettype afno
2023-07-25 16:54:54,393 - root - INFO - patch_size 8
2023-07-25 16:54:54,393 - root - INFO - width 56
2023-07-25 16:54:54,393 - root - INFO - modes 32
2023-07-25 16:54:54,394 - root - INFO - target mslp
2023-07-25 16:54:54,394 - root - INFO - normalization zscore
2023-07-25 16:54:54,394 - root - INFO - log_to_screen True
2023-07-25 16:54:54,394 - root - INFO - save_checkpoint True
2023-07-25 16:54:54,394 - root - INFO - enable_nhwc False
2023-07-25 16:54:54,394 - root - INFO - optimizer_type FusedAdam
2023-07-25 16:54:54,394 - root - INFO - crop_size_x None
2023-07-25 16:54:54,394 - root - INFO - crop_size_y None
2023-07-25 16:54:54,394 - root - INFO - two_step_training False
2023-07-25 16:54:54,394 - root - INFO - plot_animations False
2023-07-25 16:54:54,394 - root - INFO - add_noise False
2023-07-25 16:54:54,394 - root - INFO - noise_std 0
2023-07-25 16:54:54,394 - root - INFO - world_size 1
2023-07-25 16:54:54,394 - root - INFO - interp 0
2023-07-25 16:54:54,394 - root - INFO - use_daily_climatology False
2023-07-25 16:54:54,394 - root - INFO - global_batch_size 64
2023-07-25 16:54:54,394 - root - INFO - ablate T500
2023-07-25 16:54:54,394 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 16:54:54,395 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 16:54:54,395 - root - INFO - resuming False
2023-07-25 16:54:54,395 - root - INFO - local_rank 0
2023-07-25 16:54:54,395 - root - INFO - ---------------------------------------------------
2023-07-25 16:54:54,395 - root - INFO - Inference for 1 initial conditions
2023-07-25 16:54:54,658 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 16:54:54,659 - root - INFO - Number of samples per year: 1460
2023-07-25 16:54:54,659 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 16:54:54,659 - root - INFO - Delta t: 6 hours
2023-07-25 16:54:54,659 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 16:54:54,660 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 16:56:04,412 - root - INFO - Loading inference data
2023-07-25 16:56:04,412 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 16:56:04,610 - root - INFO - Initial condition 1 of 1
2023-07-25 16:56:05,476 - root - INFO - Extracting valid data from the first year
2023-07-25 16:58:27,948 - root - INFO - Standardizing data
2023-07-25 16:58:36,232 - root - INFO - Loading time means
2023-07-25 16:58:51,509 - root - INFO - Begin autoregressive inference
2023-07-25 16:59:01,608 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 16:59:12,264 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 104.41280364990234, ACC: 0.9935393333435059
2023-07-25 16:59:23,060 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 95.90306854248047, ACC: 0.9942439198493958
2023-07-25 16:59:33,446 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 101.30680847167969, ACC: 0.9937290549278259
2023-07-25 16:59:44,134 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 117.75762939453125, ACC: 0.9909026026725769
2023-07-25 16:59:54,965 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 127.57756042480469, ACC: 0.9893166422843933
2023-07-25 17:00:05,380 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 145.31777954101562, ACC: 0.9860331416130066
2023-07-25 17:00:17,292 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 150.69493103027344, ACC: 0.9852195978164673
2023-07-25 17:00:29,121 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 162.83045959472656, ACC: 0.9823852777481079
2023-07-25 17:00:39,836 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 178.13894653320312, ACC: 0.9792983531951904
2023-07-25 17:00:50,878 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 191.91062927246094, ACC: 0.9759746789932251
2023-07-25 17:01:01,041 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 199.92184448242188, ACC: 0.9739155769348145
2023-07-25 17:01:12,551 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 220.49530029296875, ACC: 0.9674264788627625
2023-07-25 17:01:23,558 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 250.902587890625, ACC: 0.9575442671775818
2023-07-25 17:01:34,228 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 284.93182373046875, ACC: 0.9445555806159973
2023-07-25 17:01:44,181 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 317.56427001953125, ACC: 0.9309294819831848
2023-07-25 17:01:54,694 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 344.8823547363281, ACC: 0.9172943830490112
2023-07-25 17:02:05,400 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 367.1102294921875, ACC: 0.9050191044807434
2023-07-25 17:02:16,090 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 376.610595703125, ACC: 0.8970380425453186
2023-07-25 17:02:27,009 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 383.7614440917969, ACC: 0.888785719871521
2023-07-25 17:02:38,115 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 397.46832275390625, ACC: 0.8731249570846558
2023-07-25 17:02:48,780 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 415.58062744140625, ACC: 0.8564346432685852
2023-07-25 17:02:59,111 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 432.9940490722656, ACC: 0.8386909365653992
2023-07-25 17:03:09,747 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 448.94232177734375, ACC: 0.8261134028434753
2023-07-25 17:03:20,507 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 471.6261901855469, ACC: 0.8035723567008972
2023-07-25 17:03:31,377 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 501.5899963378906, ACC: 0.7855502367019653
2023-07-25 17:03:42,189 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 536.8529663085938, ACC: 0.759516179561615
2023-07-25 17:03:52,834 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 568.4601440429688, ACC: 0.7402608394622803
2023-07-25 17:04:03,258 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 600.4899291992188, ACC: 0.7197929620742798
2023-07-25 17:04:14,926 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 628.1344604492188, ACC: 0.702880322933197
2023-07-25 17:04:15,011 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-T500_30-timesteps_vis.h5
2023-07-25 17:05:08,156 - root - INFO - ------------------ Configuration ------------------
2023-07-25 17:05:08,156 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 17:05:08,156 - root - INFO - Configuration name: afno_backbone
2023-07-25 17:05:08,156 - root - INFO - log_to_wandb True
2023-07-25 17:05:08,156 - root - INFO - lr 0.0005
2023-07-25 17:05:08,156 - root - INFO - batch_size 64
2023-07-25 17:05:08,156 - root - INFO - max_epochs 150
2023-07-25 17:05:08,156 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 17:05:08,157 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 17:05:08,157 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 17:05:08,157 - root - INFO - orography False
2023-07-25 17:05:08,157 - root - INFO - orography_path None
2023-07-25 17:05:08,157 - root - INFO - exp_dir FourCastNet/results
2023-07-25 17:05:08,157 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 17:05:08,157 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 17:05:08,157 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 17:05:08,157 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 17:05:08,157 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 17:05:08,157 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 17:05:08,157 - root - INFO - loss l2
2023-07-25 17:05:08,157 - root - INFO - num_data_workers 4
2023-07-25 17:05:08,157 - root - INFO - dt 1
2023-07-25 17:05:08,157 - root - INFO - n_history 0
2023-07-25 17:05:08,157 - root - INFO - prediction_type iterative
2023-07-25 17:05:08,157 - root - INFO - prediction_length 30
2023-07-25 17:05:08,157 - root - INFO - n_initial_conditions 5
2023-07-25 17:05:08,157 - root - INFO - ics_type default
2023-07-25 17:05:08,158 - root - INFO - save_raw_forecasts True
2023-07-25 17:05:08,158 - root - INFO - save_channel False
2023-07-25 17:05:08,158 - root - INFO - masked_acc False
2023-07-25 17:05:08,158 - root - INFO - maskpath None
2023-07-25 17:05:08,158 - root - INFO - perturb False
2023-07-25 17:05:08,158 - root - INFO - add_grid False
2023-07-25 17:05:08,158 - root - INFO - N_grid_channels 0
2023-07-25 17:05:08,158 - root - INFO - gridtype sinusoidal
2023-07-25 17:05:08,158 - root - INFO - roll False
2023-07-25 17:05:08,158 - root - INFO - num_blocks 8
2023-07-25 17:05:08,158 - root - INFO - nettype afno
2023-07-25 17:05:08,158 - root - INFO - patch_size 8
2023-07-25 17:05:08,158 - root - INFO - width 56
2023-07-25 17:05:08,158 - root - INFO - modes 32
2023-07-25 17:05:08,158 - root - INFO - target mslp
2023-07-25 17:05:08,158 - root - INFO - normalization zscore
2023-07-25 17:05:08,158 - root - INFO - log_to_screen True
2023-07-25 17:05:08,158 - root - INFO - save_checkpoint True
2023-07-25 17:05:08,158 - root - INFO - enable_nhwc False
2023-07-25 17:05:08,158 - root - INFO - optimizer_type FusedAdam
2023-07-25 17:05:08,158 - root - INFO - crop_size_x None
2023-07-25 17:05:08,158 - root - INFO - crop_size_y None
2023-07-25 17:05:08,158 - root - INFO - two_step_training False
2023-07-25 17:05:08,158 - root - INFO - plot_animations False
2023-07-25 17:05:08,159 - root - INFO - add_noise False
2023-07-25 17:05:08,159 - root - INFO - noise_std 0
2023-07-25 17:05:08,159 - root - INFO - world_size 1
2023-07-25 17:05:08,159 - root - INFO - interp 0
2023-07-25 17:05:08,159 - root - INFO - use_daily_climatology False
2023-07-25 17:05:08,159 - root - INFO - global_batch_size 64
2023-07-25 17:05:08,159 - root - INFO - ablate U500
2023-07-25 17:05:08,159 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 17:05:08,159 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 17:05:08,159 - root - INFO - resuming False
2023-07-25 17:05:08,159 - root - INFO - local_rank 0
2023-07-25 17:05:08,159 - root - INFO - ---------------------------------------------------
2023-07-25 17:05:08,159 - root - INFO - Inference for 1 initial conditions
2023-07-25 17:05:08,479 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 17:05:08,480 - root - INFO - Number of samples per year: 1460
2023-07-25 17:05:08,480 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 17:05:08,480 - root - INFO - Delta t: 6 hours
2023-07-25 17:05:08,480 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 17:05:08,480 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 17:06:15,874 - root - INFO - Loading inference data
2023-07-25 17:06:15,875 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 17:06:16,034 - root - INFO - Initial condition 1 of 1
2023-07-25 17:06:16,899 - root - INFO - Extracting valid data from the first year
2023-07-25 17:08:37,460 - root - INFO - Standardizing data
2023-07-25 17:08:45,408 - root - INFO - Loading time means
2023-07-25 17:09:01,823 - root - INFO - Begin autoregressive inference
2023-07-25 17:09:13,285 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 17:09:24,166 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 1750.8084716796875, ACC: 0.3923206627368927
2023-07-25 17:09:35,518 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 10738.1533203125, ACC: 0.12116888165473938
2023-07-25 17:09:46,201 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 22281.263671875, ACC: 0.03675822541117668
2023-07-25 17:09:56,959 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 31488.212890625, ACC: 0.0016336595872417092
2023-07-25 17:10:07,546 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 37590.1796875, ACC: -0.0124216852709651
2023-07-25 17:10:18,359 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 40960.37890625, ACC: -0.010178832337260246
2023-07-25 17:10:28,611 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 42886.03515625, ACC: -0.018337944522500038
2023-07-25 17:10:39,416 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 44062.68359375, ACC: -0.025672340765595436
2023-07-25 17:10:49,616 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 44803.88671875, ACC: -0.024480391293764114
2023-07-25 17:11:00,090 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 45262.9453125, ACC: -0.017312347888946533
2023-07-25 17:11:10,433 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 45552.6953125, ACC: -0.01663368195295334
2023-07-25 17:11:20,986 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 45734.69921875, ACC: -0.01876954175531864
2023-07-25 17:11:31,861 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 45846.27734375, ACC: -0.01591634564101696
2023-07-25 17:11:41,965 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 45916.15625, ACC: -0.011077617295086384
2023-07-25 17:11:53,087 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 45966.8828125, ACC: -0.012125766836106777
2023-07-25 17:12:04,069 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 46003.4609375, ACC: -0.01505980920046568
2023-07-25 17:12:14,412 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 46025.7109375, ACC: -0.013330448418855667
2023-07-25 17:12:24,428 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 46038.01171875, ACC: -0.008393899537622929
2023-07-25 17:12:34,855 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 46051.1796875, ACC: -0.01031159982085228
2023-07-25 17:12:45,428 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 46062.703125, ACC: -0.014753676950931549
2023-07-25 17:12:56,017 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 46067.36328125, ACC: -0.013306867331266403
2023-07-25 17:13:06,653 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 46067.93359375, ACC: -0.00876187440007925
2023-07-25 17:13:17,834 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 46073.37890625, ACC: -0.011533177457749844
2023-07-25 17:13:28,425 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 46079.015625, ACC: -0.01591697707772255
2023-07-25 17:13:38,164 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 46080.12109375, ACC: -0.014367829076945782
2023-07-25 17:13:49,175 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 46077.76171875, ACC: -0.009362012147903442
2023-07-25 17:13:59,746 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 46081.16015625, ACC: -0.011710465885698795
2023-07-25 17:14:10,292 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 46084.66015625, ACC: -0.01437468733638525
2023-07-25 17:14:20,768 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 46084.421875, ACC: -0.012990566901862621
2023-07-25 17:14:20,884 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-U500_30-timesteps_vis.h5
2023-07-25 17:15:14,534 - root - INFO - ------------------ Configuration ------------------
2023-07-25 17:15:14,534 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 17:15:14,534 - root - INFO - Configuration name: afno_backbone
2023-07-25 17:15:14,534 - root - INFO - log_to_wandb True
2023-07-25 17:15:14,534 - root - INFO - lr 0.0005
2023-07-25 17:15:14,534 - root - INFO - batch_size 64
2023-07-25 17:15:14,534 - root - INFO - max_epochs 150
2023-07-25 17:15:14,534 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 17:15:14,534 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 17:15:14,534 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 17:15:14,534 - root - INFO - orography False
2023-07-25 17:15:14,534 - root - INFO - orography_path None
2023-07-25 17:15:14,535 - root - INFO - exp_dir FourCastNet/results
2023-07-25 17:15:14,535 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 17:15:14,535 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 17:15:14,535 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 17:15:14,535 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 17:15:14,535 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 17:15:14,535 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 17:15:14,535 - root - INFO - loss l2
2023-07-25 17:15:14,535 - root - INFO - num_data_workers 4
2023-07-25 17:15:14,535 - root - INFO - dt 1
2023-07-25 17:15:14,535 - root - INFO - n_history 0
2023-07-25 17:15:14,535 - root - INFO - prediction_type iterative
2023-07-25 17:15:14,535 - root - INFO - prediction_length 30
2023-07-25 17:15:14,535 - root - INFO - n_initial_conditions 5
2023-07-25 17:15:14,535 - root - INFO - ics_type default
2023-07-25 17:15:14,535 - root - INFO - save_raw_forecasts True
2023-07-25 17:15:14,535 - root - INFO - save_channel False
2023-07-25 17:15:14,535 - root - INFO - masked_acc False
2023-07-25 17:15:14,535 - root - INFO - maskpath None
2023-07-25 17:15:14,535 - root - INFO - perturb False
2023-07-25 17:15:14,535 - root - INFO - add_grid False
2023-07-25 17:15:14,535 - root - INFO - N_grid_channels 0
2023-07-25 17:15:14,535 - root - INFO - gridtype sinusoidal
2023-07-25 17:15:14,535 - root - INFO - roll False
2023-07-25 17:15:14,536 - root - INFO - num_blocks 8
2023-07-25 17:15:14,536 - root - INFO - nettype afno
2023-07-25 17:15:14,536 - root - INFO - patch_size 8
2023-07-25 17:15:14,536 - root - INFO - width 56
2023-07-25 17:15:14,536 - root - INFO - modes 32
2023-07-25 17:15:14,536 - root - INFO - target mslp
2023-07-25 17:15:14,536 - root - INFO - normalization zscore
2023-07-25 17:15:14,536 - root - INFO - log_to_screen True
2023-07-25 17:15:14,536 - root - INFO - save_checkpoint True
2023-07-25 17:15:14,536 - root - INFO - enable_nhwc False
2023-07-25 17:15:14,536 - root - INFO - optimizer_type FusedAdam
2023-07-25 17:15:14,536 - root - INFO - crop_size_x None
2023-07-25 17:15:14,536 - root - INFO - crop_size_y None
2023-07-25 17:15:14,536 - root - INFO - two_step_training False
2023-07-25 17:15:14,536 - root - INFO - plot_animations False
2023-07-25 17:15:14,536 - root - INFO - add_noise False
2023-07-25 17:15:14,536 - root - INFO - noise_std 0
2023-07-25 17:15:14,537 - root - INFO - world_size 1
2023-07-25 17:15:14,537 - root - INFO - interp 0
2023-07-25 17:15:14,537 - root - INFO - use_daily_climatology False
2023-07-25 17:15:14,537 - root - INFO - global_batch_size 64
2023-07-25 17:15:14,537 - root - INFO - ablate V500
2023-07-25 17:15:14,537 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 17:15:14,537 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 17:15:14,537 - root - INFO - resuming False
2023-07-25 17:15:14,537 - root - INFO - local_rank 0
2023-07-25 17:15:14,537 - root - INFO - ---------------------------------------------------
2023-07-25 17:15:14,537 - root - INFO - Inference for 1 initial conditions
2023-07-25 17:15:14,829 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 17:15:14,829 - root - INFO - Number of samples per year: 1460
2023-07-25 17:15:14,830 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 17:15:14,830 - root - INFO - Delta t: 6 hours
2023-07-25 17:15:14,830 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 17:15:14,830 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 17:16:26,596 - root - INFO - Loading inference data
2023-07-25 17:16:26,597 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 17:16:26,877 - root - INFO - Initial condition 1 of 1
2023-07-25 17:16:27,652 - root - INFO - Extracting valid data from the first year
2023-07-25 17:18:57,774 - root - INFO - Standardizing data
2023-07-25 17:19:06,010 - root - INFO - Loading time means
2023-07-25 17:19:22,494 - root - INFO - Begin autoregressive inference
2023-07-25 17:19:32,678 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 17:19:43,394 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 8525.728515625, ACC: 0.12636733055114746
2023-07-25 17:19:53,989 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 20113.537109375, ACC: -0.01983879692852497
2023-07-25 17:20:05,037 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 28751.939453125, ACC: -0.047938134521245956
2023-07-25 17:20:16,209 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 35292.5234375, ACC: -0.05412159860134125
2023-07-25 17:20:26,518 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 39497.5, ACC: -0.045757733285427094
2023-07-25 17:20:37,360 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 41945.26953125, ACC: -0.02924926020205021
2023-07-25 17:20:47,566 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 43385.14453125, ACC: -0.02634427882730961
2023-07-25 17:20:58,371 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 44264.13671875, ACC: -0.027291689068078995
2023-07-25 17:21:08,858 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 44821.34765625, ACC: -0.023202495649456978
2023-07-25 17:21:19,331 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 45191.796875, ACC: -0.015235676430165768
2023-07-25 17:21:29,682 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 45444.671875, ACC: -0.014740523882210255
2023-07-25 17:21:40,330 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 45634.796875, ACC: -0.01790214702486992
2023-07-25 17:21:51,779 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 45784.52734375, ACC: -0.016215631738305092
2023-07-25 17:22:03,184 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 45888.18359375, ACC: -0.012096180580556393
2023-07-25 17:22:14,712 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 45958.34765625, ACC: -0.013283167965710163
2023-07-25 17:22:25,289 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 46003.4609375, ACC: -0.016274580731987953
2023-07-25 17:22:35,688 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 46028.296875, ACC: -0.014271528460085392
2023-07-25 17:22:45,820 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 46040.9375, ACC: -0.00911757256835699
2023-07-25 17:22:56,675 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 46053.54296875, ACC: -0.01080258283764124
2023-07-25 17:23:08,145 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 46064.3984375, ACC: -0.015106298960745335
2023-07-25 17:23:18,326 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 46068.48828125, ACC: -0.013517075218260288
2023-07-25 17:23:28,863 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 46068.66796875, ACC: -0.008892432786524296
2023-07-25 17:23:39,610 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 46073.859375, ACC: -0.011609493754804134
2023-07-25 17:23:49,804 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 46079.34375, ACC: -0.01596594974398613
2023-07-25 17:24:01,409 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 46080.34375, ACC: -0.014397083781659603
2023-07-25 17:24:12,022 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 46077.921875, ACC: -0.009381801821291447
2023-07-25 17:24:23,068 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 46081.26953125, ACC: -0.011723979376256466
2023-07-25 17:24:33,155 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 46084.75, ACC: -0.014384345151484013
2023-07-25 17:24:43,742 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 46084.48046875, ACC: -0.012997233308851719
2023-07-25 17:24:43,827 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-V500_30-timesteps_vis.h5
2023-07-25 17:25:36,867 - root - INFO - ------------------ Configuration ------------------
2023-07-25 17:25:36,867 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 17:25:36,867 - root - INFO - Configuration name: afno_backbone
2023-07-25 17:25:36,868 - root - INFO - log_to_wandb True
2023-07-25 17:25:36,868 - root - INFO - lr 0.0005
2023-07-25 17:25:36,868 - root - INFO - batch_size 64
2023-07-25 17:25:36,868 - root - INFO - max_epochs 150
2023-07-25 17:25:36,869 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 17:25:36,869 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 17:25:36,869 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 17:25:36,871 - root - INFO - orography False
2023-07-25 17:25:36,871 - root - INFO - orography_path None
2023-07-25 17:25:36,871 - root - INFO - exp_dir FourCastNet/results
2023-07-25 17:25:36,872 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 17:25:36,872 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 17:25:36,872 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 17:25:36,872 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 17:25:36,872 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 17:25:36,872 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 17:25:36,872 - root - INFO - loss l2
2023-07-25 17:25:36,872 - root - INFO - num_data_workers 4
2023-07-25 17:25:36,872 - root - INFO - dt 1
2023-07-25 17:25:36,872 - root - INFO - n_history 0
2023-07-25 17:25:36,872 - root - INFO - prediction_type iterative
2023-07-25 17:25:36,872 - root - INFO - prediction_length 30
2023-07-25 17:25:36,872 - root - INFO - n_initial_conditions 5
2023-07-25 17:25:36,872 - root - INFO - ics_type default
2023-07-25 17:25:36,872 - root - INFO - save_raw_forecasts True
2023-07-25 17:25:36,872 - root - INFO - save_channel False
2023-07-25 17:25:36,872 - root - INFO - masked_acc False
2023-07-25 17:25:36,872 - root - INFO - maskpath None
2023-07-25 17:25:36,872 - root - INFO - perturb False
2023-07-25 17:25:36,872 - root - INFO - add_grid False
2023-07-25 17:25:36,872 - root - INFO - N_grid_channels 0
2023-07-25 17:25:36,872 - root - INFO - gridtype sinusoidal
2023-07-25 17:25:36,872 - root - INFO - roll False
2023-07-25 17:25:36,872 - root - INFO - num_blocks 8
2023-07-25 17:25:36,872 - root - INFO - nettype afno
2023-07-25 17:25:36,872 - root - INFO - patch_size 8
2023-07-25 17:25:36,872 - root - INFO - width 56
2023-07-25 17:25:36,872 - root - INFO - modes 32
2023-07-25 17:25:36,872 - root - INFO - target mslp
2023-07-25 17:25:36,873 - root - INFO - normalization zscore
2023-07-25 17:25:36,873 - root - INFO - log_to_screen True
2023-07-25 17:25:36,873 - root - INFO - save_checkpoint True
2023-07-25 17:25:36,873 - root - INFO - enable_nhwc False
2023-07-25 17:25:36,873 - root - INFO - optimizer_type FusedAdam
2023-07-25 17:25:36,873 - root - INFO - crop_size_x None
2023-07-25 17:25:36,873 - root - INFO - crop_size_y None
2023-07-25 17:25:36,873 - root - INFO - two_step_training False
2023-07-25 17:25:36,873 - root - INFO - plot_animations False
2023-07-25 17:25:36,874 - root - INFO - add_noise False
2023-07-25 17:25:36,875 - root - INFO - noise_std 0
2023-07-25 17:25:36,875 - root - INFO - world_size 1
2023-07-25 17:25:36,875 - root - INFO - interp 0
2023-07-25 17:25:36,875 - root - INFO - use_daily_climatology False
2023-07-25 17:25:36,875 - root - INFO - global_batch_size 64
2023-07-25 17:25:36,875 - root - INFO - ablate Z500
2023-07-25 17:25:36,875 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 17:25:36,875 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 17:25:36,875 - root - INFO - resuming False
2023-07-25 17:25:36,875 - root - INFO - local_rank 0
2023-07-25 17:25:36,875 - root - INFO - ---------------------------------------------------
2023-07-25 17:25:36,875 - root - INFO - Inference for 1 initial conditions
2023-07-25 17:25:37,168 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 17:25:37,169 - root - INFO - Number of samples per year: 1460
2023-07-25 17:25:37,169 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 17:25:37,169 - root - INFO - Delta t: 6 hours
2023-07-25 17:25:37,169 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 17:25:37,169 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 17:26:51,063 - root - INFO - Loading inference data
2023-07-25 17:26:51,064 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 17:26:51,285 - root - INFO - Initial condition 1 of 1
2023-07-25 17:26:52,115 - root - INFO - Extracting valid data from the first year
2023-07-25 17:29:20,290 - root - INFO - Standardizing data
2023-07-25 17:29:28,223 - root - INFO - Loading time means
2023-07-25 17:29:45,130 - root - INFO - Begin autoregressive inference
2023-07-25 17:29:55,970 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 17:30:08,682 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 44.897193908691406, ACC: 0.9987114071846008
2023-07-25 17:30:22,447 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 68.86515808105469, ACC: 0.9969525933265686
2023-07-25 17:30:34,566 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 87.90202331542969, ACC: 0.9950904846191406
2023-07-25 17:30:47,631 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 109.63909912109375, ACC: 0.9920700192451477
2023-07-25 17:31:00,442 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 120.47108459472656, ACC: 0.990497887134552
2023-07-25 17:31:13,937 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 146.69625854492188, ACC: 0.9858391284942627
2023-07-25 17:31:25,750 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 164.7177276611328, ACC: 0.9823083877563477
2023-07-25 17:31:37,610 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 191.52993774414062, ACC: 0.9754847884178162
2023-07-25 17:31:50,859 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 214.00289916992188, ACC: 0.9698989987373352
2023-07-25 17:32:02,543 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 238.46713256835938, ACC: 0.962571918964386
2023-07-25 17:32:14,654 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 253.32717895507812, ACC: 0.9579086303710938
2023-07-25 17:32:25,699 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 276.4618225097656, ACC: 0.9484366178512573
2023-07-25 17:32:37,442 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 299.4747619628906, ACC: 0.9391506314277649
2023-07-25 17:32:49,101 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 325.2367858886719, ACC: 0.9272379875183105
2023-07-25 17:33:00,890 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 349.8534851074219, ACC: 0.9158191680908203
2023-07-25 17:33:12,653 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 381.8330383300781, ACC: 0.8981057405471802
2023-07-25 17:33:24,544 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 412.609375, ACC: 0.8795905709266663
2023-07-25 17:33:36,169 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 442.3659362792969, ACC: 0.8573148846626282
2023-07-25 17:33:47,839 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 468.927001953125, ACC: 0.8338243365287781
2023-07-25 17:33:59,206 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 499.0815734863281, ACC: 0.8012362122535706
2023-07-25 17:34:10,588 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 532.4401245117188, ACC: 0.7675111293792725
2023-07-25 17:34:22,471 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 575.0394897460938, ACC: 0.7225520610809326
2023-07-25 17:34:34,085 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 623.70947265625, ACC: 0.6741204261779785
2023-07-25 17:34:45,395 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 678.03759765625, ACC: 0.6063414216041565
2023-07-25 17:34:57,652 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 731.8096313476562, ACC: 0.5516104698181152
2023-07-25 17:35:08,847 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 772.3937377929688, ACC: 0.504015326499939
2023-07-25 17:35:19,764 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 796.0994873046875, ACC: 0.4825538992881775
2023-07-25 17:35:31,500 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 816.3306884765625, ACC: 0.4652553200721741
2023-07-25 17:35:42,868 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 830.8890991210938, ACC: 0.4553554654121399
2023-07-25 17:35:42,962 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-Z500_30-timesteps_vis.h5
2023-07-25 17:36:36,596 - root - INFO - ------------------ Configuration ------------------
2023-07-25 17:36:36,596 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 17:36:36,596 - root - INFO - Configuration name: afno_backbone
2023-07-25 17:36:36,596 - root - INFO - log_to_wandb True
2023-07-25 17:36:36,596 - root - INFO - lr 0.0005
2023-07-25 17:36:36,596 - root - INFO - batch_size 64
2023-07-25 17:36:36,596 - root - INFO - max_epochs 150
2023-07-25 17:36:36,596 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 17:36:36,596 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 17:36:36,596 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 17:36:36,596 - root - INFO - orography False
2023-07-25 17:36:36,597 - root - INFO - orography_path None
2023-07-25 17:36:36,597 - root - INFO - exp_dir FourCastNet/results
2023-07-25 17:36:36,597 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 17:36:36,597 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 17:36:36,597 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 17:36:36,597 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 17:36:36,597 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 17:36:36,597 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 17:36:36,597 - root - INFO - loss l2
2023-07-25 17:36:36,597 - root - INFO - num_data_workers 4
2023-07-25 17:36:36,597 - root - INFO - dt 1
2023-07-25 17:36:36,597 - root - INFO - n_history 0
2023-07-25 17:36:36,597 - root - INFO - prediction_type iterative
2023-07-25 17:36:36,597 - root - INFO - prediction_length 30
2023-07-25 17:36:36,598 - root - INFO - n_initial_conditions 5
2023-07-25 17:36:36,598 - root - INFO - ics_type default
2023-07-25 17:36:36,598 - root - INFO - save_raw_forecasts True
2023-07-25 17:36:36,598 - root - INFO - save_channel False
2023-07-25 17:36:36,598 - root - INFO - masked_acc False
2023-07-25 17:36:36,598 - root - INFO - maskpath None
2023-07-25 17:36:36,598 - root - INFO - perturb False
2023-07-25 17:36:36,598 - root - INFO - add_grid False
2023-07-25 17:36:36,598 - root - INFO - N_grid_channels 0
2023-07-25 17:36:36,598 - root - INFO - gridtype sinusoidal
2023-07-25 17:36:36,598 - root - INFO - roll False
2023-07-25 17:36:36,598 - root - INFO - num_blocks 8
2023-07-25 17:36:36,598 - root - INFO - nettype afno
2023-07-25 17:36:36,598 - root - INFO - patch_size 8
2023-07-25 17:36:36,598 - root - INFO - width 56
2023-07-25 17:36:36,598 - root - INFO - modes 32
2023-07-25 17:36:36,598 - root - INFO - target mslp
2023-07-25 17:36:36,598 - root - INFO - normalization zscore
2023-07-25 17:36:36,599 - root - INFO - log_to_screen True
2023-07-25 17:36:36,599 - root - INFO - save_checkpoint True
2023-07-25 17:36:36,599 - root - INFO - enable_nhwc False
2023-07-25 17:36:36,599 - root - INFO - optimizer_type FusedAdam
2023-07-25 17:36:36,599 - root - INFO - crop_size_x None
2023-07-25 17:36:36,599 - root - INFO - crop_size_y None
2023-07-25 17:36:36,599 - root - INFO - two_step_training False
2023-07-25 17:36:36,599 - root - INFO - plot_animations False
2023-07-25 17:36:36,599 - root - INFO - add_noise False
2023-07-25 17:36:36,599 - root - INFO - noise_std 0
2023-07-25 17:36:36,600 - root - INFO - world_size 1
2023-07-25 17:36:36,600 - root - INFO - interp 0
2023-07-25 17:36:36,600 - root - INFO - use_daily_climatology False
2023-07-25 17:36:36,600 - root - INFO - global_batch_size 64
2023-07-25 17:36:36,600 - root - INFO - ablate RH500
2023-07-25 17:36:36,600 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 17:36:36,600 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 17:36:36,600 - root - INFO - resuming False
2023-07-25 17:36:36,600 - root - INFO - local_rank 0
2023-07-25 17:36:36,600 - root - INFO - ---------------------------------------------------
2023-07-25 17:36:36,600 - root - INFO - Inference for 1 initial conditions
2023-07-25 17:36:36,921 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 17:36:36,922 - root - INFO - Number of samples per year: 1460
2023-07-25 17:36:36,922 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 17:36:36,922 - root - INFO - Delta t: 6 hours
2023-07-25 17:36:36,922 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 17:36:36,923 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 17:37:47,927 - root - INFO - Loading inference data
2023-07-25 17:37:47,928 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 17:37:48,204 - root - INFO - Initial condition 1 of 1
2023-07-25 17:37:49,063 - root - INFO - Extracting valid data from the first year
2023-07-25 17:40:17,020 - root - INFO - Standardizing data
2023-07-25 17:40:24,971 - root - INFO - Loading time means
2023-07-25 17:40:39,985 - root - INFO - Begin autoregressive inference
2023-07-25 17:40:50,588 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 17:41:02,415 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 43.271507263183594, ACC: 0.998805582523346
2023-07-25 17:41:12,949 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 59.4638786315918, ACC: 0.997711718082428
2023-07-25 17:41:24,633 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 71.65140533447266, ACC: 0.9967083930969238
2023-07-25 17:41:35,661 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 88.59373474121094, ACC: 0.9947881698608398
2023-07-25 17:41:46,350 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 104.47785186767578, ACC: 0.9928422570228577
2023-07-25 17:41:57,643 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 120.96016693115234, ACC: 0.9903339743614197
2023-07-25 17:42:09,295 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 128.37725830078125, ACC: 0.9893959760665894
2023-07-25 17:42:19,883 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 144.61819458007812, ACC: 0.986293613910675
2023-07-25 17:42:31,455 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 164.2734375, ACC: 0.9826084971427917
2023-07-25 17:42:42,256 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 182.80252075195312, ACC: 0.9783744812011719
2023-07-25 17:42:53,285 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 198.93792724609375, ACC: 0.9745422601699829
2023-07-25 17:43:03,833 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 224.17486572265625, ACC: 0.9666372537612915
2023-07-25 17:43:14,971 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 255.34385681152344, ACC: 0.956363320350647
2023-07-25 17:43:26,187 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 286.0174560546875, ACC: 0.9444045424461365
2023-07-25 17:43:37,178 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 314.80615234375, ACC: 0.9328397512435913
2023-07-25 17:43:47,632 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 346.871337890625, ACC: 0.9171027541160583
2023-07-25 17:43:58,908 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 376.82568359375, ACC: 0.9006911516189575
2023-07-25 17:44:10,804 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 398.2730407714844, ACC: 0.8852569460868835
2023-07-25 17:44:22,260 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 414.02880859375, ACC: 0.8711034059524536
2023-07-25 17:44:33,829 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 431.755615234375, ACC: 0.850857138633728
2023-07-25 17:44:44,980 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 451.0662841796875, ACC: 0.8326146006584167
2023-07-25 17:44:57,068 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 475.3869323730469, ACC: 0.8093364238739014
2023-07-25 17:45:09,821 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 501.17120361328125, ACC: 0.7896667122840881
2023-07-25 17:45:22,001 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 528.6041870117188, ACC: 0.7623870372772217
2023-07-25 17:45:34,603 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 551.8182373046875, ACC: 0.7508927583694458
2023-07-25 17:45:47,575 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 571.58984375, ACC: 0.7395592331886292
2023-07-25 17:45:59,940 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 596.2321166992188, ACC: 0.727013349533081
2023-07-25 17:46:11,773 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 630.5916137695312, ACC: 0.703764021396637
2023-07-25 17:46:22,945 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 664.9521484375, ACC: 0.6771084666252136
2023-07-25 17:46:23,030 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-RH500_30-timesteps_vis.h5
2023-07-25 17:47:16,212 - root - INFO - ------------------ Configuration ------------------
2023-07-25 17:47:16,212 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 17:47:16,212 - root - INFO - Configuration name: afno_backbone
2023-07-25 17:47:16,212 - root - INFO - log_to_wandb True
2023-07-25 17:47:16,212 - root - INFO - lr 0.0005
2023-07-25 17:47:16,212 - root - INFO - batch_size 64
2023-07-25 17:47:16,212 - root - INFO - max_epochs 150
2023-07-25 17:47:16,212 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 17:47:16,212 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 17:47:16,212 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 17:47:16,212 - root - INFO - orography False
2023-07-25 17:47:16,212 - root - INFO - orography_path None
2023-07-25 17:47:16,213 - root - INFO - exp_dir FourCastNet/results
2023-07-25 17:47:16,213 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 17:47:16,213 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 17:47:16,213 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 17:47:16,213 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 17:47:16,213 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 17:47:16,213 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 17:47:16,213 - root - INFO - loss l2
2023-07-25 17:47:16,213 - root - INFO - num_data_workers 4
2023-07-25 17:47:16,213 - root - INFO - dt 1
2023-07-25 17:47:16,213 - root - INFO - n_history 0
2023-07-25 17:47:16,213 - root - INFO - prediction_type iterative
2023-07-25 17:47:16,213 - root - INFO - prediction_length 30
2023-07-25 17:47:16,213 - root - INFO - n_initial_conditions 5
2023-07-25 17:47:16,213 - root - INFO - ics_type default
2023-07-25 17:47:16,213 - root - INFO - save_raw_forecasts True
2023-07-25 17:47:16,213 - root - INFO - save_channel False
2023-07-25 17:47:16,213 - root - INFO - masked_acc False
2023-07-25 17:47:16,214 - root - INFO - maskpath None
2023-07-25 17:47:16,214 - root - INFO - perturb False
2023-07-25 17:47:16,214 - root - INFO - add_grid False
2023-07-25 17:47:16,214 - root - INFO - N_grid_channels 0
2023-07-25 17:47:16,214 - root - INFO - gridtype sinusoidal
2023-07-25 17:47:16,214 - root - INFO - roll False
2023-07-25 17:47:16,214 - root - INFO - num_blocks 8
2023-07-25 17:47:16,214 - root - INFO - nettype afno
2023-07-25 17:47:16,214 - root - INFO - patch_size 8
2023-07-25 17:47:16,214 - root - INFO - width 56
2023-07-25 17:47:16,214 - root - INFO - modes 32
2023-07-25 17:47:16,214 - root - INFO - target mslp
2023-07-25 17:47:16,214 - root - INFO - normalization zscore
2023-07-25 17:47:16,214 - root - INFO - log_to_screen True
2023-07-25 17:47:16,214 - root - INFO - save_checkpoint True
2023-07-25 17:47:16,214 - root - INFO - enable_nhwc False
2023-07-25 17:47:16,214 - root - INFO - optimizer_type FusedAdam
2023-07-25 17:47:16,215 - root - INFO - crop_size_x None
2023-07-25 17:47:16,215 - root - INFO - crop_size_y None
2023-07-25 17:47:16,215 - root - INFO - two_step_training False
2023-07-25 17:47:16,215 - root - INFO - plot_animations False
2023-07-25 17:47:16,215 - root - INFO - add_noise False
2023-07-25 17:47:16,215 - root - INFO - noise_std 0
2023-07-25 17:47:16,215 - root - INFO - world_size 1
2023-07-25 17:47:16,215 - root - INFO - interp 0
2023-07-25 17:47:16,215 - root - INFO - use_daily_climatology False
2023-07-25 17:47:16,215 - root - INFO - global_batch_size 64
2023-07-25 17:47:16,215 - root - INFO - ablate Z50
2023-07-25 17:47:16,215 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 17:47:16,215 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 17:47:16,215 - root - INFO - resuming False
2023-07-25 17:47:16,215 - root - INFO - local_rank 0
2023-07-25 17:47:16,215 - root - INFO - ---------------------------------------------------
2023-07-25 17:47:16,215 - root - INFO - Inference for 1 initial conditions
2023-07-25 17:47:16,534 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 17:47:16,535 - root - INFO - Number of samples per year: 1460
2023-07-25 17:47:16,535 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 17:47:16,535 - root - INFO - Delta t: 6 hours
2023-07-25 17:47:16,535 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 17:47:16,535 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 17:48:25,296 - root - INFO - Loading inference data
2023-07-25 17:48:25,297 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 17:48:25,588 - root - INFO - Initial condition 1 of 1
2023-07-25 17:48:26,385 - root - INFO - Extracting valid data from the first year
2023-07-25 17:50:53,972 - root - INFO - Standardizing data
2023-07-25 17:51:02,492 - root - INFO - Loading time means
2023-07-25 17:51:19,190 - root - INFO - Begin autoregressive inference
2023-07-25 17:51:30,854 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 17:51:41,789 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 48.013023376464844, ACC: 0.9985301494598389
2023-07-25 17:51:53,824 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 65.9550552368164, ACC: 0.9971785545349121
2023-07-25 17:52:06,431 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 74.54066467285156, ACC: 0.9964225888252258
2023-07-25 17:52:18,207 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 88.44752502441406, ACC: 0.9947690963745117
2023-07-25 17:52:30,542 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 96.28179931640625, ACC: 0.993871808052063
2023-07-25 17:52:41,307 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 115.80367279052734, ACC: 0.9910722374916077
2023-07-25 17:52:52,287 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 125.38660430908203, ACC: 0.9897812604904175
2023-07-25 17:53:03,322 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 143.62594604492188, ACC: 0.986335039138794
2023-07-25 17:53:14,071 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 162.32635498046875, ACC: 0.9829423427581787
2023-07-25 17:53:24,499 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 183.05877685546875, ACC: 0.9782565236091614
2023-07-25 17:53:35,554 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 192.6643829345703, ACC: 0.9760828614234924
2023-07-25 17:53:46,951 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 210.1841278076172, ACC: 0.9705857038497925
2023-07-25 17:53:58,287 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 234.2820587158203, ACC: 0.963201105594635
2023-07-25 17:54:09,105 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 262.6963806152344, ACC: 0.9530730247497559
2023-07-25 17:54:19,746 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 288.1953125, ACC: 0.9434453845024109
2023-07-25 17:54:29,866 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 317.8539733886719, ACC: 0.9300360083580017
2023-07-25 17:54:40,025 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 343.5309753417969, ACC: 0.9172123074531555
2023-07-25 17:54:51,573 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 366.2830505371094, ACC: 0.9027958512306213
2023-07-25 17:55:00,862 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 379.0562438964844, ACC: 0.8916344046592712
2023-07-25 17:55:11,615 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 398.7684631347656, ACC: 0.872308611869812
2023-07-25 17:55:22,328 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 420.8759765625, ACC: 0.8534688353538513
2023-07-25 17:55:32,811 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 451.5527648925781, ACC: 0.8260340094566345
2023-07-25 17:55:43,580 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 481.4082946777344, ACC: 0.8023074865341187
2023-07-25 17:55:54,308 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 517.7924194335938, ACC: 0.7662526965141296
2023-07-25 17:56:04,999 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 551.8271484375, ACC: 0.7445605993270874
2023-07-25 17:56:16,191 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 587.3162231445312, ACC: 0.7162173390388489
2023-07-25 17:56:28,637 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 623.9883422851562, ACC: 0.6913591027259827
2023-07-25 17:56:40,040 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 662.8150634765625, ACC: 0.6611589789390564
2023-07-25 17:56:50,544 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 692.7295532226562, ACC: 0.6399937272071838
2023-07-25 17:56:50,634 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-Z50_30-timesteps_vis.h5
2023-07-25 17:57:43,987 - root - INFO - ------------------ Configuration ------------------
2023-07-25 17:57:43,987 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 17:57:43,987 - root - INFO - Configuration name: afno_backbone
2023-07-25 17:57:43,987 - root - INFO - log_to_wandb True
2023-07-25 17:57:43,987 - root - INFO - lr 0.0005
2023-07-25 17:57:43,987 - root - INFO - batch_size 64
2023-07-25 17:57:43,987 - root - INFO - max_epochs 150
2023-07-25 17:57:43,987 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 17:57:43,987 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 17:57:43,987 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 17:57:43,988 - root - INFO - orography False
2023-07-25 17:57:43,988 - root - INFO - orography_path None
2023-07-25 17:57:43,988 - root - INFO - exp_dir FourCastNet/results
2023-07-25 17:57:43,988 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 17:57:43,988 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 17:57:43,988 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 17:57:43,988 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 17:57:43,988 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 17:57:43,988 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 17:57:43,988 - root - INFO - loss l2
2023-07-25 17:57:43,988 - root - INFO - num_data_workers 4
2023-07-25 17:57:43,988 - root - INFO - dt 1
2023-07-25 17:57:43,988 - root - INFO - n_history 0
2023-07-25 17:57:43,988 - root - INFO - prediction_type iterative
2023-07-25 17:57:43,988 - root - INFO - prediction_length 30
2023-07-25 17:57:43,988 - root - INFO - n_initial_conditions 5
2023-07-25 17:57:43,988 - root - INFO - ics_type default
2023-07-25 17:57:43,988 - root - INFO - save_raw_forecasts True
2023-07-25 17:57:43,988 - root - INFO - save_channel False
2023-07-25 17:57:43,989 - root - INFO - masked_acc False
2023-07-25 17:57:43,989 - root - INFO - maskpath None
2023-07-25 17:57:43,989 - root - INFO - perturb False
2023-07-25 17:57:43,989 - root - INFO - add_grid False
2023-07-25 17:57:43,989 - root - INFO - N_grid_channels 0
2023-07-25 17:57:43,989 - root - INFO - gridtype sinusoidal
2023-07-25 17:57:43,989 - root - INFO - roll False
2023-07-25 17:57:43,989 - root - INFO - num_blocks 8
2023-07-25 17:57:43,989 - root - INFO - nettype afno
2023-07-25 17:57:43,989 - root - INFO - patch_size 8
2023-07-25 17:57:43,989 - root - INFO - width 56
2023-07-25 17:57:43,989 - root - INFO - modes 32
2023-07-25 17:57:43,989 - root - INFO - target mslp
2023-07-25 17:57:43,989 - root - INFO - normalization zscore
2023-07-25 17:57:43,989 - root - INFO - log_to_screen True
2023-07-25 17:57:43,989 - root - INFO - save_checkpoint True
2023-07-25 17:57:43,989 - root - INFO - enable_nhwc False
2023-07-25 17:57:43,989 - root - INFO - optimizer_type FusedAdam
2023-07-25 17:57:43,989 - root - INFO - crop_size_x None
2023-07-25 17:57:43,989 - root - INFO - crop_size_y None
2023-07-25 17:57:43,989 - root - INFO - two_step_training False
2023-07-25 17:57:43,989 - root - INFO - plot_animations False
2023-07-25 17:57:43,990 - root - INFO - add_noise False
2023-07-25 17:57:43,990 - root - INFO - noise_std 0
2023-07-25 17:57:43,990 - root - INFO - world_size 1
2023-07-25 17:57:43,990 - root - INFO - interp 0
2023-07-25 17:57:43,990 - root - INFO - use_daily_climatology False
2023-07-25 17:57:43,990 - root - INFO - global_batch_size 64
2023-07-25 17:57:43,990 - root - INFO - ablate TCWV
2023-07-25 17:57:43,990 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 17:57:43,990 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 17:57:43,990 - root - INFO - resuming False
2023-07-25 17:57:43,990 - root - INFO - local_rank 0
2023-07-25 17:57:43,990 - root - INFO - ---------------------------------------------------
2023-07-25 17:57:43,990 - root - INFO - Inference for 1 initial conditions
2023-07-25 17:57:44,258 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 17:57:44,259 - root - INFO - Number of samples per year: 1460
2023-07-25 17:57:44,259 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 17:57:44,259 - root - INFO - Delta t: 6 hours
2023-07-25 17:57:44,259 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 17:57:44,259 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 17:58:58,789 - root - INFO - Loading inference data
2023-07-25 17:58:58,789 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 17:58:59,015 - root - INFO - Initial condition 1 of 1
2023-07-25 17:58:59,768 - root - INFO - Extracting valid data from the first year
2023-07-25 18:01:38,417 - root - INFO - Standardizing data
2023-07-25 18:01:46,821 - root - INFO - Loading time means
2023-07-25 18:02:03,870 - root - INFO - Begin autoregressive inference
2023-07-25 18:02:15,704 - root - INFO - Predicted timestep 0 of 30. mslp RMS Error: 0.0, ACC: 1.0
2023-07-25 18:02:26,932 - root - INFO - Predicted timestep 1 of 30. mslp RMS Error: 244.41650390625, ACC: 0.9612486958503723
2023-07-25 18:02:38,921 - root - INFO - Predicted timestep 2 of 30. mslp RMS Error: 534.7005004882812, ACC: 0.8222531080245972
2023-07-25 18:02:49,572 - root - INFO - Predicted timestep 3 of 30. mslp RMS Error: 1812.382080078125, ACC: 0.3574103116989136
2023-07-25 18:03:01,042 - root - INFO - Predicted timestep 4 of 30. mslp RMS Error: 2606.588134765625, ACC: 0.2181263267993927
2023-07-25 18:03:12,296 - root - INFO - Predicted timestep 5 of 30. mslp RMS Error: 3087.377685546875, ACC: 0.17361153662204742
2023-07-25 18:03:23,562 - root - INFO - Predicted timestep 6 of 30. mslp RMS Error: 3431.773193359375, ACC: 0.1388157308101654
2023-07-25 18:03:34,805 - root - INFO - Predicted timestep 7 of 30. mslp RMS Error: 3718.017578125, ACC: 0.12038808315992355
2023-07-25 18:03:45,959 - root - INFO - Predicted timestep 8 of 30. mslp RMS Error: 3983.657958984375, ACC: 0.09614730626344681
2023-07-25 18:03:57,620 - root - INFO - Predicted timestep 9 of 30. mslp RMS Error: 4276.89111328125, ACC: 0.09140890091657639
2023-07-25 18:04:08,902 - root - INFO - Predicted timestep 10 of 30. mslp RMS Error: 4605.0830078125, ACC: 0.07768217474222183
2023-07-25 18:04:19,839 - root - INFO - Predicted timestep 11 of 30. mslp RMS Error: 4950.51806640625, ACC: 0.07604137808084488
2023-07-25 18:04:31,653 - root - INFO - Predicted timestep 12 of 30. mslp RMS Error: 5285.52734375, ACC: 0.06817246228456497
2023-07-25 18:04:42,117 - root - INFO - Predicted timestep 13 of 30. mslp RMS Error: 5619.21826171875, ACC: 0.061528731137514114
2023-07-25 18:04:54,716 - root - INFO - Predicted timestep 14 of 30. mslp RMS Error: 5985.28173828125, ACC: 0.04532391205430031
2023-07-25 18:05:07,054 - root - INFO - Predicted timestep 15 of 30. mslp RMS Error: 6368.1826171875, ACC: 0.025369681417942047
2023-07-25 18:05:17,822 - root - INFO - Predicted timestep 16 of 30. mslp RMS Error: 6791.259765625, ACC: -0.003804206382483244
2023-07-25 18:05:29,714 - root - INFO - Predicted timestep 17 of 30. mslp RMS Error: 7235.798828125, ACC: -0.016171803697943687
2023-07-25 18:05:40,569 - root - INFO - Predicted timestep 18 of 30. mslp RMS Error: 7703.73828125, ACC: -0.03393051400780678
2023-07-25 18:05:51,028 - root - INFO - Predicted timestep 19 of 30. mslp RMS Error: 8218.859375, ACC: -0.04313431680202484
2023-07-25 18:06:02,467 - root - INFO - Predicted timestep 20 of 30. mslp RMS Error: 8769.5751953125, ACC: -0.0494605116546154
2023-07-25 18:06:15,122 - root - INFO - Predicted timestep 21 of 30. mslp RMS Error: 9440.3583984375, ACC: -0.031001009047031403
2023-07-25 18:06:27,096 - root - INFO - Predicted timestep 22 of 30. mslp RMS Error: 10441.37109375, ACC: -0.023203831166028976
2023-07-25 18:06:39,300 - root - INFO - Predicted timestep 23 of 30. mslp RMS Error: 12344.146484375, ACC: -0.010529926046729088
2023-07-25 18:06:52,604 - root - INFO - Predicted timestep 24 of 30. mslp RMS Error: 16136.89453125, ACC: -0.013202453032135963
2023-07-25 18:07:05,186 - root - INFO - Predicted timestep 25 of 30. mslp RMS Error: 21496.0, ACC: -0.009654858149588108
2023-07-25 18:07:17,088 - root - INFO - Predicted timestep 26 of 30. mslp RMS Error: 27555.724609375, ACC: -0.008886393159627914
2023-07-25 18:07:28,742 - root - INFO - Predicted timestep 27 of 30. mslp RMS Error: 33083.25, ACC: -0.010281103663146496
2023-07-25 18:07:39,706 - root - INFO - Predicted timestep 28 of 30. mslp RMS Error: 37336.71484375, ACC: -0.013983656652271748
2023-07-25 18:07:51,797 - root - INFO - Predicted timestep 29 of 30. mslp RMS Error: 40328.43359375, ACC: -0.011902440339326859
2023-07-25 18:07:51,891 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-mslp_ablate-TCWV_30-timesteps_vis.h5
2023-07-25 18:08:44,986 - root - INFO - ------------------ Configuration ------------------
2023-07-25 18:08:44,986 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 18:08:44,986 - root - INFO - Configuration name: afno_backbone
2023-07-25 18:08:44,986 - root - INFO - log_to_wandb True
2023-07-25 18:08:44,986 - root - INFO - lr 0.0005
2023-07-25 18:08:44,987 - root - INFO - batch_size 64
2023-07-25 18:08:44,987 - root - INFO - max_epochs 150
2023-07-25 18:08:44,987 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 18:08:44,987 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 18:08:44,987 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 18:08:44,987 - root - INFO - orography False
2023-07-25 18:08:44,987 - root - INFO - orography_path None
2023-07-25 18:08:44,987 - root - INFO - exp_dir FourCastNet/results
2023-07-25 18:08:44,987 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 18:08:44,987 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 18:08:44,987 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 18:08:44,987 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 18:08:44,987 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 18:08:44,987 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 18:08:44,987 - root - INFO - loss l2
2023-07-25 18:08:44,988 - root - INFO - num_data_workers 4
2023-07-25 18:08:44,988 - root - INFO - dt 1
2023-07-25 18:08:44,988 - root - INFO - n_history 0
2023-07-25 18:08:44,988 - root - INFO - prediction_type iterative
2023-07-25 18:08:44,988 - root - INFO - prediction_length 30
2023-07-25 18:08:44,988 - root - INFO - n_initial_conditions 5
2023-07-25 18:08:44,988 - root - INFO - ics_type default
2023-07-25 18:08:44,988 - root - INFO - save_raw_forecasts True
2023-07-25 18:08:44,988 - root - INFO - save_channel False
2023-07-25 18:08:44,988 - root - INFO - masked_acc False
2023-07-25 18:08:44,988 - root - INFO - maskpath None
2023-07-25 18:08:44,988 - root - INFO - perturb False
2023-07-25 18:08:44,988 - root - INFO - add_grid False
2023-07-25 18:08:44,988 - root - INFO - N_grid_channels 0
2023-07-25 18:08:44,988 - root - INFO - gridtype sinusoidal
2023-07-25 18:08:44,988 - root - INFO - roll False
2023-07-25 18:08:44,989 - root - INFO - num_blocks 8
2023-07-25 18:08:44,989 - root - INFO - nettype afno
2023-07-25 18:08:44,989 - root - INFO - patch_size 8
2023-07-25 18:08:44,989 - root - INFO - width 56
2023-07-25 18:08:44,989 - root - INFO - modes 32
2023-07-25 18:08:44,989 - root - INFO - target Z1000
2023-07-25 18:08:44,989 - root - INFO - normalization zscore
2023-07-25 18:08:44,989 - root - INFO - log_to_screen True
2023-07-25 18:08:44,989 - root - INFO - save_checkpoint True
2023-07-25 18:08:44,989 - root - INFO - enable_nhwc False
2023-07-25 18:08:44,989 - root - INFO - optimizer_type FusedAdam
2023-07-25 18:08:44,989 - root - INFO - crop_size_x None
2023-07-25 18:08:44,989 - root - INFO - crop_size_y None
2023-07-25 18:08:44,989 - root - INFO - two_step_training False
2023-07-25 18:08:44,989 - root - INFO - plot_animations False
2023-07-25 18:08:44,990 - root - INFO - add_noise False
2023-07-25 18:08:44,990 - root - INFO - noise_std 0
2023-07-25 18:08:44,990 - root - INFO - world_size 1
2023-07-25 18:08:44,990 - root - INFO - interp 0
2023-07-25 18:08:44,990 - root - INFO - use_daily_climatology False
2023-07-25 18:08:44,990 - root - INFO - global_batch_size 64
2023-07-25 18:08:44,990 - root - INFO - ablate U10
2023-07-25 18:08:44,990 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 18:08:44,990 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 18:08:44,990 - root - INFO - resuming False
2023-07-25 18:08:44,990 - root - INFO - local_rank 0
2023-07-25 18:08:44,990 - root - INFO - ---------------------------------------------------
2023-07-25 18:08:44,990 - root - INFO - Inference for 1 initial conditions
2023-07-25 18:08:45,287 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 18:08:45,288 - root - INFO - Number of samples per year: 1460
2023-07-25 18:08:45,288 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 18:08:45,288 - root - INFO - Delta t: 6 hours
2023-07-25 18:08:45,290 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 18:08:45,291 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 18:09:54,433 - root - INFO - Loading inference data
2023-07-25 18:09:54,435 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 18:09:54,664 - root - INFO - Initial condition 1 of 1
2023-07-25 18:09:55,491 - root - INFO - Extracting valid data from the first year
2023-07-25 18:12:18,434 - root - INFO - Standardizing data
2023-07-25 18:12:26,470 - root - INFO - Loading time means
2023-07-25 18:12:41,839 - root - INFO - Begin autoregressive inference
2023-07-25 18:12:52,449 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 18:13:03,171 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 1.7883884906768799, ACC: 0.9300619959831238
2023-07-25 18:13:13,819 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 2.0204644203186035, ACC: 0.9088515043258667
2023-07-25 18:13:23,904 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 5.393024921417236, ACC: 0.6033218502998352
2023-07-25 18:13:34,063 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 9.159651756286621, ACC: 0.3879501223564148
2023-07-25 18:13:44,175 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 11.458663940429688, ACC: 0.29315826296806335
2023-07-25 18:13:55,325 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 12.790693283081055, ACC: 0.24956341087818146
2023-07-25 18:14:06,298 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 13.958487510681152, ACC: 0.23309077322483063
2023-07-25 18:14:17,099 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 15.174677848815918, ACC: 0.21393601596355438
2023-07-25 18:14:27,833 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 16.215463638305664, ACC: 0.1836739033460617
2023-07-25 18:14:38,709 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 17.454944610595703, ACC: 0.16305352747440338
2023-07-25 18:14:49,372 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 18.83599090576172, ACC: 0.15661850571632385
2023-07-25 18:14:59,703 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 20.196441650390625, ACC: 0.14376959204673767
2023-07-25 18:15:11,375 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 21.598817825317383, ACC: 0.12343756854534149
2023-07-25 18:15:22,377 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 22.942920684814453, ACC: 0.11710461229085922
2023-07-25 18:15:34,086 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 24.340633392333984, ACC: 0.10837110877037048
2023-07-25 18:15:43,918 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 25.62046241760254, ACC: 0.09299179911613464
2023-07-25 18:15:54,900 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 27.07542610168457, ACC: 0.07854069769382477
2023-07-25 18:16:05,965 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 28.762813568115234, ACC: 0.06898792088031769
2023-07-25 18:16:17,564 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 30.639812469482422, ACC: 0.05257244035601616
2023-07-25 18:16:28,594 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 32.318931579589844, ACC: 0.0339999794960022
2023-07-25 18:16:39,941 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 34.0587043762207, ACC: 0.02547515742480755
2023-07-25 18:16:51,990 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 35.97310256958008, ACC: 0.010295063257217407
2023-07-25 18:17:03,638 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 37.954654693603516, ACC: -0.0017841884400695562
2023-07-25 18:17:14,129 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 40.01708221435547, ACC: -0.01934407651424408
2023-07-25 18:17:24,932 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 41.80675506591797, ACC: -0.01614684797823429
2023-07-25 18:17:37,239 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 44.17799758911133, ACC: -0.02202349528670311
2023-07-25 18:17:47,691 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 46.5513916015625, ACC: -0.020046858116984367
2023-07-25 18:17:58,639 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 48.79136276245117, ACC: -0.014467781409621239
2023-07-25 18:18:09,564 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 51.04399490356445, ACC: 0.0013791590463370085
2023-07-25 18:18:09,661 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-U10_30-timesteps_vis.h5
2023-07-25 18:19:02,711 - root - INFO - ------------------ Configuration ------------------
2023-07-25 18:19:02,711 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 18:19:02,711 - root - INFO - Configuration name: afno_backbone
2023-07-25 18:19:02,711 - root - INFO - log_to_wandb True
2023-07-25 18:19:02,711 - root - INFO - lr 0.0005
2023-07-25 18:19:02,711 - root - INFO - batch_size 64
2023-07-25 18:19:02,711 - root - INFO - max_epochs 150
2023-07-25 18:19:02,711 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 18:19:02,711 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 18:19:02,711 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 18:19:02,711 - root - INFO - orography False
2023-07-25 18:19:02,711 - root - INFO - orography_path None
2023-07-25 18:19:02,711 - root - INFO - exp_dir FourCastNet/results
2023-07-25 18:19:02,711 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 18:19:02,711 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 18:19:02,712 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 18:19:02,712 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 18:19:02,712 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 18:19:02,712 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 18:19:02,712 - root - INFO - loss l2
2023-07-25 18:19:02,712 - root - INFO - num_data_workers 4
2023-07-25 18:19:02,712 - root - INFO - dt 1
2023-07-25 18:19:02,712 - root - INFO - n_history 0
2023-07-25 18:19:02,712 - root - INFO - prediction_type iterative
2023-07-25 18:19:02,712 - root - INFO - prediction_length 30
2023-07-25 18:19:02,712 - root - INFO - n_initial_conditions 5
2023-07-25 18:19:02,712 - root - INFO - ics_type default
2023-07-25 18:19:02,712 - root - INFO - save_raw_forecasts True
2023-07-25 18:19:02,712 - root - INFO - save_channel False
2023-07-25 18:19:02,712 - root - INFO - masked_acc False
2023-07-25 18:19:02,712 - root - INFO - maskpath None
2023-07-25 18:19:02,712 - root - INFO - perturb False
2023-07-25 18:19:02,713 - root - INFO - add_grid False
2023-07-25 18:19:02,713 - root - INFO - N_grid_channels 0
2023-07-25 18:19:02,713 - root - INFO - gridtype sinusoidal
2023-07-25 18:19:02,713 - root - INFO - roll False
2023-07-25 18:19:02,713 - root - INFO - num_blocks 8
2023-07-25 18:19:02,713 - root - INFO - nettype afno
2023-07-25 18:19:02,713 - root - INFO - patch_size 8
2023-07-25 18:19:02,713 - root - INFO - width 56
2023-07-25 18:19:02,713 - root - INFO - modes 32
2023-07-25 18:19:02,713 - root - INFO - target Z1000
2023-07-25 18:19:02,713 - root - INFO - normalization zscore
2023-07-25 18:19:02,713 - root - INFO - log_to_screen True
2023-07-25 18:19:02,713 - root - INFO - save_checkpoint True
2023-07-25 18:19:02,713 - root - INFO - enable_nhwc False
2023-07-25 18:19:02,713 - root - INFO - optimizer_type FusedAdam
2023-07-25 18:19:02,713 - root - INFO - crop_size_x None
2023-07-25 18:19:02,713 - root - INFO - crop_size_y None
2023-07-25 18:19:02,713 - root - INFO - two_step_training False
2023-07-25 18:19:02,713 - root - INFO - plot_animations False
2023-07-25 18:19:02,713 - root - INFO - add_noise False
2023-07-25 18:19:02,713 - root - INFO - noise_std 0
2023-07-25 18:19:02,713 - root - INFO - world_size 1
2023-07-25 18:19:02,713 - root - INFO - interp 0
2023-07-25 18:19:02,714 - root - INFO - use_daily_climatology False
2023-07-25 18:19:02,714 - root - INFO - global_batch_size 64
2023-07-25 18:19:02,714 - root - INFO - ablate V10
2023-07-25 18:19:02,714 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 18:19:02,714 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 18:19:02,714 - root - INFO - resuming False
2023-07-25 18:19:02,714 - root - INFO - local_rank 0
2023-07-25 18:19:02,714 - root - INFO - ---------------------------------------------------
2023-07-25 18:19:02,714 - root - INFO - Inference for 1 initial conditions
2023-07-25 18:19:03,066 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 18:19:03,066 - root - INFO - Number of samples per year: 1460
2023-07-25 18:19:03,067 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 18:19:03,067 - root - INFO - Delta t: 6 hours
2023-07-25 18:19:03,067 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 18:19:03,067 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 18:20:13,991 - root - INFO - Loading inference data
2023-07-25 18:20:13,992 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 18:20:14,259 - root - INFO - Initial condition 1 of 1
2023-07-25 18:20:15,096 - root - INFO - Extracting valid data from the first year
2023-07-25 18:22:38,281 - root - INFO - Standardizing data
2023-07-25 18:22:47,076 - root - INFO - Loading time means
2023-07-25 18:23:06,204 - root - INFO - Begin autoregressive inference
2023-07-25 18:23:17,525 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 18:23:28,644 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 1.0368468761444092, ACC: 0.9757887125015259
2023-07-25 18:23:39,970 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 1.1519627571105957, ACC: 0.9698578715324402
2023-07-25 18:23:51,819 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 1.196154236793518, ACC: 0.9673119187355042
2023-07-25 18:24:03,227 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 1.3398139476776123, ACC: 0.9586561918258667
2023-07-25 18:24:15,587 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 1.4118200540542603, ACC: 0.9527896642684937
2023-07-25 18:24:27,011 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 1.5451552867889404, ACC: 0.9433535933494568
2023-07-25 18:24:37,657 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 1.647270917892456, ACC: 0.9352416396141052
2023-07-25 18:24:48,635 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 1.7870311737060547, ACC: 0.926167905330658
2023-07-25 18:25:00,182 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 1.8764965534210205, ACC: 0.9195715188980103
2023-07-25 18:25:12,164 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 1.9717084169387817, ACC: 0.9161100387573242
2023-07-25 18:25:24,134 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 2.0874881744384766, ACC: 0.9081639051437378
2023-07-25 18:25:34,736 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 2.2792716026306152, ACC: 0.8906070590019226
2023-07-25 18:25:45,864 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 2.4555511474609375, ACC: 0.8753311038017273
2023-07-25 18:25:57,535 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 2.5626916885375977, ACC: 0.8647933602333069
2023-07-25 18:26:08,992 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 2.6938610076904297, ACC: 0.84770268201828
2023-07-25 18:26:20,176 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 2.8652031421661377, ACC: 0.8250767588615417
2023-07-25 18:26:30,508 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 2.9710257053375244, ACC: 0.8085057139396667
2023-07-25 18:26:41,717 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 3.092182159423828, ACC: 0.7849354147911072
2023-07-25 18:26:53,482 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 3.230617046356201, ACC: 0.7682424783706665
2023-07-25 18:27:05,753 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 3.3286190032958984, ACC: 0.7519434094429016
2023-07-25 18:27:16,269 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 3.4029600620269775, ACC: 0.7421559691429138
2023-07-25 18:27:25,906 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 3.5757744312286377, ACC: 0.716829240322113
2023-07-25 18:27:36,637 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 3.8411455154418945, ACC: 0.6740320920944214
2023-07-25 18:27:47,595 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 4.060546875, ACC: 0.636713981628418
2023-07-25 18:27:59,040 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 4.222417831420898, ACC: 0.6119595170021057
2023-07-25 18:28:09,551 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 4.369938373565674, ACC: 0.5931684374809265
2023-07-25 18:28:20,228 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 4.541378974914551, ACC: 0.5624837279319763
2023-07-25 18:28:31,432 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 4.7346415519714355, ACC: 0.5072441697120667
2023-07-25 18:28:41,877 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 4.907958984375, ACC: 0.46254682540893555
2023-07-25 18:28:41,961 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-V10_30-timesteps_vis.h5
2023-07-25 18:29:35,046 - root - INFO - ------------------ Configuration ------------------
2023-07-25 18:29:35,046 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 18:29:35,046 - root - INFO - Configuration name: afno_backbone
2023-07-25 18:29:35,046 - root - INFO - log_to_wandb True
2023-07-25 18:29:35,046 - root - INFO - lr 0.0005
2023-07-25 18:29:35,046 - root - INFO - batch_size 64
2023-07-25 18:29:35,046 - root - INFO - max_epochs 150
2023-07-25 18:29:35,046 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 18:29:35,046 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 18:29:35,047 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 18:29:35,047 - root - INFO - orography False
2023-07-25 18:29:35,047 - root - INFO - orography_path None
2023-07-25 18:29:35,047 - root - INFO - exp_dir FourCastNet/results
2023-07-25 18:29:35,047 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 18:29:35,047 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 18:29:35,047 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 18:29:35,047 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 18:29:35,047 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 18:29:35,047 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 18:29:35,047 - root - INFO - loss l2
2023-07-25 18:29:35,047 - root - INFO - num_data_workers 4
2023-07-25 18:29:35,047 - root - INFO - dt 1
2023-07-25 18:29:35,047 - root - INFO - n_history 0
2023-07-25 18:29:35,047 - root - INFO - prediction_type iterative
2023-07-25 18:29:35,047 - root - INFO - prediction_length 30
2023-07-25 18:29:35,047 - root - INFO - n_initial_conditions 5
2023-07-25 18:29:35,047 - root - INFO - ics_type default
2023-07-25 18:29:35,047 - root - INFO - save_raw_forecasts True
2023-07-25 18:29:35,047 - root - INFO - save_channel False
2023-07-25 18:29:35,047 - root - INFO - masked_acc False
2023-07-25 18:29:35,047 - root - INFO - maskpath None
2023-07-25 18:29:35,048 - root - INFO - perturb False
2023-07-25 18:29:35,048 - root - INFO - add_grid False
2023-07-25 18:29:35,048 - root - INFO - N_grid_channels 0
2023-07-25 18:29:35,048 - root - INFO - gridtype sinusoidal
2023-07-25 18:29:35,048 - root - INFO - roll False
2023-07-25 18:29:35,048 - root - INFO - num_blocks 8
2023-07-25 18:29:35,048 - root - INFO - nettype afno
2023-07-25 18:29:35,048 - root - INFO - patch_size 8
2023-07-25 18:29:35,048 - root - INFO - width 56
2023-07-25 18:29:35,048 - root - INFO - modes 32
2023-07-25 18:29:35,048 - root - INFO - target Z1000
2023-07-25 18:29:35,048 - root - INFO - normalization zscore
2023-07-25 18:29:35,048 - root - INFO - log_to_screen True
2023-07-25 18:29:35,048 - root - INFO - save_checkpoint True
2023-07-25 18:29:35,048 - root - INFO - enable_nhwc False
2023-07-25 18:29:35,048 - root - INFO - optimizer_type FusedAdam
2023-07-25 18:29:35,048 - root - INFO - crop_size_x None
2023-07-25 18:29:35,048 - root - INFO - crop_size_y None
2023-07-25 18:29:35,049 - root - INFO - two_step_training False
2023-07-25 18:29:35,049 - root - INFO - plot_animations False
2023-07-25 18:29:35,049 - root - INFO - add_noise False
2023-07-25 18:29:35,049 - root - INFO - noise_std 0
2023-07-25 18:29:35,049 - root - INFO - world_size 1
2023-07-25 18:29:35,049 - root - INFO - interp 0
2023-07-25 18:29:35,049 - root - INFO - use_daily_climatology False
2023-07-25 18:29:35,049 - root - INFO - global_batch_size 64
2023-07-25 18:29:35,049 - root - INFO - ablate T2m
2023-07-25 18:29:35,049 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 18:29:35,049 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 18:29:35,049 - root - INFO - resuming False
2023-07-25 18:29:35,049 - root - INFO - local_rank 0
2023-07-25 18:29:35,049 - root - INFO - ---------------------------------------------------
2023-07-25 18:29:35,050 - root - INFO - Inference for 1 initial conditions
2023-07-25 18:29:35,388 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 18:29:35,389 - root - INFO - Number of samples per year: 1460
2023-07-25 18:29:35,389 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 18:29:35,389 - root - INFO - Delta t: 6 hours
2023-07-25 18:29:35,389 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 18:29:35,390 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 18:30:53,960 - root - INFO - Loading inference data
2023-07-25 18:30:53,963 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 18:30:54,266 - root - INFO - Initial condition 1 of 1
2023-07-25 18:30:55,066 - root - INFO - Extracting valid data from the first year
2023-07-25 18:33:34,154 - root - INFO - Standardizing data
2023-07-25 18:33:42,290 - root - INFO - Loading time means
2023-07-25 18:34:00,161 - root - INFO - Begin autoregressive inference
2023-07-25 18:34:12,324 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 18:34:25,169 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 15.157735824584961, ACC: 0.22159992158412933
2023-07-25 18:34:36,520 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 82.66352844238281, ACC: 0.08469872176647186
2023-07-25 18:34:47,997 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 177.1539764404297, ACC: 0.12772631645202637
2023-07-25 18:34:59,400 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 224.58349609375, ACC: 0.12652061879634857
2023-07-25 18:35:10,744 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 236.8090057373047, ACC: 0.11755550652742386
2023-07-25 18:35:22,265 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 241.38848876953125, ACC: 0.09387767314910889
2023-07-25 18:35:33,313 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 250.51571655273438, ACC: 0.0662190318107605
2023-07-25 18:35:44,159 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 261.78216552734375, ACC: 0.0508614182472229
2023-07-25 18:35:55,170 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 270.9785461425781, ACC: 0.03769136592745781
2023-07-25 18:36:08,195 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 277.19091796875, ACC: 0.030084066092967987
2023-07-25 18:36:19,446 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 281.1748046875, ACC: 0.024424336850643158
2023-07-25 18:36:30,686 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 283.66729736328125, ACC: 0.022366011515259743
2023-07-25 18:36:41,313 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 285.1956787109375, ACC: 0.020371442660689354
2023-07-25 18:36:52,831 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 286.1116638183594, ACC: 0.01818263716995716
2023-07-25 18:37:05,158 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 286.6434326171875, ACC: 0.017065420746803284
2023-07-25 18:37:16,813 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 286.9402160644531, ACC: 0.01763021945953369
2023-07-25 18:37:27,839 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 287.1086730957031, ACC: 0.0174870602786541
2023-07-25 18:37:38,366 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 287.2033386230469, ACC: 0.017031453549861908
2023-07-25 18:37:48,340 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 287.2504577636719, ACC: 0.01760026440024376
2023-07-25 18:37:58,906 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 287.2841796875, ACC: 0.016137026250362396
2023-07-25 18:38:09,032 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 287.2907409667969, ACC: 0.017610620707273483
2023-07-25 18:38:20,150 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 287.3062438964844, ACC: 0.01585392653942108
2023-07-25 18:38:31,597 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 287.3070068359375, ACC: 0.016365204006433487
2023-07-25 18:38:42,312 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 287.3128967285156, ACC: 0.015466427430510521
2023-07-25 18:38:53,002 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 287.3057861328125, ACC: 0.016995461657643318
2023-07-25 18:39:03,713 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 287.3121032714844, ACC: 0.015795543789863586
2023-07-25 18:39:15,796 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 287.31036376953125, ACC: 0.016125468537211418
2023-07-25 18:39:27,149 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 287.3172912597656, ACC: 0.014704803936183453
2023-07-25 18:39:38,133 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 287.3146667480469, ACC: 0.015159014612436295
2023-07-25 18:39:38,233 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-T2m_30-timesteps_vis.h5
2023-07-25 18:40:31,701 - root - INFO - ------------------ Configuration ------------------
2023-07-25 18:40:31,702 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 18:40:31,702 - root - INFO - Configuration name: afno_backbone
2023-07-25 18:40:31,702 - root - INFO - log_to_wandb True
2023-07-25 18:40:31,702 - root - INFO - lr 0.0005
2023-07-25 18:40:31,702 - root - INFO - batch_size 64
2023-07-25 18:40:31,702 - root - INFO - max_epochs 150
2023-07-25 18:40:31,702 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 18:40:31,702 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 18:40:31,702 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 18:40:31,702 - root - INFO - orography False
2023-07-25 18:40:31,702 - root - INFO - orography_path None
2023-07-25 18:40:31,702 - root - INFO - exp_dir FourCastNet/results
2023-07-25 18:40:31,702 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 18:40:31,702 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 18:40:31,702 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 18:40:31,703 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 18:40:31,703 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 18:40:31,703 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 18:40:31,703 - root - INFO - loss l2
2023-07-25 18:40:31,703 - root - INFO - num_data_workers 4
2023-07-25 18:40:31,703 - root - INFO - dt 1
2023-07-25 18:40:31,703 - root - INFO - n_history 0
2023-07-25 18:40:31,703 - root - INFO - prediction_type iterative
2023-07-25 18:40:31,703 - root - INFO - prediction_length 30
2023-07-25 18:40:31,703 - root - INFO - n_initial_conditions 5
2023-07-25 18:40:31,703 - root - INFO - ics_type default
2023-07-25 18:40:31,703 - root - INFO - save_raw_forecasts True
2023-07-25 18:40:31,703 - root - INFO - save_channel False
2023-07-25 18:40:31,703 - root - INFO - masked_acc False
2023-07-25 18:40:31,703 - root - INFO - maskpath None
2023-07-25 18:40:31,703 - root - INFO - perturb False
2023-07-25 18:40:31,703 - root - INFO - add_grid False
2023-07-25 18:40:31,703 - root - INFO - N_grid_channels 0
2023-07-25 18:40:31,703 - root - INFO - gridtype sinusoidal
2023-07-25 18:40:31,703 - root - INFO - roll False
2023-07-25 18:40:31,703 - root - INFO - num_blocks 8
2023-07-25 18:40:31,704 - root - INFO - nettype afno
2023-07-25 18:40:31,704 - root - INFO - patch_size 8
2023-07-25 18:40:31,704 - root - INFO - width 56
2023-07-25 18:40:31,704 - root - INFO - modes 32
2023-07-25 18:40:31,704 - root - INFO - target Z1000
2023-07-25 18:40:31,704 - root - INFO - normalization zscore
2023-07-25 18:40:31,704 - root - INFO - log_to_screen True
2023-07-25 18:40:31,704 - root - INFO - save_checkpoint True
2023-07-25 18:40:31,704 - root - INFO - enable_nhwc False
2023-07-25 18:40:31,704 - root - INFO - optimizer_type FusedAdam
2023-07-25 18:40:31,704 - root - INFO - crop_size_x None
2023-07-25 18:40:31,704 - root - INFO - crop_size_y None
2023-07-25 18:40:31,704 - root - INFO - two_step_training False
2023-07-25 18:40:31,704 - root - INFO - plot_animations False
2023-07-25 18:40:31,704 - root - INFO - add_noise False
2023-07-25 18:40:31,704 - root - INFO - noise_std 0
2023-07-25 18:40:31,704 - root - INFO - world_size 1
2023-07-25 18:40:31,704 - root - INFO - interp 0
2023-07-25 18:40:31,704 - root - INFO - use_daily_climatology False
2023-07-25 18:40:31,704 - root - INFO - global_batch_size 64
2023-07-25 18:40:31,705 - root - INFO - ablate sp
2023-07-25 18:40:31,705 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 18:40:31,705 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 18:40:31,705 - root - INFO - resuming False
2023-07-25 18:40:31,705 - root - INFO - local_rank 0
2023-07-25 18:40:31,705 - root - INFO - ---------------------------------------------------
2023-07-25 18:40:31,705 - root - INFO - Inference for 1 initial conditions
2023-07-25 18:40:31,916 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 18:40:31,918 - root - INFO - Number of samples per year: 1460
2023-07-25 18:40:31,918 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 18:40:31,918 - root - INFO - Delta t: 6 hours
2023-07-25 18:40:31,918 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 18:40:31,921 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 18:41:45,535 - root - INFO - Loading inference data
2023-07-25 18:41:45,536 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 18:41:45,879 - root - INFO - Initial condition 1 of 1
2023-07-25 18:41:46,830 - root - INFO - Extracting valid data from the first year
2023-07-25 18:44:24,419 - root - INFO - Standardizing data
2023-07-25 18:44:32,600 - root - INFO - Loading time means
2023-07-25 18:44:50,068 - root - INFO - Begin autoregressive inference
2023-07-25 18:45:03,526 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 18:45:16,867 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 1.8580946922302246, ACC: 0.9289191961288452
2023-07-25 18:45:28,961 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 2.3838982582092285, ACC: 0.8693328499794006
2023-07-25 18:45:39,890 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 3.338961362838745, ACC: 0.7179540395736694
2023-07-25 18:45:51,657 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 4.303718566894531, ACC: 0.5706072449684143
2023-07-25 18:46:03,533 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 4.81576681137085, ACC: 0.48400232195854187
2023-07-25 18:46:15,972 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 5.16123628616333, ACC: 0.42639023065567017
2023-07-25 18:46:28,074 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 5.528565406799316, ACC: 0.36453500390052795
2023-07-25 18:46:39,908 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 5.939043998718262, ACC: 0.30624866485595703
2023-07-25 18:46:50,864 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 6.281802177429199, ACC: 0.26269781589508057
2023-07-25 18:47:03,288 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 6.818136692047119, ACC: 0.22453956305980682
2023-07-25 18:47:15,105 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 7.432784080505371, ACC: 0.17277736961841583
2023-07-25 18:47:27,364 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 7.804729461669922, ACC: 0.14275939762592316
2023-07-25 18:47:39,086 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 8.1648530960083, ACC: 0.11906801909208298
2023-07-25 18:47:50,677 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 8.507918357849121, ACC: 0.09965214133262634
2023-07-25 18:48:01,546 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 8.892520904541016, ACC: 0.06446900963783264
2023-07-25 18:48:14,303 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 9.273175239562988, ACC: 0.0435430184006691
2023-07-25 18:48:25,434 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 9.560745239257812, ACC: 0.030816854909062386
2023-07-25 18:48:36,382 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 9.846102714538574, ACC: 0.029472362250089645
2023-07-25 18:48:47,375 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 10.1336669921875, ACC: 0.02052890695631504
2023-07-25 18:48:59,005 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 10.286158561706543, ACC: 0.021031413227319717
2023-07-25 18:49:10,862 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 10.461688041687012, ACC: 0.029824722558259964
2023-07-25 18:49:22,364 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 10.622140884399414, ACC: 0.036489397287368774
2023-07-25 18:49:32,494 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 10.724151611328125, ACC: 0.04191535338759422
2023-07-25 18:49:42,587 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 10.85339069366455, ACC: 0.049980297684669495
2023-07-25 18:49:53,829 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 11.24173355102539, ACC: 0.0545230433344841
2023-07-25 18:50:05,683 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 11.608531951904297, ACC: 0.05683770775794983
2023-07-25 18:50:17,323 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 11.857529640197754, ACC: 0.05197691172361374
2023-07-25 18:50:27,488 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 12.022576332092285, ACC: 0.047981832176446915
2023-07-25 18:50:37,714 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 12.195211410522461, ACC: 0.04815033823251724
2023-07-25 18:50:37,800 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-sp_30-timesteps_vis.h5
2023-07-25 18:51:30,885 - root - INFO - ------------------ Configuration ------------------
2023-07-25 18:51:30,885 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 18:51:30,885 - root - INFO - Configuration name: afno_backbone
2023-07-25 18:51:30,885 - root - INFO - log_to_wandb True
2023-07-25 18:51:30,885 - root - INFO - lr 0.0005
2023-07-25 18:51:30,885 - root - INFO - batch_size 64
2023-07-25 18:51:30,885 - root - INFO - max_epochs 150
2023-07-25 18:51:30,885 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 18:51:30,885 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 18:51:30,885 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 18:51:30,885 - root - INFO - orography False
2023-07-25 18:51:30,885 - root - INFO - orography_path None
2023-07-25 18:51:30,885 - root - INFO - exp_dir FourCastNet/results
2023-07-25 18:51:30,885 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 18:51:30,885 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 18:51:30,886 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 18:51:30,886 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 18:51:30,886 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 18:51:30,886 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 18:51:30,886 - root - INFO - loss l2
2023-07-25 18:51:30,886 - root - INFO - num_data_workers 4
2023-07-25 18:51:30,886 - root - INFO - dt 1
2023-07-25 18:51:30,886 - root - INFO - n_history 0
2023-07-25 18:51:30,886 - root - INFO - prediction_type iterative
2023-07-25 18:51:30,886 - root - INFO - prediction_length 30
2023-07-25 18:51:30,886 - root - INFO - n_initial_conditions 5
2023-07-25 18:51:30,886 - root - INFO - ics_type default
2023-07-25 18:51:30,886 - root - INFO - save_raw_forecasts True
2023-07-25 18:51:30,886 - root - INFO - save_channel False
2023-07-25 18:51:30,886 - root - INFO - masked_acc False
2023-07-25 18:51:30,886 - root - INFO - maskpath None
2023-07-25 18:51:30,886 - root - INFO - perturb False
2023-07-25 18:51:30,886 - root - INFO - add_grid False
2023-07-25 18:51:30,886 - root - INFO - N_grid_channels 0
2023-07-25 18:51:30,886 - root - INFO - gridtype sinusoidal
2023-07-25 18:51:30,886 - root - INFO - roll False
2023-07-25 18:51:30,887 - root - INFO - num_blocks 8
2023-07-25 18:51:30,887 - root - INFO - nettype afno
2023-07-25 18:51:30,887 - root - INFO - patch_size 8
2023-07-25 18:51:30,887 - root - INFO - width 56
2023-07-25 18:51:30,887 - root - INFO - modes 32
2023-07-25 18:51:30,887 - root - INFO - target Z1000
2023-07-25 18:51:30,887 - root - INFO - normalization zscore
2023-07-25 18:51:30,887 - root - INFO - log_to_screen True
2023-07-25 18:51:30,887 - root - INFO - save_checkpoint True
2023-07-25 18:51:30,887 - root - INFO - enable_nhwc False
2023-07-25 18:51:30,887 - root - INFO - optimizer_type FusedAdam
2023-07-25 18:51:30,887 - root - INFO - crop_size_x None
2023-07-25 18:51:30,887 - root - INFO - crop_size_y None
2023-07-25 18:51:30,887 - root - INFO - two_step_training False
2023-07-25 18:51:30,887 - root - INFO - plot_animations False
2023-07-25 18:51:30,888 - root - INFO - add_noise False
2023-07-25 18:51:30,888 - root - INFO - noise_std 0
2023-07-25 18:51:30,888 - root - INFO - world_size 1
2023-07-25 18:51:30,888 - root - INFO - interp 0
2023-07-25 18:51:30,888 - root - INFO - use_daily_climatology False
2023-07-25 18:51:30,888 - root - INFO - global_batch_size 64
2023-07-25 18:51:30,888 - root - INFO - ablate mslp
2023-07-25 18:51:30,888 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 18:51:30,888 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 18:51:30,888 - root - INFO - resuming False
2023-07-25 18:51:30,888 - root - INFO - local_rank 0
2023-07-25 18:51:30,888 - root - INFO - ---------------------------------------------------
2023-07-25 18:51:30,888 - root - INFO - Inference for 1 initial conditions
2023-07-25 18:51:31,169 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 18:51:31,170 - root - INFO - Number of samples per year: 1460
2023-07-25 18:51:31,170 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 18:51:31,170 - root - INFO - Delta t: 6 hours
2023-07-25 18:51:31,170 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 18:51:31,171 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 18:52:39,729 - root - INFO - Loading inference data
2023-07-25 18:52:39,730 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 18:52:39,953 - root - INFO - Initial condition 1 of 1
2023-07-25 18:52:40,881 - root - INFO - Extracting valid data from the first year
2023-07-25 18:55:00,646 - root - INFO - Standardizing data
2023-07-25 18:55:09,013 - root - INFO - Loading time means
2023-07-25 18:55:22,488 - root - INFO - Begin autoregressive inference
2023-07-25 18:55:33,386 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 18:55:45,196 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 3.422071933746338, ACC: 0.7380198836326599
2023-07-25 18:55:56,413 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 9.071975708007812, ACC: 0.3383271396160126
2023-07-25 18:56:08,113 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 23.23404312133789, ACC: 0.11138266324996948
2023-07-25 18:56:19,897 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 31.41404151916504, ACC: 0.06769295781850815
2023-07-25 18:56:31,169 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 35.247928619384766, ACC: 0.05638163536787033
2023-07-25 18:56:42,466 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 38.351593017578125, ACC: 0.05183648318052292
2023-07-25 18:56:54,381 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 42.163055419921875, ACC: 0.0466732457280159
2023-07-25 18:57:05,380 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 46.03199005126953, ACC: 0.04483134299516678
2023-07-25 18:57:17,011 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 49.712158203125, ACC: 0.04048972949385643
2023-07-25 18:57:28,010 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 53.07881164550781, ACC: 0.039270900189876556
2023-07-25 18:57:39,146 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 56.16484451293945, ACC: 0.02962837554514408
2023-07-25 18:57:50,393 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 59.110015869140625, ACC: 0.02534036710858345
2023-07-25 18:58:02,742 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 62.107948303222656, ACC: 0.02171284332871437
2023-07-25 18:58:15,543 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 65.18029022216797, ACC: 0.01764020137488842
2023-07-25 18:58:26,667 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 68.33294677734375, ACC: 0.006437425967305899
2023-07-25 18:58:38,180 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 71.91356658935547, ACC: 0.005206684116274118
2023-07-25 18:58:48,959 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 76.24343872070312, ACC: 0.006380308419466019
2023-07-25 18:59:00,543 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 81.3975830078125, ACC: 0.010328557342290878
2023-07-25 18:59:11,750 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 87.60159301757812, ACC: 0.012089238502085209
2023-07-25 18:59:23,640 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 94.62731170654297, ACC: 0.011297955177724361
2023-07-25 18:59:34,638 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 104.95460510253906, ACC: 0.01179491262882948
2023-07-25 18:59:46,145 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 126.60394287109375, ACC: 0.012384056113660336
2023-07-25 18:59:58,022 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 162.53306579589844, ACC: 0.05224607139825821
2023-07-25 19:00:11,178 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 199.02586364746094, ACC: 0.08363119512796402
2023-07-25 19:00:25,595 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 222.5900115966797, ACC: 0.09969032555818558
2023-07-25 19:00:36,942 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 235.81849670410156, ACC: 0.0850851833820343
2023-07-25 19:00:48,133 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 246.485107421875, ACC: 0.06535404920578003
2023-07-25 19:00:59,421 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 257.3937683105469, ACC: 0.042285215109586716
2023-07-25 19:01:12,283 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 267.1140441894531, ACC: 0.029280049726366997
2023-07-25 19:01:12,371 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-mslp_30-timesteps_vis.h5
2023-07-25 19:02:06,105 - root - INFO - ------------------ Configuration ------------------
2023-07-25 19:02:06,105 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 19:02:06,105 - root - INFO - Configuration name: afno_backbone
2023-07-25 19:02:06,105 - root - INFO - log_to_wandb True
2023-07-25 19:02:06,106 - root - INFO - lr 0.0005
2023-07-25 19:02:06,106 - root - INFO - batch_size 64
2023-07-25 19:02:06,106 - root - INFO - max_epochs 150
2023-07-25 19:02:06,106 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 19:02:06,106 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 19:02:06,106 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 19:02:06,106 - root - INFO - orography False
2023-07-25 19:02:06,106 - root - INFO - orography_path None
2023-07-25 19:02:06,106 - root - INFO - exp_dir FourCastNet/results
2023-07-25 19:02:06,106 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 19:02:06,106 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 19:02:06,106 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 19:02:06,106 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 19:02:06,106 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 19:02:06,106 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 19:02:06,106 - root - INFO - loss l2
2023-07-25 19:02:06,106 - root - INFO - num_data_workers 4
2023-07-25 19:02:06,107 - root - INFO - dt 1
2023-07-25 19:02:06,107 - root - INFO - n_history 0
2023-07-25 19:02:06,107 - root - INFO - prediction_type iterative
2023-07-25 19:02:06,107 - root - INFO - prediction_length 30
2023-07-25 19:02:06,107 - root - INFO - n_initial_conditions 5
2023-07-25 19:02:06,107 - root - INFO - ics_type default
2023-07-25 19:02:06,107 - root - INFO - save_raw_forecasts True
2023-07-25 19:02:06,107 - root - INFO - save_channel False
2023-07-25 19:02:06,107 - root - INFO - masked_acc False
2023-07-25 19:02:06,107 - root - INFO - maskpath None
2023-07-25 19:02:06,107 - root - INFO - perturb False
2023-07-25 19:02:06,107 - root - INFO - add_grid False
2023-07-25 19:02:06,107 - root - INFO - N_grid_channels 0
2023-07-25 19:02:06,107 - root - INFO - gridtype sinusoidal
2023-07-25 19:02:06,107 - root - INFO - roll False
2023-07-25 19:02:06,107 - root - INFO - num_blocks 8
2023-07-25 19:02:06,107 - root - INFO - nettype afno
2023-07-25 19:02:06,107 - root - INFO - patch_size 8
2023-07-25 19:02:06,107 - root - INFO - width 56
2023-07-25 19:02:06,107 - root - INFO - modes 32
2023-07-25 19:02:06,108 - root - INFO - target Z1000
2023-07-25 19:02:06,108 - root - INFO - normalization zscore
2023-07-25 19:02:06,108 - root - INFO - log_to_screen True
2023-07-25 19:02:06,108 - root - INFO - save_checkpoint True
2023-07-25 19:02:06,108 - root - INFO - enable_nhwc False
2023-07-25 19:02:06,108 - root - INFO - optimizer_type FusedAdam
2023-07-25 19:02:06,108 - root - INFO - crop_size_x None
2023-07-25 19:02:06,108 - root - INFO - crop_size_y None
2023-07-25 19:02:06,108 - root - INFO - two_step_training False
2023-07-25 19:02:06,108 - root - INFO - plot_animations False
2023-07-25 19:02:06,108 - root - INFO - add_noise False
2023-07-25 19:02:06,108 - root - INFO - noise_std 0
2023-07-25 19:02:06,108 - root - INFO - world_size 1
2023-07-25 19:02:06,108 - root - INFO - interp 0
2023-07-25 19:02:06,108 - root - INFO - use_daily_climatology False
2023-07-25 19:02:06,108 - root - INFO - global_batch_size 64
2023-07-25 19:02:06,108 - root - INFO - ablate U1000
2023-07-25 19:02:06,108 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 19:02:06,108 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 19:02:06,108 - root - INFO - resuming False
2023-07-25 19:02:06,108 - root - INFO - local_rank 0
2023-07-25 19:02:06,108 - root - INFO - ---------------------------------------------------
2023-07-25 19:02:06,108 - root - INFO - Inference for 1 initial conditions
2023-07-25 19:02:06,376 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 19:02:06,377 - root - INFO - Number of samples per year: 1460
2023-07-25 19:02:06,377 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 19:02:06,377 - root - INFO - Delta t: 6 hours
2023-07-25 19:02:06,377 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 19:02:06,377 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 19:03:10,431 - root - INFO - Loading inference data
2023-07-25 19:03:10,432 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 19:03:10,794 - root - INFO - Initial condition 1 of 1
2023-07-25 19:03:11,633 - root - INFO - Extracting valid data from the first year
2023-07-25 19:05:36,226 - root - INFO - Standardizing data
2023-07-25 19:05:44,692 - root - INFO - Loading time means
2023-07-25 19:05:59,400 - root - INFO - Begin autoregressive inference
2023-07-25 19:06:10,593 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 19:06:23,924 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 5.115417957305908, ACC: 0.6183674931526184
2023-07-25 19:06:35,207 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 20.599260330200195, ACC: 0.14172542095184326
2023-07-25 19:06:46,695 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 43.60578918457031, ACC: 0.08019401878118515
2023-07-25 19:06:58,862 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 66.8333511352539, ACC: 0.08988340944051743
2023-07-25 19:07:10,564 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 84.05836486816406, ACC: 0.10685170441865921
2023-07-25 19:07:21,458 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 106.94294738769531, ACC: 0.12003762274980545
2023-07-25 19:07:32,964 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 148.08871459960938, ACC: 0.13298898935317993
2023-07-25 19:07:43,960 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 193.20579528808594, ACC: 0.1352849304676056
2023-07-25 19:07:55,605 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 225.16836547851562, ACC: 0.12473735958337784
2023-07-25 19:08:06,585 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 240.01101684570312, ACC: 0.09399174153804779
2023-07-25 19:08:18,153 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 248.13198852539062, ACC: 0.06613883376121521
2023-07-25 19:08:29,764 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 256.4877624511719, ACC: 0.04700712487101555
2023-07-25 19:08:41,405 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 265.0851135253906, ACC: 0.03525108844041824
2023-07-25 19:08:52,585 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 272.30889892578125, ACC: 0.025589177384972572
2023-07-25 19:09:03,622 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 277.58734130859375, ACC: 0.02024652436375618
2023-07-25 19:09:14,550 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 281.1551818847656, ACC: 0.01850903406739235
2023-07-25 19:09:25,093 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 283.49169921875, ACC: 0.017917100340127945
2023-07-25 19:09:35,919 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 284.944580078125, ACC: 0.017758991569280624
2023-07-25 19:09:47,454 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 285.8236999511719, ACC: 0.018518123775720596
2023-07-25 19:09:59,042 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 286.38238525390625, ACC: 0.01683102734386921
2023-07-25 19:10:10,879 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 286.7313537597656, ACC: 0.018236182630062103
2023-07-25 19:10:22,654 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 286.9696044921875, ACC: 0.016332074999809265
2023-07-25 19:10:34,244 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 287.1103210449219, ACC: 0.01663842424750328
2023-07-25 19:10:45,368 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 287.2005920410156, ACC: 0.01563001424074173
2023-07-25 19:10:56,346 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 287.24273681640625, ACC: 0.01708861067891121
2023-07-25 19:11:08,531 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 287.27716064453125, ACC: 0.015846243128180504
2023-07-25 19:11:20,067 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 287.291259765625, ACC: 0.01613294705748558
2023-07-25 19:11:31,267 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 287.30694580078125, ACC: 0.014695273712277412
2023-07-25 19:11:42,076 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 287.30914306640625, ACC: 0.015147031284868717
2023-07-25 19:11:42,179 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-U1000_30-timesteps_vis.h5
2023-07-25 19:12:35,439 - root - INFO - ------------------ Configuration ------------------
2023-07-25 19:12:35,439 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 19:12:35,439 - root - INFO - Configuration name: afno_backbone
2023-07-25 19:12:35,439 - root - INFO - log_to_wandb True
2023-07-25 19:12:35,439 - root - INFO - lr 0.0005
2023-07-25 19:12:35,439 - root - INFO - batch_size 64
2023-07-25 19:12:35,439 - root - INFO - max_epochs 150
2023-07-25 19:12:35,439 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 19:12:35,440 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 19:12:35,440 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 19:12:35,440 - root - INFO - orography False
2023-07-25 19:12:35,440 - root - INFO - orography_path None
2023-07-25 19:12:35,440 - root - INFO - exp_dir FourCastNet/results
2023-07-25 19:12:35,440 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 19:12:35,440 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 19:12:35,440 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 19:12:35,440 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 19:12:35,440 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 19:12:35,440 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 19:12:35,440 - root - INFO - loss l2
2023-07-25 19:12:35,440 - root - INFO - num_data_workers 4
2023-07-25 19:12:35,440 - root - INFO - dt 1
2023-07-25 19:12:35,441 - root - INFO - n_history 0
2023-07-25 19:12:35,441 - root - INFO - prediction_type iterative
2023-07-25 19:12:35,441 - root - INFO - prediction_length 30
2023-07-25 19:12:35,441 - root - INFO - n_initial_conditions 5
2023-07-25 19:12:35,441 - root - INFO - ics_type default
2023-07-25 19:12:35,441 - root - INFO - save_raw_forecasts True
2023-07-25 19:12:35,441 - root - INFO - save_channel False
2023-07-25 19:12:35,441 - root - INFO - masked_acc False
2023-07-25 19:12:35,441 - root - INFO - maskpath None
2023-07-25 19:12:35,441 - root - INFO - perturb False
2023-07-25 19:12:35,441 - root - INFO - add_grid False
2023-07-25 19:12:35,441 - root - INFO - N_grid_channels 0
2023-07-25 19:12:35,441 - root - INFO - gridtype sinusoidal
2023-07-25 19:12:35,441 - root - INFO - roll False
2023-07-25 19:12:35,441 - root - INFO - num_blocks 8
2023-07-25 19:12:35,441 - root - INFO - nettype afno
2023-07-25 19:12:35,441 - root - INFO - patch_size 8
2023-07-25 19:12:35,441 - root - INFO - width 56
2023-07-25 19:12:35,441 - root - INFO - modes 32
2023-07-25 19:12:35,441 - root - INFO - target Z1000
2023-07-25 19:12:35,442 - root - INFO - normalization zscore
2023-07-25 19:12:35,442 - root - INFO - log_to_screen True
2023-07-25 19:12:35,442 - root - INFO - save_checkpoint True
2023-07-25 19:12:35,442 - root - INFO - enable_nhwc False
2023-07-25 19:12:35,442 - root - INFO - optimizer_type FusedAdam
2023-07-25 19:12:35,442 - root - INFO - crop_size_x None
2023-07-25 19:12:35,442 - root - INFO - crop_size_y None
2023-07-25 19:12:35,442 - root - INFO - two_step_training False
2023-07-25 19:12:35,442 - root - INFO - plot_animations False
2023-07-25 19:12:35,442 - root - INFO - add_noise False
2023-07-25 19:12:35,442 - root - INFO - noise_std 0
2023-07-25 19:12:35,442 - root - INFO - world_size 1
2023-07-25 19:12:35,442 - root - INFO - interp 0
2023-07-25 19:12:35,442 - root - INFO - use_daily_climatology False
2023-07-25 19:12:35,442 - root - INFO - global_batch_size 64
2023-07-25 19:12:35,442 - root - INFO - ablate V1000
2023-07-25 19:12:35,442 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 19:12:35,442 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 19:12:35,442 - root - INFO - resuming False
2023-07-25 19:12:35,442 - root - INFO - local_rank 0
2023-07-25 19:12:35,442 - root - INFO - ---------------------------------------------------
2023-07-25 19:12:35,442 - root - INFO - Inference for 1 initial conditions
2023-07-25 19:12:35,733 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 19:12:35,734 - root - INFO - Number of samples per year: 1460
2023-07-25 19:12:35,734 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 19:12:35,735 - root - INFO - Delta t: 6 hours
2023-07-25 19:12:35,735 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 19:12:35,735 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 19:13:47,038 - root - INFO - Loading inference data
2023-07-25 19:13:47,039 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 19:13:47,311 - root - INFO - Initial condition 1 of 1
2023-07-25 19:13:48,170 - root - INFO - Extracting valid data from the first year
2023-07-25 19:16:22,249 - root - INFO - Standardizing data
2023-07-25 19:16:30,757 - root - INFO - Loading time means
2023-07-25 19:16:47,173 - root - INFO - Begin autoregressive inference
2023-07-25 19:16:58,967 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 19:17:11,776 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 1.5126961469650269, ACC: 0.9478514790534973
2023-07-25 19:17:22,721 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 1.524094581604004, ACC: 0.9466820955276489
2023-07-25 19:17:34,007 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 1.5756604671478271, ACC: 0.9428820610046387
2023-07-25 19:17:43,958 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 1.650693655014038, ACC: 0.9369298219680786
2023-07-25 19:17:55,402 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 1.6750715970993042, ACC: 0.9335359334945679
2023-07-25 19:18:06,726 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 1.794956922531128, ACC: 0.9231373071670532
2023-07-25 19:18:17,809 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 1.9248073101043701, ACC: 0.9110105633735657
2023-07-25 19:18:28,532 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 2.099426031112671, ACC: 0.8972945809364319
2023-07-25 19:18:39,586 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 2.2363860607147217, ACC: 0.8855074644088745
2023-07-25 19:18:50,188 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 2.3767144680023193, ACC: 0.8780391812324524
2023-07-25 19:19:01,681 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 2.500091791152954, ACC: 0.8690981864929199
2023-07-25 19:19:13,549 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 2.664430856704712, ACC: 0.8524035215377808
2023-07-25 19:19:23,916 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 2.8228793144226074, ACC: 0.8385416865348816
2023-07-25 19:19:34,179 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 2.9770257472991943, ACC: 0.822533130645752
2023-07-25 19:19:44,094 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 3.178795576095581, ACC: 0.7948635220527649
2023-07-25 19:19:54,872 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 3.321770191192627, ACC: 0.7727089524269104
2023-07-25 19:20:06,764 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 3.399726152420044, ACC: 0.7587239146232605
2023-07-25 19:20:17,259 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 3.4973106384277344, ACC: 0.7355107665061951
2023-07-25 19:20:27,644 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 3.5933592319488525, ACC: 0.7215775847434998
2023-07-25 19:20:39,412 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 3.701586961746216, ACC: 0.700000524520874
2023-07-25 19:20:50,722 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 3.857055902481079, ACC: 0.6763221025466919
2023-07-25 19:21:01,974 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 4.057465076446533, ACC: 0.6418427228927612
2023-07-25 19:21:13,489 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 4.240593910217285, ACC: 0.6091175079345703
2023-07-25 19:21:24,872 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 4.406227111816406, ACC: 0.5802615880966187
2023-07-25 19:21:36,390 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 4.606412887573242, ACC: 0.5487931370735168
2023-07-25 19:21:47,390 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 4.7819623947143555, ACC: 0.5230116248130798
2023-07-25 19:21:59,300 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 4.972209453582764, ACC: 0.48555055260658264
2023-07-25 19:22:10,979 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 5.021761894226074, ACC: 0.4577903747558594
2023-07-25 19:22:22,374 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 5.117483615875244, ACC: 0.4319039285182953
2023-07-25 19:22:22,463 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-V1000_30-timesteps_vis.h5
2023-07-25 19:23:15,868 - root - INFO - ------------------ Configuration ------------------
2023-07-25 19:23:15,869 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 19:23:15,870 - root - INFO - Configuration name: afno_backbone
2023-07-25 19:23:15,870 - root - INFO - log_to_wandb True
2023-07-25 19:23:15,870 - root - INFO - lr 0.0005
2023-07-25 19:23:15,870 - root - INFO - batch_size 64
2023-07-25 19:23:15,871 - root - INFO - max_epochs 150
2023-07-25 19:23:15,871 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 19:23:15,871 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 19:23:15,872 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 19:23:15,872 - root - INFO - orography False
2023-07-25 19:23:15,872 - root - INFO - orography_path None
2023-07-25 19:23:15,872 - root - INFO - exp_dir FourCastNet/results
2023-07-25 19:23:15,872 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 19:23:15,872 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 19:23:15,872 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 19:23:15,872 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 19:23:15,872 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 19:23:15,872 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 19:23:15,872 - root - INFO - loss l2
2023-07-25 19:23:15,872 - root - INFO - num_data_workers 4
2023-07-25 19:23:15,872 - root - INFO - dt 1
2023-07-25 19:23:15,872 - root - INFO - n_history 0
2023-07-25 19:23:15,872 - root - INFO - prediction_type iterative
2023-07-25 19:23:15,872 - root - INFO - prediction_length 30
2023-07-25 19:23:15,872 - root - INFO - n_initial_conditions 5
2023-07-25 19:23:15,872 - root - INFO - ics_type default
2023-07-25 19:23:15,872 - root - INFO - save_raw_forecasts True
2023-07-25 19:23:15,872 - root - INFO - save_channel False
2023-07-25 19:23:15,872 - root - INFO - masked_acc False
2023-07-25 19:23:15,872 - root - INFO - maskpath None
2023-07-25 19:23:15,872 - root - INFO - perturb False
2023-07-25 19:23:15,872 - root - INFO - add_grid False
2023-07-25 19:23:15,872 - root - INFO - N_grid_channels 0
2023-07-25 19:23:15,872 - root - INFO - gridtype sinusoidal
2023-07-25 19:23:15,872 - root - INFO - roll False
2023-07-25 19:23:15,872 - root - INFO - num_blocks 8
2023-07-25 19:23:15,873 - root - INFO - nettype afno
2023-07-25 19:23:15,873 - root - INFO - patch_size 8
2023-07-25 19:23:15,873 - root - INFO - width 56
2023-07-25 19:23:15,873 - root - INFO - modes 32
2023-07-25 19:23:15,873 - root - INFO - target Z1000
2023-07-25 19:23:15,873 - root - INFO - normalization zscore
2023-07-25 19:23:15,873 - root - INFO - log_to_screen True
2023-07-25 19:23:15,873 - root - INFO - save_checkpoint True
2023-07-25 19:23:15,873 - root - INFO - enable_nhwc False
2023-07-25 19:23:15,873 - root - INFO - optimizer_type FusedAdam
2023-07-25 19:23:15,873 - root - INFO - crop_size_x None
2023-07-25 19:23:15,873 - root - INFO - crop_size_y None
2023-07-25 19:23:15,873 - root - INFO - two_step_training False
2023-07-25 19:23:15,873 - root - INFO - plot_animations False
2023-07-25 19:23:15,873 - root - INFO - add_noise False
2023-07-25 19:23:15,873 - root - INFO - noise_std 0
2023-07-25 19:23:15,873 - root - INFO - world_size 1
2023-07-25 19:23:15,873 - root - INFO - interp 0
2023-07-25 19:23:15,873 - root - INFO - use_daily_climatology False
2023-07-25 19:23:15,873 - root - INFO - global_batch_size 64
2023-07-25 19:23:15,873 - root - INFO - ablate T850
2023-07-25 19:23:15,873 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 19:23:15,873 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 19:23:15,873 - root - INFO - resuming False
2023-07-25 19:23:15,873 - root - INFO - local_rank 0
2023-07-25 19:23:15,873 - root - INFO - ---------------------------------------------------
2023-07-25 19:23:15,873 - root - INFO - Inference for 1 initial conditions
2023-07-25 19:23:16,131 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 19:23:16,132 - root - INFO - Number of samples per year: 1460
2023-07-25 19:23:16,132 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 19:23:16,132 - root - INFO - Delta t: 6 hours
2023-07-25 19:23:16,132 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 19:23:16,133 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 19:24:26,627 - root - INFO - Loading inference data
2023-07-25 19:24:26,628 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 19:24:26,842 - root - INFO - Initial condition 1 of 1
2023-07-25 19:24:27,669 - root - INFO - Extracting valid data from the first year
2023-07-25 19:26:53,989 - root - INFO - Standardizing data
2023-07-25 19:27:02,818 - root - INFO - Loading time means
2023-07-25 19:27:19,309 - root - INFO - Begin autoregressive inference
2023-07-25 19:27:31,235 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 19:27:43,149 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 12.364038467407227, ACC: 0.24420376121997833
2023-07-25 19:27:55,620 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 54.33992385864258, ACC: 0.034324437379837036
2023-07-25 19:28:06,672 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 95.67861938476562, ACC: 0.024024229496717453
2023-07-25 19:28:18,544 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 150.5828399658203, ACC: 0.07039643824100494
2023-07-25 19:28:29,364 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 200.09271240234375, ACC: 0.12332040816545486
2023-07-25 19:28:41,038 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 225.36614990234375, ACC: 0.13022227585315704
2023-07-25 19:28:52,697 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 236.95623779296875, ACC: 0.10622580349445343
2023-07-25 19:29:03,248 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 247.0115203857422, ACC: 0.08416136354207993
2023-07-25 19:29:15,579 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 258.0401306152344, ACC: 0.06308639794588089
2023-07-25 19:29:26,818 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 267.7130432128906, ACC: 0.04621339216828346
2023-07-25 19:29:38,123 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 274.7339782714844, ACC: 0.033385828137397766
2023-07-25 19:29:48,974 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 279.3385009765625, ACC: 0.02642580308020115
2023-07-25 19:29:59,645 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 282.279296875, ACC: 0.020765772089362144
2023-07-25 19:30:11,690 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 284.1899108886719, ACC: 0.018126435577869415
2023-07-25 19:30:23,934 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 285.4293518066406, ACC: 0.017123017460107803
2023-07-25 19:30:37,097 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 286.20220947265625, ACC: 0.018083831295371056
2023-07-25 19:30:48,826 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 286.67547607421875, ACC: 0.017570937052369118
2023-07-25 19:31:00,641 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 286.9539489746094, ACC: 0.017043085768818855
2023-07-25 19:31:12,742 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 287.1088562011719, ACC: 0.01767430268228054
2023-07-25 19:31:24,662 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 287.2048645019531, ACC: 0.016193004325032234
2023-07-25 19:31:36,222 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 287.246826171875, ACC: 0.01763388141989708
2023-07-25 19:31:48,225 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 287.2821960449219, ACC: 0.01585761271417141
2023-07-25 19:32:00,533 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 287.2939147949219, ACC: 0.016377553343772888
2023-07-25 19:32:12,130 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 287.3058776855469, ACC: 0.015479584224522114
2023-07-25 19:32:24,172 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 287.30218505859375, ACC: 0.01700170524418354
2023-07-25 19:32:35,521 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 287.31024169921875, ACC: 0.015797795727849007
2023-07-25 19:32:47,565 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 287.3094787597656, ACC: 0.01612657867372036
2023-07-25 19:32:58,731 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 287.3169250488281, ACC: 0.014705533161759377
2023-07-25 19:33:11,111 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 287.3145446777344, ACC: 0.015158957801759243
2023-07-25 19:33:11,198 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-T850_30-timesteps_vis.h5
2023-07-25 19:34:04,960 - root - INFO - ------------------ Configuration ------------------
2023-07-25 19:34:04,960 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 19:34:04,960 - root - INFO - Configuration name: afno_backbone
2023-07-25 19:34:04,960 - root - INFO - log_to_wandb True
2023-07-25 19:34:04,960 - root - INFO - lr 0.0005
2023-07-25 19:34:04,960 - root - INFO - batch_size 64
2023-07-25 19:34:04,960 - root - INFO - max_epochs 150
2023-07-25 19:34:04,960 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 19:34:04,961 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 19:34:04,961 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 19:34:04,961 - root - INFO - orography False
2023-07-25 19:34:04,961 - root - INFO - orography_path None
2023-07-25 19:34:04,961 - root - INFO - exp_dir FourCastNet/results
2023-07-25 19:34:04,961 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 19:34:04,961 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 19:34:04,961 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 19:34:04,961 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 19:34:04,961 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 19:34:04,961 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 19:34:04,961 - root - INFO - loss l2
2023-07-25 19:34:04,961 - root - INFO - num_data_workers 4
2023-07-25 19:34:04,961 - root - INFO - dt 1
2023-07-25 19:34:04,961 - root - INFO - n_history 0
2023-07-25 19:34:04,961 - root - INFO - prediction_type iterative
2023-07-25 19:34:04,961 - root - INFO - prediction_length 30
2023-07-25 19:34:04,961 - root - INFO - n_initial_conditions 5
2023-07-25 19:34:04,961 - root - INFO - ics_type default
2023-07-25 19:34:04,961 - root - INFO - save_raw_forecasts True
2023-07-25 19:34:04,961 - root - INFO - save_channel False
2023-07-25 19:34:04,961 - root - INFO - masked_acc False
2023-07-25 19:34:04,961 - root - INFO - maskpath None
2023-07-25 19:34:04,961 - root - INFO - perturb False
2023-07-25 19:34:04,961 - root - INFO - add_grid False
2023-07-25 19:34:04,961 - root - INFO - N_grid_channels 0
2023-07-25 19:34:04,961 - root - INFO - gridtype sinusoidal
2023-07-25 19:34:04,961 - root - INFO - roll False
2023-07-25 19:34:04,962 - root - INFO - num_blocks 8
2023-07-25 19:34:04,962 - root - INFO - nettype afno
2023-07-25 19:34:04,962 - root - INFO - patch_size 8
2023-07-25 19:34:04,962 - root - INFO - width 56
2023-07-25 19:34:04,962 - root - INFO - modes 32
2023-07-25 19:34:04,962 - root - INFO - target Z1000
2023-07-25 19:34:04,962 - root - INFO - normalization zscore
2023-07-25 19:34:04,962 - root - INFO - log_to_screen True
2023-07-25 19:34:04,962 - root - INFO - save_checkpoint True
2023-07-25 19:34:04,962 - root - INFO - enable_nhwc False
2023-07-25 19:34:04,962 - root - INFO - optimizer_type FusedAdam
2023-07-25 19:34:04,962 - root - INFO - crop_size_x None
2023-07-25 19:34:04,962 - root - INFO - crop_size_y None
2023-07-25 19:34:04,962 - root - INFO - two_step_training False
2023-07-25 19:34:04,962 - root - INFO - plot_animations False
2023-07-25 19:34:04,962 - root - INFO - add_noise False
2023-07-25 19:34:04,962 - root - INFO - noise_std 0
2023-07-25 19:34:04,962 - root - INFO - world_size 1
2023-07-25 19:34:04,962 - root - INFO - interp 0
2023-07-25 19:34:04,962 - root - INFO - use_daily_climatology False
2023-07-25 19:34:04,962 - root - INFO - global_batch_size 64
2023-07-25 19:34:04,962 - root - INFO - ablate U850
2023-07-25 19:34:04,962 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 19:34:04,962 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 19:34:04,962 - root - INFO - resuming False
2023-07-25 19:34:04,963 - root - INFO - local_rank 0
2023-07-25 19:34:04,963 - root - INFO - ---------------------------------------------------
2023-07-25 19:34:04,963 - root - INFO - Inference for 1 initial conditions
2023-07-25 19:34:05,282 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 19:34:05,283 - root - INFO - Number of samples per year: 1460
2023-07-25 19:34:05,283 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 19:34:05,283 - root - INFO - Delta t: 6 hours
2023-07-25 19:34:05,283 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 19:34:05,283 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 19:35:14,313 - root - INFO - Loading inference data
2023-07-25 19:35:14,316 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 19:35:14,616 - root - INFO - Initial condition 1 of 1
2023-07-25 19:35:15,424 - root - INFO - Extracting valid data from the first year
2023-07-25 19:37:43,263 - root - INFO - Standardizing data
2023-07-25 19:37:51,284 - root - INFO - Loading time means
2023-07-25 19:38:07,384 - root - INFO - Begin autoregressive inference
2023-07-25 19:38:18,534 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 19:38:29,522 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 1.2641584873199463, ACC: 0.963475227355957
2023-07-25 19:38:40,674 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 1.5182008743286133, ACC: 0.9471926689147949
2023-07-25 19:38:52,151 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 1.6687126159667969, ACC: 0.9356765747070312
2023-07-25 19:39:03,435 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 1.7601886987686157, ACC: 0.9282646775245667
2023-07-25 19:39:15,442 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 1.7772427797317505, ACC: 0.9249787330627441
2023-07-25 19:39:27,129 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 1.8361587524414062, ACC: 0.9192777872085571
2023-07-25 19:39:40,181 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 1.9268771409988403, ACC: 0.91036456823349
2023-07-25 19:39:52,334 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 2.0773932933807373, ACC: 0.8989253640174866
2023-07-25 19:40:04,789 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 2.197288751602173, ACC: 0.8884966969490051
2023-07-25 19:40:17,224 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 2.318741798400879, ACC: 0.8828797340393066
2023-07-25 19:40:28,443 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 2.4495859146118164, ACC: 0.8729973435401917
2023-07-25 19:40:40,199 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 2.6190717220306396, ACC: 0.8561514616012573
2023-07-25 19:40:52,317 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 2.8062853813171387, ACC: 0.838972270488739
2023-07-25 19:41:04,953 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 2.9845504760742188, ACC: 0.8203808069229126
2023-07-25 19:41:18,135 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 3.1595282554626465, ACC: 0.7965510487556458
2023-07-25 19:41:29,758 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 3.3717381954193115, ACC: 0.7651829123497009
2023-07-25 19:41:41,532 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 3.4972963333129883, ACC: 0.743855893611908
2023-07-25 19:41:53,086 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 3.6062371730804443, ACC: 0.7189040184020996
2023-07-25 19:42:04,774 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 3.7253427505493164, ACC: 0.7000779509544373
2023-07-25 19:42:17,344 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 3.8927347660064697, ACC: 0.6649451851844788
2023-07-25 19:42:29,558 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 4.029883861541748, ACC: 0.6413411498069763
2023-07-25 19:42:41,226 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 4.175236225128174, ACC: 0.6175974011421204
2023-07-25 19:42:51,887 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 4.310374736785889, ACC: 0.594975471496582
2023-07-25 19:43:03,298 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 4.380918025970459, ACC: 0.5824477672576904
2023-07-25 19:43:13,341 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 4.481493949890137, ACC: 0.5689681768417358
2023-07-25 19:43:23,756 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 4.574774742126465, ACC: 0.5597195625305176
2023-07-25 19:43:35,124 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 4.691681861877441, ACC: 0.5389129519462585
2023-07-25 19:43:45,989 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 4.7178120613098145, ACC: 0.5200096964836121
2023-07-25 19:43:56,770 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 4.771151065826416, ACC: 0.5015116930007935
2023-07-25 19:43:56,876 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-U850_30-timesteps_vis.h5
2023-07-25 19:44:50,206 - root - INFO - ------------------ Configuration ------------------
2023-07-25 19:44:50,206 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 19:44:50,206 - root - INFO - Configuration name: afno_backbone
2023-07-25 19:44:50,206 - root - INFO - log_to_wandb True
2023-07-25 19:44:50,206 - root - INFO - lr 0.0005
2023-07-25 19:44:50,206 - root - INFO - batch_size 64
2023-07-25 19:44:50,206 - root - INFO - max_epochs 150
2023-07-25 19:44:50,206 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 19:44:50,206 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 19:44:50,207 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 19:44:50,207 - root - INFO - orography False
2023-07-25 19:44:50,207 - root - INFO - orography_path None
2023-07-25 19:44:50,207 - root - INFO - exp_dir FourCastNet/results
2023-07-25 19:44:50,207 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 19:44:50,207 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 19:44:50,207 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 19:44:50,207 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 19:44:50,207 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 19:44:50,207 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 19:44:50,207 - root - INFO - loss l2
2023-07-25 19:44:50,207 - root - INFO - num_data_workers 4
2023-07-25 19:44:50,207 - root - INFO - dt 1
2023-07-25 19:44:50,207 - root - INFO - n_history 0
2023-07-25 19:44:50,207 - root - INFO - prediction_type iterative
2023-07-25 19:44:50,207 - root - INFO - prediction_length 30
2023-07-25 19:44:50,207 - root - INFO - n_initial_conditions 5
2023-07-25 19:44:50,207 - root - INFO - ics_type default
2023-07-25 19:44:50,207 - root - INFO - save_raw_forecasts True
2023-07-25 19:44:50,207 - root - INFO - save_channel False
2023-07-25 19:44:50,207 - root - INFO - masked_acc False
2023-07-25 19:44:50,207 - root - INFO - maskpath None
2023-07-25 19:44:50,207 - root - INFO - perturb False
2023-07-25 19:44:50,207 - root - INFO - add_grid False
2023-07-25 19:44:50,207 - root - INFO - N_grid_channels 0
2023-07-25 19:44:50,207 - root - INFO - gridtype sinusoidal
2023-07-25 19:44:50,208 - root - INFO - roll False
2023-07-25 19:44:50,208 - root - INFO - num_blocks 8
2023-07-25 19:44:50,208 - root - INFO - nettype afno
2023-07-25 19:44:50,208 - root - INFO - patch_size 8
2023-07-25 19:44:50,208 - root - INFO - width 56
2023-07-25 19:44:50,208 - root - INFO - modes 32
2023-07-25 19:44:50,208 - root - INFO - target Z1000
2023-07-25 19:44:50,208 - root - INFO - normalization zscore
2023-07-25 19:44:50,208 - root - INFO - log_to_screen True
2023-07-25 19:44:50,208 - root - INFO - save_checkpoint True
2023-07-25 19:44:50,208 - root - INFO - enable_nhwc False
2023-07-25 19:44:50,208 - root - INFO - optimizer_type FusedAdam
2023-07-25 19:44:50,208 - root - INFO - crop_size_x None
2023-07-25 19:44:50,208 - root - INFO - crop_size_y None
2023-07-25 19:44:50,208 - root - INFO - two_step_training False
2023-07-25 19:44:50,208 - root - INFO - plot_animations False
2023-07-25 19:44:50,208 - root - INFO - add_noise False
2023-07-25 19:44:50,208 - root - INFO - noise_std 0
2023-07-25 19:44:50,208 - root - INFO - world_size 1
2023-07-25 19:44:50,208 - root - INFO - interp 0
2023-07-25 19:44:50,208 - root - INFO - use_daily_climatology False
2023-07-25 19:44:50,208 - root - INFO - global_batch_size 64
2023-07-25 19:44:50,208 - root - INFO - ablate V850
2023-07-25 19:44:50,208 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 19:44:50,208 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 19:44:50,208 - root - INFO - resuming False
2023-07-25 19:44:50,208 - root - INFO - local_rank 0
2023-07-25 19:44:50,208 - root - INFO - ---------------------------------------------------
2023-07-25 19:44:50,208 - root - INFO - Inference for 1 initial conditions
2023-07-25 19:44:50,504 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 19:44:50,505 - root - INFO - Number of samples per year: 1460
2023-07-25 19:44:50,505 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 19:44:50,505 - root - INFO - Delta t: 6 hours
2023-07-25 19:44:50,505 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 19:44:50,505 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 19:46:00,522 - root - INFO - Loading inference data
2023-07-25 19:46:00,523 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 19:46:00,802 - root - INFO - Initial condition 1 of 1
2023-07-25 19:46:01,590 - root - INFO - Extracting valid data from the first year
2023-07-25 19:48:28,304 - root - INFO - Standardizing data
2023-07-25 19:48:36,375 - root - INFO - Loading time means
2023-07-25 19:48:50,049 - root - INFO - Begin autoregressive inference
2023-07-25 19:49:01,140 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 19:49:12,377 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 0.9373810291290283, ACC: 0.9801719188690186
2023-07-25 19:49:23,314 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 1.2790799140930176, ACC: 0.9648485779762268
2023-07-25 19:49:34,317 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 1.3450807332992554, ACC: 0.9590323567390442
2023-07-25 19:49:45,851 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 1.4475598335266113, ACC: 0.951629102230072
2023-07-25 19:49:56,631 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 1.5322625637054443, ACC: 0.9439709186553955
2023-07-25 19:50:08,442 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 1.6214245557785034, ACC: 0.9371098279953003
2023-07-25 19:50:20,100 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 1.6867421865463257, ACC: 0.9316083788871765
2023-07-25 19:50:31,342 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 1.8511708974838257, ACC: 0.9202771186828613
2023-07-25 19:50:41,257 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 1.9554835557937622, ACC: 0.912226140499115
2023-07-25 19:50:51,286 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 2.065392017364502, ACC: 0.9075728058815002
2023-07-25 19:51:01,310 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 2.183279275894165, ACC: 0.8993993401527405
2023-07-25 19:51:11,897 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 2.381605863571167, ACC: 0.8805522322654724
2023-07-25 19:51:22,431 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 2.551273822784424, ACC: 0.8656677007675171
2023-07-25 19:51:33,118 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 2.6977121829986572, ACC: 0.8505773544311523
2023-07-25 19:51:43,261 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 2.850008726119995, ACC: 0.8303652405738831
2023-07-25 19:51:54,693 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 3.061575174331665, ACC: 0.801785945892334
2023-07-25 19:52:06,307 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 3.190629005432129, ACC: 0.7813408374786377
2023-07-25 19:52:16,336 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 3.3071417808532715, ACC: 0.7568742036819458
2023-07-25 19:52:26,396 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 3.4137837886810303, ACC: 0.743832528591156
2023-07-25 19:52:36,967 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 3.563491106033325, ACC: 0.7177454233169556
2023-07-25 19:52:47,053 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 3.653587579727173, ACC: 0.7036451697349548
2023-07-25 19:52:57,094 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 3.8221988677978516, ACC: 0.6765426397323608
2023-07-25 19:53:07,028 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 3.9776785373687744, ACC: 0.6534461379051208
2023-07-25 19:53:17,882 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 4.099567890167236, ACC: 0.6363887190818787
2023-07-25 19:53:28,477 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 4.144205093383789, ACC: 0.6373430490493774
2023-07-25 19:53:39,021 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 4.1975884437561035, ACC: 0.6363387703895569
2023-07-25 19:53:49,771 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 4.233861446380615, ACC: 0.63251793384552
2023-07-25 19:54:00,461 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 4.280981063842773, ACC: 0.6134538054466248
2023-07-25 19:54:10,760 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 4.3692121505737305, ACC: 0.5935091972351074
2023-07-25 19:54:10,853 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-V850_30-timesteps_vis.h5
2023-07-25 19:55:04,163 - root - INFO - ------------------ Configuration ------------------
2023-07-25 19:55:04,163 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 19:55:04,163 - root - INFO - Configuration name: afno_backbone
2023-07-25 19:55:04,163 - root - INFO - log_to_wandb True
2023-07-25 19:55:04,164 - root - INFO - lr 0.0005
2023-07-25 19:55:04,164 - root - INFO - batch_size 64
2023-07-25 19:55:04,164 - root - INFO - max_epochs 150
2023-07-25 19:55:04,164 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 19:55:04,164 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 19:55:04,164 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 19:55:04,164 - root - INFO - orography False
2023-07-25 19:55:04,164 - root - INFO - orography_path None
2023-07-25 19:55:04,164 - root - INFO - exp_dir FourCastNet/results
2023-07-25 19:55:04,164 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 19:55:04,164 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 19:55:04,164 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 19:55:04,164 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 19:55:04,164 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 19:55:04,164 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 19:55:04,164 - root - INFO - loss l2
2023-07-25 19:55:04,164 - root - INFO - num_data_workers 4
2023-07-25 19:55:04,165 - root - INFO - dt 1
2023-07-25 19:55:04,165 - root - INFO - n_history 0
2023-07-25 19:55:04,165 - root - INFO - prediction_type iterative
2023-07-25 19:55:04,165 - root - INFO - prediction_length 30
2023-07-25 19:55:04,165 - root - INFO - n_initial_conditions 5
2023-07-25 19:55:04,165 - root - INFO - ics_type default
2023-07-25 19:55:04,165 - root - INFO - save_raw_forecasts True
2023-07-25 19:55:04,165 - root - INFO - save_channel False
2023-07-25 19:55:04,165 - root - INFO - masked_acc False
2023-07-25 19:55:04,165 - root - INFO - maskpath None
2023-07-25 19:55:04,165 - root - INFO - perturb False
2023-07-25 19:55:04,165 - root - INFO - add_grid False
2023-07-25 19:55:04,165 - root - INFO - N_grid_channels 0
2023-07-25 19:55:04,165 - root - INFO - gridtype sinusoidal
2023-07-25 19:55:04,165 - root - INFO - roll False
2023-07-25 19:55:04,165 - root - INFO - num_blocks 8
2023-07-25 19:55:04,165 - root - INFO - nettype afno
2023-07-25 19:55:04,165 - root - INFO - patch_size 8
2023-07-25 19:55:04,165 - root - INFO - width 56
2023-07-25 19:55:04,165 - root - INFO - modes 32
2023-07-25 19:55:04,165 - root - INFO - target Z1000
2023-07-25 19:55:04,165 - root - INFO - normalization zscore
2023-07-25 19:55:04,165 - root - INFO - log_to_screen True
2023-07-25 19:55:04,165 - root - INFO - save_checkpoint True
2023-07-25 19:55:04,165 - root - INFO - enable_nhwc False
2023-07-25 19:55:04,165 - root - INFO - optimizer_type FusedAdam
2023-07-25 19:55:04,166 - root - INFO - crop_size_x None
2023-07-25 19:55:04,166 - root - INFO - crop_size_y None
2023-07-25 19:55:04,166 - root - INFO - two_step_training False
2023-07-25 19:55:04,166 - root - INFO - plot_animations False
2023-07-25 19:55:04,166 - root - INFO - add_noise False
2023-07-25 19:55:04,166 - root - INFO - noise_std 0
2023-07-25 19:55:04,166 - root - INFO - world_size 1
2023-07-25 19:55:04,166 - root - INFO - interp 0
2023-07-25 19:55:04,166 - root - INFO - use_daily_climatology False
2023-07-25 19:55:04,166 - root - INFO - global_batch_size 64
2023-07-25 19:55:04,166 - root - INFO - ablate Z850
2023-07-25 19:55:04,166 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 19:55:04,166 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 19:55:04,166 - root - INFO - resuming False
2023-07-25 19:55:04,166 - root - INFO - local_rank 0
2023-07-25 19:55:04,166 - root - INFO - ---------------------------------------------------
2023-07-25 19:55:04,166 - root - INFO - Inference for 1 initial conditions
2023-07-25 19:55:04,485 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 19:55:04,486 - root - INFO - Number of samples per year: 1460
2023-07-25 19:55:04,487 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 19:55:04,487 - root - INFO - Delta t: 6 hours
2023-07-25 19:55:04,487 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 19:55:04,487 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 19:56:10,628 - root - INFO - Loading inference data
2023-07-25 19:56:10,629 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 19:56:10,929 - root - INFO - Initial condition 1 of 1
2023-07-25 19:56:11,829 - root - INFO - Extracting valid data from the first year
2023-07-25 19:58:25,891 - root - INFO - Standardizing data
2023-07-25 19:58:34,335 - root - INFO - Loading time means
2023-07-25 19:58:47,674 - root - INFO - Begin autoregressive inference
2023-07-25 19:58:58,777 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 19:59:10,865 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 17.17551040649414, ACC: 0.1525835245847702
2023-07-25 19:59:22,909 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 110.1627197265625, ACC: 0.059375930577516556
2023-07-25 19:59:33,361 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 188.09327697753906, ACC: 0.1066582053899765
2023-07-25 19:59:44,730 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 222.44772338867188, ACC: 0.11784568428993225
2023-07-25 19:59:56,220 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 232.87408447265625, ACC: 0.1171531081199646
2023-07-25 20:00:08,627 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 242.49900817871094, ACC: 0.09329523891210556
2023-07-25 20:00:21,813 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 255.1751708984375, ACC: 0.0651344433426857
2023-07-25 20:00:34,531 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 266.34967041015625, ACC: 0.04861300066113472
2023-07-25 20:00:47,414 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 274.0089416503906, ACC: 0.03630996122956276
2023-07-25 20:00:59,636 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 278.9599914550781, ACC: 0.028900116682052612
2023-07-25 20:01:13,019 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 282.19012451171875, ACC: 0.023828288540244102
2023-07-25 20:01:25,146 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 284.2559509277344, ACC: 0.021834416314959526
2023-07-25 20:01:36,371 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 285.5345764160156, ACC: 0.02032679133117199
2023-07-25 20:01:48,151 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 286.3054504394531, ACC: 0.017995106056332588
2023-07-25 20:02:01,377 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 286.75146484375, ACC: 0.016863951459527016
2023-07-25 20:02:14,066 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 286.9990539550781, ACC: 0.017382105812430382
2023-07-25 20:02:26,598 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 287.1390686035156, ACC: 0.017371097579598427
2023-07-25 20:02:39,191 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 287.2183532714844, ACC: 0.016963940113782883
2023-07-25 20:02:51,675 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 287.2572326660156, ACC: 0.01758604496717453
2023-07-25 20:03:03,870 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 287.2867126464844, ACC: 0.016145789995789528
2023-07-25 20:03:15,358 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 287.2912902832031, ACC: 0.017630403861403465
2023-07-25 20:03:26,531 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 287.3059387207031, ACC: 0.015866464003920555
2023-07-25 20:03:37,694 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 287.3064270019531, ACC: 0.01637405902147293
2023-07-25 20:03:48,533 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 287.3122863769531, ACC: 0.015471627935767174
2023-07-25 20:03:59,785 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 287.3052673339844, ACC: 0.016998236998915672
2023-07-25 20:04:11,548 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 287.3116760253906, ACC: 0.015797032043337822
2023-07-25 20:04:23,217 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 287.3100280761719, ACC: 0.016126835718750954
2023-07-25 20:04:34,508 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 287.3170471191406, ACC: 0.014706273563206196
2023-07-25 20:04:45,693 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 287.3144836425781, ACC: 0.01516028679907322
2023-07-25 20:04:45,790 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-Z850_30-timesteps_vis.h5
2023-07-25 20:05:39,153 - root - INFO - ------------------ Configuration ------------------
2023-07-25 20:05:39,153 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 20:05:39,154 - root - INFO - Configuration name: afno_backbone
2023-07-25 20:05:39,154 - root - INFO - log_to_wandb True
2023-07-25 20:05:39,154 - root - INFO - lr 0.0005
2023-07-25 20:05:39,154 - root - INFO - batch_size 64
2023-07-25 20:05:39,154 - root - INFO - max_epochs 150
2023-07-25 20:05:39,154 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 20:05:39,154 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 20:05:39,154 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 20:05:39,154 - root - INFO - orography False
2023-07-25 20:05:39,154 - root - INFO - orography_path None
2023-07-25 20:05:39,154 - root - INFO - exp_dir FourCastNet/results
2023-07-25 20:05:39,154 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 20:05:39,154 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 20:05:39,154 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 20:05:39,154 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 20:05:39,154 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 20:05:39,154 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 20:05:39,154 - root - INFO - loss l2
2023-07-25 20:05:39,155 - root - INFO - num_data_workers 4
2023-07-25 20:05:39,155 - root - INFO - dt 1
2023-07-25 20:05:39,155 - root - INFO - n_history 0
2023-07-25 20:05:39,155 - root - INFO - prediction_type iterative
2023-07-25 20:05:39,155 - root - INFO - prediction_length 30
2023-07-25 20:05:39,155 - root - INFO - n_initial_conditions 5
2023-07-25 20:05:39,155 - root - INFO - ics_type default
2023-07-25 20:05:39,155 - root - INFO - save_raw_forecasts True
2023-07-25 20:05:39,155 - root - INFO - save_channel False
2023-07-25 20:05:39,155 - root - INFO - masked_acc False
2023-07-25 20:05:39,155 - root - INFO - maskpath None
2023-07-25 20:05:39,155 - root - INFO - perturb False
2023-07-25 20:05:39,155 - root - INFO - add_grid False
2023-07-25 20:05:39,155 - root - INFO - N_grid_channels 0
2023-07-25 20:05:39,155 - root - INFO - gridtype sinusoidal
2023-07-25 20:05:39,155 - root - INFO - roll False
2023-07-25 20:05:39,155 - root - INFO - num_blocks 8
2023-07-25 20:05:39,156 - root - INFO - nettype afno
2023-07-25 20:05:39,156 - root - INFO - patch_size 8
2023-07-25 20:05:39,156 - root - INFO - width 56
2023-07-25 20:05:39,156 - root - INFO - modes 32
2023-07-25 20:05:39,156 - root - INFO - target Z1000
2023-07-25 20:05:39,156 - root - INFO - normalization zscore
2023-07-25 20:05:39,156 - root - INFO - log_to_screen True
2023-07-25 20:05:39,156 - root - INFO - save_checkpoint True
2023-07-25 20:05:39,156 - root - INFO - enable_nhwc False
2023-07-25 20:05:39,156 - root - INFO - optimizer_type FusedAdam
2023-07-25 20:05:39,156 - root - INFO - crop_size_x None
2023-07-25 20:05:39,156 - root - INFO - crop_size_y None
2023-07-25 20:05:39,156 - root - INFO - two_step_training False
2023-07-25 20:05:39,156 - root - INFO - plot_animations False
2023-07-25 20:05:39,156 - root - INFO - add_noise False
2023-07-25 20:05:39,156 - root - INFO - noise_std 0
2023-07-25 20:05:39,156 - root - INFO - world_size 1
2023-07-25 20:05:39,156 - root - INFO - interp 0
2023-07-25 20:05:39,156 - root - INFO - use_daily_climatology False
2023-07-25 20:05:39,156 - root - INFO - global_batch_size 64
2023-07-25 20:05:39,157 - root - INFO - ablate RH850
2023-07-25 20:05:39,157 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 20:05:39,157 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 20:05:39,157 - root - INFO - resuming False
2023-07-25 20:05:39,157 - root - INFO - local_rank 0
2023-07-25 20:05:39,157 - root - INFO - ---------------------------------------------------
2023-07-25 20:05:39,157 - root - INFO - Inference for 1 initial conditions
2023-07-25 20:05:39,459 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 20:05:39,460 - root - INFO - Number of samples per year: 1460
2023-07-25 20:05:39,460 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 20:05:39,460 - root - INFO - Delta t: 6 hours
2023-07-25 20:05:39,460 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 20:05:39,461 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 20:06:50,385 - root - INFO - Loading inference data
2023-07-25 20:06:50,386 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 20:06:50,697 - root - INFO - Initial condition 1 of 1
2023-07-25 20:06:51,602 - root - INFO - Extracting valid data from the first year
2023-07-25 20:09:14,602 - root - INFO - Standardizing data
2023-07-25 20:09:22,773 - root - INFO - Loading time means
2023-07-25 20:09:36,901 - root - INFO - Begin autoregressive inference
2023-07-25 20:09:47,644 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 20:09:59,338 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 1.1056503057479858, ACC: 0.9723528027534485
2023-07-25 20:10:11,885 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 1.4609469175338745, ACC: 0.950867235660553
2023-07-25 20:10:24,262 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 1.721702218055725, ACC: 0.9310919046401978
2023-07-25 20:10:36,852 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 1.897171139717102, ACC: 0.9157170653343201
2023-07-25 20:10:48,568 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 2.069690465927124, ACC: 0.8965593576431274
2023-07-25 20:11:01,256 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 2.1973159313201904, ACC: 0.8828732967376709
2023-07-25 20:11:14,065 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 2.322706460952759, ACC: 0.8681355118751526
2023-07-25 20:11:26,303 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 2.4876651763916016, ACC: 0.8533991575241089
2023-07-25 20:11:37,563 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 2.558222770690918, ACC: 0.8471623659133911
2023-07-25 20:11:48,715 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 2.630307674407959, ACC: 0.8473941087722778
2023-07-25 20:12:00,417 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 2.8081393241882324, ACC: 0.8307989835739136
2023-07-25 20:12:12,022 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 2.998643398284912, ACC: 0.8087393641471863
2023-07-25 20:12:22,808 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 3.1923437118530273, ACC: 0.7884306311607361
2023-07-25 20:12:34,460 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 3.305598020553589, ACC: 0.7761701345443726
2023-07-25 20:12:46,236 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 3.4447684288024902, ACC: 0.7554900646209717
2023-07-25 20:12:57,926 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 3.629173994064331, ACC: 0.7249678373336792
2023-07-25 20:13:09,764 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 3.728044271469116, ACC: 0.7063703536987305
2023-07-25 20:13:20,925 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 3.8263604640960693, ACC: 0.6800917387008667
2023-07-25 20:13:32,528 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 4.0126872062683105, ACC: 0.6503698825836182
2023-07-25 20:13:43,988 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 4.223718166351318, ACC: 0.6065689325332642
2023-07-25 20:13:55,602 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 4.443918704986572, ACC: 0.5669767260551453
2023-07-25 20:14:06,750 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 4.587156772613525, ACC: 0.5403173565864563
2023-07-25 20:14:18,197 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 4.766165733337402, ACC: 0.5064606070518494
2023-07-25 20:14:29,964 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 4.8893561363220215, ACC: 0.4799199104309082
2023-07-25 20:14:41,981 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 5.064993858337402, ACC: 0.45244407653808594
2023-07-25 20:14:53,812 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 5.17573881149292, ACC: 0.4412717819213867
2023-07-25 20:15:06,147 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 5.316434860229492, ACC: 0.41800546646118164
2023-07-25 20:15:18,600 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 5.336809158325195, ACC: 0.3973709046840668
2023-07-25 20:15:30,692 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 5.350705623626709, ACC: 0.389206200838089
2023-07-25 20:15:30,780 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-RH850_30-timesteps_vis.h5
2023-07-25 20:16:23,764 - root - INFO - ------------------ Configuration ------------------
2023-07-25 20:16:23,764 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 20:16:23,764 - root - INFO - Configuration name: afno_backbone
2023-07-25 20:16:23,764 - root - INFO - log_to_wandb True
2023-07-25 20:16:23,764 - root - INFO - lr 0.0005
2023-07-25 20:16:23,764 - root - INFO - batch_size 64
2023-07-25 20:16:23,764 - root - INFO - max_epochs 150
2023-07-25 20:16:23,764 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 20:16:23,764 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 20:16:23,764 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 20:16:23,764 - root - INFO - orography False
2023-07-25 20:16:23,764 - root - INFO - orography_path None
2023-07-25 20:16:23,764 - root - INFO - exp_dir FourCastNet/results
2023-07-25 20:16:23,765 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 20:16:23,765 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 20:16:23,765 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 20:16:23,765 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 20:16:23,765 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 20:16:23,765 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 20:16:23,765 - root - INFO - loss l2
2023-07-25 20:16:23,765 - root - INFO - num_data_workers 4
2023-07-25 20:16:23,765 - root - INFO - dt 1
2023-07-25 20:16:23,765 - root - INFO - n_history 0
2023-07-25 20:16:23,765 - root - INFO - prediction_type iterative
2023-07-25 20:16:23,765 - root - INFO - prediction_length 30
2023-07-25 20:16:23,765 - root - INFO - n_initial_conditions 5
2023-07-25 20:16:23,765 - root - INFO - ics_type default
2023-07-25 20:16:23,765 - root - INFO - save_raw_forecasts True
2023-07-25 20:16:23,765 - root - INFO - save_channel False
2023-07-25 20:16:23,765 - root - INFO - masked_acc False
2023-07-25 20:16:23,765 - root - INFO - maskpath None
2023-07-25 20:16:23,766 - root - INFO - perturb False
2023-07-25 20:16:23,766 - root - INFO - add_grid False
2023-07-25 20:16:23,766 - root - INFO - N_grid_channels 0
2023-07-25 20:16:23,766 - root - INFO - gridtype sinusoidal
2023-07-25 20:16:23,766 - root - INFO - roll False
2023-07-25 20:16:23,766 - root - INFO - num_blocks 8
2023-07-25 20:16:23,766 - root - INFO - nettype afno
2023-07-25 20:16:23,766 - root - INFO - patch_size 8
2023-07-25 20:16:23,766 - root - INFO - width 56
2023-07-25 20:16:23,766 - root - INFO - modes 32
2023-07-25 20:16:23,766 - root - INFO - target Z1000
2023-07-25 20:16:23,766 - root - INFO - normalization zscore
2023-07-25 20:16:23,766 - root - INFO - log_to_screen True
2023-07-25 20:16:23,766 - root - INFO - save_checkpoint True
2023-07-25 20:16:23,766 - root - INFO - enable_nhwc False
2023-07-25 20:16:23,766 - root - INFO - optimizer_type FusedAdam
2023-07-25 20:16:23,766 - root - INFO - crop_size_x None
2023-07-25 20:16:23,766 - root - INFO - crop_size_y None
2023-07-25 20:16:23,766 - root - INFO - two_step_training False
2023-07-25 20:16:23,766 - root - INFO - plot_animations False
2023-07-25 20:16:23,766 - root - INFO - add_noise False
2023-07-25 20:16:23,767 - root - INFO - noise_std 0
2023-07-25 20:16:23,767 - root - INFO - world_size 1
2023-07-25 20:16:23,767 - root - INFO - interp 0
2023-07-25 20:16:23,767 - root - INFO - use_daily_climatology False
2023-07-25 20:16:23,767 - root - INFO - global_batch_size 64
2023-07-25 20:16:23,767 - root - INFO - ablate T500
2023-07-25 20:16:23,767 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 20:16:23,767 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 20:16:23,767 - root - INFO - resuming False
2023-07-25 20:16:23,767 - root - INFO - local_rank 0
2023-07-25 20:16:23,767 - root - INFO - ---------------------------------------------------
2023-07-25 20:16:23,767 - root - INFO - Inference for 1 initial conditions
2023-07-25 20:16:24,076 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 20:16:24,083 - root - INFO - Number of samples per year: 1460
2023-07-25 20:16:24,084 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 20:16:24,084 - root - INFO - Delta t: 6 hours
2023-07-25 20:16:24,084 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 20:16:24,084 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 20:17:31,365 - root - INFO - Loading inference data
2023-07-25 20:17:31,366 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 20:17:31,597 - root - INFO - Initial condition 1 of 1
2023-07-25 20:17:32,548 - root - INFO - Extracting valid data from the first year
2023-07-25 20:19:54,056 - root - INFO - Standardizing data
2023-07-25 20:20:02,544 - root - INFO - Loading time means
2023-07-25 20:20:17,912 - root - INFO - Begin autoregressive inference
2023-07-25 20:20:28,969 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 20:20:41,102 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 1.0009013414382935, ACC: 0.9784654378890991
2023-07-25 20:20:55,101 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 1.1550627946853638, ACC: 0.9699425101280212
2023-07-25 20:21:09,031 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 1.2627843618392944, ACC: 0.9634814858436584
2023-07-25 20:21:22,499 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 1.3941445350646973, ACC: 0.9551360607147217
2023-07-25 20:21:35,559 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 1.5101714134216309, ACC: 0.9457919001579285
2023-07-25 20:21:48,319 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 1.6444793939590454, ACC: 0.9356204867362976
2023-07-25 20:22:01,541 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 1.7296541929244995, ACC: 0.9282253980636597
2023-07-25 20:22:13,549 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 1.8933968544006348, ACC: 0.9167243242263794
2023-07-25 20:22:25,060 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 1.988700270652771, ACC: 0.909355878829956
2023-07-25 20:22:37,643 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 2.1230621337890625, ACC: 0.9023429751396179
2023-07-25 20:22:51,161 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 2.255608558654785, ACC: 0.8924770355224609
2023-07-25 20:23:04,709 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 2.4503073692321777, ACC: 0.873198390007019
2023-07-25 20:23:17,311 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 2.6161670684814453, ACC: 0.858022928237915
2023-07-25 20:23:30,136 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 2.7981674671173096, ACC: 0.8377482295036316
2023-07-25 20:23:42,602 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 2.997589588165283, ACC: 0.8100525140762329
2023-07-25 20:23:53,898 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 3.185330390930176, ACC: 0.7824557423591614
2023-07-25 20:24:05,442 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 3.2828094959259033, ACC: 0.7656080722808838
2023-07-25 20:24:17,842 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 3.391585111618042, ACC: 0.7406876087188721
2023-07-25 20:24:29,988 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 3.467317819595337, ACC: 0.7317690849304199
2023-07-25 20:24:42,085 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 3.538041591644287, ACC: 0.7176598310470581
2023-07-25 20:24:54,136 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 3.5879297256469727, ACC: 0.7117750644683838
2023-07-25 20:25:07,001 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 3.689397096633911, ACC: 0.6959660649299622
2023-07-25 20:25:19,660 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 3.8782706260681152, ACC: 0.6660060286521912
2023-07-25 20:25:31,638 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 4.070865154266357, ACC: 0.6346101760864258
2023-07-25 20:25:43,797 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 4.249122619628906, ACC: 0.6094906330108643
2023-07-25 20:25:56,349 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 4.4282097816467285, ACC: 0.5880305171012878
2023-07-25 20:26:09,744 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 4.604472637176514, ACC: 0.5579185485839844
2023-07-25 20:26:22,264 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 4.687191963195801, ACC: 0.5253349542617798
2023-07-25 20:26:34,882 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 4.740210056304932, ACC: 0.5067533850669861
2023-07-25 20:26:34,969 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-T500_30-timesteps_vis.h5
2023-07-25 20:27:28,067 - root - INFO - ------------------ Configuration ------------------
2023-07-25 20:27:28,067 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 20:27:28,067 - root - INFO - Configuration name: afno_backbone
2023-07-25 20:27:28,067 - root - INFO - log_to_wandb True
2023-07-25 20:27:28,067 - root - INFO - lr 0.0005
2023-07-25 20:27:28,067 - root - INFO - batch_size 64
2023-07-25 20:27:28,067 - root - INFO - max_epochs 150
2023-07-25 20:27:28,067 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 20:27:28,067 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 20:27:28,067 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 20:27:28,067 - root - INFO - orography False
2023-07-25 20:27:28,067 - root - INFO - orography_path None
2023-07-25 20:27:28,067 - root - INFO - exp_dir FourCastNet/results
2023-07-25 20:27:28,067 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 20:27:28,067 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 20:27:28,067 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 20:27:28,067 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 20:27:28,068 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 20:27:28,068 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 20:27:28,068 - root - INFO - loss l2
2023-07-25 20:27:28,068 - root - INFO - num_data_workers 4
2023-07-25 20:27:28,068 - root - INFO - dt 1
2023-07-25 20:27:28,068 - root - INFO - n_history 0
2023-07-25 20:27:28,068 - root - INFO - prediction_type iterative
2023-07-25 20:27:28,068 - root - INFO - prediction_length 30
2023-07-25 20:27:28,068 - root - INFO - n_initial_conditions 5
2023-07-25 20:27:28,068 - root - INFO - ics_type default
2023-07-25 20:27:28,068 - root - INFO - save_raw_forecasts True
2023-07-25 20:27:28,068 - root - INFO - save_channel False
2023-07-25 20:27:28,068 - root - INFO - masked_acc False
2023-07-25 20:27:28,068 - root - INFO - maskpath None
2023-07-25 20:27:28,068 - root - INFO - perturb False
2023-07-25 20:27:28,068 - root - INFO - add_grid False
2023-07-25 20:27:28,068 - root - INFO - N_grid_channels 0
2023-07-25 20:27:28,068 - root - INFO - gridtype sinusoidal
2023-07-25 20:27:28,069 - root - INFO - roll False
2023-07-25 20:27:28,069 - root - INFO - num_blocks 8
2023-07-25 20:27:28,069 - root - INFO - nettype afno
2023-07-25 20:27:28,069 - root - INFO - patch_size 8
2023-07-25 20:27:28,069 - root - INFO - width 56
2023-07-25 20:27:28,069 - root - INFO - modes 32
2023-07-25 20:27:28,069 - root - INFO - target Z1000
2023-07-25 20:27:28,069 - root - INFO - normalization zscore
2023-07-25 20:27:28,069 - root - INFO - log_to_screen True
2023-07-25 20:27:28,069 - root - INFO - save_checkpoint True
2023-07-25 20:27:28,069 - root - INFO - enable_nhwc False
2023-07-25 20:27:28,069 - root - INFO - optimizer_type FusedAdam
2023-07-25 20:27:28,069 - root - INFO - crop_size_x None
2023-07-25 20:27:28,069 - root - INFO - crop_size_y None
2023-07-25 20:27:28,069 - root - INFO - two_step_training False
2023-07-25 20:27:28,069 - root - INFO - plot_animations False
2023-07-25 20:27:28,069 - root - INFO - add_noise False
2023-07-25 20:27:28,069 - root - INFO - noise_std 0
2023-07-25 20:27:28,069 - root - INFO - world_size 1
2023-07-25 20:27:28,069 - root - INFO - interp 0
2023-07-25 20:27:28,069 - root - INFO - use_daily_climatology False
2023-07-25 20:27:28,070 - root - INFO - global_batch_size 64
2023-07-25 20:27:28,070 - root - INFO - ablate U500
2023-07-25 20:27:28,070 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 20:27:28,070 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 20:27:28,070 - root - INFO - resuming False
2023-07-25 20:27:28,070 - root - INFO - local_rank 0
2023-07-25 20:27:28,070 - root - INFO - ---------------------------------------------------
2023-07-25 20:27:28,070 - root - INFO - Inference for 1 initial conditions
2023-07-25 20:27:28,441 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 20:27:28,442 - root - INFO - Number of samples per year: 1460
2023-07-25 20:27:28,442 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 20:27:28,442 - root - INFO - Delta t: 6 hours
2023-07-25 20:27:28,442 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 20:27:28,443 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 20:28:38,725 - root - INFO - Loading inference data
2023-07-25 20:28:38,726 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 20:28:38,937 - root - INFO - Initial condition 1 of 1
2023-07-25 20:28:39,725 - root - INFO - Extracting valid data from the first year
2023-07-25 20:31:13,509 - root - INFO - Standardizing data
2023-07-25 20:31:22,339 - root - INFO - Loading time means
2023-07-25 20:31:41,445 - root - INFO - Begin autoregressive inference
2023-07-25 20:31:53,011 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 20:32:05,804 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 16.585926055908203, ACC: 0.1312197893857956
2023-07-25 20:32:18,730 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 128.0195770263672, ACC: 0.11931753158569336
2023-07-25 20:32:32,288 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 214.2672119140625, ACC: 0.13320738077163696
2023-07-25 20:32:45,560 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 241.30572509765625, ACC: 0.12652552127838135
2023-07-25 20:32:58,887 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 244.4090118408203, ACC: 0.11040958762168884
2023-07-25 20:33:12,139 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 250.61978149414062, ACC: 0.0821513682603836
2023-07-25 20:33:24,652 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 261.0166320800781, ACC: 0.05536208674311638
2023-07-25 20:33:37,893 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 270.35040283203125, ACC: 0.040983449667692184
2023-07-25 20:33:51,005 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 276.8373718261719, ACC: 0.03010421060025692
2023-07-25 20:34:03,864 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 280.87030029296875, ACC: 0.024220885708928108
2023-07-25 20:34:17,051 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 283.38360595703125, ACC: 0.020764917135238647
2023-07-25 20:34:30,301 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 284.9686279296875, ACC: 0.019756793975830078
2023-07-25 20:34:43,149 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 285.9534912109375, ACC: 0.018802281469106674
2023-07-25 20:34:55,794 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 286.5481262207031, ACC: 0.017051175236701965
2023-07-25 20:35:08,056 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 286.8902282714844, ACC: 0.016318699344992638
2023-07-25 20:35:21,052 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 287.07684326171875, ACC: 0.01714031584560871
2023-07-25 20:35:33,811 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 287.1819152832031, ACC: 0.017265280708670616
2023-07-25 20:35:45,855 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 287.2413024902344, ACC: 0.016927773132920265
2023-07-25 20:35:58,887 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 287.269287109375, ACC: 0.017571279779076576
2023-07-25 20:36:11,514 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 287.2928466796875, ACC: 0.01613515429198742
2023-07-25 20:36:23,897 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 287.294189453125, ACC: 0.017623675987124443
2023-07-25 20:36:36,745 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 287.3072509765625, ACC: 0.015863293781876564
2023-07-25 20:36:49,713 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 287.3068542480469, ACC: 0.016373904421925545
2023-07-25 20:37:02,803 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 287.31231689453125, ACC: 0.015473201870918274
2023-07-25 20:37:15,595 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 287.3051452636719, ACC: 0.017000237479805946
2023-07-25 20:37:28,119 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 287.3115234375, ACC: 0.015798546373844147
2023-07-25 20:37:40,787 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 287.3098449707031, ACC: 0.016127921640872955
2023-07-25 20:37:53,179 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 287.31689453125, ACC: 0.014706769026815891
2023-07-25 20:38:05,873 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 287.3143615722656, ACC: 0.015160645358264446
2023-07-25 20:38:05,983 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-U500_30-timesteps_vis.h5
2023-07-25 20:38:59,140 - root - INFO - ------------------ Configuration ------------------
2023-07-25 20:38:59,140 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 20:38:59,140 - root - INFO - Configuration name: afno_backbone
2023-07-25 20:38:59,140 - root - INFO - log_to_wandb True
2023-07-25 20:38:59,140 - root - INFO - lr 0.0005
2023-07-25 20:38:59,140 - root - INFO - batch_size 64
2023-07-25 20:38:59,140 - root - INFO - max_epochs 150
2023-07-25 20:38:59,140 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 20:38:59,140 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 20:38:59,140 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 20:38:59,140 - root - INFO - orography False
2023-07-25 20:38:59,140 - root - INFO - orography_path None
2023-07-25 20:38:59,140 - root - INFO - exp_dir FourCastNet/results
2023-07-25 20:38:59,140 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 20:38:59,140 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 20:38:59,141 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 20:38:59,141 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 20:38:59,141 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 20:38:59,141 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 20:38:59,141 - root - INFO - loss l2
2023-07-25 20:38:59,141 - root - INFO - num_data_workers 4
2023-07-25 20:38:59,141 - root - INFO - dt 1
2023-07-25 20:38:59,141 - root - INFO - n_history 0
2023-07-25 20:38:59,141 - root - INFO - prediction_type iterative
2023-07-25 20:38:59,141 - root - INFO - prediction_length 30
2023-07-25 20:38:59,141 - root - INFO - n_initial_conditions 5
2023-07-25 20:38:59,141 - root - INFO - ics_type default
2023-07-25 20:38:59,141 - root - INFO - save_raw_forecasts True
2023-07-25 20:38:59,141 - root - INFO - save_channel False
2023-07-25 20:38:59,141 - root - INFO - masked_acc False
2023-07-25 20:38:59,141 - root - INFO - maskpath None
2023-07-25 20:38:59,141 - root - INFO - perturb False
2023-07-25 20:38:59,141 - root - INFO - add_grid False
2023-07-25 20:38:59,141 - root - INFO - N_grid_channels 0
2023-07-25 20:38:59,141 - root - INFO - gridtype sinusoidal
2023-07-25 20:38:59,142 - root - INFO - roll False
2023-07-25 20:38:59,142 - root - INFO - num_blocks 8
2023-07-25 20:38:59,142 - root - INFO - nettype afno
2023-07-25 20:38:59,142 - root - INFO - patch_size 8
2023-07-25 20:38:59,142 - root - INFO - width 56
2023-07-25 20:38:59,142 - root - INFO - modes 32
2023-07-25 20:38:59,142 - root - INFO - target Z1000
2023-07-25 20:38:59,142 - root - INFO - normalization zscore
2023-07-25 20:38:59,142 - root - INFO - log_to_screen True
2023-07-25 20:38:59,142 - root - INFO - save_checkpoint True
2023-07-25 20:38:59,142 - root - INFO - enable_nhwc False
2023-07-25 20:38:59,142 - root - INFO - optimizer_type FusedAdam
2023-07-25 20:38:59,142 - root - INFO - crop_size_x None
2023-07-25 20:38:59,142 - root - INFO - crop_size_y None
2023-07-25 20:38:59,142 - root - INFO - two_step_training False
2023-07-25 20:38:59,142 - root - INFO - plot_animations False
2023-07-25 20:38:59,142 - root - INFO - add_noise False
2023-07-25 20:38:59,142 - root - INFO - noise_std 0
2023-07-25 20:38:59,142 - root - INFO - world_size 1
2023-07-25 20:38:59,142 - root - INFO - interp 0
2023-07-25 20:38:59,143 - root - INFO - use_daily_climatology False
2023-07-25 20:38:59,143 - root - INFO - global_batch_size 64
2023-07-25 20:38:59,143 - root - INFO - ablate V500
2023-07-25 20:38:59,143 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 20:38:59,143 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 20:38:59,143 - root - INFO - resuming False
2023-07-25 20:38:59,143 - root - INFO - local_rank 0
2023-07-25 20:38:59,143 - root - INFO - ---------------------------------------------------
2023-07-25 20:38:59,143 - root - INFO - Inference for 1 initial conditions
2023-07-25 20:38:59,454 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 20:38:59,455 - root - INFO - Number of samples per year: 1460
2023-07-25 20:38:59,455 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 20:38:59,455 - root - INFO - Delta t: 6 hours
2023-07-25 20:38:59,455 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 20:38:59,455 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 20:40:09,544 - root - INFO - Loading inference data
2023-07-25 20:40:09,545 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 20:40:09,879 - root - INFO - Initial condition 1 of 1
2023-07-25 20:40:10,696 - root - INFO - Extracting valid data from the first year
2023-07-25 20:42:41,556 - root - INFO - Standardizing data
2023-07-25 20:42:49,571 - root - INFO - Loading time means
2023-07-25 20:43:04,885 - root - INFO - Begin autoregressive inference
2023-07-25 20:43:15,631 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 20:43:26,416 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 93.73213195800781, ACC: 0.14179907739162445
2023-07-25 20:43:37,313 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 184.9209747314453, ACC: 0.11288217455148697
2023-07-25 20:43:49,027 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 230.14915466308594, ACC: 0.12258997559547424
2023-07-25 20:43:59,995 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 239.33224487304688, ACC: 0.11822662502527237
2023-07-25 20:44:10,743 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 244.50335693359375, ACC: 0.09748559445142746
2023-07-25 20:44:22,001 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 254.41827392578125, ACC: 0.07216880470514297
2023-07-25 20:44:32,428 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 264.9627685546875, ACC: 0.0494806282222271
2023-07-25 20:44:43,493 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 273.0777587890625, ACC: 0.040101680904626846
2023-07-25 20:44:54,166 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 278.5649719238281, ACC: 0.030685199424624443
2023-07-25 20:45:06,956 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 282.0609436035156, ACC: 0.025715753436088562
2023-07-25 20:45:19,792 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 284.193359375, ACC: 0.02216295711696148
2023-07-25 20:45:31,105 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 285.5774841308594, ACC: 0.021037926897406578
2023-07-25 20:45:41,951 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 286.3879089355469, ACC: 0.020113855600357056
2023-07-25 20:45:53,992 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 286.7821350097656, ACC: 0.0181093942373991
2023-07-25 20:46:05,520 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 286.9708251953125, ACC: 0.01708049699664116
2023-07-25 20:46:17,658 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 287.0817565917969, ACC: 0.0175425224006176
2023-07-25 20:46:28,958 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 287.16259765625, ACC: 0.017483849078416824
2023-07-25 20:46:40,454 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 287.21966552734375, ACC: 0.017044659703969955
2023-07-25 20:46:51,878 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 287.25201416015625, ACC: 0.01765553466975689
2023-07-25 20:47:03,117 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 287.2807312011719, ACC: 0.016182441264390945
2023-07-25 20:47:14,339 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 287.2861328125, ACC: 0.017651986330747604
2023-07-25 20:47:24,612 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 287.3018493652344, ACC: 0.01588338240981102
2023-07-25 20:47:35,074 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 287.3033142089844, ACC: 0.016385141760110855
2023-07-25 20:47:45,284 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 287.30999755859375, ACC: 0.015482546761631966
2023-07-25 20:47:55,671 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 287.30364990234375, ACC: 0.017006350681185722
2023-07-25 20:48:06,710 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 287.310546875, ACC: 0.015803340822458267
2023-07-25 20:48:17,281 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 287.3092346191406, ACC: 0.016130613163113594
2023-07-25 20:48:27,910 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 287.3165283203125, ACC: 0.014708424918353558
2023-07-25 20:48:38,305 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 287.3141174316406, ACC: 0.015161475166678429
2023-07-25 20:48:38,391 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-V500_30-timesteps_vis.h5
2023-07-25 20:49:31,474 - root - INFO - ------------------ Configuration ------------------
2023-07-25 20:49:31,474 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 20:49:31,475 - root - INFO - Configuration name: afno_backbone
2023-07-25 20:49:31,475 - root - INFO - log_to_wandb True
2023-07-25 20:49:31,475 - root - INFO - lr 0.0005
2023-07-25 20:49:31,475 - root - INFO - batch_size 64
2023-07-25 20:49:31,475 - root - INFO - max_epochs 150
2023-07-25 20:49:31,475 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 20:49:31,475 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 20:49:31,475 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 20:49:31,475 - root - INFO - orography False
2023-07-25 20:49:31,475 - root - INFO - orography_path None
2023-07-25 20:49:31,475 - root - INFO - exp_dir FourCastNet/results
2023-07-25 20:49:31,475 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 20:49:31,475 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 20:49:31,475 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 20:49:31,475 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 20:49:31,475 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 20:49:31,475 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 20:49:31,475 - root - INFO - loss l2
2023-07-25 20:49:31,475 - root - INFO - num_data_workers 4
2023-07-25 20:49:31,475 - root - INFO - dt 1
2023-07-25 20:49:31,475 - root - INFO - n_history 0
2023-07-25 20:49:31,475 - root - INFO - prediction_type iterative
2023-07-25 20:49:31,475 - root - INFO - prediction_length 30
2023-07-25 20:49:31,476 - root - INFO - n_initial_conditions 5
2023-07-25 20:49:31,476 - root - INFO - ics_type default
2023-07-25 20:49:31,476 - root - INFO - save_raw_forecasts True
2023-07-25 20:49:31,476 - root - INFO - save_channel False
2023-07-25 20:49:31,476 - root - INFO - masked_acc False
2023-07-25 20:49:31,476 - root - INFO - maskpath None
2023-07-25 20:49:31,476 - root - INFO - perturb False
2023-07-25 20:49:31,476 - root - INFO - add_grid False
2023-07-25 20:49:31,476 - root - INFO - N_grid_channels 0
2023-07-25 20:49:31,476 - root - INFO - gridtype sinusoidal
2023-07-25 20:49:31,476 - root - INFO - roll False
2023-07-25 20:49:31,476 - root - INFO - num_blocks 8
2023-07-25 20:49:31,476 - root - INFO - nettype afno
2023-07-25 20:49:31,476 - root - INFO - patch_size 8
2023-07-25 20:49:31,476 - root - INFO - width 56
2023-07-25 20:49:31,476 - root - INFO - modes 32
2023-07-25 20:49:31,476 - root - INFO - target Z1000
2023-07-25 20:49:31,476 - root - INFO - normalization zscore
2023-07-25 20:49:31,476 - root - INFO - log_to_screen True
2023-07-25 20:49:31,476 - root - INFO - save_checkpoint True
2023-07-25 20:49:31,476 - root - INFO - enable_nhwc False
2023-07-25 20:49:31,476 - root - INFO - optimizer_type FusedAdam
2023-07-25 20:49:31,477 - root - INFO - crop_size_x None
2023-07-25 20:49:31,477 - root - INFO - crop_size_y None
2023-07-25 20:49:31,477 - root - INFO - two_step_training False
2023-07-25 20:49:31,477 - root - INFO - plot_animations False
2023-07-25 20:49:31,477 - root - INFO - add_noise False
2023-07-25 20:49:31,477 - root - INFO - noise_std 0
2023-07-25 20:49:31,477 - root - INFO - world_size 1
2023-07-25 20:49:31,477 - root - INFO - interp 0
2023-07-25 20:49:31,477 - root - INFO - use_daily_climatology False
2023-07-25 20:49:31,477 - root - INFO - global_batch_size 64
2023-07-25 20:49:31,477 - root - INFO - ablate Z500
2023-07-25 20:49:31,477 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 20:49:31,477 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 20:49:31,477 - root - INFO - resuming False
2023-07-25 20:49:31,477 - root - INFO - local_rank 0
2023-07-25 20:49:31,477 - root - INFO - ---------------------------------------------------
2023-07-25 20:49:31,477 - root - INFO - Inference for 1 initial conditions
2023-07-25 20:49:31,707 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 20:49:31,708 - root - INFO - Number of samples per year: 1460
2023-07-25 20:49:31,708 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 20:49:31,708 - root - INFO - Delta t: 6 hours
2023-07-25 20:49:31,708 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 20:49:31,708 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 20:50:34,696 - root - INFO - Loading inference data
2023-07-25 20:50:34,703 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 20:50:34,962 - root - INFO - Initial condition 1 of 1
2023-07-25 20:50:35,834 - root - INFO - Extracting valid data from the first year
2023-07-25 20:52:42,739 - root - INFO - Standardizing data
2023-07-25 20:52:50,650 - root - INFO - Loading time means
2023-07-25 20:53:03,808 - root - INFO - Begin autoregressive inference
2023-07-25 20:53:14,085 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 20:53:24,818 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 0.6257221102714539, ACC: 0.991159975528717
2023-07-25 20:53:35,347 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 0.9033096432685852, ACC: 0.9815027117729187
2023-07-25 20:53:45,485 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 1.0530287027359009, ACC: 0.9748803973197937
2023-07-25 20:53:55,892 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 1.2277013063430786, ACC: 0.9655935764312744
2023-07-25 20:54:05,885 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 1.3284021615982056, ACC: 0.9590598940849304
2023-07-25 20:54:15,998 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 1.486655831336975, ACC: 0.9482129812240601
2023-07-25 20:54:25,866 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 1.650038242340088, ACC: 0.9364106059074402
2023-07-25 20:54:36,346 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 1.8585588932037354, ACC: 0.9210857152938843
2023-07-25 20:54:46,469 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 2.077918529510498, ACC: 0.9030536413192749
2023-07-25 20:54:56,745 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 2.2399234771728516, ACC: 0.8927550315856934
2023-07-25 20:55:06,700 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 2.458806037902832, ACC: 0.8752882480621338
2023-07-25 20:55:16,209 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 2.6622557640075684, ACC: 0.854544460773468
2023-07-25 20:55:26,692 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 2.841766357421875, ACC: 0.8383547067642212
2023-07-25 20:55:37,160 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 2.9863944053649902, ACC: 0.8212805390357971
2023-07-25 20:55:47,422 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 3.2107231616973877, ACC: 0.7911331057548523
2023-07-25 20:55:57,999 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 3.4150562286376953, ACC: 0.7585495710372925
2023-07-25 20:56:08,515 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 3.607964277267456, ACC: 0.7257706522941589
2023-07-25 20:56:18,859 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 3.753347158432007, ACC: 0.690197765827179
2023-07-25 20:56:29,615 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 3.9231648445129395, ACC: 0.6651018857955933
2023-07-25 20:56:39,557 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 4.082839488983154, ACC: 0.6315203905105591
2023-07-25 20:56:49,929 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 4.305361747741699, ACC: 0.5912648439407349
2023-07-25 20:57:00,341 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 4.509707927703857, ACC: 0.5487986207008362
2023-07-25 20:57:10,974 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 4.806811809539795, ACC: 0.49168574810028076
2023-07-25 20:57:21,242 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 5.063995838165283, ACC: 0.4363866150379181
2023-07-25 20:57:32,302 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 5.354701995849609, ACC: 0.3861328959465027
2023-07-25 20:57:41,900 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 5.608485698699951, ACC: 0.3430849313735962
2023-07-25 20:57:52,449 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 5.784099578857422, ACC: 0.30966413021087646
2023-07-25 20:58:03,124 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 5.844499111175537, ACC: 0.2623394727706909
2023-07-25 20:58:13,989 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 5.927199840545654, ACC: 0.22364795207977295
2023-07-25 20:58:14,091 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-Z500_30-timesteps_vis.h5
2023-07-25 20:59:07,614 - root - INFO - ------------------ Configuration ------------------
2023-07-25 20:59:07,614 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 20:59:07,614 - root - INFO - Configuration name: afno_backbone
2023-07-25 20:59:07,614 - root - INFO - log_to_wandb True
2023-07-25 20:59:07,614 - root - INFO - lr 0.0005
2023-07-25 20:59:07,614 - root - INFO - batch_size 64
2023-07-25 20:59:07,614 - root - INFO - max_epochs 150
2023-07-25 20:59:07,614 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 20:59:07,615 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 20:59:07,615 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 20:59:07,615 - root - INFO - orography False
2023-07-25 20:59:07,615 - root - INFO - orography_path None
2023-07-25 20:59:07,615 - root - INFO - exp_dir FourCastNet/results
2023-07-25 20:59:07,615 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 20:59:07,615 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 20:59:07,615 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 20:59:07,615 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 20:59:07,615 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 20:59:07,615 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 20:59:07,615 - root - INFO - loss l2
2023-07-25 20:59:07,615 - root - INFO - num_data_workers 4
2023-07-25 20:59:07,615 - root - INFO - dt 1
2023-07-25 20:59:07,615 - root - INFO - n_history 0
2023-07-25 20:59:07,615 - root - INFO - prediction_type iterative
2023-07-25 20:59:07,616 - root - INFO - prediction_length 30
2023-07-25 20:59:07,616 - root - INFO - n_initial_conditions 5
2023-07-25 20:59:07,616 - root - INFO - ics_type default
2023-07-25 20:59:07,616 - root - INFO - save_raw_forecasts True
2023-07-25 20:59:07,616 - root - INFO - save_channel False
2023-07-25 20:59:07,616 - root - INFO - masked_acc False
2023-07-25 20:59:07,616 - root - INFO - maskpath None
2023-07-25 20:59:07,616 - root - INFO - perturb False
2023-07-25 20:59:07,616 - root - INFO - add_grid False
2023-07-25 20:59:07,616 - root - INFO - N_grid_channels 0
2023-07-25 20:59:07,616 - root - INFO - gridtype sinusoidal
2023-07-25 20:59:07,616 - root - INFO - roll False
2023-07-25 20:59:07,616 - root - INFO - num_blocks 8
2023-07-25 20:59:07,616 - root - INFO - nettype afno
2023-07-25 20:59:07,616 - root - INFO - patch_size 8
2023-07-25 20:59:07,616 - root - INFO - width 56
2023-07-25 20:59:07,616 - root - INFO - modes 32
2023-07-25 20:59:07,616 - root - INFO - target Z1000
2023-07-25 20:59:07,616 - root - INFO - normalization zscore
2023-07-25 20:59:07,616 - root - INFO - log_to_screen True
2023-07-25 20:59:07,617 - root - INFO - save_checkpoint True
2023-07-25 20:59:07,617 - root - INFO - enable_nhwc False
2023-07-25 20:59:07,617 - root - INFO - optimizer_type FusedAdam
2023-07-25 20:59:07,617 - root - INFO - crop_size_x None
2023-07-25 20:59:07,617 - root - INFO - crop_size_y None
2023-07-25 20:59:07,617 - root - INFO - two_step_training False
2023-07-25 20:59:07,617 - root - INFO - plot_animations False
2023-07-25 20:59:07,617 - root - INFO - add_noise False
2023-07-25 20:59:07,617 - root - INFO - noise_std 0
2023-07-25 20:59:07,617 - root - INFO - world_size 1
2023-07-25 20:59:07,617 - root - INFO - interp 0
2023-07-25 20:59:07,617 - root - INFO - use_daily_climatology False
2023-07-25 20:59:07,617 - root - INFO - global_batch_size 64
2023-07-25 20:59:07,617 - root - INFO - ablate RH500
2023-07-25 20:59:07,617 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 20:59:07,617 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 20:59:07,617 - root - INFO - resuming False
2023-07-25 20:59:07,617 - root - INFO - local_rank 0
2023-07-25 20:59:07,617 - root - INFO - ---------------------------------------------------
2023-07-25 20:59:07,618 - root - INFO - Inference for 1 initial conditions
2023-07-25 20:59:07,878 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 20:59:07,879 - root - INFO - Number of samples per year: 1460
2023-07-25 20:59:07,879 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 20:59:07,879 - root - INFO - Delta t: 6 hours
2023-07-25 20:59:07,879 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 20:59:07,879 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 21:00:03,269 - root - INFO - Loading inference data
2023-07-25 21:00:03,271 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 21:00:03,464 - root - INFO - Initial condition 1 of 1
2023-07-25 21:00:04,409 - root - INFO - Extracting valid data from the first year
2023-07-25 21:02:07,628 - root - INFO - Standardizing data
2023-07-25 21:02:15,952 - root - INFO - Loading time means
2023-07-25 21:02:28,288 - root - INFO - Begin autoregressive inference
2023-07-25 21:02:39,526 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 21:02:51,329 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 0.643420398235321, ACC: 0.9906533360481262
2023-07-25 21:03:03,293 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 0.9093775153160095, ACC: 0.9812490344047546
2023-07-25 21:03:15,124 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 1.042175531387329, ACC: 0.9752797484397888
2023-07-25 21:03:27,512 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 1.2004293203353882, ACC: 0.9669590592384338
2023-07-25 21:03:39,554 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 1.275068759918213, ACC: 0.961780846118927
2023-07-25 21:03:51,004 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 1.4037649631500244, ACC: 0.9534823894500732
2023-07-25 21:04:03,186 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 1.5360569953918457, ACC: 0.9442346096038818
2023-07-25 21:04:15,388 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 1.7371197938919067, ACC: 0.9306216835975647
2023-07-25 21:04:27,274 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 1.9147590398788452, ACC: 0.9171971082687378
2023-07-25 21:04:38,764 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 2.0495364665985107, ACC: 0.910250186920166
2023-07-25 21:04:50,414 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 2.2395455837249756, ACC: 0.8959929943084717
2023-07-25 21:05:03,079 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 2.4919240474700928, ACC: 0.8717585802078247
2023-07-25 21:05:14,724 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 2.6971707344055176, ACC: 0.8534756302833557
2023-07-25 21:05:27,261 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 2.8668980598449707, ACC: 0.835168182849884
2023-07-25 21:05:39,328 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 3.040278434753418, ACC: 0.812511682510376
2023-07-25 21:05:51,371 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 3.266091823577881, ACC: 0.7790113687515259
2023-07-25 21:06:03,784 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 3.382923126220703, ACC: 0.7583903074264526
2023-07-25 21:06:16,478 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 3.455237627029419, ACC: 0.7374401688575745
2023-07-25 21:06:29,498 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 3.5810062885284424, ACC: 0.7195839881896973
2023-07-25 21:06:41,898 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 3.720264434814453, ACC: 0.6931499242782593
2023-07-25 21:06:54,465 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 3.821457862854004, ACC: 0.6771560907363892
2023-07-25 21:07:07,235 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 3.9631435871124268, ACC: 0.655119776725769
2023-07-25 21:07:18,845 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 4.137045383453369, ACC: 0.6306936740875244
2023-07-25 21:07:30,017 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 4.232671737670898, ACC: 0.6160810589790344
2023-07-25 21:07:42,842 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 4.301562309265137, ACC: 0.6115825772285461
2023-07-25 21:07:55,963 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 4.440115928649902, ACC: 0.5962049961090088
2023-07-25 21:08:09,464 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 4.648495197296143, ACC: 0.5635707974433899
2023-07-25 21:08:21,307 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 4.853123664855957, ACC: 0.5110498666763306
2023-07-25 21:08:33,532 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 5.044071674346924, ACC: 0.46509313583374023
2023-07-25 21:08:33,620 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-RH500_30-timesteps_vis.h5
2023-07-25 21:09:26,883 - root - INFO - ------------------ Configuration ------------------
2023-07-25 21:09:26,883 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 21:09:26,883 - root - INFO - Configuration name: afno_backbone
2023-07-25 21:09:26,883 - root - INFO - log_to_wandb True
2023-07-25 21:09:26,883 - root - INFO - lr 0.0005
2023-07-25 21:09:26,883 - root - INFO - batch_size 64
2023-07-25 21:09:26,883 - root - INFO - max_epochs 150
2023-07-25 21:09:26,883 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 21:09:26,883 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 21:09:26,883 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 21:09:26,883 - root - INFO - orography False
2023-07-25 21:09:26,883 - root - INFO - orography_path None
2023-07-25 21:09:26,883 - root - INFO - exp_dir FourCastNet/results
2023-07-25 21:09:26,884 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 21:09:26,884 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 21:09:26,884 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 21:09:26,884 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 21:09:26,884 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 21:09:26,884 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 21:09:26,884 - root - INFO - loss l2
2023-07-25 21:09:26,884 - root - INFO - num_data_workers 4
2023-07-25 21:09:26,884 - root - INFO - dt 1
2023-07-25 21:09:26,884 - root - INFO - n_history 0
2023-07-25 21:09:26,884 - root - INFO - prediction_type iterative
2023-07-25 21:09:26,884 - root - INFO - prediction_length 30
2023-07-25 21:09:26,884 - root - INFO - n_initial_conditions 5
2023-07-25 21:09:26,884 - root - INFO - ics_type default
2023-07-25 21:09:26,884 - root - INFO - save_raw_forecasts True
2023-07-25 21:09:26,884 - root - INFO - save_channel False
2023-07-25 21:09:26,884 - root - INFO - masked_acc False
2023-07-25 21:09:26,884 - root - INFO - maskpath None
2023-07-25 21:09:26,884 - root - INFO - perturb False
2023-07-25 21:09:26,885 - root - INFO - add_grid False
2023-07-25 21:09:26,885 - root - INFO - N_grid_channels 0
2023-07-25 21:09:26,885 - root - INFO - gridtype sinusoidal
2023-07-25 21:09:26,885 - root - INFO - roll False
2023-07-25 21:09:26,885 - root - INFO - num_blocks 8
2023-07-25 21:09:26,885 - root - INFO - nettype afno
2023-07-25 21:09:26,885 - root - INFO - patch_size 8
2023-07-25 21:09:26,885 - root - INFO - width 56
2023-07-25 21:09:26,885 - root - INFO - modes 32
2023-07-25 21:09:26,885 - root - INFO - target Z1000
2023-07-25 21:09:26,885 - root - INFO - normalization zscore
2023-07-25 21:09:26,885 - root - INFO - log_to_screen True
2023-07-25 21:09:26,885 - root - INFO - save_checkpoint True
2023-07-25 21:09:26,885 - root - INFO - enable_nhwc False
2023-07-25 21:09:26,885 - root - INFO - optimizer_type FusedAdam
2023-07-25 21:09:26,885 - root - INFO - crop_size_x None
2023-07-25 21:09:26,885 - root - INFO - crop_size_y None
2023-07-25 21:09:26,885 - root - INFO - two_step_training False
2023-07-25 21:09:26,886 - root - INFO - plot_animations False
2023-07-25 21:09:26,886 - root - INFO - add_noise False
2023-07-25 21:09:26,886 - root - INFO - noise_std 0
2023-07-25 21:09:26,886 - root - INFO - world_size 1
2023-07-25 21:09:26,886 - root - INFO - interp 0
2023-07-25 21:09:26,886 - root - INFO - use_daily_climatology False
2023-07-25 21:09:26,886 - root - INFO - global_batch_size 64
2023-07-25 21:09:26,886 - root - INFO - ablate Z50
2023-07-25 21:09:26,886 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 21:09:26,886 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 21:09:26,886 - root - INFO - resuming False
2023-07-25 21:09:26,886 - root - INFO - local_rank 0
2023-07-25 21:09:26,886 - root - INFO - ---------------------------------------------------
2023-07-25 21:09:26,886 - root - INFO - Inference for 1 initial conditions
2023-07-25 21:09:27,196 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 21:09:27,197 - root - INFO - Number of samples per year: 1460
2023-07-25 21:09:27,197 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 21:09:27,197 - root - INFO - Delta t: 6 hours
2023-07-25 21:09:27,197 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 21:09:27,197 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 21:10:33,824 - root - INFO - Loading inference data
2023-07-25 21:10:33,824 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 21:10:34,058 - root - INFO - Initial condition 1 of 1
2023-07-25 21:10:34,887 - root - INFO - Extracting valid data from the first year
2023-07-25 21:13:10,746 - root - INFO - Standardizing data
2023-07-25 21:13:18,960 - root - INFO - Loading time means
2023-07-25 21:13:40,200 - root - INFO - Begin autoregressive inference
2023-07-25 21:13:50,734 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 21:14:01,113 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 0.7388325929641724, ACC: 0.987653911113739
2023-07-25 21:14:12,503 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 0.9979677200317383, ACC: 0.9773797392845154
2023-07-25 21:14:23,494 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 1.1170471906661987, ACC: 0.9715685248374939
2023-07-25 21:14:33,965 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 1.239664912223816, ACC: 0.9648372530937195
2023-07-25 21:14:43,660 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 1.3342927694320679, ACC: 0.9583120942115784
2023-07-25 21:14:54,018 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 1.4515286684036255, ACC: 0.950619101524353
2023-07-25 21:15:04,948 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 1.5686362981796265, ACC: 0.9419351816177368
2023-07-25 21:15:15,961 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 1.7262715101242065, ACC: 0.9315454959869385
2023-07-25 21:15:26,492 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 1.837586522102356, ACC: 0.9233863949775696
2023-07-25 21:15:37,011 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 1.958435297012329, ACC: 0.9177795052528381
2023-07-25 21:15:47,109 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 2.1055092811584473, ACC: 0.9073392748832703
2023-07-25 21:15:58,099 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 2.297415256500244, ACC: 0.890132486820221
2023-07-25 21:16:08,762 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 2.4835619926452637, ACC: 0.8742998838424683
2023-07-25 21:16:18,464 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 2.6427509784698486, ACC: 0.8585514426231384
2023-07-25 21:16:28,941 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 2.8118934631347656, ACC: 0.8371572494506836
2023-07-25 21:16:39,602 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 2.975114583969116, ACC: 0.8148686289787292
2023-07-25 21:16:50,897 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 3.0804412364959717, ACC: 0.7974549531936646
2023-07-25 21:17:01,774 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 3.182323455810547, ACC: 0.7750734686851501
2023-07-25 21:17:14,088 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 3.317993640899658, ACC: 0.7570825815200806
2023-07-25 21:17:24,270 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 3.469566583633423, ACC: 0.730866014957428
2023-07-25 21:17:35,290 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 3.628931999206543, ACC: 0.7054116129875183
2023-07-25 21:17:46,342 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 3.8428661823272705, ACC: 0.6693623661994934
2023-07-25 21:17:56,940 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 4.0970659255981445, ACC: 0.6263198256492615
2023-07-25 21:18:07,011 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 4.253950595855713, ACC: 0.5998616218566895
2023-07-25 21:18:17,637 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 4.332329273223877, ACC: 0.5927543640136719
2023-07-25 21:18:27,650 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 4.48427152633667, ACC: 0.574506938457489
2023-07-25 21:18:37,948 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 4.700562477111816, ACC: 0.5371681451797485
2023-07-25 21:18:47,496 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 4.830864906311035, ACC: 0.501293957233429
2023-07-25 21:18:57,727 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 4.910745620727539, ACC: 0.4843728542327881
2023-07-25 21:18:57,829 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-Z50_30-timesteps_vis.h5
2023-07-25 21:19:51,046 - root - INFO - ------------------ Configuration ------------------
2023-07-25 21:19:51,047 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 21:19:51,047 - root - INFO - Configuration name: afno_backbone
2023-07-25 21:19:51,047 - root - INFO - log_to_wandb True
2023-07-25 21:19:51,047 - root - INFO - lr 0.0005
2023-07-25 21:19:51,047 - root - INFO - batch_size 64
2023-07-25 21:19:51,047 - root - INFO - max_epochs 150
2023-07-25 21:19:51,047 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 21:19:51,047 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 21:19:51,047 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 21:19:51,047 - root - INFO - orography False
2023-07-25 21:19:51,047 - root - INFO - orography_path None
2023-07-25 21:19:51,047 - root - INFO - exp_dir FourCastNet/results
2023-07-25 21:19:51,047 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 21:19:51,047 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 21:19:51,047 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 21:19:51,047 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 21:19:51,047 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 21:19:51,048 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 21:19:51,048 - root - INFO - loss l2
2023-07-25 21:19:51,048 - root - INFO - num_data_workers 4
2023-07-25 21:19:51,048 - root - INFO - dt 1
2023-07-25 21:19:51,048 - root - INFO - n_history 0
2023-07-25 21:19:51,048 - root - INFO - prediction_type iterative
2023-07-25 21:19:51,048 - root - INFO - prediction_length 30
2023-07-25 21:19:51,048 - root - INFO - n_initial_conditions 5
2023-07-25 21:19:51,048 - root - INFO - ics_type default
2023-07-25 21:19:51,048 - root - INFO - save_raw_forecasts True
2023-07-25 21:19:51,048 - root - INFO - save_channel False
2023-07-25 21:19:51,048 - root - INFO - masked_acc False
2023-07-25 21:19:51,048 - root - INFO - maskpath None
2023-07-25 21:19:51,048 - root - INFO - perturb False
2023-07-25 21:19:51,048 - root - INFO - add_grid False
2023-07-25 21:19:51,048 - root - INFO - N_grid_channels 0
2023-07-25 21:19:51,048 - root - INFO - gridtype sinusoidal
2023-07-25 21:19:51,048 - root - INFO - roll False
2023-07-25 21:19:51,048 - root - INFO - num_blocks 8
2023-07-25 21:19:51,048 - root - INFO - nettype afno
2023-07-25 21:19:51,049 - root - INFO - patch_size 8
2023-07-25 21:19:51,049 - root - INFO - width 56
2023-07-25 21:19:51,049 - root - INFO - modes 32
2023-07-25 21:19:51,049 - root - INFO - target Z1000
2023-07-25 21:19:51,049 - root - INFO - normalization zscore
2023-07-25 21:19:51,049 - root - INFO - log_to_screen True
2023-07-25 21:19:51,049 - root - INFO - save_checkpoint True
2023-07-25 21:19:51,049 - root - INFO - enable_nhwc False
2023-07-25 21:19:51,049 - root - INFO - optimizer_type FusedAdam
2023-07-25 21:19:51,049 - root - INFO - crop_size_x None
2023-07-25 21:19:51,049 - root - INFO - crop_size_y None
2023-07-25 21:19:51,049 - root - INFO - two_step_training False
2023-07-25 21:19:51,049 - root - INFO - plot_animations False
2023-07-25 21:19:51,049 - root - INFO - add_noise False
2023-07-25 21:19:51,049 - root - INFO - noise_std 0
2023-07-25 21:19:51,049 - root - INFO - world_size 1
2023-07-25 21:19:51,049 - root - INFO - interp 0
2023-07-25 21:19:51,049 - root - INFO - use_daily_climatology False
2023-07-25 21:19:51,049 - root - INFO - global_batch_size 64
2023-07-25 21:19:51,049 - root - INFO - ablate TCWV
2023-07-25 21:19:51,049 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 21:19:51,050 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 21:19:51,050 - root - INFO - resuming False
2023-07-25 21:19:51,050 - root - INFO - local_rank 0
2023-07-25 21:19:51,050 - root - INFO - ---------------------------------------------------
2023-07-25 21:19:51,050 - root - INFO - Inference for 1 initial conditions
2023-07-25 21:19:51,385 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 21:19:51,386 - root - INFO - Number of samples per year: 1460
2023-07-25 21:19:51,386 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 21:19:51,386 - root - INFO - Delta t: 6 hours
2023-07-25 21:19:51,386 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 21:19:51,387 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 21:20:57,246 - root - INFO - Loading inference data
2023-07-25 21:20:57,247 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 21:20:57,508 - root - INFO - Initial condition 1 of 1
2023-07-25 21:20:58,386 - root - INFO - Extracting valid data from the first year
2023-07-25 21:23:20,705 - root - INFO - Standardizing data
2023-07-25 21:23:28,633 - root - INFO - Loading time means
2023-07-25 21:23:42,799 - root - INFO - Begin autoregressive inference
2023-07-25 21:23:53,175 - root - INFO - Predicted timestep 0 of 30. Z1000 RMS Error: 0.0, ACC: 1.0
2023-07-25 21:24:03,865 - root - INFO - Predicted timestep 1 of 30. Z1000 RMS Error: 2.138373374938965, ACC: 0.8931172490119934
2023-07-25 21:24:14,480 - root - INFO - Predicted timestep 2 of 30. Z1000 RMS Error: 3.1612045764923096, ACC: 0.7715680599212646
2023-07-25 21:24:25,203 - root - INFO - Predicted timestep 3 of 30. Z1000 RMS Error: 10.833768844604492, ACC: 0.32195547223091125
2023-07-25 21:24:35,258 - root - INFO - Predicted timestep 4 of 30. Z1000 RMS Error: 17.005693435668945, ACC: 0.20882010459899902
2023-07-25 21:24:45,842 - root - INFO - Predicted timestep 5 of 30. Z1000 RMS Error: 19.62957191467285, ACC: 0.1712193340063095
2023-07-25 21:24:56,453 - root - INFO - Predicted timestep 6 of 30. Z1000 RMS Error: 20.999361038208008, ACC: 0.14739792048931122
2023-07-25 21:25:06,862 - root - INFO - Predicted timestep 7 of 30. Z1000 RMS Error: 22.707563400268555, ACC: 0.12374243885278702
2023-07-25 21:25:18,270 - root - INFO - Predicted timestep 8 of 30. Z1000 RMS Error: 24.643388748168945, ACC: 0.1040501669049263
2023-07-25 21:25:29,155 - root - INFO - Predicted timestep 9 of 30. Z1000 RMS Error: 26.783872604370117, ACC: 0.09100182354450226
2023-07-25 21:25:40,366 - root - INFO - Predicted timestep 10 of 30. Z1000 RMS Error: 29.143817901611328, ACC: 0.07806672900915146
2023-07-25 21:25:50,607 - root - INFO - Predicted timestep 11 of 30. Z1000 RMS Error: 31.382068634033203, ACC: 0.06749418377876282
2023-07-25 21:26:00,633 - root - INFO - Predicted timestep 12 of 30. Z1000 RMS Error: 33.522525787353516, ACC: 0.05619916319847107
2023-07-25 21:26:11,044 - root - INFO - Predicted timestep 13 of 30. Z1000 RMS Error: 35.73700714111328, ACC: 0.05217617750167847
2023-07-25 21:26:20,966 - root - INFO - Predicted timestep 14 of 30. Z1000 RMS Error: 38.23370361328125, ACC: 0.044656381011009216
2023-07-25 21:26:31,895 - root - INFO - Predicted timestep 15 of 30. Z1000 RMS Error: 40.85321044921875, ACC: 0.03146711364388466
2023-07-25 21:26:42,540 - root - INFO - Predicted timestep 16 of 30. Z1000 RMS Error: 43.42735290527344, ACC: 0.024545859545469284
2023-07-25 21:26:53,013 - root - INFO - Predicted timestep 17 of 30. Z1000 RMS Error: 46.34342575073242, ACC: 0.016492363065481186
2023-07-25 21:27:04,104 - root - INFO - Predicted timestep 18 of 30. Z1000 RMS Error: 49.48079299926758, ACC: 0.012840368784964085
2023-07-25 21:27:14,905 - root - INFO - Predicted timestep 19 of 30. Z1000 RMS Error: 52.94873046875, ACC: 0.006486464757472277
2023-07-25 21:27:24,644 - root - INFO - Predicted timestep 20 of 30. Z1000 RMS Error: 56.98868179321289, ACC: 0.0012138938764110208
2023-07-25 21:27:35,150 - root - INFO - Predicted timestep 21 of 30. Z1000 RMS Error: 62.413761138916016, ACC: 0.0027869499754160643
2023-07-25 21:27:45,617 - root - INFO - Predicted timestep 22 of 30. Z1000 RMS Error: 70.92173767089844, ACC: 0.006346723530441523
2023-07-25 21:27:55,776 - root - INFO - Predicted timestep 23 of 30. Z1000 RMS Error: 88.21456909179688, ACC: 0.0344398133456707
2023-07-25 21:28:07,078 - root - INFO - Predicted timestep 24 of 30. Z1000 RMS Error: 126.48676300048828, ACC: 0.05982277914881706
2023-07-25 21:28:17,690 - root - INFO - Predicted timestep 25 of 30. Z1000 RMS Error: 173.27813720703125, ACC: 0.07246452569961548
2023-07-25 21:28:27,937 - root - INFO - Predicted timestep 26 of 30. Z1000 RMS Error: 207.04428100585938, ACC: 0.0735381543636322
2023-07-25 21:28:38,013 - root - INFO - Predicted timestep 27 of 30. Z1000 RMS Error: 226.78353881835938, ACC: 0.07307872921228409
2023-07-25 21:28:48,405 - root - INFO - Predicted timestep 28 of 30. Z1000 RMS Error: 240.1091766357422, ACC: 0.050323735922575
2023-07-25 21:28:58,618 - root - INFO - Predicted timestep 29 of 30. Z1000 RMS Error: 252.114013671875, ACC: 0.039205774664878845
2023-07-25 21:28:58,712 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z1000_ablate-TCWV_30-timesteps_vis.h5
2023-07-25 21:29:51,871 - root - INFO - ------------------ Configuration ------------------
2023-07-25 21:29:51,872 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 21:29:51,872 - root - INFO - Configuration name: afno_backbone
2023-07-25 21:29:51,872 - root - INFO - log_to_wandb True
2023-07-25 21:29:51,872 - root - INFO - lr 0.0005
2023-07-25 21:29:51,872 - root - INFO - batch_size 64
2023-07-25 21:29:51,872 - root - INFO - max_epochs 150
2023-07-25 21:29:51,872 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 21:29:51,872 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 21:29:51,872 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 21:29:51,872 - root - INFO - orography False
2023-07-25 21:29:51,872 - root - INFO - orography_path None
2023-07-25 21:29:51,872 - root - INFO - exp_dir FourCastNet/results
2023-07-25 21:29:51,872 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 21:29:51,872 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 21:29:51,872 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 21:29:51,872 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 21:29:51,872 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 21:29:51,872 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 21:29:51,872 - root - INFO - loss l2
2023-07-25 21:29:51,872 - root - INFO - num_data_workers 4
2023-07-25 21:29:51,873 - root - INFO - dt 1
2023-07-25 21:29:51,873 - root - INFO - n_history 0
2023-07-25 21:29:51,873 - root - INFO - prediction_type iterative
2023-07-25 21:29:51,873 - root - INFO - prediction_length 30
2023-07-25 21:29:51,873 - root - INFO - n_initial_conditions 5
2023-07-25 21:29:51,873 - root - INFO - ics_type default
2023-07-25 21:29:51,873 - root - INFO - save_raw_forecasts True
2023-07-25 21:29:51,873 - root - INFO - save_channel False
2023-07-25 21:29:51,873 - root - INFO - masked_acc False
2023-07-25 21:29:51,873 - root - INFO - maskpath None
2023-07-25 21:29:51,873 - root - INFO - perturb False
2023-07-25 21:29:51,873 - root - INFO - add_grid False
2023-07-25 21:29:51,873 - root - INFO - N_grid_channels 0
2023-07-25 21:29:51,873 - root - INFO - gridtype sinusoidal
2023-07-25 21:29:51,873 - root - INFO - roll False
2023-07-25 21:29:51,873 - root - INFO - num_blocks 8
2023-07-25 21:29:51,873 - root - INFO - nettype afno
2023-07-25 21:29:51,873 - root - INFO - patch_size 8
2023-07-25 21:29:51,873 - root - INFO - width 56
2023-07-25 21:29:51,873 - root - INFO - modes 32
2023-07-25 21:29:51,874 - root - INFO - target Z850
2023-07-25 21:29:51,874 - root - INFO - normalization zscore
2023-07-25 21:29:51,874 - root - INFO - log_to_screen True
2023-07-25 21:29:51,874 - root - INFO - save_checkpoint True
2023-07-25 21:29:51,874 - root - INFO - enable_nhwc False
2023-07-25 21:29:51,874 - root - INFO - optimizer_type FusedAdam
2023-07-25 21:29:51,874 - root - INFO - crop_size_x None
2023-07-25 21:29:51,874 - root - INFO - crop_size_y None
2023-07-25 21:29:51,874 - root - INFO - two_step_training False
2023-07-25 21:29:51,874 - root - INFO - plot_animations False
2023-07-25 21:29:51,874 - root - INFO - add_noise False
2023-07-25 21:29:51,874 - root - INFO - noise_std 0
2023-07-25 21:29:51,874 - root - INFO - world_size 1
2023-07-25 21:29:51,874 - root - INFO - interp 0
2023-07-25 21:29:51,874 - root - INFO - use_daily_climatology False
2023-07-25 21:29:51,874 - root - INFO - global_batch_size 64
2023-07-25 21:29:51,874 - root - INFO - ablate U10
2023-07-25 21:29:51,874 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 21:29:51,874 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 21:29:51,874 - root - INFO - resuming False
2023-07-25 21:29:51,875 - root - INFO - local_rank 0
2023-07-25 21:29:51,875 - root - INFO - ---------------------------------------------------
2023-07-25 21:29:51,875 - root - INFO - Inference for 1 initial conditions
2023-07-25 21:29:52,196 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 21:29:52,197 - root - INFO - Number of samples per year: 1460
2023-07-25 21:29:52,197 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 21:29:52,197 - root - INFO - Delta t: 6 hours
2023-07-25 21:29:52,197 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 21:29:52,197 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 21:30:59,798 - root - INFO - Loading inference data
2023-07-25 21:30:59,800 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 21:31:00,022 - root - INFO - Initial condition 1 of 1
2023-07-25 21:31:00,842 - root - INFO - Extracting valid data from the first year
2023-07-25 21:33:17,010 - root - INFO - Standardizing data
2023-07-25 21:33:25,715 - root - INFO - Loading time means
2023-07-25 21:33:40,265 - root - INFO - Begin autoregressive inference
2023-07-25 21:33:51,177 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 21:34:03,035 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 110.87027740478516, ACC: 0.9835966229438782
2023-07-25 21:34:13,924 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 164.1444091796875, ACC: 0.9656603336334229
2023-07-25 21:34:25,379 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 242.6238250732422, ACC: 0.9317682385444641
2023-07-25 21:34:37,140 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 410.8665771484375, ACC: 0.8267177939414978
2023-07-25 21:34:48,344 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 710.607177734375, ACC: 0.6468265652656555
2023-07-25 21:34:59,539 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 1024.4464111328125, ACC: 0.49565789103507996
2023-07-25 21:35:10,965 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 1305.50732421875, ACC: 0.40565240383148193
2023-07-25 21:35:21,636 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 1561.4974365234375, ACC: 0.3418697416782379
2023-07-25 21:35:32,258 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 1805.469970703125, ACC: 0.2909790575504303
2023-07-25 21:35:42,964 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 2024.4827880859375, ACC: 0.25203850865364075
2023-07-25 21:35:54,159 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 2222.86865234375, ACC: 0.21483060717582703
2023-07-25 21:36:04,862 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 2424.562255859375, ACC: 0.17715279757976532
2023-07-25 21:36:16,905 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 2623.72802734375, ACC: 0.1338459700345993
2023-07-25 21:36:27,453 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 2831.798828125, ACC: 0.09899381548166275
2023-07-25 21:36:38,355 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 3045.530029296875, ACC: 0.05717978626489639
2023-07-25 21:36:49,851 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 3267.69775390625, ACC: 0.02698664180934429
2023-07-25 21:37:01,262 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 3490.12158203125, ACC: -0.00844261609017849
2023-07-25 21:37:14,335 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 3707.6220703125, ACC: -0.02853860706090927
2023-07-25 21:37:25,391 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 3929.92041015625, ACC: -0.058034561574459076
2023-07-25 21:37:36,693 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 4163.2861328125, ACC: -0.0647660419344902
2023-07-25 21:37:46,653 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 4398.79345703125, ACC: -0.07985527813434601
2023-07-25 21:37:57,466 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 4635.96435546875, ACC: -0.06931204348802567
2023-07-25 21:38:08,501 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 4884.5732421875, ACC: -0.07155635207891464
2023-07-25 21:38:18,654 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 5143.4287109375, ACC: -0.06228063628077507
2023-07-25 21:38:30,800 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 5427.4716796875, ACC: -0.07432059198617935
2023-07-25 21:38:41,662 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 5708.81201171875, ACC: -0.06807994842529297
2023-07-25 21:38:53,243 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 6017.49658203125, ACC: -0.08200634270906448
2023-07-25 21:39:04,461 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 6336.359375, ACC: -0.09120164066553116
2023-07-25 21:39:16,067 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 6674.24462890625, ACC: -0.10705944150686264
2023-07-25 21:39:16,164 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-U10_30-timesteps_vis.h5
2023-07-25 21:40:09,628 - root - INFO - ------------------ Configuration ------------------
2023-07-25 21:40:09,628 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 21:40:09,628 - root - INFO - Configuration name: afno_backbone
2023-07-25 21:40:09,628 - root - INFO - log_to_wandb True
2023-07-25 21:40:09,628 - root - INFO - lr 0.0005
2023-07-25 21:40:09,628 - root - INFO - batch_size 64
2023-07-25 21:40:09,628 - root - INFO - max_epochs 150
2023-07-25 21:40:09,628 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 21:40:09,628 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 21:40:09,629 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 21:40:09,629 - root - INFO - orography False
2023-07-25 21:40:09,629 - root - INFO - orography_path None
2023-07-25 21:40:09,629 - root - INFO - exp_dir FourCastNet/results
2023-07-25 21:40:09,629 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 21:40:09,629 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 21:40:09,629 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 21:40:09,629 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 21:40:09,629 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 21:40:09,629 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 21:40:09,629 - root - INFO - loss l2
2023-07-25 21:40:09,629 - root - INFO - num_data_workers 4
2023-07-25 21:40:09,629 - root - INFO - dt 1
2023-07-25 21:40:09,629 - root - INFO - n_history 0
2023-07-25 21:40:09,629 - root - INFO - prediction_type iterative
2023-07-25 21:40:09,629 - root - INFO - prediction_length 30
2023-07-25 21:40:09,630 - root - INFO - n_initial_conditions 5
2023-07-25 21:40:09,630 - root - INFO - ics_type default
2023-07-25 21:40:09,630 - root - INFO - save_raw_forecasts True
2023-07-25 21:40:09,630 - root - INFO - save_channel False
2023-07-25 21:40:09,630 - root - INFO - masked_acc False
2023-07-25 21:40:09,630 - root - INFO - maskpath None
2023-07-25 21:40:09,630 - root - INFO - perturb False
2023-07-25 21:40:09,630 - root - INFO - add_grid False
2023-07-25 21:40:09,630 - root - INFO - N_grid_channels 0
2023-07-25 21:40:09,630 - root - INFO - gridtype sinusoidal
2023-07-25 21:40:09,630 - root - INFO - roll False
2023-07-25 21:40:09,630 - root - INFO - num_blocks 8
2023-07-25 21:40:09,630 - root - INFO - nettype afno
2023-07-25 21:40:09,630 - root - INFO - patch_size 8
2023-07-25 21:40:09,630 - root - INFO - width 56
2023-07-25 21:40:09,630 - root - INFO - modes 32
2023-07-25 21:40:09,630 - root - INFO - target Z850
2023-07-25 21:40:09,630 - root - INFO - normalization zscore
2023-07-25 21:40:09,630 - root - INFO - log_to_screen True
2023-07-25 21:40:09,631 - root - INFO - save_checkpoint True
2023-07-25 21:40:09,631 - root - INFO - enable_nhwc False
2023-07-25 21:40:09,631 - root - INFO - optimizer_type FusedAdam
2023-07-25 21:40:09,631 - root - INFO - crop_size_x None
2023-07-25 21:40:09,631 - root - INFO - crop_size_y None
2023-07-25 21:40:09,631 - root - INFO - two_step_training False
2023-07-25 21:40:09,631 - root - INFO - plot_animations False
2023-07-25 21:40:09,631 - root - INFO - add_noise False
2023-07-25 21:40:09,631 - root - INFO - noise_std 0
2023-07-25 21:40:09,631 - root - INFO - world_size 1
2023-07-25 21:40:09,631 - root - INFO - interp 0
2023-07-25 21:40:09,631 - root - INFO - use_daily_climatology False
2023-07-25 21:40:09,631 - root - INFO - global_batch_size 64
2023-07-25 21:40:09,631 - root - INFO - ablate V10
2023-07-25 21:40:09,631 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 21:40:09,631 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 21:40:09,631 - root - INFO - resuming False
2023-07-25 21:40:09,631 - root - INFO - local_rank 0
2023-07-25 21:40:09,631 - root - INFO - ---------------------------------------------------
2023-07-25 21:40:09,632 - root - INFO - Inference for 1 initial conditions
2023-07-25 21:40:09,881 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 21:40:09,882 - root - INFO - Number of samples per year: 1460
2023-07-25 21:40:09,882 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 21:40:09,882 - root - INFO - Delta t: 6 hours
2023-07-25 21:40:09,882 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 21:40:09,883 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 21:41:13,380 - root - INFO - Loading inference data
2023-07-25 21:41:13,382 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 21:41:13,588 - root - INFO - Initial condition 1 of 1
2023-07-25 21:41:14,539 - root - INFO - Extracting valid data from the first year
2023-07-25 21:43:32,446 - root - INFO - Standardizing data
2023-07-25 21:43:40,398 - root - INFO - Loading time means
2023-07-25 21:43:56,824 - root - INFO - Begin autoregressive inference
2023-07-25 21:44:06,812 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 21:44:17,732 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 42.90283203125, ACC: 0.997529149055481
2023-07-25 21:44:28,455 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 47.646148681640625, ACC: 0.9969976544380188
2023-07-25 21:44:38,459 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 53.816322326660156, ACC: 0.9963228106498718
2023-07-25 21:44:48,897 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 68.50072479248047, ACC: 0.9938804507255554
2023-07-25 21:44:59,100 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 78.76311492919922, ACC: 0.9921055436134338
2023-07-25 21:45:10,445 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 92.361572265625, ACC: 0.9894245266914368
2023-07-25 21:45:21,852 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 98.9446792602539, ACC: 0.9883829355239868
2023-07-25 21:45:34,409 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 110.15845489501953, ACC: 0.9855647683143616
2023-07-25 21:45:45,282 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 123.81669616699219, ACC: 0.9824251532554626
2023-07-25 21:45:56,297 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 134.16661071777344, ACC: 0.9795411825180054
2023-07-25 21:46:08,353 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 142.17710876464844, ACC: 0.9768073558807373
2023-07-25 21:46:20,199 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 156.6580047607422, ACC: 0.9711640477180481
2023-07-25 21:46:31,575 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 177.4503936767578, ACC: 0.9627386927604675
2023-07-25 21:46:42,087 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 197.9220428466797, ACC: 0.9534105658531189
2023-07-25 21:46:52,683 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 214.29478454589844, ACC: 0.9456824064254761
2023-07-25 21:47:03,094 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 235.0952911376953, ACC: 0.9345825910568237
2023-07-25 21:47:14,836 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 252.43153381347656, ACC: 0.9244236350059509
2023-07-25 21:47:25,017 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 265.5660095214844, ACC: 0.9161732196807861
2023-07-25 21:47:35,851 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 274.9422912597656, ACC: 0.9086008071899414
2023-07-25 21:47:45,845 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 285.50677490234375, ACC: 0.8971055150032043
2023-07-25 21:47:56,230 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 295.16876220703125, ACC: 0.8892029523849487
2023-07-25 21:48:07,389 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 309.01654052734375, ACC: 0.8764945864677429
2023-07-25 21:48:18,180 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 324.4669189453125, ACC: 0.8642273545265198
2023-07-25 21:48:28,709 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 345.86749267578125, ACC: 0.8438896536827087
2023-07-25 21:48:38,851 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 368.5375671386719, ACC: 0.8307323455810547
2023-07-25 21:48:48,984 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 392.1924133300781, ACC: 0.8100401759147644
2023-07-25 21:48:58,670 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 419.57696533203125, ACC: 0.7900524735450745
2023-07-25 21:49:09,278 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 454.9991455078125, ACC: 0.7600997090339661
2023-07-25 21:49:20,924 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 489.42462158203125, ACC: 0.7251257300376892
2023-07-25 21:49:21,024 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-V10_30-timesteps_vis.h5
2023-07-25 21:50:15,244 - root - INFO - ------------------ Configuration ------------------
2023-07-25 21:50:15,244 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 21:50:15,244 - root - INFO - Configuration name: afno_backbone
2023-07-25 21:50:15,244 - root - INFO - log_to_wandb True
2023-07-25 21:50:15,244 - root - INFO - lr 0.0005
2023-07-25 21:50:15,244 - root - INFO - batch_size 64
2023-07-25 21:50:15,244 - root - INFO - max_epochs 150
2023-07-25 21:50:15,244 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 21:50:15,244 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 21:50:15,244 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 21:50:15,244 - root - INFO - orography False
2023-07-25 21:50:15,244 - root - INFO - orography_path None
2023-07-25 21:50:15,245 - root - INFO - exp_dir FourCastNet/results
2023-07-25 21:50:15,245 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 21:50:15,245 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 21:50:15,245 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 21:50:15,245 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 21:50:15,245 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 21:50:15,245 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 21:50:15,245 - root - INFO - loss l2
2023-07-25 21:50:15,245 - root - INFO - num_data_workers 4
2023-07-25 21:50:15,245 - root - INFO - dt 1
2023-07-25 21:50:15,245 - root - INFO - n_history 0
2023-07-25 21:50:15,245 - root - INFO - prediction_type iterative
2023-07-25 21:50:15,245 - root - INFO - prediction_length 30
2023-07-25 21:50:15,245 - root - INFO - n_initial_conditions 5
2023-07-25 21:50:15,245 - root - INFO - ics_type default
2023-07-25 21:50:15,245 - root - INFO - save_raw_forecasts True
2023-07-25 21:50:15,245 - root - INFO - save_channel False
2023-07-25 21:50:15,245 - root - INFO - masked_acc False
2023-07-25 21:50:15,245 - root - INFO - maskpath None
2023-07-25 21:50:15,245 - root - INFO - perturb False
2023-07-25 21:50:15,246 - root - INFO - add_grid False
2023-07-25 21:50:15,246 - root - INFO - N_grid_channels 0
2023-07-25 21:50:15,246 - root - INFO - gridtype sinusoidal
2023-07-25 21:50:15,246 - root - INFO - roll False
2023-07-25 21:50:15,246 - root - INFO - num_blocks 8
2023-07-25 21:50:15,246 - root - INFO - nettype afno
2023-07-25 21:50:15,246 - root - INFO - patch_size 8
2023-07-25 21:50:15,246 - root - INFO - width 56
2023-07-25 21:50:15,246 - root - INFO - modes 32
2023-07-25 21:50:15,246 - root - INFO - target Z850
2023-07-25 21:50:15,246 - root - INFO - normalization zscore
2023-07-25 21:50:15,246 - root - INFO - log_to_screen True
2023-07-25 21:50:15,246 - root - INFO - save_checkpoint True
2023-07-25 21:50:15,246 - root - INFO - enable_nhwc False
2023-07-25 21:50:15,246 - root - INFO - optimizer_type FusedAdam
2023-07-25 21:50:15,246 - root - INFO - crop_size_x None
2023-07-25 21:50:15,246 - root - INFO - crop_size_y None
2023-07-25 21:50:15,246 - root - INFO - two_step_training False
2023-07-25 21:50:15,246 - root - INFO - plot_animations False
2023-07-25 21:50:15,246 - root - INFO - add_noise False
2023-07-25 21:50:15,247 - root - INFO - noise_std 0
2023-07-25 21:50:15,247 - root - INFO - world_size 1
2023-07-25 21:50:15,247 - root - INFO - interp 0
2023-07-25 21:50:15,247 - root - INFO - use_daily_climatology False
2023-07-25 21:50:15,247 - root - INFO - global_batch_size 64
2023-07-25 21:50:15,247 - root - INFO - ablate T2m
2023-07-25 21:50:15,247 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 21:50:15,247 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 21:50:15,247 - root - INFO - resuming False
2023-07-25 21:50:15,247 - root - INFO - local_rank 0
2023-07-25 21:50:15,247 - root - INFO - ---------------------------------------------------
2023-07-25 21:50:15,247 - root - INFO - Inference for 1 initial conditions
2023-07-25 21:50:15,458 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 21:50:15,458 - root - INFO - Number of samples per year: 1460
2023-07-25 21:50:15,459 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 21:50:15,459 - root - INFO - Delta t: 6 hours
2023-07-25 21:50:15,459 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 21:50:15,459 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 21:51:20,336 - root - INFO - Loading inference data
2023-07-25 21:51:20,337 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 21:51:20,528 - root - INFO - Initial condition 1 of 1
2023-07-25 21:51:21,393 - root - INFO - Extracting valid data from the first year
2023-07-25 21:53:30,910 - root - INFO - Standardizing data
2023-07-25 21:53:38,942 - root - INFO - Loading time means
2023-07-25 21:53:51,883 - root - INFO - Begin autoregressive inference
2023-07-25 21:54:01,939 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 21:54:12,493 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 706.6951293945312, ACC: 0.5898306369781494
2023-07-25 21:54:23,422 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 3883.530517578125, ACC: 0.10413255542516708
2023-07-25 21:54:33,991 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 7486.22705078125, ACC: 0.05832107737660408
2023-07-25 21:54:44,007 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 11686.50390625, ACC: 0.012308003380894661
2023-07-25 21:54:54,620 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 16906.48828125, ACC: -0.02863745391368866
2023-07-25 21:55:06,072 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 22549.9375, ACC: -0.05373421683907509
2023-07-25 21:55:18,338 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 27869.369140625, ACC: -0.06153314560651779
2023-07-25 21:55:30,227 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 32391.775390625, ACC: -0.0741979107260704
2023-07-25 21:55:41,906 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 35946.94921875, ACC: -0.08064078539609909
2023-07-25 21:55:53,468 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 38593.6953125, ACC: -0.08146855980157852
2023-07-25 21:56:05,174 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 40495.7890625, ACC: -0.08189591765403748
2023-07-25 21:56:15,971 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 41834.33984375, ACC: -0.08784085512161255
2023-07-25 21:56:26,748 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 42760.5390625, ACC: -0.09249603748321533
2023-07-25 21:56:38,134 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 43389.171875, ACC: -0.08896824717521667
2023-07-25 21:56:49,983 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 43817.17578125, ACC: -0.08698399364948273
2023-07-25 21:57:01,729 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 44110.41015625, ACC: -0.08953765779733658
2023-07-25 21:57:12,463 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 44312.5078125, ACC: -0.09516878426074982
2023-07-25 21:57:24,524 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 44446.30078125, ACC: -0.09248563647270203
2023-07-25 21:57:35,260 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 44537.62109375, ACC: -0.09044188261032104
2023-07-25 21:57:46,551 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 44603.42578125, ACC: -0.09454718977212906
2023-07-25 21:57:58,509 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 44651.37890625, ACC: -0.09951667487621307
2023-07-25 21:58:10,832 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 44679.60546875, ACC: -0.09508853405714035
2023-07-25 21:58:22,364 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 44700.4609375, ACC: -0.09279169887304306
2023-07-25 21:58:33,846 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 44716.12890625, ACC: -0.09281563758850098
2023-07-25 21:58:44,930 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 44729.63671875, ACC: -0.0934004858136177
2023-07-25 21:58:57,446 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 44733.7734375, ACC: -0.0864088237285614
2023-07-25 21:59:08,374 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 44737.390625, ACC: -0.08113498985767365
2023-07-25 21:59:18,942 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 44742.68359375, ACC: -0.08068880438804626
2023-07-25 21:59:29,139 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 44748.30078125, ACC: -0.08352980017662048
2023-07-25 21:59:29,259 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-T2m_30-timesteps_vis.h5
2023-07-25 22:00:23,027 - root - INFO - ------------------ Configuration ------------------
2023-07-25 22:00:23,027 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 22:00:23,027 - root - INFO - Configuration name: afno_backbone
2023-07-25 22:00:23,027 - root - INFO - log_to_wandb True
2023-07-25 22:00:23,027 - root - INFO - lr 0.0005
2023-07-25 22:00:23,027 - root - INFO - batch_size 64
2023-07-25 22:00:23,027 - root - INFO - max_epochs 150
2023-07-25 22:00:23,027 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 22:00:23,027 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 22:00:23,028 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 22:00:23,028 - root - INFO - orography False
2023-07-25 22:00:23,028 - root - INFO - orography_path None
2023-07-25 22:00:23,028 - root - INFO - exp_dir FourCastNet/results
2023-07-25 22:00:23,028 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 22:00:23,028 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 22:00:23,028 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 22:00:23,028 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 22:00:23,028 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 22:00:23,028 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 22:00:23,028 - root - INFO - loss l2
2023-07-25 22:00:23,028 - root - INFO - num_data_workers 4
2023-07-25 22:00:23,028 - root - INFO - dt 1
2023-07-25 22:00:23,028 - root - INFO - n_history 0
2023-07-25 22:00:23,028 - root - INFO - prediction_type iterative
2023-07-25 22:00:23,028 - root - INFO - prediction_length 30
2023-07-25 22:00:23,028 - root - INFO - n_initial_conditions 5
2023-07-25 22:00:23,029 - root - INFO - ics_type default
2023-07-25 22:00:23,029 - root - INFO - save_raw_forecasts True
2023-07-25 22:00:23,029 - root - INFO - save_channel False
2023-07-25 22:00:23,029 - root - INFO - masked_acc False
2023-07-25 22:00:23,029 - root - INFO - maskpath None
2023-07-25 22:00:23,029 - root - INFO - perturb False
2023-07-25 22:00:23,029 - root - INFO - add_grid False
2023-07-25 22:00:23,029 - root - INFO - N_grid_channels 0
2023-07-25 22:00:23,029 - root - INFO - gridtype sinusoidal
2023-07-25 22:00:23,029 - root - INFO - roll False
2023-07-25 22:00:23,029 - root - INFO - num_blocks 8
2023-07-25 22:00:23,029 - root - INFO - nettype afno
2023-07-25 22:00:23,029 - root - INFO - patch_size 8
2023-07-25 22:00:23,029 - root - INFO - width 56
2023-07-25 22:00:23,029 - root - INFO - modes 32
2023-07-25 22:00:23,029 - root - INFO - target Z850
2023-07-25 22:00:23,029 - root - INFO - normalization zscore
2023-07-25 22:00:23,029 - root - INFO - log_to_screen True
2023-07-25 22:00:23,029 - root - INFO - save_checkpoint True
2023-07-25 22:00:23,030 - root - INFO - enable_nhwc False
2023-07-25 22:00:23,030 - root - INFO - optimizer_type FusedAdam
2023-07-25 22:00:23,030 - root - INFO - crop_size_x None
2023-07-25 22:00:23,030 - root - INFO - crop_size_y None
2023-07-25 22:00:23,030 - root - INFO - two_step_training False
2023-07-25 22:00:23,030 - root - INFO - plot_animations False
2023-07-25 22:00:23,030 - root - INFO - add_noise False
2023-07-25 22:00:23,030 - root - INFO - noise_std 0
2023-07-25 22:00:23,030 - root - INFO - world_size 1
2023-07-25 22:00:23,030 - root - INFO - interp 0
2023-07-25 22:00:23,030 - root - INFO - use_daily_climatology False
2023-07-25 22:00:23,030 - root - INFO - global_batch_size 64
2023-07-25 22:00:23,030 - root - INFO - ablate sp
2023-07-25 22:00:23,030 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 22:00:23,030 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 22:00:23,030 - root - INFO - resuming False
2023-07-25 22:00:23,030 - root - INFO - local_rank 0
2023-07-25 22:00:23,030 - root - INFO - ---------------------------------------------------
2023-07-25 22:00:23,030 - root - INFO - Inference for 1 initial conditions
2023-07-25 22:00:23,275 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 22:00:23,276 - root - INFO - Number of samples per year: 1460
2023-07-25 22:00:23,276 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 22:00:23,276 - root - INFO - Delta t: 6 hours
2023-07-25 22:00:23,276 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 22:00:23,276 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 22:01:27,939 - root - INFO - Loading inference data
2023-07-25 22:01:27,940 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 22:01:28,215 - root - INFO - Initial condition 1 of 1
2023-07-25 22:01:29,013 - root - INFO - Extracting valid data from the first year
2023-07-25 22:03:45,248 - root - INFO - Standardizing data
2023-07-25 22:03:53,755 - root - INFO - Loading time means
2023-07-25 22:04:06,170 - root - INFO - Begin autoregressive inference
2023-07-25 22:04:17,354 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 22:04:29,619 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 104.44993591308594, ACC: 0.9866421222686768
2023-07-25 22:04:41,742 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 179.97714233398438, ACC: 0.9584375619888306
2023-07-25 22:04:52,780 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 248.7437744140625, ACC: 0.9183995723724365
2023-07-25 22:05:03,828 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 311.6619567871094, ACC: 0.861997127532959
2023-07-25 22:05:15,060 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 394.67144775390625, ACC: 0.7772459983825684
2023-07-25 22:05:26,580 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 502.7738342285156, ACC: 0.6512608528137207
2023-07-25 22:05:38,450 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 597.4698486328125, ACC: 0.559787392616272
2023-07-25 22:05:49,985 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 686.3762817382812, ACC: 0.4649532735347748
2023-07-25 22:06:02,204 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 764.4315795898438, ACC: 0.4039626121520996
2023-07-25 22:06:13,987 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 828.2869873046875, ACC: 0.3386270999908447
2023-07-25 22:06:24,305 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 871.0286865234375, ACC: 0.30869734287261963
2023-07-25 22:06:35,626 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 917.8775634765625, ACC: 0.2684263586997986
2023-07-25 22:06:47,481 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 977.183349609375, ACC: 0.23363839089870453
2023-07-25 22:06:58,794 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 1048.2691650390625, ACC: 0.1779366135597229
2023-07-25 22:07:10,555 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 1107.999755859375, ACC: 0.1608445793390274
2023-07-25 22:07:22,043 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 1167.7701416015625, ACC: 0.1317058503627777
2023-07-25 22:07:33,266 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 1223.0130615234375, ACC: 0.11433909088373184
2023-07-25 22:07:45,735 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 1279.446044921875, ACC: 0.08683251589536667
2023-07-25 22:07:56,514 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 1319.6441650390625, ACC: 0.09710094332695007
2023-07-25 22:08:08,756 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 1359.7393798828125, ACC: 0.09667135775089264
2023-07-25 22:08:19,590 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 1409.2784423828125, ACC: 0.09527183324098587
2023-07-25 22:08:31,589 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 1451.542724609375, ACC: 0.0879444107413292
2023-07-25 22:08:43,438 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 1475.7664794921875, ACC: 0.11093270033597946
2023-07-25 22:08:54,117 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 1493.370361328125, ACC: 0.12189074605703354
2023-07-25 22:09:05,904 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 1522.40966796875, ACC: 0.1261506974697113
2023-07-25 22:09:16,778 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 1551.08154296875, ACC: 0.12436436116695404
2023-07-25 22:09:27,693 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 1584.8704833984375, ACC: 0.13765251636505127
2023-07-25 22:09:38,554 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 1632.487548828125, ACC: 0.13649989664554596
2023-07-25 22:09:49,513 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 1686.0789794921875, ACC: 0.12901823222637177
2023-07-25 22:09:49,607 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-sp_30-timesteps_vis.h5
2023-07-25 22:10:42,799 - root - INFO - ------------------ Configuration ------------------
2023-07-25 22:10:42,799 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 22:10:42,799 - root - INFO - Configuration name: afno_backbone
2023-07-25 22:10:42,799 - root - INFO - log_to_wandb True
2023-07-25 22:10:42,799 - root - INFO - lr 0.0005
2023-07-25 22:10:42,799 - root - INFO - batch_size 64
2023-07-25 22:10:42,799 - root - INFO - max_epochs 150
2023-07-25 22:10:42,799 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 22:10:42,799 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 22:10:42,799 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 22:10:42,799 - root - INFO - orography False
2023-07-25 22:10:42,800 - root - INFO - orography_path None
2023-07-25 22:10:42,800 - root - INFO - exp_dir FourCastNet/results
2023-07-25 22:10:42,800 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 22:10:42,800 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 22:10:42,800 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 22:10:42,800 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 22:10:42,800 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 22:10:42,800 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 22:10:42,800 - root - INFO - loss l2
2023-07-25 22:10:42,800 - root - INFO - num_data_workers 4
2023-07-25 22:10:42,800 - root - INFO - dt 1
2023-07-25 22:10:42,801 - root - INFO - n_history 0
2023-07-25 22:10:42,801 - root - INFO - prediction_type iterative
2023-07-25 22:10:42,801 - root - INFO - prediction_length 30
2023-07-25 22:10:42,801 - root - INFO - n_initial_conditions 5
2023-07-25 22:10:42,801 - root - INFO - ics_type default
2023-07-25 22:10:42,801 - root - INFO - save_raw_forecasts True
2023-07-25 22:10:42,801 - root - INFO - save_channel False
2023-07-25 22:10:42,801 - root - INFO - masked_acc False
2023-07-25 22:10:42,801 - root - INFO - maskpath None
2023-07-25 22:10:42,801 - root - INFO - perturb False
2023-07-25 22:10:42,801 - root - INFO - add_grid False
2023-07-25 22:10:42,801 - root - INFO - N_grid_channels 0
2023-07-25 22:10:42,801 - root - INFO - gridtype sinusoidal
2023-07-25 22:10:42,801 - root - INFO - roll False
2023-07-25 22:10:42,801 - root - INFO - num_blocks 8
2023-07-25 22:10:42,801 - root - INFO - nettype afno
2023-07-25 22:10:42,801 - root - INFO - patch_size 8
2023-07-25 22:10:42,801 - root - INFO - width 56
2023-07-25 22:10:42,801 - root - INFO - modes 32
2023-07-25 22:10:42,802 - root - INFO - target Z850
2023-07-25 22:10:42,802 - root - INFO - normalization zscore
2023-07-25 22:10:42,802 - root - INFO - log_to_screen True
2023-07-25 22:10:42,802 - root - INFO - save_checkpoint True
2023-07-25 22:10:42,802 - root - INFO - enable_nhwc False
2023-07-25 22:10:42,802 - root - INFO - optimizer_type FusedAdam
2023-07-25 22:10:42,802 - root - INFO - crop_size_x None
2023-07-25 22:10:42,802 - root - INFO - crop_size_y None
2023-07-25 22:10:42,802 - root - INFO - two_step_training False
2023-07-25 22:10:42,802 - root - INFO - plot_animations False
2023-07-25 22:10:42,802 - root - INFO - add_noise False
2023-07-25 22:10:42,802 - root - INFO - noise_std 0
2023-07-25 22:10:42,802 - root - INFO - world_size 1
2023-07-25 22:10:42,802 - root - INFO - interp 0
2023-07-25 22:10:42,802 - root - INFO - use_daily_climatology False
2023-07-25 22:10:42,803 - root - INFO - global_batch_size 64
2023-07-25 22:10:42,803 - root - INFO - ablate mslp
2023-07-25 22:10:42,803 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 22:10:42,803 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 22:10:42,803 - root - INFO - resuming False
2023-07-25 22:10:42,804 - root - INFO - local_rank 0
2023-07-25 22:10:42,804 - root - INFO - ---------------------------------------------------
2023-07-25 22:10:42,804 - root - INFO - Inference for 1 initial conditions
2023-07-25 22:10:43,107 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 22:10:43,108 - root - INFO - Number of samples per year: 1460
2023-07-25 22:10:43,108 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 22:10:43,108 - root - INFO - Delta t: 6 hours
2023-07-25 22:10:43,108 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 22:10:43,108 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 22:11:45,259 - root - INFO - Loading inference data
2023-07-25 22:11:45,260 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 22:11:45,517 - root - INFO - Initial condition 1 of 1
2023-07-25 22:11:46,365 - root - INFO - Extracting valid data from the first year
2023-07-25 22:13:58,350 - root - INFO - Standardizing data
2023-07-25 22:14:06,602 - root - INFO - Loading time means
2023-07-25 22:14:19,235 - root - INFO - Begin autoregressive inference
2023-07-25 22:14:30,439 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 22:14:40,888 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 243.54116821289062, ACC: 0.9183163046836853
2023-07-25 22:14:51,973 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 570.764404296875, ACC: 0.6415528059005737
2023-07-25 22:15:03,310 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 863.9574584960938, ACC: 0.4712919294834137
2023-07-25 22:15:15,055 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 1352.673583984375, ACC: 0.38794654607772827
2023-07-25 22:15:27,461 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 2231.64453125, ACC: 0.2975236773490906
2023-07-25 22:15:38,662 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 3197.63623046875, ACC: 0.24828338623046875
2023-07-25 22:15:50,122 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 4121.94140625, ACC: 0.2152988314628601
2023-07-25 22:16:02,444 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 4957.13037109375, ACC: 0.18381361663341522
2023-07-25 22:16:14,447 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 5688.96728515625, ACC: 0.15847623348236084
2023-07-25 22:16:26,125 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 6333.28076171875, ACC: 0.13632610440254211
2023-07-25 22:16:38,051 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 6914.568359375, ACC: 0.11548330634832382
2023-07-25 22:16:49,056 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 7455.89892578125, ACC: 0.08313781768083572
2023-07-25 22:17:02,904 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 7964.6748046875, ACC: 0.05515166372060776
2023-07-25 22:17:15,014 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 8457.7685546875, ACC: 0.024594195187091827
2023-07-25 22:17:25,366 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 8950.8701171875, ACC: -0.009070483036339283
2023-07-25 22:17:36,951 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 9450.326171875, ACC: -0.041979048401117325
2023-07-25 22:17:48,801 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 9961.19921875, ACC: -0.06620114296674728
2023-07-25 22:18:00,321 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 10501.9130859375, ACC: -0.07534297555685043
2023-07-25 22:18:12,389 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 11115.7236328125, ACC: -0.09913700073957443
2023-07-25 22:18:23,197 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 11828.6875, ACC: -0.12344159185886383
2023-07-25 22:18:33,788 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 12738.009765625, ACC: -0.1667175590991974
2023-07-25 22:18:44,127 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 13986.1044921875, ACC: -0.186034694314003
2023-07-25 22:18:54,530 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 15658.2294921875, ACC: -0.20838943123817444
2023-07-25 22:19:04,046 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 17808.650390625, ACC: -0.21081675589084625
2023-07-25 22:19:14,293 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 20730.546875, ACC: -0.20641273260116577
2023-07-25 22:19:24,509 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 24301.234375, ACC: -0.1746726930141449
2023-07-25 22:19:34,694 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 28140.060546875, ACC: -0.15748557448387146
2023-07-25 22:19:43,987 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 31784.9375, ACC: -0.1383522003889084
2023-07-25 22:19:54,813 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 34949.765625, ACC: -0.12836895883083344
2023-07-25 22:19:54,903 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-mslp_30-timesteps_vis.h5
2023-07-25 22:20:48,071 - root - INFO - ------------------ Configuration ------------------
2023-07-25 22:20:48,071 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 22:20:48,071 - root - INFO - Configuration name: afno_backbone
2023-07-25 22:20:48,071 - root - INFO - log_to_wandb True
2023-07-25 22:20:48,071 - root - INFO - lr 0.0005
2023-07-25 22:20:48,071 - root - INFO - batch_size 64
2023-07-25 22:20:48,071 - root - INFO - max_epochs 150
2023-07-25 22:20:48,071 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 22:20:48,071 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 22:20:48,071 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 22:20:48,071 - root - INFO - orography False
2023-07-25 22:20:48,071 - root - INFO - orography_path None
2023-07-25 22:20:48,072 - root - INFO - exp_dir FourCastNet/results
2023-07-25 22:20:48,072 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 22:20:48,072 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 22:20:48,072 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 22:20:48,072 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 22:20:48,072 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 22:20:48,072 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 22:20:48,072 - root - INFO - loss l2
2023-07-25 22:20:48,072 - root - INFO - num_data_workers 4
2023-07-25 22:20:48,072 - root - INFO - dt 1
2023-07-25 22:20:48,072 - root - INFO - n_history 0
2023-07-25 22:20:48,072 - root - INFO - prediction_type iterative
2023-07-25 22:20:48,072 - root - INFO - prediction_length 30
2023-07-25 22:20:48,072 - root - INFO - n_initial_conditions 5
2023-07-25 22:20:48,072 - root - INFO - ics_type default
2023-07-25 22:20:48,072 - root - INFO - save_raw_forecasts True
2023-07-25 22:20:48,072 - root - INFO - save_channel False
2023-07-25 22:20:48,072 - root - INFO - masked_acc False
2023-07-25 22:20:48,073 - root - INFO - maskpath None
2023-07-25 22:20:48,073 - root - INFO - perturb False
2023-07-25 22:20:48,073 - root - INFO - add_grid False
2023-07-25 22:20:48,073 - root - INFO - N_grid_channels 0
2023-07-25 22:20:48,073 - root - INFO - gridtype sinusoidal
2023-07-25 22:20:48,073 - root - INFO - roll False
2023-07-25 22:20:48,073 - root - INFO - num_blocks 8
2023-07-25 22:20:48,073 - root - INFO - nettype afno
2023-07-25 22:20:48,073 - root - INFO - patch_size 8
2023-07-25 22:20:48,073 - root - INFO - width 56
2023-07-25 22:20:48,073 - root - INFO - modes 32
2023-07-25 22:20:48,073 - root - INFO - target Z850
2023-07-25 22:20:48,073 - root - INFO - normalization zscore
2023-07-25 22:20:48,073 - root - INFO - log_to_screen True
2023-07-25 22:20:48,073 - root - INFO - save_checkpoint True
2023-07-25 22:20:48,073 - root - INFO - enable_nhwc False
2023-07-25 22:20:48,073 - root - INFO - optimizer_type FusedAdam
2023-07-25 22:20:48,073 - root - INFO - crop_size_x None
2023-07-25 22:20:48,073 - root - INFO - crop_size_y None
2023-07-25 22:20:48,073 - root - INFO - two_step_training False
2023-07-25 22:20:48,073 - root - INFO - plot_animations False
2023-07-25 22:20:48,073 - root - INFO - add_noise False
2023-07-25 22:20:48,073 - root - INFO - noise_std 0
2023-07-25 22:20:48,074 - root - INFO - world_size 1
2023-07-25 22:20:48,074 - root - INFO - interp 0
2023-07-25 22:20:48,074 - root - INFO - use_daily_climatology False
2023-07-25 22:20:48,074 - root - INFO - global_batch_size 64
2023-07-25 22:20:48,074 - root - INFO - ablate U1000
2023-07-25 22:20:48,074 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 22:20:48,074 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 22:20:48,074 - root - INFO - resuming False
2023-07-25 22:20:48,074 - root - INFO - local_rank 0
2023-07-25 22:20:48,074 - root - INFO - ---------------------------------------------------
2023-07-25 22:20:48,074 - root - INFO - Inference for 1 initial conditions
2023-07-25 22:20:48,297 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 22:20:48,298 - root - INFO - Number of samples per year: 1460
2023-07-25 22:20:48,298 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 22:20:48,299 - root - INFO - Delta t: 6 hours
2023-07-25 22:20:48,299 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 22:20:48,299 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 22:21:49,449 - root - INFO - Loading inference data
2023-07-25 22:21:49,451 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 22:21:49,676 - root - INFO - Initial condition 1 of 1
2023-07-25 22:21:50,525 - root - INFO - Extracting valid data from the first year
2023-07-25 22:24:02,674 - root - INFO - Standardizing data
2023-07-25 22:24:11,090 - root - INFO - Loading time means
2023-07-25 22:24:24,042 - root - INFO - Begin autoregressive inference
2023-07-25 22:24:33,678 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 22:24:45,580 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 545.8496704101562, ACC: 0.7345414757728577
2023-07-25 22:24:56,530 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 1247.6339111328125, ACC: 0.4077796936035156
2023-07-25 22:25:07,305 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 2290.949951171875, ACC: 0.2097250372171402
2023-07-25 22:25:17,980 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 3529.145263671875, ACC: 0.09170785546302795
2023-07-25 22:25:29,004 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 5493.27734375, ACC: 0.006549117621034384
2023-07-25 22:25:40,334 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 7879.03759765625, ACC: -0.0130800511687994
2023-07-25 22:25:50,568 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 10899.8974609375, ACC: -0.04680261015892029
2023-07-25 22:26:00,915 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 14440.45703125, ACC: -0.044347234070301056
2023-07-25 22:26:11,573 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 18453.087890625, ACC: -0.07592204958200455
2023-07-25 22:26:22,739 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 22827.705078125, ACC: -0.0728444829583168
2023-07-25 22:26:33,708 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 27218.818359375, ACC: -0.08819235861301422
2023-07-25 22:26:45,073 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 31228.5, ACC: -0.09199496358633041
2023-07-25 22:26:56,564 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 34613.21484375, ACC: -0.10037798434495926
2023-07-25 22:27:08,345 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 37292.09375, ACC: -0.09731178730726242
2023-07-25 22:27:19,965 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 39336.27734375, ACC: -0.0987015813589096
2023-07-25 22:27:29,975 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 40861.90625, ACC: -0.10225003212690353
2023-07-25 22:27:41,474 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 41983.8359375, ACC: -0.10589629411697388
2023-07-25 22:27:51,949 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 42796.12109375, ACC: -0.1002868115901947
2023-07-25 22:28:03,451 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 43381.8671875, ACC: -0.09588228166103363
2023-07-25 22:28:14,686 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 43801.9375, ACC: -0.09813892841339111
2023-07-25 22:28:25,759 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 44100.11328125, ACC: -0.10158419609069824
2023-07-25 22:28:36,241 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 44302.70703125, ACC: -0.09618687629699707
2023-07-25 22:28:47,360 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 44443.51171875, ACC: -0.0934770256280899
2023-07-25 22:28:58,761 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 44540.88671875, ACC: -0.09323850274085999
2023-07-25 22:29:10,220 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 44609.80859375, ACC: -0.09369305521249771
2023-07-25 22:29:21,134 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 44651.45703125, ACC: -0.08659746497869492
2023-07-25 22:29:31,381 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 44680.5703125, ACC: -0.08128733187913895
2023-07-25 22:29:42,687 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 44703.234375, ACC: -0.08079702407121658
2023-07-25 22:29:53,687 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 44720.765625, ACC: -0.08361164480447769
2023-07-25 22:29:53,796 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-U1000_30-timesteps_vis.h5
2023-07-25 22:30:47,421 - root - INFO - ------------------ Configuration ------------------
2023-07-25 22:30:47,421 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 22:30:47,421 - root - INFO - Configuration name: afno_backbone
2023-07-25 22:30:47,421 - root - INFO - log_to_wandb True
2023-07-25 22:30:47,421 - root - INFO - lr 0.0005
2023-07-25 22:30:47,421 - root - INFO - batch_size 64
2023-07-25 22:30:47,421 - root - INFO - max_epochs 150
2023-07-25 22:30:47,421 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 22:30:47,421 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 22:30:47,421 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 22:30:47,421 - root - INFO - orography False
2023-07-25 22:30:47,421 - root - INFO - orography_path None
2023-07-25 22:30:47,421 - root - INFO - exp_dir FourCastNet/results
2023-07-25 22:30:47,421 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 22:30:47,421 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 22:30:47,421 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 22:30:47,422 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 22:30:47,422 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 22:30:47,422 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 22:30:47,422 - root - INFO - loss l2
2023-07-25 22:30:47,422 - root - INFO - num_data_workers 4
2023-07-25 22:30:47,422 - root - INFO - dt 1
2023-07-25 22:30:47,422 - root - INFO - n_history 0
2023-07-25 22:30:47,422 - root - INFO - prediction_type iterative
2023-07-25 22:30:47,422 - root - INFO - prediction_length 30
2023-07-25 22:30:47,422 - root - INFO - n_initial_conditions 5
2023-07-25 22:30:47,422 - root - INFO - ics_type default
2023-07-25 22:30:47,422 - root - INFO - save_raw_forecasts True
2023-07-25 22:30:47,422 - root - INFO - save_channel False
2023-07-25 22:30:47,422 - root - INFO - masked_acc False
2023-07-25 22:30:47,422 - root - INFO - maskpath None
2023-07-25 22:30:47,422 - root - INFO - perturb False
2023-07-25 22:30:47,422 - root - INFO - add_grid False
2023-07-25 22:30:47,422 - root - INFO - N_grid_channels 0
2023-07-25 22:30:47,422 - root - INFO - gridtype sinusoidal
2023-07-25 22:30:47,422 - root - INFO - roll False
2023-07-25 22:30:47,422 - root - INFO - num_blocks 8
2023-07-25 22:30:47,423 - root - INFO - nettype afno
2023-07-25 22:30:47,423 - root - INFO - patch_size 8
2023-07-25 22:30:47,423 - root - INFO - width 56
2023-07-25 22:30:47,423 - root - INFO - modes 32
2023-07-25 22:30:47,423 - root - INFO - target Z850
2023-07-25 22:30:47,423 - root - INFO - normalization zscore
2023-07-25 22:30:47,423 - root - INFO - log_to_screen True
2023-07-25 22:30:47,423 - root - INFO - save_checkpoint True
2023-07-25 22:30:47,423 - root - INFO - enable_nhwc False
2023-07-25 22:30:47,423 - root - INFO - optimizer_type FusedAdam
2023-07-25 22:30:47,423 - root - INFO - crop_size_x None
2023-07-25 22:30:47,423 - root - INFO - crop_size_y None
2023-07-25 22:30:47,423 - root - INFO - two_step_training False
2023-07-25 22:30:47,423 - root - INFO - plot_animations False
2023-07-25 22:30:47,423 - root - INFO - add_noise False
2023-07-25 22:30:47,423 - root - INFO - noise_std 0
2023-07-25 22:30:47,423 - root - INFO - world_size 1
2023-07-25 22:30:47,423 - root - INFO - interp 0
2023-07-25 22:30:47,423 - root - INFO - use_daily_climatology False
2023-07-25 22:30:47,423 - root - INFO - global_batch_size 64
2023-07-25 22:30:47,423 - root - INFO - ablate V1000
2023-07-25 22:30:47,423 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 22:30:47,423 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 22:30:47,423 - root - INFO - resuming False
2023-07-25 22:30:47,424 - root - INFO - local_rank 0
2023-07-25 22:30:47,424 - root - INFO - ---------------------------------------------------
2023-07-25 22:30:47,424 - root - INFO - Inference for 1 initial conditions
2023-07-25 22:30:47,684 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 22:30:47,686 - root - INFO - Number of samples per year: 1460
2023-07-25 22:30:47,686 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 22:30:47,686 - root - INFO - Delta t: 6 hours
2023-07-25 22:30:47,686 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 22:30:47,687 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 22:31:49,805 - root - INFO - Loading inference data
2023-07-25 22:31:49,806 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 22:31:49,989 - root - INFO - Initial condition 1 of 1
2023-07-25 22:31:50,763 - root - INFO - Extracting valid data from the first year
2023-07-25 22:34:11,956 - root - INFO - Standardizing data
2023-07-25 22:34:20,589 - root - INFO - Loading time means
2023-07-25 22:34:36,487 - root - INFO - Begin autoregressive inference
2023-07-25 22:34:47,849 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 22:34:59,942 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 84.46929168701172, ACC: 0.9903229475021362
2023-07-25 22:35:12,098 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 84.7776870727539, ACC: 0.9903967380523682
2023-07-25 22:35:24,406 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 92.24057006835938, ACC: 0.9890519380569458
2023-07-25 22:35:36,329 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 98.75714874267578, ACC: 0.9871901869773865
2023-07-25 22:35:48,184 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 106.9228286743164, ACC: 0.9853419661521912
2023-07-25 22:35:59,825 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 118.34551239013672, ACC: 0.9824033379554749
2023-07-25 22:36:10,860 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 131.31211853027344, ACC: 0.9791635274887085
2023-07-25 22:36:21,226 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 150.9725799560547, ACC: 0.9723976254463196
2023-07-25 22:36:31,565 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 171.55343627929688, ACC: 0.9657606482505798
2023-07-25 22:36:43,732 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 185.75692749023438, ACC: 0.9603224992752075
2023-07-25 22:36:56,411 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 192.22532653808594, ACC: 0.9577324986457825
2023-07-25 22:37:07,124 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 204.1069793701172, ACC: 0.9511215686798096
2023-07-25 22:37:18,496 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 223.47244262695312, ACC: 0.9409359693527222
2023-07-25 22:37:28,638 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 251.02064514160156, ACC: 0.9243976473808289
2023-07-25 22:37:39,389 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 276.8418884277344, ACC: 0.9080896377563477
2023-07-25 22:37:49,003 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 305.5776062011719, ACC: 0.8873018026351929
2023-07-25 22:37:59,482 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 328.8088684082031, ACC: 0.8688918948173523
2023-07-25 22:38:08,815 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 347.6580505371094, ACC: 0.8525583148002625
2023-07-25 22:38:19,348 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 356.970458984375, ACC: 0.8416654467582703
2023-07-25 22:38:30,082 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 362.5906066894531, ACC: 0.8296087384223938
2023-07-25 22:38:41,036 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 367.8802490234375, ACC: 0.8229445815086365
2023-07-25 22:38:52,353 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 380.53594970703125, ACC: 0.8073031306266785
2023-07-25 22:39:04,139 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 399.6796569824219, ACC: 0.7873998880386353
2023-07-25 22:39:15,450 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 427.9084777832031, ACC: 0.7544809579849243
2023-07-25 22:39:25,965 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 458.7654724121094, ACC: 0.7309688329696655
2023-07-25 22:39:36,856 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 489.2337951660156, ACC: 0.6995649933815002
2023-07-25 22:39:48,160 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 514.7716064453125, ACC: 0.678626537322998
2023-07-25 22:39:58,792 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 538.589111328125, ACC: 0.65888911485672
2023-07-25 22:40:10,376 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 560.5628051757812, ACC: 0.6346595287322998
2023-07-25 22:40:10,467 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-V1000_30-timesteps_vis.h5
2023-07-25 22:41:03,798 - root - INFO - ------------------ Configuration ------------------
2023-07-25 22:41:03,798 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 22:41:03,798 - root - INFO - Configuration name: afno_backbone
2023-07-25 22:41:03,798 - root - INFO - log_to_wandb True
2023-07-25 22:41:03,799 - root - INFO - lr 0.0005
2023-07-25 22:41:03,799 - root - INFO - batch_size 64
2023-07-25 22:41:03,799 - root - INFO - max_epochs 150
2023-07-25 22:41:03,799 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 22:41:03,799 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 22:41:03,799 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 22:41:03,799 - root - INFO - orography False
2023-07-25 22:41:03,799 - root - INFO - orography_path None
2023-07-25 22:41:03,799 - root - INFO - exp_dir FourCastNet/results
2023-07-25 22:41:03,799 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 22:41:03,799 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 22:41:03,800 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 22:41:03,800 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 22:41:03,800 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 22:41:03,800 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 22:41:03,800 - root - INFO - loss l2
2023-07-25 22:41:03,800 - root - INFO - num_data_workers 4
2023-07-25 22:41:03,800 - root - INFO - dt 1
2023-07-25 22:41:03,800 - root - INFO - n_history 0
2023-07-25 22:41:03,800 - root - INFO - prediction_type iterative
2023-07-25 22:41:03,800 - root - INFO - prediction_length 30
2023-07-25 22:41:03,800 - root - INFO - n_initial_conditions 5
2023-07-25 22:41:03,800 - root - INFO - ics_type default
2023-07-25 22:41:03,800 - root - INFO - save_raw_forecasts True
2023-07-25 22:41:03,800 - root - INFO - save_channel False
2023-07-25 22:41:03,800 - root - INFO - masked_acc False
2023-07-25 22:41:03,800 - root - INFO - maskpath None
2023-07-25 22:41:03,800 - root - INFO - perturb False
2023-07-25 22:41:03,800 - root - INFO - add_grid False
2023-07-25 22:41:03,800 - root - INFO - N_grid_channels 0
2023-07-25 22:41:03,800 - root - INFO - gridtype sinusoidal
2023-07-25 22:41:03,800 - root - INFO - roll False
2023-07-25 22:41:03,800 - root - INFO - num_blocks 8
2023-07-25 22:41:03,800 - root - INFO - nettype afno
2023-07-25 22:41:03,800 - root - INFO - patch_size 8
2023-07-25 22:41:03,800 - root - INFO - width 56
2023-07-25 22:41:03,800 - root - INFO - modes 32
2023-07-25 22:41:03,800 - root - INFO - target Z850
2023-07-25 22:41:03,801 - root - INFO - normalization zscore
2023-07-25 22:41:03,801 - root - INFO - log_to_screen True
2023-07-25 22:41:03,801 - root - INFO - save_checkpoint True
2023-07-25 22:41:03,801 - root - INFO - enable_nhwc False
2023-07-25 22:41:03,801 - root - INFO - optimizer_type FusedAdam
2023-07-25 22:41:03,801 - root - INFO - crop_size_x None
2023-07-25 22:41:03,801 - root - INFO - crop_size_y None
2023-07-25 22:41:03,801 - root - INFO - two_step_training False
2023-07-25 22:41:03,801 - root - INFO - plot_animations False
2023-07-25 22:41:03,801 - root - INFO - add_noise False
2023-07-25 22:41:03,801 - root - INFO - noise_std 0
2023-07-25 22:41:03,801 - root - INFO - world_size 1
2023-07-25 22:41:03,801 - root - INFO - interp 0
2023-07-25 22:41:03,801 - root - INFO - use_daily_climatology False
2023-07-25 22:41:03,801 - root - INFO - global_batch_size 64
2023-07-25 22:41:03,802 - root - INFO - ablate Z1000
2023-07-25 22:41:03,802 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 22:41:03,802 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 22:41:03,802 - root - INFO - resuming False
2023-07-25 22:41:03,802 - root - INFO - local_rank 0
2023-07-25 22:41:03,802 - root - INFO - ---------------------------------------------------
2023-07-25 22:41:03,802 - root - INFO - Inference for 1 initial conditions
2023-07-25 22:41:04,088 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 22:41:04,089 - root - INFO - Number of samples per year: 1460
2023-07-25 22:41:04,089 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 22:41:04,089 - root - INFO - Delta t: 6 hours
2023-07-25 22:41:04,090 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 22:41:04,090 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 22:42:03,952 - root - INFO - Loading inference data
2023-07-25 22:42:03,953 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 22:42:04,161 - root - INFO - Initial condition 1 of 1
2023-07-25 22:42:05,175 - root - INFO - Extracting valid data from the first year
2023-07-25 22:44:16,751 - root - INFO - Standardizing data
2023-07-25 22:44:24,719 - root - INFO - Loading time means
2023-07-25 22:44:40,537 - root - INFO - Begin autoregressive inference
2023-07-25 22:44:51,606 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 22:45:02,987 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 46.010292053222656, ACC: 0.997295081615448
2023-07-25 22:45:14,549 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 52.609004974365234, ACC: 0.9963066577911377
2023-07-25 22:45:26,099 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 57.479095458984375, ACC: 0.9957137107849121
2023-07-25 22:45:37,262 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 70.32120513916016, ACC: 0.9934516549110413
2023-07-25 22:45:48,137 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 76.70307159423828, ACC: 0.9924382567405701
2023-07-25 22:45:58,345 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 90.14007568359375, ACC: 0.9898678064346313
2023-07-25 22:46:09,510 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 100.4950942993164, ACC: 0.9879054427146912
2023-07-25 22:46:20,825 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 117.5967788696289, ACC: 0.9834622740745544
2023-07-25 22:46:31,352 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 133.8032989501953, ACC: 0.9793714880943298
2023-07-25 22:46:42,333 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 145.9981689453125, ACC: 0.9757211208343506
2023-07-25 22:46:53,188 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 154.68016052246094, ACC: 0.9725005030632019
2023-07-25 22:47:03,194 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 169.99046325683594, ACC: 0.9661021828651428
2023-07-25 22:47:14,141 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 189.72808837890625, ACC: 0.9574540257453918
2023-07-25 22:47:24,893 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 211.11866760253906, ACC: 0.9471808075904846
2023-07-25 22:47:35,913 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 230.4302978515625, ACC: 0.9372206926345825
2023-07-25 22:47:47,132 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 254.81153869628906, ACC: 0.9230091571807861
2023-07-25 22:47:58,339 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 276.52960205078125, ACC: 0.9086442589759827
2023-07-25 22:48:10,116 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 298.06805419921875, ACC: 0.8932136297225952
2023-07-25 22:48:20,725 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 312.3067321777344, ACC: 0.8801941275596619
2023-07-25 22:48:30,561 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 326.2920837402344, ACC: 0.8628727197647095
2023-07-25 22:48:41,256 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 336.6391906738281, ACC: 0.8528438210487366
2023-07-25 22:48:52,263 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 351.0086364746094, ACC: 0.8372936248779297
2023-07-25 22:49:02,705 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 363.0627136230469, ACC: 0.8266893029212952
2023-07-25 22:49:13,157 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 381.1564636230469, ACC: 0.8075974583625793
2023-07-25 22:49:24,449 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 398.18328857421875, ACC: 0.8007962703704834
2023-07-25 22:49:35,940 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 416.010986328125, ACC: 0.7862086296081543
2023-07-25 22:49:46,168 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 432.5081481933594, ACC: 0.7787656784057617
2023-07-25 22:49:56,798 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 451.7037353515625, ACC: 0.7675735950469971
2023-07-25 22:50:07,372 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 469.493896484375, ACC: 0.7541276216506958
2023-07-25 22:50:07,473 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-Z1000_30-timesteps_vis.h5
2023-07-25 22:51:00,786 - root - INFO - ------------------ Configuration ------------------
2023-07-25 22:51:00,787 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 22:51:00,787 - root - INFO - Configuration name: afno_backbone
2023-07-25 22:51:00,787 - root - INFO - log_to_wandb True
2023-07-25 22:51:00,787 - root - INFO - lr 0.0005
2023-07-25 22:51:00,787 - root - INFO - batch_size 64
2023-07-25 22:51:00,787 - root - INFO - max_epochs 150
2023-07-25 22:51:00,787 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 22:51:00,787 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 22:51:00,787 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 22:51:00,787 - root - INFO - orography False
2023-07-25 22:51:00,787 - root - INFO - orography_path None
2023-07-25 22:51:00,787 - root - INFO - exp_dir FourCastNet/results
2023-07-25 22:51:00,787 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 22:51:00,787 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 22:51:00,787 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 22:51:00,788 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 22:51:00,788 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 22:51:00,788 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 22:51:00,788 - root - INFO - loss l2
2023-07-25 22:51:00,788 - root - INFO - num_data_workers 4
2023-07-25 22:51:00,788 - root - INFO - dt 1
2023-07-25 22:51:00,788 - root - INFO - n_history 0
2023-07-25 22:51:00,788 - root - INFO - prediction_type iterative
2023-07-25 22:51:00,788 - root - INFO - prediction_length 30
2023-07-25 22:51:00,788 - root - INFO - n_initial_conditions 5
2023-07-25 22:51:00,788 - root - INFO - ics_type default
2023-07-25 22:51:00,788 - root - INFO - save_raw_forecasts True
2023-07-25 22:51:00,788 - root - INFO - save_channel False
2023-07-25 22:51:00,788 - root - INFO - masked_acc False
2023-07-25 22:51:00,788 - root - INFO - maskpath None
2023-07-25 22:51:00,788 - root - INFO - perturb False
2023-07-25 22:51:00,788 - root - INFO - add_grid False
2023-07-25 22:51:00,788 - root - INFO - N_grid_channels 0
2023-07-25 22:51:00,789 - root - INFO - gridtype sinusoidal
2023-07-25 22:51:00,789 - root - INFO - roll False
2023-07-25 22:51:00,789 - root - INFO - num_blocks 8
2023-07-25 22:51:00,789 - root - INFO - nettype afno
2023-07-25 22:51:00,789 - root - INFO - patch_size 8
2023-07-25 22:51:00,789 - root - INFO - width 56
2023-07-25 22:51:00,789 - root - INFO - modes 32
2023-07-25 22:51:00,789 - root - INFO - target Z850
2023-07-25 22:51:00,789 - root - INFO - normalization zscore
2023-07-25 22:51:00,789 - root - INFO - log_to_screen True
2023-07-25 22:51:00,789 - root - INFO - save_checkpoint True
2023-07-25 22:51:00,789 - root - INFO - enable_nhwc False
2023-07-25 22:51:00,789 - root - INFO - optimizer_type FusedAdam
2023-07-25 22:51:00,789 - root - INFO - crop_size_x None
2023-07-25 22:51:00,789 - root - INFO - crop_size_y None
2023-07-25 22:51:00,789 - root - INFO - two_step_training False
2023-07-25 22:51:00,789 - root - INFO - plot_animations False
2023-07-25 22:51:00,789 - root - INFO - add_noise False
2023-07-25 22:51:00,789 - root - INFO - noise_std 0
2023-07-25 22:51:00,789 - root - INFO - world_size 1
2023-07-25 22:51:00,789 - root - INFO - interp 0
2023-07-25 22:51:00,790 - root - INFO - use_daily_climatology False
2023-07-25 22:51:00,790 - root - INFO - global_batch_size 64
2023-07-25 22:51:00,790 - root - INFO - ablate T850
2023-07-25 22:51:00,790 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 22:51:00,790 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 22:51:00,790 - root - INFO - resuming False
2023-07-25 22:51:00,790 - root - INFO - local_rank 0
2023-07-25 22:51:00,790 - root - INFO - ---------------------------------------------------
2023-07-25 22:51:00,790 - root - INFO - Inference for 1 initial conditions
2023-07-25 22:51:01,044 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 22:51:01,044 - root - INFO - Number of samples per year: 1460
2023-07-25 22:51:01,045 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 22:51:01,045 - root - INFO - Delta t: 6 hours
2023-07-25 22:51:01,045 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 22:51:01,045 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 22:51:58,885 - root - INFO - Loading inference data
2023-07-25 22:51:58,886 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 22:51:59,092 - root - INFO - Initial condition 1 of 1
2023-07-25 22:51:59,906 - root - INFO - Extracting valid data from the first year
2023-07-25 22:54:02,743 - root - INFO - Standardizing data
2023-07-25 22:54:10,908 - root - INFO - Loading time means
2023-07-25 22:54:22,765 - root - INFO - Begin autoregressive inference
2023-07-25 22:54:33,877 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 22:54:45,024 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 791.3585815429688, ACC: 0.6275973916053772
2023-07-25 22:54:55,771 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 2147.793212890625, ACC: 0.15462346374988556
2023-07-25 22:55:06,273 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 4970.68212890625, ACC: 0.09381052851676941
2023-07-25 22:55:16,637 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 8810.7880859375, ACC: 0.09146212041378021
2023-07-25 22:55:28,420 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 12865.3564453125, ACC: 0.046830251812934875
2023-07-25 22:55:40,180 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 17597.1796875, ACC: 0.017364637926220894
2023-07-25 22:55:51,312 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 22603.763671875, ACC: -0.020379815250635147
2023-07-25 22:56:02,467 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 27404.294921875, ACC: -0.04377225786447525
2023-07-25 22:56:14,935 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 31623.423828125, ACC: -0.0655680000782013
2023-07-25 22:56:26,571 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 35065.8359375, ACC: -0.06963127106428146
2023-07-25 22:56:37,898 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 37750.21875, ACC: -0.07491185516119003
2023-07-25 22:56:49,294 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 39777.29296875, ACC: -0.08173387497663498
2023-07-25 22:56:59,576 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 41270.62109375, ACC: -0.0890389084815979
2023-07-25 22:57:10,855 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 42338.7578125, ACC: -0.08629819750785828
2023-07-25 22:57:22,379 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 43092.8125, ACC: -0.08582748472690582
2023-07-25 22:57:34,461 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 43618.078125, ACC: -0.08892872184515
2023-07-25 22:57:46,119 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 43980.8671875, ACC: -0.09506682306528091
2023-07-25 22:57:56,922 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 44223.484375, ACC: -0.09242288023233414
2023-07-25 22:58:08,266 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 44387.76953125, ACC: -0.09051739424467087
2023-07-25 22:58:19,392 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 44502.12109375, ACC: -0.09457585215568542
2023-07-25 22:58:29,853 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 44582.5078125, ACC: -0.09957044571638107
2023-07-25 22:58:40,527 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 44632.42578125, ACC: -0.09509570151567459
2023-07-25 22:58:51,731 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 44667.9296875, ACC: -0.09280572086572647
2023-07-25 22:59:03,182 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 44693.52734375, ACC: -0.092807337641716
2023-07-25 22:59:16,006 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 44713.85546875, ACC: -0.09339413791894913
2023-07-25 22:59:27,743 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 44722.6875, ACC: -0.0863955095410347
2023-07-25 22:59:39,028 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 44729.57421875, ACC: -0.08112888783216476
2023-07-25 22:59:50,423 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 44737.14453125, ACC: -0.08068226277828217
2023-07-25 23:00:01,844 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 44744.3671875, ACC: -0.08352630585432053
2023-07-25 23:00:01,936 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-T850_30-timesteps_vis.h5
2023-07-25 23:00:55,347 - root - INFO - ------------------ Configuration ------------------
2023-07-25 23:00:55,347 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 23:00:55,347 - root - INFO - Configuration name: afno_backbone
2023-07-25 23:00:55,347 - root - INFO - log_to_wandb True
2023-07-25 23:00:55,347 - root - INFO - lr 0.0005
2023-07-25 23:00:55,347 - root - INFO - batch_size 64
2023-07-25 23:00:55,347 - root - INFO - max_epochs 150
2023-07-25 23:00:55,347 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 23:00:55,347 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 23:00:55,348 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 23:00:55,348 - root - INFO - orography False
2023-07-25 23:00:55,348 - root - INFO - orography_path None
2023-07-25 23:00:55,348 - root - INFO - exp_dir FourCastNet/results
2023-07-25 23:00:55,348 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 23:00:55,348 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 23:00:55,348 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 23:00:55,348 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 23:00:55,348 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 23:00:55,348 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 23:00:55,348 - root - INFO - loss l2
2023-07-25 23:00:55,348 - root - INFO - num_data_workers 4
2023-07-25 23:00:55,348 - root - INFO - dt 1
2023-07-25 23:00:55,348 - root - INFO - n_history 0
2023-07-25 23:00:55,348 - root - INFO - prediction_type iterative
2023-07-25 23:00:55,348 - root - INFO - prediction_length 30
2023-07-25 23:00:55,348 - root - INFO - n_initial_conditions 5
2023-07-25 23:00:55,348 - root - INFO - ics_type default
2023-07-25 23:00:55,348 - root - INFO - save_raw_forecasts True
2023-07-25 23:00:55,348 - root - INFO - save_channel False
2023-07-25 23:00:55,348 - root - INFO - masked_acc False
2023-07-25 23:00:55,348 - root - INFO - maskpath None
2023-07-25 23:00:55,348 - root - INFO - perturb False
2023-07-25 23:00:55,348 - root - INFO - add_grid False
2023-07-25 23:00:55,348 - root - INFO - N_grid_channels 0
2023-07-25 23:00:55,348 - root - INFO - gridtype sinusoidal
2023-07-25 23:00:55,348 - root - INFO - roll False
2023-07-25 23:00:55,349 - root - INFO - num_blocks 8
2023-07-25 23:00:55,349 - root - INFO - nettype afno
2023-07-25 23:00:55,349 - root - INFO - patch_size 8
2023-07-25 23:00:55,349 - root - INFO - width 56
2023-07-25 23:00:55,349 - root - INFO - modes 32
2023-07-25 23:00:55,349 - root - INFO - target Z850
2023-07-25 23:00:55,349 - root - INFO - normalization zscore
2023-07-25 23:00:55,349 - root - INFO - log_to_screen True
2023-07-25 23:00:55,349 - root - INFO - save_checkpoint True
2023-07-25 23:00:55,349 - root - INFO - enable_nhwc False
2023-07-25 23:00:55,349 - root - INFO - optimizer_type FusedAdam
2023-07-25 23:00:55,349 - root - INFO - crop_size_x None
2023-07-25 23:00:55,349 - root - INFO - crop_size_y None
2023-07-25 23:00:55,349 - root - INFO - two_step_training False
2023-07-25 23:00:55,349 - root - INFO - plot_animations False
2023-07-25 23:00:55,349 - root - INFO - add_noise False
2023-07-25 23:00:55,349 - root - INFO - noise_std 0
2023-07-25 23:00:55,349 - root - INFO - world_size 1
2023-07-25 23:00:55,349 - root - INFO - interp 0
2023-07-25 23:00:55,349 - root - INFO - use_daily_climatology False
2023-07-25 23:00:55,349 - root - INFO - global_batch_size 64
2023-07-25 23:00:55,349 - root - INFO - ablate U850
2023-07-25 23:00:55,349 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 23:00:55,349 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 23:00:55,349 - root - INFO - resuming False
2023-07-25 23:00:55,349 - root - INFO - local_rank 0
2023-07-25 23:00:55,349 - root - INFO - ---------------------------------------------------
2023-07-25 23:00:55,349 - root - INFO - Inference for 1 initial conditions
2023-07-25 23:00:55,665 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 23:00:55,666 - root - INFO - Number of samples per year: 1460
2023-07-25 23:00:55,666 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 23:00:55,666 - root - INFO - Delta t: 6 hours
2023-07-25 23:00:55,666 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 23:00:55,666 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 23:01:54,517 - root - INFO - Loading inference data
2023-07-25 23:01:54,519 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 23:01:54,708 - root - INFO - Initial condition 1 of 1
2023-07-25 23:01:55,559 - root - INFO - Extracting valid data from the first year
2023-07-25 23:04:07,046 - root - INFO - Standardizing data
2023-07-25 23:04:15,445 - root - INFO - Loading time means
2023-07-25 23:04:30,310 - root - INFO - Begin autoregressive inference
2023-07-25 23:04:41,634 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 23:04:53,776 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 112.68299865722656, ACC: 0.9828104972839355
2023-07-25 23:05:05,842 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 111.09212493896484, ACC: 0.9835793375968933
2023-07-25 23:05:18,881 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 104.66728210449219, ACC: 0.9857733845710754
2023-07-25 23:05:29,092 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 106.27037811279297, ACC: 0.9850408434867859
2023-07-25 23:05:40,775 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 111.07978057861328, ACC: 0.9840551614761353
2023-07-25 23:05:51,408 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 119.41787719726562, ACC: 0.98199462890625
2023-07-25 23:06:03,107 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 125.74231719970703, ACC: 0.9808698296546936
2023-07-25 23:06:15,093 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 137.2674102783203, ACC: 0.9772327542304993
2023-07-25 23:06:26,025 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 155.9602813720703, ACC: 0.9718697667121887
2023-07-25 23:06:37,586 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 171.15957641601562, ACC: 0.9666092395782471
2023-07-25 23:06:50,587 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 178.3111572265625, ACC: 0.9643686413764954
2023-07-25 23:07:02,943 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 190.58013916015625, ACC: 0.9586297869682312
2023-07-25 23:07:15,119 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 210.02796936035156, ACC: 0.9498834013938904
2023-07-25 23:07:26,544 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 237.23280334472656, ACC: 0.9347902536392212
2023-07-25 23:07:37,183 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 261.699462890625, ACC: 0.9207529425621033
2023-07-25 23:07:48,815 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 287.717529296875, ACC: 0.9030905961990356
2023-07-25 23:08:00,949 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 310.25091552734375, ACC: 0.8869590759277344
2023-07-25 23:08:13,357 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 330.85504150390625, ACC: 0.8697434067726135
2023-07-25 23:08:25,313 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 346.1543273925781, ACC: 0.8551467061042786
2023-07-25 23:08:36,433 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 356.8283996582031, ACC: 0.8388504385948181
2023-07-25 23:08:47,353 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 363.9728088378906, ACC: 0.8315815925598145
2023-07-25 23:08:58,823 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 373.1119384765625, ACC: 0.8197449445724487
2023-07-25 23:09:10,293 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 379.09368896484375, ACC: 0.8167334198951721
2023-07-25 23:09:20,935 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 391.97930908203125, ACC: 0.8018550872802734
2023-07-25 23:09:31,702 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 402.0080261230469, ACC: 0.8025521039962769
2023-07-25 23:09:41,806 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 420.9167175292969, ACC: 0.7861216068267822
2023-07-25 23:09:52,342 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 436.5232238769531, ACC: 0.7802824378013611
2023-07-25 23:10:03,138 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 459.8763732910156, ACC: 0.7629575729370117
2023-07-25 23:10:14,510 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 476.7752380371094, ACC: 0.7509236335754395
2023-07-25 23:10:14,642 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-U850_30-timesteps_vis.h5
2023-07-25 23:11:08,151 - root - INFO - ------------------ Configuration ------------------
2023-07-25 23:11:08,151 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 23:11:08,152 - root - INFO - Configuration name: afno_backbone
2023-07-25 23:11:08,152 - root - INFO - log_to_wandb True
2023-07-25 23:11:08,152 - root - INFO - lr 0.0005
2023-07-25 23:11:08,152 - root - INFO - batch_size 64
2023-07-25 23:11:08,152 - root - INFO - max_epochs 150
2023-07-25 23:11:08,152 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 23:11:08,152 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 23:11:08,152 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 23:11:08,152 - root - INFO - orography False
2023-07-25 23:11:08,152 - root - INFO - orography_path None
2023-07-25 23:11:08,152 - root - INFO - exp_dir FourCastNet/results
2023-07-25 23:11:08,152 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 23:11:08,152 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 23:11:08,152 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 23:11:08,152 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 23:11:08,152 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 23:11:08,152 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 23:11:08,153 - root - INFO - loss l2
2023-07-25 23:11:08,153 - root - INFO - num_data_workers 4
2023-07-25 23:11:08,153 - root - INFO - dt 1
2023-07-25 23:11:08,153 - root - INFO - n_history 0
2023-07-25 23:11:08,153 - root - INFO - prediction_type iterative
2023-07-25 23:11:08,153 - root - INFO - prediction_length 30
2023-07-25 23:11:08,153 - root - INFO - n_initial_conditions 5
2023-07-25 23:11:08,153 - root - INFO - ics_type default
2023-07-25 23:11:08,153 - root - INFO - save_raw_forecasts True
2023-07-25 23:11:08,153 - root - INFO - save_channel False
2023-07-25 23:11:08,153 - root - INFO - masked_acc False
2023-07-25 23:11:08,153 - root - INFO - maskpath None
2023-07-25 23:11:08,153 - root - INFO - perturb False
2023-07-25 23:11:08,153 - root - INFO - add_grid False
2023-07-25 23:11:08,153 - root - INFO - N_grid_channels 0
2023-07-25 23:11:08,153 - root - INFO - gridtype sinusoidal
2023-07-25 23:11:08,153 - root - INFO - roll False
2023-07-25 23:11:08,154 - root - INFO - num_blocks 8
2023-07-25 23:11:08,154 - root - INFO - nettype afno
2023-07-25 23:11:08,154 - root - INFO - patch_size 8
2023-07-25 23:11:08,154 - root - INFO - width 56
2023-07-25 23:11:08,154 - root - INFO - modes 32
2023-07-25 23:11:08,154 - root - INFO - target Z850
2023-07-25 23:11:08,154 - root - INFO - normalization zscore
2023-07-25 23:11:08,154 - root - INFO - log_to_screen True
2023-07-25 23:11:08,154 - root - INFO - save_checkpoint True
2023-07-25 23:11:08,154 - root - INFO - enable_nhwc False
2023-07-25 23:11:08,154 - root - INFO - optimizer_type FusedAdam
2023-07-25 23:11:08,154 - root - INFO - crop_size_x None
2023-07-25 23:11:08,154 - root - INFO - crop_size_y None
2023-07-25 23:11:08,154 - root - INFO - two_step_training False
2023-07-25 23:11:08,154 - root - INFO - plot_animations False
2023-07-25 23:11:08,154 - root - INFO - add_noise False
2023-07-25 23:11:08,154 - root - INFO - noise_std 0
2023-07-25 23:11:08,154 - root - INFO - world_size 1
2023-07-25 23:11:08,154 - root - INFO - interp 0
2023-07-25 23:11:08,155 - root - INFO - use_daily_climatology False
2023-07-25 23:11:08,155 - root - INFO - global_batch_size 64
2023-07-25 23:11:08,155 - root - INFO - ablate V850
2023-07-25 23:11:08,155 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 23:11:08,155 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 23:11:08,155 - root - INFO - resuming False
2023-07-25 23:11:08,155 - root - INFO - local_rank 0
2023-07-25 23:11:08,155 - root - INFO - ---------------------------------------------------
2023-07-25 23:11:08,155 - root - INFO - Inference for 1 initial conditions
2023-07-25 23:11:08,512 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 23:11:08,513 - root - INFO - Number of samples per year: 1460
2023-07-25 23:11:08,513 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 23:11:08,513 - root - INFO - Delta t: 6 hours
2023-07-25 23:11:08,513 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 23:11:08,513 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 23:12:11,729 - root - INFO - Loading inference data
2023-07-25 23:12:11,730 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 23:12:11,944 - root - INFO - Initial condition 1 of 1
2023-07-25 23:12:12,982 - root - INFO - Extracting valid data from the first year
2023-07-25 23:14:30,693 - root - INFO - Standardizing data
2023-07-25 23:14:38,958 - root - INFO - Loading time means
2023-07-25 23:14:53,443 - root - INFO - Begin autoregressive inference
2023-07-25 23:15:05,300 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 23:15:19,307 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 80.81044006347656, ACC: 0.993100643157959
2023-07-25 23:15:32,520 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 70.87319946289062, ACC: 0.9942148327827454
2023-07-25 23:15:45,469 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 76.25730895996094, ACC: 0.9931856393814087
2023-07-25 23:15:57,152 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 83.3941650390625, ACC: 0.9912539124488831
2023-07-25 23:16:09,154 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 91.43315887451172, ACC: 0.9895066618919373
2023-07-25 23:16:20,881 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 100.02692413330078, ACC: 0.9877105355262756
2023-07-25 23:16:31,765 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 106.54386901855469, ACC: 0.9865126013755798
2023-07-25 23:16:42,495 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 116.8013916015625, ACC: 0.9837525486946106
2023-07-25 23:16:53,903 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 131.561767578125, ACC: 0.9800884127616882
2023-07-25 23:17:05,324 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 140.54576110839844, ACC: 0.9774709343910217
2023-07-25 23:17:17,574 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 144.07711791992188, ACC: 0.9761571884155273
2023-07-25 23:17:28,983 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 155.65956115722656, ACC: 0.9715079069137573
2023-07-25 23:17:40,038 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 175.48643493652344, ACC: 0.9635607600212097
2023-07-25 23:17:50,598 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 197.02943420410156, ACC: 0.9538000226020813
2023-07-25 23:18:02,254 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 215.98370361328125, ACC: 0.9447928667068481
2023-07-25 23:18:14,107 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 235.490966796875, ACC: 0.9343510866165161
2023-07-25 23:18:26,102 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 254.90228271484375, ACC: 0.9228582978248596
2023-07-25 23:18:37,057 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 270.3088684082031, ACC: 0.9130024909973145
2023-07-25 23:18:48,176 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 283.5311279296875, ACC: 0.9024229049682617
2023-07-25 23:18:59,400 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 299.83001708984375, ACC: 0.8858268857002258
2023-07-25 23:19:09,855 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 316.64056396484375, ACC: 0.8713100552558899
2023-07-25 23:19:21,194 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 330.2112121582031, ACC: 0.8575959205627441
2023-07-25 23:19:32,235 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 339.8053283691406, ACC: 0.8496074676513672
2023-07-25 23:19:43,595 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 350.7365417480469, ACC: 0.8384407758712769
2023-07-25 23:19:54,156 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 359.1901550292969, ACC: 0.8390867710113525
2023-07-25 23:20:04,987 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 367.8636779785156, ACC: 0.8343383073806763
2023-07-25 23:20:15,713 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 376.9736328125, ACC: 0.8334513902664185
2023-07-25 23:20:26,128 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 391.42877197265625, ACC: 0.8279789686203003
2023-07-25 23:20:36,448 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 407.5816345214844, ACC: 0.8164390921592712
2023-07-25 23:20:36,536 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-V850_30-timesteps_vis.h5
2023-07-25 23:21:29,838 - root - INFO - ------------------ Configuration ------------------
2023-07-25 23:21:29,839 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 23:21:29,839 - root - INFO - Configuration name: afno_backbone
2023-07-25 23:21:29,839 - root - INFO - log_to_wandb True
2023-07-25 23:21:29,839 - root - INFO - lr 0.0005
2023-07-25 23:21:29,839 - root - INFO - batch_size 64
2023-07-25 23:21:29,839 - root - INFO - max_epochs 150
2023-07-25 23:21:29,839 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 23:21:29,839 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 23:21:29,839 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 23:21:29,839 - root - INFO - orography False
2023-07-25 23:21:29,839 - root - INFO - orography_path None
2023-07-25 23:21:29,839 - root - INFO - exp_dir FourCastNet/results
2023-07-25 23:21:29,839 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 23:21:29,839 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 23:21:29,839 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 23:21:29,840 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 23:21:29,840 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 23:21:29,840 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 23:21:29,840 - root - INFO - loss l2
2023-07-25 23:21:29,840 - root - INFO - num_data_workers 4
2023-07-25 23:21:29,840 - root - INFO - dt 1
2023-07-25 23:21:29,840 - root - INFO - n_history 0
2023-07-25 23:21:29,840 - root - INFO - prediction_type iterative
2023-07-25 23:21:29,840 - root - INFO - prediction_length 30
2023-07-25 23:21:29,840 - root - INFO - n_initial_conditions 5
2023-07-25 23:21:29,840 - root - INFO - ics_type default
2023-07-25 23:21:29,840 - root - INFO - save_raw_forecasts True
2023-07-25 23:21:29,840 - root - INFO - save_channel False
2023-07-25 23:21:29,840 - root - INFO - masked_acc False
2023-07-25 23:21:29,840 - root - INFO - maskpath None
2023-07-25 23:21:29,840 - root - INFO - perturb False
2023-07-25 23:21:29,840 - root - INFO - add_grid False
2023-07-25 23:21:29,840 - root - INFO - N_grid_channels 0
2023-07-25 23:21:29,840 - root - INFO - gridtype sinusoidal
2023-07-25 23:21:29,840 - root - INFO - roll False
2023-07-25 23:21:29,841 - root - INFO - num_blocks 8
2023-07-25 23:21:29,841 - root - INFO - nettype afno
2023-07-25 23:21:29,841 - root - INFO - patch_size 8
2023-07-25 23:21:29,841 - root - INFO - width 56
2023-07-25 23:21:29,841 - root - INFO - modes 32
2023-07-25 23:21:29,841 - root - INFO - target Z850
2023-07-25 23:21:29,841 - root - INFO - normalization zscore
2023-07-25 23:21:29,841 - root - INFO - log_to_screen True
2023-07-25 23:21:29,841 - root - INFO - save_checkpoint True
2023-07-25 23:21:29,841 - root - INFO - enable_nhwc False
2023-07-25 23:21:29,841 - root - INFO - optimizer_type FusedAdam
2023-07-25 23:21:29,841 - root - INFO - crop_size_x None
2023-07-25 23:21:29,841 - root - INFO - crop_size_y None
2023-07-25 23:21:29,841 - root - INFO - two_step_training False
2023-07-25 23:21:29,841 - root - INFO - plot_animations False
2023-07-25 23:21:29,841 - root - INFO - add_noise False
2023-07-25 23:21:29,841 - root - INFO - noise_std 0
2023-07-25 23:21:29,841 - root - INFO - world_size 1
2023-07-25 23:21:29,841 - root - INFO - interp 0
2023-07-25 23:21:29,841 - root - INFO - use_daily_climatology False
2023-07-25 23:21:29,841 - root - INFO - global_batch_size 64
2023-07-25 23:21:29,841 - root - INFO - ablate RH850
2023-07-25 23:21:29,842 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 23:21:29,842 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 23:21:29,842 - root - INFO - resuming False
2023-07-25 23:21:29,842 - root - INFO - local_rank 0
2023-07-25 23:21:29,842 - root - INFO - ---------------------------------------------------
2023-07-25 23:21:29,842 - root - INFO - Inference for 1 initial conditions
2023-07-25 23:21:30,147 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 23:21:30,148 - root - INFO - Number of samples per year: 1460
2023-07-25 23:21:30,148 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 23:21:30,148 - root - INFO - Delta t: 6 hours
2023-07-25 23:21:30,148 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 23:21:30,148 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 23:22:33,101 - root - INFO - Loading inference data
2023-07-25 23:22:33,102 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 23:22:33,262 - root - INFO - Initial condition 1 of 1
2023-07-25 23:22:34,042 - root - INFO - Extracting valid data from the first year
2023-07-25 23:24:46,795 - root - INFO - Standardizing data
2023-07-25 23:24:54,918 - root - INFO - Loading time means
2023-07-25 23:25:07,318 - root - INFO - Begin autoregressive inference
2023-07-25 23:25:17,768 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 23:25:29,320 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 85.85929107666016, ACC: 0.9906951189041138
2023-07-25 23:25:40,293 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 93.8118896484375, ACC: 0.9888452291488647
2023-07-25 23:25:51,129 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 109.1418228149414, ACC: 0.9851956963539124
2023-07-25 23:26:01,352 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 126.44365692138672, ACC: 0.979227602481842
2023-07-25 23:26:11,614 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 148.70559692382812, ACC: 0.9717274308204651
2023-07-25 23:26:22,117 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 165.0749053955078, ACC: 0.9657939076423645
2023-07-25 23:26:32,636 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 180.75376892089844, ACC: 0.9607003331184387
2023-07-25 23:26:43,817 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 197.8193817138672, ACC: 0.9528771042823792
2023-07-25 23:26:55,161 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 217.40692138671875, ACC: 0.9450291991233826
2023-07-25 23:27:05,656 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 232.038330078125, ACC: 0.937772274017334
2023-07-25 23:27:16,928 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 242.41746520996094, ACC: 0.9309963583946228
2023-07-25 23:27:27,127 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 253.40264892578125, ACC: 0.9225723743438721
2023-07-25 23:27:37,763 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 272.22772216796875, ACC: 0.9100707769393921
2023-07-25 23:27:48,515 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 294.19317626953125, ACC: 0.89410001039505
2023-07-25 23:27:58,525 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 311.3651123046875, ACC: 0.8823820352554321
2023-07-25 23:28:08,577 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 333.7705993652344, ACC: 0.8645016551017761
2023-07-25 23:28:19,351 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 355.4276428222656, ACC: 0.8465436100959778
2023-07-25 23:28:30,198 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 375.74725341796875, ACC: 0.8274672031402588
2023-07-25 23:28:40,907 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 395.56427001953125, ACC: 0.806422770023346
2023-07-25 23:28:51,268 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 414.0672912597656, ACC: 0.7796676158905029
2023-07-25 23:29:02,270 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 428.1844482421875, ACC: 0.7641785144805908
2023-07-25 23:29:14,024 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 438.8846435546875, ACC: 0.747941792011261
2023-07-25 23:29:24,365 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 446.95660400390625, ACC: 0.7407499551773071
2023-07-25 23:29:34,538 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 460.9886474609375, ACC: 0.7202847599983215
2023-07-25 23:29:45,063 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 472.33203125, ACC: 0.7201617956161499
2023-07-25 23:29:55,590 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 484.0613708496094, ACC: 0.7093904614448547
2023-07-25 23:30:06,701 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 494.68280029296875, ACC: 0.7101549506187439
2023-07-25 23:30:17,895 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 510.3956604003906, ACC: 0.7022136449813843
2023-07-25 23:30:29,282 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 526.4301147460938, ACC: 0.6929620504379272
2023-07-25 23:30:29,386 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-RH850_30-timesteps_vis.h5
2023-07-25 23:31:22,733 - root - INFO - ------------------ Configuration ------------------
2023-07-25 23:31:22,733 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 23:31:22,733 - root - INFO - Configuration name: afno_backbone
2023-07-25 23:31:22,733 - root - INFO - log_to_wandb True
2023-07-25 23:31:22,733 - root - INFO - lr 0.0005
2023-07-25 23:31:22,734 - root - INFO - batch_size 64
2023-07-25 23:31:22,734 - root - INFO - max_epochs 150
2023-07-25 23:31:22,734 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 23:31:22,734 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 23:31:22,734 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 23:31:22,734 - root - INFO - orography False
2023-07-25 23:31:22,734 - root - INFO - orography_path None
2023-07-25 23:31:22,734 - root - INFO - exp_dir FourCastNet/results
2023-07-25 23:31:22,734 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 23:31:22,734 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 23:31:22,734 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 23:31:22,734 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 23:31:22,734 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 23:31:22,734 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 23:31:22,734 - root - INFO - loss l2
2023-07-25 23:31:22,734 - root - INFO - num_data_workers 4
2023-07-25 23:31:22,734 - root - INFO - dt 1
2023-07-25 23:31:22,735 - root - INFO - n_history 0
2023-07-25 23:31:22,735 - root - INFO - prediction_type iterative
2023-07-25 23:31:22,735 - root - INFO - prediction_length 30
2023-07-25 23:31:22,735 - root - INFO - n_initial_conditions 5
2023-07-25 23:31:22,735 - root - INFO - ics_type default
2023-07-25 23:31:22,735 - root - INFO - save_raw_forecasts True
2023-07-25 23:31:22,735 - root - INFO - save_channel False
2023-07-25 23:31:22,735 - root - INFO - masked_acc False
2023-07-25 23:31:22,735 - root - INFO - maskpath None
2023-07-25 23:31:22,735 - root - INFO - perturb False
2023-07-25 23:31:22,735 - root - INFO - add_grid False
2023-07-25 23:31:22,735 - root - INFO - N_grid_channels 0
2023-07-25 23:31:22,735 - root - INFO - gridtype sinusoidal
2023-07-25 23:31:22,736 - root - INFO - roll False
2023-07-25 23:31:22,736 - root - INFO - num_blocks 8
2023-07-25 23:31:22,736 - root - INFO - nettype afno
2023-07-25 23:31:22,736 - root - INFO - patch_size 8
2023-07-25 23:31:22,736 - root - INFO - width 56
2023-07-25 23:31:22,736 - root - INFO - modes 32
2023-07-25 23:31:22,736 - root - INFO - target Z850
2023-07-25 23:31:22,736 - root - INFO - normalization zscore
2023-07-25 23:31:22,736 - root - INFO - log_to_screen True
2023-07-25 23:31:22,736 - root - INFO - save_checkpoint True
2023-07-25 23:31:22,736 - root - INFO - enable_nhwc False
2023-07-25 23:31:22,736 - root - INFO - optimizer_type FusedAdam
2023-07-25 23:31:22,736 - root - INFO - crop_size_x None
2023-07-25 23:31:22,736 - root - INFO - crop_size_y None
2023-07-25 23:31:22,736 - root - INFO - two_step_training False
2023-07-25 23:31:22,737 - root - INFO - plot_animations False
2023-07-25 23:31:22,737 - root - INFO - add_noise False
2023-07-25 23:31:22,737 - root - INFO - noise_std 0
2023-07-25 23:31:22,737 - root - INFO - world_size 1
2023-07-25 23:31:22,737 - root - INFO - interp 0
2023-07-25 23:31:22,737 - root - INFO - use_daily_climatology False
2023-07-25 23:31:22,737 - root - INFO - global_batch_size 64
2023-07-25 23:31:22,737 - root - INFO - ablate T500
2023-07-25 23:31:22,737 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 23:31:22,737 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 23:31:22,737 - root - INFO - resuming False
2023-07-25 23:31:22,737 - root - INFO - local_rank 0
2023-07-25 23:31:22,737 - root - INFO - ---------------------------------------------------
2023-07-25 23:31:22,737 - root - INFO - Inference for 1 initial conditions
2023-07-25 23:31:23,012 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 23:31:23,013 - root - INFO - Number of samples per year: 1460
2023-07-25 23:31:23,013 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 23:31:23,013 - root - INFO - Delta t: 6 hours
2023-07-25 23:31:23,013 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 23:31:23,014 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 23:32:28,993 - root - INFO - Loading inference data
2023-07-25 23:32:28,994 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 23:32:29,192 - root - INFO - Initial condition 1 of 1
2023-07-25 23:32:29,961 - root - INFO - Extracting valid data from the first year
2023-07-25 23:34:48,303 - root - INFO - Standardizing data
2023-07-25 23:34:56,837 - root - INFO - Loading time means
2023-07-25 23:35:09,534 - root - INFO - Begin autoregressive inference
2023-07-25 23:35:20,818 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 23:35:32,485 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 84.09059143066406, ACC: 0.991322934627533
2023-07-25 23:35:42,829 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 73.40838623046875, ACC: 0.9930299520492554
2023-07-25 23:35:52,862 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 75.7193374633789, ACC: 0.9929091334342957
2023-07-25 23:36:03,140 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 88.84477996826172, ACC: 0.9896702766418457
2023-07-25 23:36:14,165 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 96.36112213134766, ACC: 0.9881359934806824
2023-07-25 23:36:24,489 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 108.86582946777344, ACC: 0.9852589964866638
2023-07-25 23:36:34,731 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 113.88162994384766, ACC: 0.9844973683357239
2023-07-25 23:36:45,602 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 125.31757354736328, ACC: 0.9812296628952026
2023-07-25 23:36:56,844 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 137.62979125976562, ACC: 0.9782133102416992
2023-07-25 23:37:07,331 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 147.4499053955078, ACC: 0.9752244353294373
2023-07-25 23:37:17,928 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 153.62425231933594, ACC: 0.9728593230247498
2023-07-25 23:37:27,366 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 170.35928344726562, ACC: 0.9657770991325378
2023-07-25 23:37:37,501 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 192.70913696289062, ACC: 0.9558874368667603
2023-07-25 23:37:48,319 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 216.1111602783203, ACC: 0.9441115260124207
2023-07-25 23:37:59,328 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 238.95909118652344, ACC: 0.9319272041320801
2023-07-25 23:38:09,470 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 259.7654113769531, ACC: 0.9194808006286621
2023-07-25 23:38:19,862 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 275.7779846191406, ACC: 0.9090669751167297
2023-07-25 23:38:29,422 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 281.2260437011719, ACC: 0.9054632782936096
2023-07-25 23:38:39,845 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 284.91259765625, ACC: 0.9014018177986145
2023-07-25 23:38:49,786 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 293.6496276855469, ACC: 0.8905541300773621
2023-07-25 23:39:00,560 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 305.9434814453125, ACC: 0.8800272345542908
2023-07-25 23:39:10,201 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 316.96575927734375, ACC: 0.8689640164375305
2023-07-25 23:39:20,958 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 327.52081298828125, ACC: 0.8603311777114868
2023-07-25 23:39:30,920 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 344.1268005371094, ACC: 0.8444294333457947
2023-07-25 23:39:41,178 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 367.40576171875, ACC: 0.830987274646759
2023-07-25 23:39:52,139 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 394.5519104003906, ACC: 0.8072293996810913
2023-07-25 23:40:02,689 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 420.8326110839844, ACC: 0.7886413931846619
2023-07-25 23:40:13,245 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 446.9150695800781, ACC: 0.7700393795967102
2023-07-25 23:40:23,177 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 469.76605224609375, ACC: 0.7503038048744202
2023-07-25 23:40:23,283 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-T500_30-timesteps_vis.h5
2023-07-25 23:41:16,579 - root - INFO - ------------------ Configuration ------------------
2023-07-25 23:41:16,579 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 23:41:16,579 - root - INFO - Configuration name: afno_backbone
2023-07-25 23:41:16,579 - root - INFO - log_to_wandb True
2023-07-25 23:41:16,579 - root - INFO - lr 0.0005
2023-07-25 23:41:16,579 - root - INFO - batch_size 64
2023-07-25 23:41:16,579 - root - INFO - max_epochs 150
2023-07-25 23:41:16,579 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 23:41:16,579 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 23:41:16,579 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 23:41:16,579 - root - INFO - orography False
2023-07-25 23:41:16,579 - root - INFO - orography_path None
2023-07-25 23:41:16,579 - root - INFO - exp_dir FourCastNet/results
2023-07-25 23:41:16,579 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 23:41:16,580 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 23:41:16,580 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 23:41:16,580 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 23:41:16,580 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 23:41:16,580 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 23:41:16,580 - root - INFO - loss l2
2023-07-25 23:41:16,580 - root - INFO - num_data_workers 4
2023-07-25 23:41:16,580 - root - INFO - dt 1
2023-07-25 23:41:16,580 - root - INFO - n_history 0
2023-07-25 23:41:16,580 - root - INFO - prediction_type iterative
2023-07-25 23:41:16,580 - root - INFO - prediction_length 30
2023-07-25 23:41:16,580 - root - INFO - n_initial_conditions 5
2023-07-25 23:41:16,580 - root - INFO - ics_type default
2023-07-25 23:41:16,580 - root - INFO - save_raw_forecasts True
2023-07-25 23:41:16,580 - root - INFO - save_channel False
2023-07-25 23:41:16,580 - root - INFO - masked_acc False
2023-07-25 23:41:16,580 - root - INFO - maskpath None
2023-07-25 23:41:16,580 - root - INFO - perturb False
2023-07-25 23:41:16,580 - root - INFO - add_grid False
2023-07-25 23:41:16,580 - root - INFO - N_grid_channels 0
2023-07-25 23:41:16,581 - root - INFO - gridtype sinusoidal
2023-07-25 23:41:16,581 - root - INFO - roll False
2023-07-25 23:41:16,581 - root - INFO - num_blocks 8
2023-07-25 23:41:16,581 - root - INFO - nettype afno
2023-07-25 23:41:16,581 - root - INFO - patch_size 8
2023-07-25 23:41:16,581 - root - INFO - width 56
2023-07-25 23:41:16,581 - root - INFO - modes 32
2023-07-25 23:41:16,581 - root - INFO - target Z850
2023-07-25 23:41:16,581 - root - INFO - normalization zscore
2023-07-25 23:41:16,581 - root - INFO - log_to_screen True
2023-07-25 23:41:16,581 - root - INFO - save_checkpoint True
2023-07-25 23:41:16,581 - root - INFO - enable_nhwc False
2023-07-25 23:41:16,581 - root - INFO - optimizer_type FusedAdam
2023-07-25 23:41:16,581 - root - INFO - crop_size_x None
2023-07-25 23:41:16,581 - root - INFO - crop_size_y None
2023-07-25 23:41:16,581 - root - INFO - two_step_training False
2023-07-25 23:41:16,581 - root - INFO - plot_animations False
2023-07-25 23:41:16,581 - root - INFO - add_noise False
2023-07-25 23:41:16,581 - root - INFO - noise_std 0
2023-07-25 23:41:16,581 - root - INFO - world_size 1
2023-07-25 23:41:16,582 - root - INFO - interp 0
2023-07-25 23:41:16,582 - root - INFO - use_daily_climatology False
2023-07-25 23:41:16,582 - root - INFO - global_batch_size 64
2023-07-25 23:41:16,582 - root - INFO - ablate U500
2023-07-25 23:41:16,582 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 23:41:16,582 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 23:41:16,582 - root - INFO - resuming False
2023-07-25 23:41:16,582 - root - INFO - local_rank 0
2023-07-25 23:41:16,582 - root - INFO - ---------------------------------------------------
2023-07-25 23:41:16,582 - root - INFO - Inference for 1 initial conditions
2023-07-25 23:41:16,764 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 23:41:16,765 - root - INFO - Number of samples per year: 1460
2023-07-25 23:41:16,765 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 23:41:16,765 - root - INFO - Delta t: 6 hours
2023-07-25 23:41:16,765 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 23:41:16,766 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 23:42:17,727 - root - INFO - Loading inference data
2023-07-25 23:42:17,728 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 23:42:17,981 - root - INFO - Initial condition 1 of 1
2023-07-25 23:42:18,836 - root - INFO - Extracting valid data from the first year
2023-07-25 23:44:27,339 - root - INFO - Standardizing data
2023-07-25 23:44:35,363 - root - INFO - Loading time means
2023-07-25 23:44:47,679 - root - INFO - Begin autoregressive inference
2023-07-25 23:44:58,255 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 23:45:09,449 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 976.7372436523438, ACC: 0.4656870365142822
2023-07-25 23:45:20,712 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 5778.482421875, ACC: -0.002355986274778843
2023-07-25 23:45:31,264 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 9323.599609375, ACC: -0.06043893098831177
2023-07-25 23:45:42,224 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 15018.8515625, ACC: -0.08907155692577362
2023-07-25 23:45:54,236 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 21300.720703125, ACC: -0.09485691785812378
2023-07-25 23:46:04,586 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 27187.994140625, ACC: -0.09340500831604004
2023-07-25 23:46:15,597 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 32062.736328125, ACC: -0.08804288506507874
2023-07-25 23:46:26,145 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 35796.96484375, ACC: -0.0902707427740097
2023-07-25 23:46:36,866 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 38531.4765625, ACC: -0.08951645344495773
2023-07-25 23:46:47,781 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 40475.796875, ACC: -0.08451923727989197
2023-07-25 23:46:58,460 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 41834.17578125, ACC: -0.08350299298763275
2023-07-25 23:47:09,530 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 42772.328125, ACC: -0.08805172890424728
2023-07-25 23:47:19,805 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 43413.01171875, ACC: -0.09232092648744583
2023-07-25 23:47:29,820 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 43842.04296875, ACC: -0.08836694061756134
2023-07-25 23:47:40,631 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 44131.765625, ACC: -0.08635327219963074
2023-07-25 23:47:51,349 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 44329.3671875, ACC: -0.0888785719871521
2023-07-25 23:48:01,607 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 44465.53125, ACC: -0.09460634738206863
2023-07-25 23:48:11,992 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 44553.7578125, ACC: -0.09198880195617676
2023-07-25 23:48:23,195 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 44613.49609375, ACC: -0.09007850289344788
2023-07-25 23:48:32,509 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 44657.21484375, ACC: -0.0942494347691536
2023-07-25 23:48:42,345 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 44689.64453125, ACC: -0.099275141954422
2023-07-25 23:48:52,712 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 44706.89453125, ACC: -0.09488331526517868
2023-07-25 23:49:02,716 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 44719.98046875, ACC: -0.09265924990177155
2023-07-25 23:49:13,307 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 44730.10546875, ACC: -0.09272373467683792
2023-07-25 23:49:23,402 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 44739.66796875, ACC: -0.09334339946508408
2023-07-25 23:49:34,282 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 44740.96875, ACC: -0.08636943995952606
2023-07-25 23:49:44,272 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 44742.55859375, ACC: -0.08111025393009186
2023-07-25 23:49:54,403 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 44746.40234375, ACC: -0.08067019283771515
2023-07-25 23:50:05,468 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 44750.9765625, ACC: -0.08351805806159973
2023-07-25 23:50:05,562 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-U500_30-timesteps_vis.h5
2023-07-25 23:50:59,006 - root - INFO - ------------------ Configuration ------------------
2023-07-25 23:50:59,006 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-25 23:50:59,006 - root - INFO - Configuration name: afno_backbone
2023-07-25 23:50:59,006 - root - INFO - log_to_wandb True
2023-07-25 23:50:59,006 - root - INFO - lr 0.0005
2023-07-25 23:50:59,006 - root - INFO - batch_size 64
2023-07-25 23:50:59,006 - root - INFO - max_epochs 150
2023-07-25 23:50:59,006 - root - INFO - scheduler CosineAnnealingLR
2023-07-25 23:50:59,006 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 23:50:59,006 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-25 23:50:59,006 - root - INFO - orography False
2023-07-25 23:50:59,006 - root - INFO - orography_path None
2023-07-25 23:50:59,006 - root - INFO - exp_dir FourCastNet/results
2023-07-25 23:50:59,006 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-25 23:50:59,006 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-25 23:50:59,007 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 23:50:59,007 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-25 23:50:59,007 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-25 23:50:59,007 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-25 23:50:59,007 - root - INFO - loss l2
2023-07-25 23:50:59,007 - root - INFO - num_data_workers 4
2023-07-25 23:50:59,007 - root - INFO - dt 1
2023-07-25 23:50:59,007 - root - INFO - n_history 0
2023-07-25 23:50:59,007 - root - INFO - prediction_type iterative
2023-07-25 23:50:59,007 - root - INFO - prediction_length 30
2023-07-25 23:50:59,007 - root - INFO - n_initial_conditions 5
2023-07-25 23:50:59,007 - root - INFO - ics_type default
2023-07-25 23:50:59,007 - root - INFO - save_raw_forecasts True
2023-07-25 23:50:59,007 - root - INFO - save_channel False
2023-07-25 23:50:59,007 - root - INFO - masked_acc False
2023-07-25 23:50:59,007 - root - INFO - maskpath None
2023-07-25 23:50:59,007 - root - INFO - perturb False
2023-07-25 23:50:59,007 - root - INFO - add_grid False
2023-07-25 23:50:59,007 - root - INFO - N_grid_channels 0
2023-07-25 23:50:59,007 - root - INFO - gridtype sinusoidal
2023-07-25 23:50:59,007 - root - INFO - roll False
2023-07-25 23:50:59,007 - root - INFO - num_blocks 8
2023-07-25 23:50:59,007 - root - INFO - nettype afno
2023-07-25 23:50:59,007 - root - INFO - patch_size 8
2023-07-25 23:50:59,008 - root - INFO - width 56
2023-07-25 23:50:59,008 - root - INFO - modes 32
2023-07-25 23:50:59,008 - root - INFO - target Z850
2023-07-25 23:50:59,008 - root - INFO - normalization zscore
2023-07-25 23:50:59,008 - root - INFO - log_to_screen True
2023-07-25 23:50:59,008 - root - INFO - save_checkpoint True
2023-07-25 23:50:59,008 - root - INFO - enable_nhwc False
2023-07-25 23:50:59,008 - root - INFO - optimizer_type FusedAdam
2023-07-25 23:50:59,008 - root - INFO - crop_size_x None
2023-07-25 23:50:59,008 - root - INFO - crop_size_y None
2023-07-25 23:50:59,008 - root - INFO - two_step_training False
2023-07-25 23:50:59,008 - root - INFO - plot_animations False
2023-07-25 23:50:59,008 - root - INFO - add_noise False
2023-07-25 23:50:59,008 - root - INFO - noise_std 0
2023-07-25 23:50:59,008 - root - INFO - world_size 1
2023-07-25 23:50:59,008 - root - INFO - interp 0
2023-07-25 23:50:59,008 - root - INFO - use_daily_climatology False
2023-07-25 23:50:59,008 - root - INFO - global_batch_size 64
2023-07-25 23:50:59,008 - root - INFO - ablate V500
2023-07-25 23:50:59,008 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-25 23:50:59,008 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 23:50:59,008 - root - INFO - resuming False
2023-07-25 23:50:59,008 - root - INFO - local_rank 0
2023-07-25 23:50:59,008 - root - INFO - ---------------------------------------------------
2023-07-25 23:50:59,008 - root - INFO - Inference for 1 initial conditions
2023-07-25 23:50:59,358 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-25 23:50:59,359 - root - INFO - Number of samples per year: 1460
2023-07-25 23:50:59,359 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-25 23:50:59,359 - root - INFO - Delta t: 6 hours
2023-07-25 23:50:59,359 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-25 23:50:59,360 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-25 23:51:55,120 - root - INFO - Loading inference data
2023-07-25 23:51:55,122 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-25 23:51:55,289 - root - INFO - Initial condition 1 of 1
2023-07-25 23:51:56,237 - root - INFO - Extracting valid data from the first year
2023-07-25 23:53:53,261 - root - INFO - Standardizing data
2023-07-25 23:54:01,738 - root - INFO - Loading time means
2023-07-25 23:54:12,418 - root - INFO - Begin autoregressive inference
2023-07-25 23:54:24,093 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-25 23:54:35,989 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 5905.220703125, ACC: 0.062003783881664276
2023-07-25 23:54:46,579 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 7301.49755859375, ACC: 0.0002923423598986119
2023-07-25 23:54:57,107 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 11832.57421875, ACC: -0.04465470090508461
2023-07-25 23:55:07,553 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 17938.783203125, ACC: -0.06554904580116272
2023-07-25 23:55:18,083 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 24100.244140625, ACC: -0.0746537446975708
2023-07-25 23:55:30,064 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 29518.623046875, ACC: -0.07504478842020035
2023-07-25 23:55:41,617 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 33861.98046875, ACC: -0.07280667126178741
2023-07-25 23:55:53,733 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 37124.5859375, ACC: -0.0780264213681221
2023-07-25 23:56:05,933 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 39460.4453125, ACC: -0.08168019354343414
2023-07-25 23:56:17,634 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 41079.5703125, ACC: -0.07981374859809875
2023-07-25 23:56:28,992 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 42198.58984375, ACC: -0.08051534742116928
2023-07-25 23:56:40,257 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 42968.61328125, ACC: -0.08600024878978729
2023-07-25 23:56:50,705 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 43498.35546875, ACC: -0.09118019789457321
2023-07-25 23:57:00,584 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 43863.71484375, ACC: -0.08806734532117844
2023-07-25 23:57:10,721 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 44123.3359375, ACC: -0.0866517424583435
2023-07-25 23:57:20,387 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 44311.35546875, ACC: -0.08949163556098938
2023-07-25 23:57:31,217 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 44447.84765625, ACC: -0.09514715522527695
2023-07-25 23:57:42,346 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 44539.875, ACC: -0.09243004769086838
2023-07-25 23:57:53,356 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 44603.83984375, ACC: -0.09042081236839294
2023-07-25 23:58:04,218 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 44650.99609375, ACC: -0.0945337638258934
2023-07-25 23:58:14,474 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 44685.828125, ACC: -0.09947635978460312
2023-07-25 23:58:24,740 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 44704.65625, ACC: -0.09502524882555008
2023-07-25 23:58:35,465 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 44718.71484375, ACC: -0.09274835139513016
2023-07-25 23:58:45,665 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 44729.42578125, ACC: -0.09278183430433273
2023-07-25 23:58:56,938 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 44739.328125, ACC: -0.09337857365608215
2023-07-25 23:59:06,904 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 44740.8203125, ACC: -0.08639124035835266
2023-07-25 23:59:17,231 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 44742.51171875, ACC: -0.0811239704489708
2023-07-25 23:59:27,732 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 44746.40625, ACC: -0.08068019151687622
2023-07-25 23:59:37,977 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 44751.00390625, ACC: -0.08352474123239517
2023-07-25 23:59:38,064 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-V500_30-timesteps_vis.h5
2023-07-26 00:00:31,453 - root - INFO - ------------------ Configuration ------------------
2023-07-26 00:00:31,454 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 00:00:31,454 - root - INFO - Configuration name: afno_backbone
2023-07-26 00:00:31,454 - root - INFO - log_to_wandb True
2023-07-26 00:00:31,454 - root - INFO - lr 0.0005
2023-07-26 00:00:31,454 - root - INFO - batch_size 64
2023-07-26 00:00:31,454 - root - INFO - max_epochs 150
2023-07-26 00:00:31,454 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 00:00:31,454 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 00:00:31,454 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 00:00:31,454 - root - INFO - orography False
2023-07-26 00:00:31,454 - root - INFO - orography_path None
2023-07-26 00:00:31,454 - root - INFO - exp_dir FourCastNet/results
2023-07-26 00:00:31,454 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 00:00:31,454 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 00:00:31,454 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 00:00:31,454 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 00:00:31,455 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 00:00:31,455 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 00:00:31,455 - root - INFO - loss l2
2023-07-26 00:00:31,455 - root - INFO - num_data_workers 4
2023-07-26 00:00:31,455 - root - INFO - dt 1
2023-07-26 00:00:31,455 - root - INFO - n_history 0
2023-07-26 00:00:31,455 - root - INFO - prediction_type iterative
2023-07-26 00:00:31,455 - root - INFO - prediction_length 30
2023-07-26 00:00:31,455 - root - INFO - n_initial_conditions 5
2023-07-26 00:00:31,455 - root - INFO - ics_type default
2023-07-26 00:00:31,455 - root - INFO - save_raw_forecasts True
2023-07-26 00:00:31,455 - root - INFO - save_channel False
2023-07-26 00:00:31,456 - root - INFO - masked_acc False
2023-07-26 00:00:31,456 - root - INFO - maskpath None
2023-07-26 00:00:31,456 - root - INFO - perturb False
2023-07-26 00:00:31,456 - root - INFO - add_grid False
2023-07-26 00:00:31,456 - root - INFO - N_grid_channels 0
2023-07-26 00:00:31,456 - root - INFO - gridtype sinusoidal
2023-07-26 00:00:31,456 - root - INFO - roll False
2023-07-26 00:00:31,456 - root - INFO - num_blocks 8
2023-07-26 00:00:31,456 - root - INFO - nettype afno
2023-07-26 00:00:31,456 - root - INFO - patch_size 8
2023-07-26 00:00:31,456 - root - INFO - width 56
2023-07-26 00:00:31,456 - root - INFO - modes 32
2023-07-26 00:00:31,456 - root - INFO - target Z850
2023-07-26 00:00:31,456 - root - INFO - normalization zscore
2023-07-26 00:00:31,456 - root - INFO - log_to_screen True
2023-07-26 00:00:31,456 - root - INFO - save_checkpoint True
2023-07-26 00:00:31,456 - root - INFO - enable_nhwc False
2023-07-26 00:00:31,456 - root - INFO - optimizer_type FusedAdam
2023-07-26 00:00:31,457 - root - INFO - crop_size_x None
2023-07-26 00:00:31,457 - root - INFO - crop_size_y None
2023-07-26 00:00:31,457 - root - INFO - two_step_training False
2023-07-26 00:00:31,457 - root - INFO - plot_animations False
2023-07-26 00:00:31,457 - root - INFO - add_noise False
2023-07-26 00:00:31,457 - root - INFO - noise_std 0
2023-07-26 00:00:31,457 - root - INFO - world_size 1
2023-07-26 00:00:31,457 - root - INFO - interp 0
2023-07-26 00:00:31,457 - root - INFO - use_daily_climatology False
2023-07-26 00:00:31,457 - root - INFO - global_batch_size 64
2023-07-26 00:00:31,457 - root - INFO - ablate Z500
2023-07-26 00:00:31,457 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 00:00:31,457 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 00:00:31,457 - root - INFO - resuming False
2023-07-26 00:00:31,457 - root - INFO - local_rank 0
2023-07-26 00:00:31,457 - root - INFO - ---------------------------------------------------
2023-07-26 00:00:31,457 - root - INFO - Inference for 1 initial conditions
2023-07-26 00:00:31,662 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 00:00:31,663 - root - INFO - Number of samples per year: 1460
2023-07-26 00:00:31,663 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 00:00:31,664 - root - INFO - Delta t: 6 hours
2023-07-26 00:00:31,664 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 00:00:31,664 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 00:01:33,190 - root - INFO - Loading inference data
2023-07-26 00:01:33,191 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 00:01:33,393 - root - INFO - Initial condition 1 of 1
2023-07-26 00:01:34,295 - root - INFO - Extracting valid data from the first year
2023-07-26 00:03:57,796 - root - INFO - Standardizing data
2023-07-26 00:04:06,391 - root - INFO - Loading time means
2023-07-26 00:04:20,849 - root - INFO - Begin autoregressive inference
2023-07-26 00:04:32,212 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-26 00:04:44,934 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 31.70937156677246, ACC: 0.9986467361450195
2023-07-26 00:04:57,374 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 50.54033660888672, ACC: 0.9965492486953735
2023-07-26 00:05:09,374 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 66.18114471435547, ACC: 0.9942678213119507
2023-07-26 00:05:22,041 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 82.14922332763672, ACC: 0.9909955859184265
2023-07-26 00:05:33,796 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 89.20960235595703, ACC: 0.989723265171051
2023-07-26 00:05:45,927 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 108.85554504394531, ACC: 0.9850620031356812
2023-07-26 00:05:57,201 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 122.95291900634766, ACC: 0.9817232489585876
2023-07-26 00:06:08,497 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 144.04505920410156, ACC: 0.9749200940132141
2023-07-26 00:06:21,400 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 162.05291748046875, ACC: 0.969483494758606
2023-07-26 00:06:33,645 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 181.724365234375, ACC: 0.9619510173797607
2023-07-26 00:06:45,830 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 193.4144287109375, ACC: 0.9567494988441467
2023-07-26 00:06:57,869 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 210.9239959716797, ACC: 0.9471402764320374
2023-07-26 00:07:09,317 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 227.73838806152344, ACC: 0.9379577040672302
2023-07-26 00:07:20,858 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 247.90550231933594, ACC: 0.9258055090904236
2023-07-26 00:07:32,442 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 268.67327880859375, ACC: 0.9131914973258972
2023-07-26 00:07:43,767 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 293.90399169921875, ACC: 0.8959137201309204
2023-07-26 00:07:55,404 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 317.2386474609375, ACC: 0.8783037662506104
2023-07-26 00:08:06,760 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 340.855224609375, ACC: 0.8586405515670776
2023-07-26 00:08:18,097 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 360.34906005859375, ACC: 0.8386563658714294
2023-07-26 00:08:29,127 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 380.02740478515625, ACC: 0.8129173517227173
2023-07-26 00:08:40,602 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 401.1022033691406, ACC: 0.7896294593811035
2023-07-26 00:08:52,032 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 431.2047424316406, ACC: 0.7532796263694763
2023-07-26 00:09:04,193 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 466.34747314453125, ACC: 0.7115712761878967
2023-07-26 00:09:15,975 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 507.6771240234375, ACC: 0.6549240350723267
2023-07-26 00:09:27,177 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 547.762939453125, ACC: 0.6123440861701965
2023-07-26 00:09:38,067 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 577.6239013671875, ACC: 0.5687999129295349
2023-07-26 00:09:48,666 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 598.7798461914062, ACC: 0.5454874038696289
2023-07-26 00:09:59,920 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 619.40966796875, ACC: 0.5240536332130432
2023-07-26 00:10:12,000 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 634.1978759765625, ACC: 0.5052839517593384
2023-07-26 00:10:12,088 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-Z500_30-timesteps_vis.h5
2023-07-26 00:11:05,546 - root - INFO - ------------------ Configuration ------------------
2023-07-26 00:11:05,546 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 00:11:05,546 - root - INFO - Configuration name: afno_backbone
2023-07-26 00:11:05,546 - root - INFO - log_to_wandb True
2023-07-26 00:11:05,546 - root - INFO - lr 0.0005
2023-07-26 00:11:05,546 - root - INFO - batch_size 64
2023-07-26 00:11:05,546 - root - INFO - max_epochs 150
2023-07-26 00:11:05,546 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 00:11:05,546 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 00:11:05,546 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 00:11:05,546 - root - INFO - orography False
2023-07-26 00:11:05,546 - root - INFO - orography_path None
2023-07-26 00:11:05,546 - root - INFO - exp_dir FourCastNet/results
2023-07-26 00:11:05,546 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 00:11:05,547 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 00:11:05,547 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 00:11:05,547 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 00:11:05,547 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 00:11:05,547 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 00:11:05,547 - root - INFO - loss l2
2023-07-26 00:11:05,547 - root - INFO - num_data_workers 4
2023-07-26 00:11:05,547 - root - INFO - dt 1
2023-07-26 00:11:05,547 - root - INFO - n_history 0
2023-07-26 00:11:05,547 - root - INFO - prediction_type iterative
2023-07-26 00:11:05,547 - root - INFO - prediction_length 30
2023-07-26 00:11:05,547 - root - INFO - n_initial_conditions 5
2023-07-26 00:11:05,547 - root - INFO - ics_type default
2023-07-26 00:11:05,547 - root - INFO - save_raw_forecasts True
2023-07-26 00:11:05,547 - root - INFO - save_channel False
2023-07-26 00:11:05,547 - root - INFO - masked_acc False
2023-07-26 00:11:05,547 - root - INFO - maskpath None
2023-07-26 00:11:05,547 - root - INFO - perturb False
2023-07-26 00:11:05,548 - root - INFO - add_grid False
2023-07-26 00:11:05,548 - root - INFO - N_grid_channels 0
2023-07-26 00:11:05,548 - root - INFO - gridtype sinusoidal
2023-07-26 00:11:05,548 - root - INFO - roll False
2023-07-26 00:11:05,548 - root - INFO - num_blocks 8
2023-07-26 00:11:05,548 - root - INFO - nettype afno
2023-07-26 00:11:05,548 - root - INFO - patch_size 8
2023-07-26 00:11:05,548 - root - INFO - width 56
2023-07-26 00:11:05,548 - root - INFO - modes 32
2023-07-26 00:11:05,548 - root - INFO - target Z850
2023-07-26 00:11:05,548 - root - INFO - normalization zscore
2023-07-26 00:11:05,548 - root - INFO - log_to_screen True
2023-07-26 00:11:05,548 - root - INFO - save_checkpoint True
2023-07-26 00:11:05,548 - root - INFO - enable_nhwc False
2023-07-26 00:11:05,548 - root - INFO - optimizer_type FusedAdam
2023-07-26 00:11:05,548 - root - INFO - crop_size_x None
2023-07-26 00:11:05,548 - root - INFO - crop_size_y None
2023-07-26 00:11:05,548 - root - INFO - two_step_training False
2023-07-26 00:11:05,549 - root - INFO - plot_animations False
2023-07-26 00:11:05,549 - root - INFO - add_noise False
2023-07-26 00:11:05,549 - root - INFO - noise_std 0
2023-07-26 00:11:05,549 - root - INFO - world_size 1
2023-07-26 00:11:05,549 - root - INFO - interp 0
2023-07-26 00:11:05,549 - root - INFO - use_daily_climatology False
2023-07-26 00:11:05,549 - root - INFO - global_batch_size 64
2023-07-26 00:11:05,549 - root - INFO - ablate RH500
2023-07-26 00:11:05,549 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 00:11:05,549 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 00:11:05,549 - root - INFO - resuming False
2023-07-26 00:11:05,549 - root - INFO - local_rank 0
2023-07-26 00:11:05,549 - root - INFO - ---------------------------------------------------
2023-07-26 00:11:05,549 - root - INFO - Inference for 1 initial conditions
2023-07-26 00:11:05,878 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 00:11:05,881 - root - INFO - Number of samples per year: 1460
2023-07-26 00:11:05,881 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 00:11:05,881 - root - INFO - Delta t: 6 hours
2023-07-26 00:11:05,881 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 00:11:05,881 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 00:12:15,450 - root - INFO - Loading inference data
2023-07-26 00:12:15,451 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 00:12:15,653 - root - INFO - Initial condition 1 of 1
2023-07-26 00:12:16,567 - root - INFO - Extracting valid data from the first year
2023-07-26 00:14:38,294 - root - INFO - Standardizing data
2023-07-26 00:14:46,299 - root - INFO - Loading time means
2023-07-26 00:15:02,731 - root - INFO - Begin autoregressive inference
2023-07-26 00:15:14,871 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-26 00:15:26,772 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 31.39943504333496, ACC: 0.9986659288406372
2023-07-26 00:15:39,162 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 43.259849548339844, ACC: 0.9974755644798279
2023-07-26 00:15:50,448 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 54.82499694824219, ACC: 0.9960748553276062
2023-07-26 00:16:02,457 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 68.2127456665039, ACC: 0.9938239455223083
2023-07-26 00:16:13,817 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 80.55087280273438, ACC: 0.9916654229164124
2023-07-26 00:16:25,562 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 91.61549377441406, ACC: 0.9894201159477234
2023-07-26 00:16:36,570 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 97.94298553466797, ACC: 0.9884512424468994
2023-07-26 00:16:47,995 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 111.6339340209961, ACC: 0.985036313533783
2023-07-26 00:16:59,299 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 127.07682800292969, ACC: 0.9813977479934692
2023-07-26 00:17:10,237 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 140.87835693359375, ACC: 0.9773545861244202
2023-07-26 00:17:21,929 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 154.11839294433594, ACC: 0.972868800163269
2023-07-26 00:17:33,199 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 174.1343994140625, ACC: 0.9643825888633728
2023-07-26 00:17:43,695 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 198.5425262451172, ACC: 0.9533186554908752
2023-07-26 00:17:54,185 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 222.88702392578125, ACC: 0.9405661821365356
2023-07-26 00:18:05,678 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 245.9516143798828, ACC: 0.9279512166976929
2023-07-26 00:18:16,724 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 272.4719543457031, ACC: 0.9113832712173462
2023-07-26 00:18:26,891 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 294.1489562988281, ACC: 0.8962480425834656
2023-07-26 00:18:38,129 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 309.23565673828125, ACC: 0.884671688079834
2023-07-26 00:18:48,895 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 320.0748291015625, ACC: 0.8741581439971924
2023-07-26 00:18:59,684 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 331.69329833984375, ACC: 0.8589550852775574
2023-07-26 00:19:10,976 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 343.2924499511719, ACC: 0.8481034636497498
2023-07-26 00:19:21,874 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 359.08465576171875, ACC: 0.8319591879844666
2023-07-26 00:19:32,425 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 377.1050720214844, ACC: 0.8166324496269226
2023-07-26 00:19:42,862 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 398.7908935546875, ACC: 0.7940192818641663
2023-07-26 00:19:52,573 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 414.54864501953125, ACC: 0.787520706653595
2023-07-26 00:20:03,386 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 426.6216735839844, ACC: 0.7782742977142334
2023-07-26 00:20:13,753 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 445.7745056152344, ACC: 0.7661948800086975
2023-07-26 00:20:24,131 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 475.0830078125, ACC: 0.7424700856208801
2023-07-26 00:20:34,242 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 502.9754943847656, ACC: 0.7142688035964966
2023-07-26 00:20:34,339 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-RH500_30-timesteps_vis.h5
2023-07-26 00:21:27,552 - root - INFO - ------------------ Configuration ------------------
2023-07-26 00:21:27,552 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 00:21:27,552 - root - INFO - Configuration name: afno_backbone
2023-07-26 00:21:27,552 - root - INFO - log_to_wandb True
2023-07-26 00:21:27,552 - root - INFO - lr 0.0005
2023-07-26 00:21:27,552 - root - INFO - batch_size 64
2023-07-26 00:21:27,552 - root - INFO - max_epochs 150
2023-07-26 00:21:27,552 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 00:21:27,552 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 00:21:27,552 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 00:21:27,552 - root - INFO - orography False
2023-07-26 00:21:27,553 - root - INFO - orography_path None
2023-07-26 00:21:27,553 - root - INFO - exp_dir FourCastNet/results
2023-07-26 00:21:27,553 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 00:21:27,553 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 00:21:27,553 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 00:21:27,553 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 00:21:27,553 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 00:21:27,553 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 00:21:27,553 - root - INFO - loss l2
2023-07-26 00:21:27,553 - root - INFO - num_data_workers 4
2023-07-26 00:21:27,553 - root - INFO - dt 1
2023-07-26 00:21:27,553 - root - INFO - n_history 0
2023-07-26 00:21:27,553 - root - INFO - prediction_type iterative
2023-07-26 00:21:27,553 - root - INFO - prediction_length 30
2023-07-26 00:21:27,553 - root - INFO - n_initial_conditions 5
2023-07-26 00:21:27,553 - root - INFO - ics_type default
2023-07-26 00:21:27,553 - root - INFO - save_raw_forecasts True
2023-07-26 00:21:27,553 - root - INFO - save_channel False
2023-07-26 00:21:27,553 - root - INFO - masked_acc False
2023-07-26 00:21:27,553 - root - INFO - maskpath None
2023-07-26 00:21:27,553 - root - INFO - perturb False
2023-07-26 00:21:27,553 - root - INFO - add_grid False
2023-07-26 00:21:27,553 - root - INFO - N_grid_channels 0
2023-07-26 00:21:27,553 - root - INFO - gridtype sinusoidal
2023-07-26 00:21:27,553 - root - INFO - roll False
2023-07-26 00:21:27,553 - root - INFO - num_blocks 8
2023-07-26 00:21:27,553 - root - INFO - nettype afno
2023-07-26 00:21:27,553 - root - INFO - patch_size 8
2023-07-26 00:21:27,554 - root - INFO - width 56
2023-07-26 00:21:27,554 - root - INFO - modes 32
2023-07-26 00:21:27,554 - root - INFO - target Z850
2023-07-26 00:21:27,554 - root - INFO - normalization zscore
2023-07-26 00:21:27,554 - root - INFO - log_to_screen True
2023-07-26 00:21:27,554 - root - INFO - save_checkpoint True
2023-07-26 00:21:27,554 - root - INFO - enable_nhwc False
2023-07-26 00:21:27,554 - root - INFO - optimizer_type FusedAdam
2023-07-26 00:21:27,554 - root - INFO - crop_size_x None
2023-07-26 00:21:27,554 - root - INFO - crop_size_y None
2023-07-26 00:21:27,554 - root - INFO - two_step_training False
2023-07-26 00:21:27,554 - root - INFO - plot_animations False
2023-07-26 00:21:27,554 - root - INFO - add_noise False
2023-07-26 00:21:27,554 - root - INFO - noise_std 0
2023-07-26 00:21:27,555 - root - INFO - world_size 1
2023-07-26 00:21:27,555 - root - INFO - interp 0
2023-07-26 00:21:27,555 - root - INFO - use_daily_climatology False
2023-07-26 00:21:27,555 - root - INFO - global_batch_size 64
2023-07-26 00:21:27,555 - root - INFO - ablate Z50
2023-07-26 00:21:27,555 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 00:21:27,555 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 00:21:27,555 - root - INFO - resuming False
2023-07-26 00:21:27,555 - root - INFO - local_rank 0
2023-07-26 00:21:27,555 - root - INFO - ---------------------------------------------------
2023-07-26 00:21:27,555 - root - INFO - Inference for 1 initial conditions
2023-07-26 00:21:27,928 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 00:21:27,929 - root - INFO - Number of samples per year: 1460
2023-07-26 00:21:27,929 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 00:21:27,929 - root - INFO - Delta t: 6 hours
2023-07-26 00:21:27,929 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 00:21:27,929 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 00:22:41,075 - root - INFO - Loading inference data
2023-07-26 00:22:41,077 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 00:22:41,321 - root - INFO - Initial condition 1 of 1
2023-07-26 00:22:42,155 - root - INFO - Extracting valid data from the first year
2023-07-26 00:25:11,044 - root - INFO - Standardizing data
2023-07-26 00:25:19,199 - root - INFO - Loading time means
2023-07-26 00:25:35,257 - root - INFO - Begin autoregressive inference
2023-07-26 00:25:46,268 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-26 00:25:57,501 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 35.4203987121582, ACC: 0.9983359575271606
2023-07-26 00:26:08,460 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 45.8359489440918, ACC: 0.9971787333488464
2023-07-26 00:26:19,330 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 52.09196472167969, ACC: 0.9964605569839478
2023-07-26 00:26:30,293 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 64.09481811523438, ACC: 0.9945380091667175
2023-07-26 00:26:40,916 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 68.80817413330078, ACC: 0.9939199090003967
2023-07-26 00:26:52,152 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 82.90359497070312, ACC: 0.9913424849510193
2023-07-26 00:27:03,776 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 90.65254211425781, ACC: 0.9901229739189148
2023-07-26 00:27:14,907 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 106.96038055419922, ACC: 0.9862664937973022
2023-07-26 00:27:25,570 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 122.57435607910156, ACC: 0.9827497005462646
2023-07-26 00:27:36,153 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 137.6258544921875, ACC: 0.9784551858901978
2023-07-26 00:27:46,863 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 144.83892822265625, ACC: 0.9762064218521118
2023-07-26 00:27:57,386 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 158.38772583007812, ACC: 0.9706080555915833
2023-07-26 00:28:08,636 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 176.46336364746094, ACC: 0.9632722735404968
2023-07-26 00:28:20,209 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 197.41905212402344, ACC: 0.9535965323448181
2023-07-26 00:28:30,848 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 216.85597229003906, ACC: 0.9443132877349854
2023-07-26 00:28:42,071 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 240.5374755859375, ACC: 0.9313871264457703
2023-07-26 00:28:52,421 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 260.21942138671875, ACC: 0.9194895625114441
2023-07-26 00:29:02,589 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 276.1679382324219, ACC: 0.9089997410774231
2023-07-26 00:29:12,284 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 286.2439880371094, ACC: 0.9004306197166443
2023-07-26 00:29:22,802 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 301.01654052734375, ACC: 0.884685218334198
2023-07-26 00:29:33,025 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 315.8018493652344, ACC: 0.871821403503418
2023-07-26 00:29:43,405 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 338.05926513671875, ACC: 0.8501472473144531
2023-07-26 00:29:54,231 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 360.5944519042969, ACC: 0.82920241355896
2023-07-26 00:30:06,118 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 389.9490966796875, ACC: 0.7973644733428955
2023-07-26 00:30:17,579 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 414.71453857421875, ACC: 0.7814033627510071
2023-07-26 00:30:29,646 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 439.9822692871094, ACC: 0.7566708922386169
2023-07-26 00:30:41,392 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 467.07720947265625, ACC: 0.7354738116264343
2023-07-26 00:30:52,572 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 497.2545471191406, ACC: 0.7093434929847717
2023-07-26 00:31:03,736 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 519.724853515625, ACC: 0.6878212094306946
2023-07-26 00:31:03,830 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-Z50_30-timesteps_vis.h5
2023-07-26 00:31:57,503 - root - INFO - ------------------ Configuration ------------------
2023-07-26 00:31:57,503 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 00:31:57,503 - root - INFO - Configuration name: afno_backbone
2023-07-26 00:31:57,503 - root - INFO - log_to_wandb True
2023-07-26 00:31:57,503 - root - INFO - lr 0.0005
2023-07-26 00:31:57,503 - root - INFO - batch_size 64
2023-07-26 00:31:57,504 - root - INFO - max_epochs 150
2023-07-26 00:31:57,504 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 00:31:57,504 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 00:31:57,504 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 00:31:57,504 - root - INFO - orography False
2023-07-26 00:31:57,504 - root - INFO - orography_path None
2023-07-26 00:31:57,504 - root - INFO - exp_dir FourCastNet/results
2023-07-26 00:31:57,504 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 00:31:57,504 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 00:31:57,504 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 00:31:57,504 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 00:31:57,504 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 00:31:57,504 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 00:31:57,504 - root - INFO - loss l2
2023-07-26 00:31:57,504 - root - INFO - num_data_workers 4
2023-07-26 00:31:57,504 - root - INFO - dt 1
2023-07-26 00:31:57,505 - root - INFO - n_history 0
2023-07-26 00:31:57,505 - root - INFO - prediction_type iterative
2023-07-26 00:31:57,505 - root - INFO - prediction_length 30
2023-07-26 00:31:57,505 - root - INFO - n_initial_conditions 5
2023-07-26 00:31:57,505 - root - INFO - ics_type default
2023-07-26 00:31:57,505 - root - INFO - save_raw_forecasts True
2023-07-26 00:31:57,505 - root - INFO - save_channel False
2023-07-26 00:31:57,505 - root - INFO - masked_acc False
2023-07-26 00:31:57,505 - root - INFO - maskpath None
2023-07-26 00:31:57,505 - root - INFO - perturb False
2023-07-26 00:31:57,505 - root - INFO - add_grid False
2023-07-26 00:31:57,505 - root - INFO - N_grid_channels 0
2023-07-26 00:31:57,505 - root - INFO - gridtype sinusoidal
2023-07-26 00:31:57,505 - root - INFO - roll False
2023-07-26 00:31:57,505 - root - INFO - num_blocks 8
2023-07-26 00:31:57,505 - root - INFO - nettype afno
2023-07-26 00:31:57,505 - root - INFO - patch_size 8
2023-07-26 00:31:57,505 - root - INFO - width 56
2023-07-26 00:31:57,505 - root - INFO - modes 32
2023-07-26 00:31:57,505 - root - INFO - target Z850
2023-07-26 00:31:57,505 - root - INFO - normalization zscore
2023-07-26 00:31:57,505 - root - INFO - log_to_screen True
2023-07-26 00:31:57,505 - root - INFO - save_checkpoint True
2023-07-26 00:31:57,505 - root - INFO - enable_nhwc False
2023-07-26 00:31:57,505 - root - INFO - optimizer_type FusedAdam
2023-07-26 00:31:57,506 - root - INFO - crop_size_x None
2023-07-26 00:31:57,506 - root - INFO - crop_size_y None
2023-07-26 00:31:57,506 - root - INFO - two_step_training False
2023-07-26 00:31:57,506 - root - INFO - plot_animations False
2023-07-26 00:31:57,506 - root - INFO - add_noise False
2023-07-26 00:31:57,506 - root - INFO - noise_std 0
2023-07-26 00:31:57,506 - root - INFO - world_size 1
2023-07-26 00:31:57,506 - root - INFO - interp 0
2023-07-26 00:31:57,506 - root - INFO - use_daily_climatology False
2023-07-26 00:31:57,506 - root - INFO - global_batch_size 64
2023-07-26 00:31:57,506 - root - INFO - ablate TCWV
2023-07-26 00:31:57,506 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 00:31:57,506 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 00:31:57,506 - root - INFO - resuming False
2023-07-26 00:31:57,506 - root - INFO - local_rank 0
2023-07-26 00:31:57,507 - root - INFO - ---------------------------------------------------
2023-07-26 00:31:57,507 - root - INFO - Inference for 1 initial conditions
2023-07-26 00:31:57,781 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 00:31:57,781 - root - INFO - Number of samples per year: 1460
2023-07-26 00:31:57,782 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 00:31:57,782 - root - INFO - Delta t: 6 hours
2023-07-26 00:31:57,782 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 00:31:57,782 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 00:33:06,798 - root - INFO - Loading inference data
2023-07-26 00:33:06,799 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 00:33:07,038 - root - INFO - Initial condition 1 of 1
2023-07-26 00:33:07,896 - root - INFO - Extracting valid data from the first year
2023-07-26 00:35:25,667 - root - INFO - Standardizing data
2023-07-26 00:35:34,228 - root - INFO - Loading time means
2023-07-26 00:35:50,032 - root - INFO - Begin autoregressive inference
2023-07-26 00:36:00,859 - root - INFO - Predicted timestep 0 of 30. Z850 RMS Error: 0.0, ACC: 1.0
2023-07-26 00:36:12,192 - root - INFO - Predicted timestep 1 of 30. Z850 RMS Error: 201.98487854003906, ACC: 0.9452235102653503
2023-07-26 00:36:23,152 - root - INFO - Predicted timestep 2 of 30. Z850 RMS Error: 277.5416259765625, ACC: 0.8956789374351501
2023-07-26 00:36:33,243 - root - INFO - Predicted timestep 3 of 30. Z850 RMS Error: 488.5404357910156, ACC: 0.7406741976737976
2023-07-26 00:36:43,826 - root - INFO - Predicted timestep 4 of 30. Z850 RMS Error: 939.21630859375, ACC: 0.48883479833602905
2023-07-26 00:36:54,462 - root - INFO - Predicted timestep 5 of 30. Z850 RMS Error: 1520.1746826171875, ACC: 0.3364320993423462
2023-07-26 00:37:05,137 - root - INFO - Predicted timestep 6 of 30. Z850 RMS Error: 2079.892578125, ACC: 0.25604572892189026
2023-07-26 00:37:15,696 - root - INFO - Predicted timestep 7 of 30. Z850 RMS Error: 2561.107666015625, ACC: 0.20908139646053314
2023-07-26 00:37:26,471 - root - INFO - Predicted timestep 8 of 30. Z850 RMS Error: 2955.84619140625, ACC: 0.18053922057151794
2023-07-26 00:37:36,963 - root - INFO - Predicted timestep 9 of 30. Z850 RMS Error: 3288.483642578125, ACC: 0.15543632209300995
2023-07-26 00:37:47,607 - root - INFO - Predicted timestep 10 of 30. Z850 RMS Error: 3590.0205078125, ACC: 0.12933069467544556
2023-07-26 00:37:58,676 - root - INFO - Predicted timestep 11 of 30. Z850 RMS Error: 3892.374267578125, ACC: 0.10139572620391846
2023-07-26 00:38:09,875 - root - INFO - Predicted timestep 12 of 30. Z850 RMS Error: 4207.5556640625, ACC: 0.07484331727027893
2023-07-26 00:38:21,311 - root - INFO - Predicted timestep 13 of 30. Z850 RMS Error: 4544.86474609375, ACC: 0.05067002400755882
2023-07-26 00:38:33,097 - root - INFO - Predicted timestep 14 of 30. Z850 RMS Error: 4881.68408203125, ACC: 0.048089832067489624
2023-07-26 00:38:44,845 - root - INFO - Predicted timestep 15 of 30. Z850 RMS Error: 5228.1904296875, ACC: 0.05009765550494194
2023-07-26 00:38:56,259 - root - INFO - Predicted timestep 16 of 30. Z850 RMS Error: 5579.68896484375, ACC: 0.0643501877784729
2023-07-26 00:39:06,948 - root - INFO - Predicted timestep 17 of 30. Z850 RMS Error: 5954.5166015625, ACC: 0.0709611028432846
2023-07-26 00:39:18,248 - root - INFO - Predicted timestep 18 of 30. Z850 RMS Error: 6352.40185546875, ACC: 0.07972345501184464
2023-07-26 00:39:28,584 - root - INFO - Predicted timestep 19 of 30. Z850 RMS Error: 6783.7314453125, ACC: 0.07742185890674591
2023-07-26 00:39:38,949 - root - INFO - Predicted timestep 20 of 30. Z850 RMS Error: 7250.00244140625, ACC: 0.071128711104393
2023-07-26 00:39:49,587 - root - INFO - Predicted timestep 21 of 30. Z850 RMS Error: 7786.59326171875, ACC: 0.042040277272462845
2023-07-26 00:40:02,078 - root - INFO - Predicted timestep 22 of 30. Z850 RMS Error: 8458.7958984375, ACC: 0.02171000838279724
2023-07-26 00:40:13,494 - root - INFO - Predicted timestep 23 of 30. Z850 RMS Error: 9400.205078125, ACC: -0.008976430632174015
2023-07-26 00:40:24,269 - root - INFO - Predicted timestep 24 of 30. Z850 RMS Error: 10744.1728515625, ACC: -0.023718640208244324
2023-07-26 00:40:34,393 - root - INFO - Predicted timestep 25 of 30. Z850 RMS Error: 12708.5458984375, ACC: -0.059047598391771317
2023-07-26 00:40:44,369 - root - INFO - Predicted timestep 26 of 30. Z850 RMS Error: 15692.20703125, ACC: -0.06738002598285675
2023-07-26 00:40:54,955 - root - INFO - Predicted timestep 27 of 30. Z850 RMS Error: 19702.466796875, ACC: -0.08042556792497635
2023-07-26 00:41:05,746 - root - INFO - Predicted timestep 28 of 30. Z850 RMS Error: 24212.71875, ACC: -0.08048989623785019
2023-07-26 00:41:16,111 - root - INFO - Predicted timestep 29 of 30. Z850 RMS Error: 28641.97265625, ACC: -0.09110377728939056
2023-07-26 00:41:16,224 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-Z850_ablate-TCWV_30-timesteps_vis.h5
2023-07-26 00:42:09,819 - root - INFO - ------------------ Configuration ------------------
2023-07-26 00:42:09,819 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 00:42:09,819 - root - INFO - Configuration name: afno_backbone
2023-07-26 00:42:09,819 - root - INFO - log_to_wandb True
2023-07-26 00:42:09,819 - root - INFO - lr 0.0005
2023-07-26 00:42:09,819 - root - INFO - batch_size 64
2023-07-26 00:42:09,820 - root - INFO - max_epochs 150
2023-07-26 00:42:09,820 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 00:42:09,820 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 00:42:09,820 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 00:42:09,820 - root - INFO - orography False
2023-07-26 00:42:09,820 - root - INFO - orography_path None
2023-07-26 00:42:09,820 - root - INFO - exp_dir FourCastNet/results
2023-07-26 00:42:09,820 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 00:42:09,820 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 00:42:09,820 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 00:42:09,820 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 00:42:09,820 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 00:42:09,820 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 00:42:09,820 - root - INFO - loss l2
2023-07-26 00:42:09,821 - root - INFO - num_data_workers 4
2023-07-26 00:42:09,821 - root - INFO - dt 1
2023-07-26 00:42:09,821 - root - INFO - n_history 0
2023-07-26 00:42:09,821 - root - INFO - prediction_type iterative
2023-07-26 00:42:09,821 - root - INFO - prediction_length 30
2023-07-26 00:42:09,821 - root - INFO - n_initial_conditions 5
2023-07-26 00:42:09,821 - root - INFO - ics_type default
2023-07-26 00:42:09,821 - root - INFO - save_raw_forecasts True
2023-07-26 00:42:09,821 - root - INFO - save_channel False
2023-07-26 00:42:09,821 - root - INFO - masked_acc False
2023-07-26 00:42:09,821 - root - INFO - maskpath None
2023-07-26 00:42:09,821 - root - INFO - perturb False
2023-07-26 00:42:09,821 - root - INFO - add_grid False
2023-07-26 00:42:09,821 - root - INFO - N_grid_channels 0
2023-07-26 00:42:09,821 - root - INFO - gridtype sinusoidal
2023-07-26 00:42:09,821 - root - INFO - roll False
2023-07-26 00:42:09,821 - root - INFO - num_blocks 8
2023-07-26 00:42:09,821 - root - INFO - nettype afno
2023-07-26 00:42:09,822 - root - INFO - patch_size 8
2023-07-26 00:42:09,822 - root - INFO - width 56
2023-07-26 00:42:09,822 - root - INFO - modes 32
2023-07-26 00:42:09,822 - root - INFO - target RH850
2023-07-26 00:42:09,822 - root - INFO - normalization zscore
2023-07-26 00:42:09,822 - root - INFO - log_to_screen True
2023-07-26 00:42:09,822 - root - INFO - save_checkpoint True
2023-07-26 00:42:09,822 - root - INFO - enable_nhwc False
2023-07-26 00:42:09,822 - root - INFO - optimizer_type FusedAdam
2023-07-26 00:42:09,822 - root - INFO - crop_size_x None
2023-07-26 00:42:09,822 - root - INFO - crop_size_y None
2023-07-26 00:42:09,822 - root - INFO - two_step_training False
2023-07-26 00:42:09,822 - root - INFO - plot_animations False
2023-07-26 00:42:09,822 - root - INFO - add_noise False
2023-07-26 00:42:09,823 - root - INFO - noise_std 0
2023-07-26 00:42:09,823 - root - INFO - world_size 1
2023-07-26 00:42:09,823 - root - INFO - interp 0
2023-07-26 00:42:09,823 - root - INFO - use_daily_climatology False
2023-07-26 00:42:09,823 - root - INFO - global_batch_size 64
2023-07-26 00:42:09,823 - root - INFO - ablate U10
2023-07-26 00:42:09,823 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 00:42:09,823 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 00:42:09,823 - root - INFO - resuming False
2023-07-26 00:42:09,823 - root - INFO - local_rank 0
2023-07-26 00:42:09,823 - root - INFO - ---------------------------------------------------
2023-07-26 00:42:09,824 - root - INFO - Inference for 1 initial conditions
2023-07-26 00:42:10,194 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 00:42:10,195 - root - INFO - Number of samples per year: 1460
2023-07-26 00:42:10,195 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 00:42:10,195 - root - INFO - Delta t: 6 hours
2023-07-26 00:42:10,195 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 00:42:10,196 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 00:43:16,542 - root - INFO - Loading inference data
2023-07-26 00:43:16,543 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 00:43:16,761 - root - INFO - Initial condition 1 of 1
2023-07-26 00:43:17,587 - root - INFO - Extracting valid data from the first year
2023-07-26 00:45:29,882 - root - INFO - Standardizing data
2023-07-26 00:45:38,233 - root - INFO - Loading time means
2023-07-26 00:45:49,462 - root - INFO - Begin autoregressive inference
2023-07-26 00:46:00,699 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 00:46:13,285 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 2.7270631790161133, ACC: 0.9626508355140686
2023-07-26 00:46:24,585 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 3.1826624870300293, ACC: 0.9489156007766724
2023-07-26 00:46:35,079 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 5.971004009246826, ACC: 0.8450385332107544
2023-07-26 00:46:45,112 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 8.861271858215332, ACC: 0.7278843522071838
2023-07-26 00:46:55,249 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 10.876935005187988, ACC: 0.6424374580383301
2023-07-26 00:47:06,188 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 12.138604164123535, ACC: 0.5873079299926758
2023-07-26 00:47:16,986 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 13.198831558227539, ACC: 0.5470657348632812
2023-07-26 00:47:27,016 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 14.060256004333496, ACC: 0.5118911266326904
2023-07-26 00:47:37,418 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 14.609389305114746, ACC: 0.48799097537994385
2023-07-26 00:47:47,693 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 15.877090454101562, ACC: 0.44196391105651855
2023-07-26 00:47:58,557 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 16.945070266723633, ACC: 0.40135979652404785
2023-07-26 00:48:09,159 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 18.232803344726562, ACC: 0.3432076573371887
2023-07-26 00:48:19,461 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 19.596729278564453, ACC: 0.29799947142601013
2023-07-26 00:48:29,860 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 21.016080856323242, ACC: 0.25560489296913147
2023-07-26 00:48:40,316 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 22.207157135009766, ACC: 0.22316431999206543
2023-07-26 00:48:50,658 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 23.166311264038086, ACC: 0.2018796056509018
2023-07-26 00:49:02,137 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 24.247528076171875, ACC: 0.19030600786209106
2023-07-26 00:49:13,537 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 25.66423988342285, ACC: 0.17081604897975922
2023-07-26 00:49:23,606 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 26.942440032958984, ACC: 0.1541326344013214
2023-07-26 00:49:35,568 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 28.261173248291016, ACC: 0.13739663362503052
2023-07-26 00:49:46,027 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 29.75019645690918, ACC: 0.12794575095176697
2023-07-26 00:49:56,443 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 31.30339241027832, ACC: 0.11715605109930038
2023-07-26 00:50:06,827 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 32.8974609375, ACC: 0.10069605708122253
2023-07-26 00:50:17,294 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 34.220458984375, ACC: 0.09727900475263596
2023-07-26 00:50:28,189 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 35.672088623046875, ACC: 0.0915856659412384
2023-07-26 00:50:38,549 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 37.618465423583984, ACC: 0.07588449120521545
2023-07-26 00:50:49,396 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 39.54368591308594, ACC: 0.051981259137392044
2023-07-26 00:51:01,119 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 41.391178131103516, ACC: 0.032888367772102356
2023-07-26 00:51:13,253 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 43.219600677490234, ACC: 0.010665933601558208
2023-07-26 00:51:13,339 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-U10_30-timesteps_vis.h5
2023-07-26 00:52:06,651 - root - INFO - ------------------ Configuration ------------------
2023-07-26 00:52:06,651 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 00:52:06,651 - root - INFO - Configuration name: afno_backbone
2023-07-26 00:52:06,651 - root - INFO - log_to_wandb True
2023-07-26 00:52:06,651 - root - INFO - lr 0.0005
2023-07-26 00:52:06,651 - root - INFO - batch_size 64
2023-07-26 00:52:06,651 - root - INFO - max_epochs 150
2023-07-26 00:52:06,651 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 00:52:06,652 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 00:52:06,652 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 00:52:06,652 - root - INFO - orography False
2023-07-26 00:52:06,652 - root - INFO - orography_path None
2023-07-26 00:52:06,652 - root - INFO - exp_dir FourCastNet/results
2023-07-26 00:52:06,652 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 00:52:06,652 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 00:52:06,652 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 00:52:06,652 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 00:52:06,652 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 00:52:06,652 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 00:52:06,652 - root - INFO - loss l2
2023-07-26 00:52:06,652 - root - INFO - num_data_workers 4
2023-07-26 00:52:06,652 - root - INFO - dt 1
2023-07-26 00:52:06,652 - root - INFO - n_history 0
2023-07-26 00:52:06,652 - root - INFO - prediction_type iterative
2023-07-26 00:52:06,652 - root - INFO - prediction_length 30
2023-07-26 00:52:06,652 - root - INFO - n_initial_conditions 5
2023-07-26 00:52:06,652 - root - INFO - ics_type default
2023-07-26 00:52:06,653 - root - INFO - save_raw_forecasts True
2023-07-26 00:52:06,653 - root - INFO - save_channel False
2023-07-26 00:52:06,653 - root - INFO - masked_acc False
2023-07-26 00:52:06,653 - root - INFO - maskpath None
2023-07-26 00:52:06,653 - root - INFO - perturb False
2023-07-26 00:52:06,653 - root - INFO - add_grid False
2023-07-26 00:52:06,653 - root - INFO - N_grid_channels 0
2023-07-26 00:52:06,653 - root - INFO - gridtype sinusoidal
2023-07-26 00:52:06,653 - root - INFO - roll False
2023-07-26 00:52:06,653 - root - INFO - num_blocks 8
2023-07-26 00:52:06,653 - root - INFO - nettype afno
2023-07-26 00:52:06,653 - root - INFO - patch_size 8
2023-07-26 00:52:06,653 - root - INFO - width 56
2023-07-26 00:52:06,653 - root - INFO - modes 32
2023-07-26 00:52:06,653 - root - INFO - target RH850
2023-07-26 00:52:06,653 - root - INFO - normalization zscore
2023-07-26 00:52:06,653 - root - INFO - log_to_screen True
2023-07-26 00:52:06,653 - root - INFO - save_checkpoint True
2023-07-26 00:52:06,653 - root - INFO - enable_nhwc False
2023-07-26 00:52:06,653 - root - INFO - optimizer_type FusedAdam
2023-07-26 00:52:06,654 - root - INFO - crop_size_x None
2023-07-26 00:52:06,654 - root - INFO - crop_size_y None
2023-07-26 00:52:06,654 - root - INFO - two_step_training False
2023-07-26 00:52:06,654 - root - INFO - plot_animations False
2023-07-26 00:52:06,654 - root - INFO - add_noise False
2023-07-26 00:52:06,654 - root - INFO - noise_std 0
2023-07-26 00:52:06,654 - root - INFO - world_size 1
2023-07-26 00:52:06,654 - root - INFO - interp 0
2023-07-26 00:52:06,654 - root - INFO - use_daily_climatology False
2023-07-26 00:52:06,654 - root - INFO - global_batch_size 64
2023-07-26 00:52:06,654 - root - INFO - ablate V10
2023-07-26 00:52:06,654 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 00:52:06,654 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 00:52:06,654 - root - INFO - resuming False
2023-07-26 00:52:06,654 - root - INFO - local_rank 0
2023-07-26 00:52:06,654 - root - INFO - ---------------------------------------------------
2023-07-26 00:52:06,654 - root - INFO - Inference for 1 initial conditions
2023-07-26 00:52:06,885 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 00:52:06,886 - root - INFO - Number of samples per year: 1460
2023-07-26 00:52:06,886 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 00:52:06,886 - root - INFO - Delta t: 6 hours
2023-07-26 00:52:06,886 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 00:52:06,887 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 00:53:05,409 - root - INFO - Loading inference data
2023-07-26 00:53:05,410 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 00:53:05,553 - root - INFO - Initial condition 1 of 1
2023-07-26 00:53:06,429 - root - INFO - Extracting valid data from the first year
2023-07-26 00:55:06,657 - root - INFO - Standardizing data
2023-07-26 00:55:14,980 - root - INFO - Loading time means
2023-07-26 00:55:27,892 - root - INFO - Begin autoregressive inference
2023-07-26 00:55:38,506 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 00:55:49,084 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 1.2738417387008667, ACC: 0.9919525980949402
2023-07-26 00:55:59,303 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 1.766523838043213, ACC: 0.9845272302627563
2023-07-26 00:56:10,036 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 2.078373670578003, ACC: 0.9783416390419006
2023-07-26 00:56:20,272 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 2.4636781215667725, ACC: 0.9692239761352539
2023-07-26 00:56:30,297 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 2.639108657836914, ACC: 0.9643228054046631
2023-07-26 00:56:41,137 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 2.938897132873535, ACC: 0.9563879370689392
2023-07-26 00:56:52,233 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 3.1616857051849365, ACC: 0.9501357674598694
2023-07-26 00:57:03,186 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 3.5051398277282715, ACC: 0.940628707408905
2023-07-26 00:57:13,662 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 3.644209146499634, ACC: 0.9359754920005798
2023-07-26 00:57:24,250 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 3.8118791580200195, ACC: 0.9302751421928406
2023-07-26 00:57:34,959 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 3.9810750484466553, ACC: 0.9220618605613708
2023-07-26 00:57:45,593 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 4.2686767578125, ACC: 0.9092791080474854
2023-07-26 00:57:55,026 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 4.430213928222656, ACC: 0.9017782807350159
2023-07-26 00:58:05,873 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 4.672161102294922, ACC: 0.8909962773323059
2023-07-26 00:58:15,816 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 4.9322710037231445, ACC: 0.877324640750885
2023-07-26 00:58:25,921 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 5.2492289543151855, ACC: 0.8621399402618408
2023-07-26 00:58:35,767 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 5.455285549163818, ACC: 0.8496304154396057
2023-07-26 00:58:47,122 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 5.681549549102783, ACC: 0.8396177887916565
2023-07-26 00:58:57,394 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 5.855842113494873, ACC: 0.8313160538673401
2023-07-26 00:59:07,895 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 6.045262813568115, ACC: 0.8240443468093872
2023-07-26 00:59:18,558 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 6.230017185211182, ACC: 0.8142423629760742
2023-07-26 00:59:29,852 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 6.552170276641846, ACC: 0.798831582069397
2023-07-26 00:59:40,770 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 6.813241958618164, ACC: 0.784008264541626
2023-07-26 00:59:51,383 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 7.100880146026611, ACC: 0.7670615911483765
2023-07-26 01:00:03,210 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 7.235296726226807, ACC: 0.7592980265617371
2023-07-26 01:00:16,424 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 7.404500484466553, ACC: 0.7477796077728271
2023-07-26 01:00:27,737 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 7.661894798278809, ACC: 0.7251524329185486
2023-07-26 01:00:38,683 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 7.909672737121582, ACC: 0.6996537446975708
2023-07-26 01:00:50,127 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 8.31490707397461, ACC: 0.6638186573982239
2023-07-26 01:00:50,220 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-V10_30-timesteps_vis.h5
2023-07-26 01:01:43,952 - root - INFO - ------------------ Configuration ------------------
2023-07-26 01:01:43,952 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 01:01:43,952 - root - INFO - Configuration name: afno_backbone
2023-07-26 01:01:43,952 - root - INFO - log_to_wandb True
2023-07-26 01:01:43,952 - root - INFO - lr 0.0005
2023-07-26 01:01:43,953 - root - INFO - batch_size 64
2023-07-26 01:01:43,953 - root - INFO - max_epochs 150
2023-07-26 01:01:43,953 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 01:01:43,953 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 01:01:43,953 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 01:01:43,953 - root - INFO - orography False
2023-07-26 01:01:43,953 - root - INFO - orography_path None
2023-07-26 01:01:43,953 - root - INFO - exp_dir FourCastNet/results
2023-07-26 01:01:43,953 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 01:01:43,953 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 01:01:43,953 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 01:01:43,953 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 01:01:43,953 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 01:01:43,953 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 01:01:43,953 - root - INFO - loss l2
2023-07-26 01:01:43,953 - root - INFO - num_data_workers 4
2023-07-26 01:01:43,953 - root - INFO - dt 1
2023-07-26 01:01:43,953 - root - INFO - n_history 0
2023-07-26 01:01:43,953 - root - INFO - prediction_type iterative
2023-07-26 01:01:43,953 - root - INFO - prediction_length 30
2023-07-26 01:01:43,953 - root - INFO - n_initial_conditions 5
2023-07-26 01:01:43,953 - root - INFO - ics_type default
2023-07-26 01:01:43,953 - root - INFO - save_raw_forecasts True
2023-07-26 01:01:43,954 - root - INFO - save_channel False
2023-07-26 01:01:43,954 - root - INFO - masked_acc False
2023-07-26 01:01:43,954 - root - INFO - maskpath None
2023-07-26 01:01:43,954 - root - INFO - perturb False
2023-07-26 01:01:43,954 - root - INFO - add_grid False
2023-07-26 01:01:43,954 - root - INFO - N_grid_channels 0
2023-07-26 01:01:43,954 - root - INFO - gridtype sinusoidal
2023-07-26 01:01:43,954 - root - INFO - roll False
2023-07-26 01:01:43,954 - root - INFO - num_blocks 8
2023-07-26 01:01:43,954 - root - INFO - nettype afno
2023-07-26 01:01:43,954 - root - INFO - patch_size 8
2023-07-26 01:01:43,954 - root - INFO - width 56
2023-07-26 01:01:43,954 - root - INFO - modes 32
2023-07-26 01:01:43,954 - root - INFO - target RH850
2023-07-26 01:01:43,954 - root - INFO - normalization zscore
2023-07-26 01:01:43,954 - root - INFO - log_to_screen True
2023-07-26 01:01:43,954 - root - INFO - save_checkpoint True
2023-07-26 01:01:43,954 - root - INFO - enable_nhwc False
2023-07-26 01:01:43,954 - root - INFO - optimizer_type FusedAdam
2023-07-26 01:01:43,954 - root - INFO - crop_size_x None
2023-07-26 01:01:43,954 - root - INFO - crop_size_y None
2023-07-26 01:01:43,954 - root - INFO - two_step_training False
2023-07-26 01:01:43,954 - root - INFO - plot_animations False
2023-07-26 01:01:43,954 - root - INFO - add_noise False
2023-07-26 01:01:43,954 - root - INFO - noise_std 0
2023-07-26 01:01:43,954 - root - INFO - world_size 1
2023-07-26 01:01:43,954 - root - INFO - interp 0
2023-07-26 01:01:43,954 - root - INFO - use_daily_climatology False
2023-07-26 01:01:43,954 - root - INFO - global_batch_size 64
2023-07-26 01:01:43,954 - root - INFO - ablate T2m
2023-07-26 01:01:43,955 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 01:01:43,955 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 01:01:43,955 - root - INFO - resuming False
2023-07-26 01:01:43,955 - root - INFO - local_rank 0
2023-07-26 01:01:43,955 - root - INFO - ---------------------------------------------------
2023-07-26 01:01:43,955 - root - INFO - Inference for 1 initial conditions
2023-07-26 01:01:44,211 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 01:01:44,216 - root - INFO - Number of samples per year: 1460
2023-07-26 01:01:44,216 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 01:01:44,216 - root - INFO - Delta t: 6 hours
2023-07-26 01:01:44,216 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 01:01:44,217 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 01:02:45,642 - root - INFO - Loading inference data
2023-07-26 01:02:45,644 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 01:02:45,913 - root - INFO - Initial condition 1 of 1
2023-07-26 01:02:46,776 - root - INFO - Extracting valid data from the first year
2023-07-26 01:05:03,875 - root - INFO - Standardizing data
2023-07-26 01:05:12,178 - root - INFO - Loading time means
2023-07-26 01:05:25,709 - root - INFO - Begin autoregressive inference
2023-07-26 01:05:36,968 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 01:05:47,483 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 15.002817153930664, ACC: 0.38940858840942383
2023-07-26 01:05:58,910 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 86.39835357666016, ACC: 0.1236596331000328
2023-07-26 01:06:09,983 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 183.23997497558594, ACC: 0.06309273093938828
2023-07-26 01:06:21,858 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 232.380859375, ACC: 0.03444991633296013
2023-07-26 01:06:32,181 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 240.48988342285156, ACC: 0.013095373287796974
2023-07-26 01:06:43,121 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 229.4712371826172, ACC: -0.000984778394922614
2023-07-26 01:06:55,156 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 214.91583251953125, ACC: -0.014122788794338703
2023-07-26 01:07:07,450 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 204.74234008789062, ACC: -0.029037106782197952
2023-07-26 01:07:20,121 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 200.21995544433594, ACC: -0.03708916902542114
2023-07-26 01:07:31,223 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 200.38626098632812, ACC: -0.048616427928209305
2023-07-26 01:07:42,500 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 203.1590576171875, ACC: -0.04922947287559509
2023-07-26 01:07:54,421 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 206.89659118652344, ACC: -0.054728537797927856
2023-07-26 01:08:06,365 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 210.3692169189453, ACC: -0.048411931842565536
2023-07-26 01:08:19,265 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 213.435791015625, ACC: -0.056699302047491074
2023-07-26 01:08:31,475 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 215.6910858154297, ACC: -0.048703983426094055
2023-07-26 01:08:44,088 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 217.48934936523438, ACC: -0.051322486251592636
2023-07-26 01:08:55,479 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 218.73036193847656, ACC: -0.04634282737970352
2023-07-26 01:09:07,387 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 219.74237060546875, ACC: -0.051965948194265366
2023-07-26 01:09:19,587 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 220.25572204589844, ACC: -0.03503672406077385
2023-07-26 01:09:31,115 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 220.75721740722656, ACC: -0.035182785242795944
2023-07-26 01:09:42,944 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 220.9988250732422, ACC: -0.024777235463261604
2023-07-26 01:09:54,906 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 221.2744903564453, ACC: -0.026168497279286385
2023-07-26 01:10:06,485 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 221.36212158203125, ACC: -0.01720467582345009
2023-07-26 01:10:17,997 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 221.47427368164062, ACC: -0.015262366272509098
2023-07-26 01:10:28,591 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 221.49392700195312, ACC: -0.008369815535843372
2023-07-26 01:10:40,090 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 221.5819549560547, ACC: -0.010479472577571869
2023-07-26 01:10:51,146 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 221.55203247070312, ACC: -0.003772739553824067
2023-07-26 01:11:01,936 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 221.57618713378906, ACC: -0.0035226349718868732
2023-07-26 01:11:14,097 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 221.54486083984375, ACC: 0.0015796634834259748
2023-07-26 01:11:14,198 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-T2m_30-timesteps_vis.h5
2023-07-26 01:12:07,776 - root - INFO - ------------------ Configuration ------------------
2023-07-26 01:12:07,776 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 01:12:07,776 - root - INFO - Configuration name: afno_backbone
2023-07-26 01:12:07,776 - root - INFO - log_to_wandb True
2023-07-26 01:12:07,776 - root - INFO - lr 0.0005
2023-07-26 01:12:07,776 - root - INFO - batch_size 64
2023-07-26 01:12:07,776 - root - INFO - max_epochs 150
2023-07-26 01:12:07,776 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 01:12:07,776 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 01:12:07,776 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 01:12:07,776 - root - INFO - orography False
2023-07-26 01:12:07,776 - root - INFO - orography_path None
2023-07-26 01:12:07,776 - root - INFO - exp_dir FourCastNet/results
2023-07-26 01:12:07,777 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 01:12:07,777 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 01:12:07,777 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 01:12:07,777 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 01:12:07,777 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 01:12:07,777 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 01:12:07,777 - root - INFO - loss l2
2023-07-26 01:12:07,777 - root - INFO - num_data_workers 4
2023-07-26 01:12:07,777 - root - INFO - dt 1
2023-07-26 01:12:07,777 - root - INFO - n_history 0
2023-07-26 01:12:07,777 - root - INFO - prediction_type iterative
2023-07-26 01:12:07,777 - root - INFO - prediction_length 30
2023-07-26 01:12:07,777 - root - INFO - n_initial_conditions 5
2023-07-26 01:12:07,777 - root - INFO - ics_type default
2023-07-26 01:12:07,778 - root - INFO - save_raw_forecasts True
2023-07-26 01:12:07,778 - root - INFO - save_channel False
2023-07-26 01:12:07,778 - root - INFO - masked_acc False
2023-07-26 01:12:07,778 - root - INFO - maskpath None
2023-07-26 01:12:07,778 - root - INFO - perturb False
2023-07-26 01:12:07,778 - root - INFO - add_grid False
2023-07-26 01:12:07,778 - root - INFO - N_grid_channels 0
2023-07-26 01:12:07,778 - root - INFO - gridtype sinusoidal
2023-07-26 01:12:07,778 - root - INFO - roll False
2023-07-26 01:12:07,778 - root - INFO - num_blocks 8
2023-07-26 01:12:07,778 - root - INFO - nettype afno
2023-07-26 01:12:07,778 - root - INFO - patch_size 8
2023-07-26 01:12:07,778 - root - INFO - width 56
2023-07-26 01:12:07,778 - root - INFO - modes 32
2023-07-26 01:12:07,778 - root - INFO - target RH850
2023-07-26 01:12:07,778 - root - INFO - normalization zscore
2023-07-26 01:12:07,778 - root - INFO - log_to_screen True
2023-07-26 01:12:07,778 - root - INFO - save_checkpoint True
2023-07-26 01:12:07,778 - root - INFO - enable_nhwc False
2023-07-26 01:12:07,778 - root - INFO - optimizer_type FusedAdam
2023-07-26 01:12:07,778 - root - INFO - crop_size_x None
2023-07-26 01:12:07,778 - root - INFO - crop_size_y None
2023-07-26 01:12:07,778 - root - INFO - two_step_training False
2023-07-26 01:12:07,778 - root - INFO - plot_animations False
2023-07-26 01:12:07,778 - root - INFO - add_noise False
2023-07-26 01:12:07,778 - root - INFO - noise_std 0
2023-07-26 01:12:07,778 - root - INFO - world_size 1
2023-07-26 01:12:07,779 - root - INFO - interp 0
2023-07-26 01:12:07,779 - root - INFO - use_daily_climatology False
2023-07-26 01:12:07,779 - root - INFO - global_batch_size 64
2023-07-26 01:12:07,779 - root - INFO - ablate sp
2023-07-26 01:12:07,779 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 01:12:07,779 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 01:12:07,779 - root - INFO - resuming False
2023-07-26 01:12:07,779 - root - INFO - local_rank 0
2023-07-26 01:12:07,779 - root - INFO - ---------------------------------------------------
2023-07-26 01:12:07,779 - root - INFO - Inference for 1 initial conditions
2023-07-26 01:12:08,119 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 01:12:08,121 - root - INFO - Number of samples per year: 1460
2023-07-26 01:12:08,121 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 01:12:08,121 - root - INFO - Delta t: 6 hours
2023-07-26 01:12:08,121 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 01:12:08,121 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 01:13:12,216 - root - INFO - Loading inference data
2023-07-26 01:13:12,217 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 01:13:12,401 - root - INFO - Initial condition 1 of 1
2023-07-26 01:13:13,266 - root - INFO - Extracting valid data from the first year
2023-07-26 01:15:34,465 - root - INFO - Standardizing data
2023-07-26 01:15:42,491 - root - INFO - Loading time means
2023-07-26 01:15:57,689 - root - INFO - Begin autoregressive inference
2023-07-26 01:16:08,271 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 01:16:19,293 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 2.2392449378967285, ACC: 0.976925253868103
2023-07-26 01:16:29,356 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 3.6751439571380615, ACC: 0.934658944606781
2023-07-26 01:16:39,430 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 5.307578086853027, ACC: 0.8489300012588501
2023-07-26 01:16:49,872 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 6.400146484375, ACC: 0.7727833986282349
2023-07-26 01:17:00,885 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 6.920590877532959, ACC: 0.7262385487556458
2023-07-26 01:17:12,209 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 7.4519829750061035, ACC: 0.6791471242904663
2023-07-26 01:17:22,355 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 7.908110618591309, ACC: 0.6341149806976318
2023-07-26 01:17:32,949 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 8.374884605407715, ACC: 0.5943223834037781
2023-07-26 01:17:43,661 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 8.888578414916992, ACC: 0.5366337895393372
2023-07-26 01:17:54,127 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 9.71772575378418, ACC: 0.45489683747291565
2023-07-26 01:18:04,140 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 10.175930976867676, ACC: 0.39624688029289246
2023-07-26 01:18:14,061 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 10.511099815368652, ACC: 0.3473670780658722
2023-07-26 01:18:24,184 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 10.827298164367676, ACC: 0.3095698654651642
2023-07-26 01:18:34,681 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 11.059812545776367, ACC: 0.2803112268447876
2023-07-26 01:18:45,023 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 11.364312171936035, ACC: 0.24875488877296448
2023-07-26 01:18:55,509 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 11.776739120483398, ACC: 0.2186480015516281
2023-07-26 01:19:06,041 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 11.89033031463623, ACC: 0.20208923518657684
2023-07-26 01:19:17,090 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 12.208929061889648, ACC: 0.17696744203567505
2023-07-26 01:19:28,192 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 12.33761978149414, ACC: 0.16247054934501648
2023-07-26 01:19:38,316 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 12.512258529663086, ACC: 0.1507333219051361
2023-07-26 01:19:49,251 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 12.716650009155273, ACC: 0.13712601363658905
2023-07-26 01:20:00,144 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 13.012093544006348, ACC: 0.12547044456005096
2023-07-26 01:20:10,836 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 13.378829002380371, ACC: 0.11169443279504776
2023-07-26 01:20:21,654 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 13.649085998535156, ACC: 0.1063733622431755
2023-07-26 01:20:32,570 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 13.944646835327148, ACC: 0.10746851563453674
2023-07-26 01:20:43,224 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 13.940202713012695, ACC: 0.10579060763120651
2023-07-26 01:20:53,938 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 13.847524642944336, ACC: 0.10506131500005722
2023-07-26 01:21:04,701 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 13.858504295349121, ACC: 0.09165393561124802
2023-07-26 01:21:15,161 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 13.97787857055664, ACC: 0.07864915579557419
2023-07-26 01:21:15,250 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-sp_30-timesteps_vis.h5
2023-07-26 01:22:08,807 - root - INFO - ------------------ Configuration ------------------
2023-07-26 01:22:08,807 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 01:22:08,808 - root - INFO - Configuration name: afno_backbone
2023-07-26 01:22:08,808 - root - INFO - log_to_wandb True
2023-07-26 01:22:08,808 - root - INFO - lr 0.0005
2023-07-26 01:22:08,808 - root - INFO - batch_size 64
2023-07-26 01:22:08,808 - root - INFO - max_epochs 150
2023-07-26 01:22:08,808 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 01:22:08,808 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 01:22:08,808 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 01:22:08,808 - root - INFO - orography False
2023-07-26 01:22:08,808 - root - INFO - orography_path None
2023-07-26 01:22:08,808 - root - INFO - exp_dir FourCastNet/results
2023-07-26 01:22:08,808 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 01:22:08,808 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 01:22:08,808 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 01:22:08,808 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 01:22:08,808 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 01:22:08,808 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 01:22:08,808 - root - INFO - loss l2
2023-07-26 01:22:08,808 - root - INFO - num_data_workers 4
2023-07-26 01:22:08,808 - root - INFO - dt 1
2023-07-26 01:22:08,808 - root - INFO - n_history 0
2023-07-26 01:22:08,808 - root - INFO - prediction_type iterative
2023-07-26 01:22:08,809 - root - INFO - prediction_length 30
2023-07-26 01:22:08,809 - root - INFO - n_initial_conditions 5
2023-07-26 01:22:08,809 - root - INFO - ics_type default
2023-07-26 01:22:08,809 - root - INFO - save_raw_forecasts True
2023-07-26 01:22:08,809 - root - INFO - save_channel False
2023-07-26 01:22:08,809 - root - INFO - masked_acc False
2023-07-26 01:22:08,809 - root - INFO - maskpath None
2023-07-26 01:22:08,809 - root - INFO - perturb False
2023-07-26 01:22:08,809 - root - INFO - add_grid False
2023-07-26 01:22:08,809 - root - INFO - N_grid_channels 0
2023-07-26 01:22:08,809 - root - INFO - gridtype sinusoidal
2023-07-26 01:22:08,809 - root - INFO - roll False
2023-07-26 01:22:08,809 - root - INFO - num_blocks 8
2023-07-26 01:22:08,809 - root - INFO - nettype afno
2023-07-26 01:22:08,809 - root - INFO - patch_size 8
2023-07-26 01:22:08,809 - root - INFO - width 56
2023-07-26 01:22:08,809 - root - INFO - modes 32
2023-07-26 01:22:08,809 - root - INFO - target RH850
2023-07-26 01:22:08,809 - root - INFO - normalization zscore
2023-07-26 01:22:08,809 - root - INFO - log_to_screen True
2023-07-26 01:22:08,809 - root - INFO - save_checkpoint True
2023-07-26 01:22:08,809 - root - INFO - enable_nhwc False
2023-07-26 01:22:08,809 - root - INFO - optimizer_type FusedAdam
2023-07-26 01:22:08,809 - root - INFO - crop_size_x None
2023-07-26 01:22:08,809 - root - INFO - crop_size_y None
2023-07-26 01:22:08,809 - root - INFO - two_step_training False
2023-07-26 01:22:08,809 - root - INFO - plot_animations False
2023-07-26 01:22:08,809 - root - INFO - add_noise False
2023-07-26 01:22:08,809 - root - INFO - noise_std 0
2023-07-26 01:22:08,810 - root - INFO - world_size 1
2023-07-26 01:22:08,810 - root - INFO - interp 0
2023-07-26 01:22:08,810 - root - INFO - use_daily_climatology False
2023-07-26 01:22:08,810 - root - INFO - global_batch_size 64
2023-07-26 01:22:08,810 - root - INFO - ablate mslp
2023-07-26 01:22:08,810 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 01:22:08,810 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 01:22:08,810 - root - INFO - resuming False
2023-07-26 01:22:08,810 - root - INFO - local_rank 0
2023-07-26 01:22:08,810 - root - INFO - ---------------------------------------------------
2023-07-26 01:22:08,810 - root - INFO - Inference for 1 initial conditions
2023-07-26 01:22:09,036 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 01:22:09,037 - root - INFO - Number of samples per year: 1460
2023-07-26 01:22:09,037 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 01:22:09,037 - root - INFO - Delta t: 6 hours
2023-07-26 01:22:09,037 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 01:22:09,037 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 01:23:16,838 - root - INFO - Loading inference data
2023-07-26 01:23:16,839 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 01:23:17,077 - root - INFO - Initial condition 1 of 1
2023-07-26 01:23:17,934 - root - INFO - Extracting valid data from the first year
2023-07-26 01:25:42,016 - root - INFO - Standardizing data
2023-07-26 01:25:50,207 - root - INFO - Loading time means
2023-07-26 01:26:04,692 - root - INFO - Begin autoregressive inference
2023-07-26 01:26:15,212 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 01:26:25,923 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 3.4054148197174072, ACC: 0.9422548413276672
2023-07-26 01:26:36,667 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 10.425862312316895, ACC: 0.6180484294891357
2023-07-26 01:26:47,298 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 26.612028121948242, ACC: 0.2190449833869934
2023-07-26 01:26:58,163 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 33.08134460449219, ACC: 0.16353964805603027
2023-07-26 01:27:09,250 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 34.282161712646484, ACC: 0.16763459146022797
2023-07-26 01:27:19,746 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 34.763397216796875, ACC: 0.16915421187877655
2023-07-26 01:27:31,069 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 36.01581954956055, ACC: 0.16344545781612396
2023-07-26 01:27:42,867 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 37.745540618896484, ACC: 0.15219824016094208
2023-07-26 01:27:54,459 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 39.94935989379883, ACC: 0.14675410091876984
2023-07-26 01:28:06,097 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 42.677223205566406, ACC: 0.1300048530101776
2023-07-26 01:28:17,085 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 45.263221740722656, ACC: 0.12674614787101746
2023-07-26 01:28:28,254 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 48.03723907470703, ACC: 0.11693070828914642
2023-07-26 01:28:39,808 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 50.755340576171875, ACC: 0.11530134081840515
2023-07-26 01:28:51,011 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 53.33344268798828, ACC: 0.10714955627918243
2023-07-26 01:29:02,173 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 55.62403869628906, ACC: 0.10514738410711288
2023-07-26 01:29:13,487 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 58.63567352294922, ACC: 0.08999141305685043
2023-07-26 01:29:24,978 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 62.561561584472656, ACC: 0.07578347623348236
2023-07-26 01:29:35,821 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 67.68597412109375, ACC: 0.05101029574871063
2023-07-26 01:29:46,995 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 73.60391998291016, ACC: 0.041749849915504456
2023-07-26 01:29:57,697 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 80.11414337158203, ACC: 0.03172118589282036
2023-07-26 01:30:09,236 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 90.97343444824219, ACC: 0.013264969922602177
2023-07-26 01:30:20,789 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 118.60167694091797, ACC: 0.014507966116070747
2023-07-26 01:30:32,887 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 164.6614990234375, ACC: 0.010083881206810474
2023-07-26 01:30:44,801 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 204.80374145507812, ACC: 0.006801709998399019
2023-07-26 01:30:56,342 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 222.5982208251953, ACC: -0.00028735000523738563
2023-07-26 01:31:08,692 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 221.6854705810547, ACC: -0.003479819279164076
2023-07-26 01:31:20,037 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 213.34812927246094, ACC: -0.00845024362206459
2023-07-26 01:31:31,565 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 205.8689727783203, ACC: -0.011056615971028805
2023-07-26 01:31:42,590 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 201.77833557128906, ACC: -0.010725435800850391
2023-07-26 01:31:42,692 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-mslp_30-timesteps_vis.h5
2023-07-26 01:32:36,066 - root - INFO - ------------------ Configuration ------------------
2023-07-26 01:32:36,066 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 01:32:36,066 - root - INFO - Configuration name: afno_backbone
2023-07-26 01:32:36,066 - root - INFO - log_to_wandb True
2023-07-26 01:32:36,067 - root - INFO - lr 0.0005
2023-07-26 01:32:36,067 - root - INFO - batch_size 64
2023-07-26 01:32:36,067 - root - INFO - max_epochs 150
2023-07-26 01:32:36,067 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 01:32:36,067 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 01:32:36,069 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 01:32:36,069 - root - INFO - orography False
2023-07-26 01:32:36,069 - root - INFO - orography_path None
2023-07-26 01:32:36,070 - root - INFO - exp_dir FourCastNet/results
2023-07-26 01:32:36,070 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 01:32:36,070 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 01:32:36,070 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 01:32:36,070 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 01:32:36,070 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 01:32:36,070 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 01:32:36,070 - root - INFO - loss l2
2023-07-26 01:32:36,070 - root - INFO - num_data_workers 4
2023-07-26 01:32:36,070 - root - INFO - dt 1
2023-07-26 01:32:36,070 - root - INFO - n_history 0
2023-07-26 01:32:36,070 - root - INFO - prediction_type iterative
2023-07-26 01:32:36,070 - root - INFO - prediction_length 30
2023-07-26 01:32:36,070 - root - INFO - n_initial_conditions 5
2023-07-26 01:32:36,070 - root - INFO - ics_type default
2023-07-26 01:32:36,070 - root - INFO - save_raw_forecasts True
2023-07-26 01:32:36,070 - root - INFO - save_channel False
2023-07-26 01:32:36,070 - root - INFO - masked_acc False
2023-07-26 01:32:36,070 - root - INFO - maskpath None
2023-07-26 01:32:36,070 - root - INFO - perturb False
2023-07-26 01:32:36,070 - root - INFO - add_grid False
2023-07-26 01:32:36,070 - root - INFO - N_grid_channels 0
2023-07-26 01:32:36,070 - root - INFO - gridtype sinusoidal
2023-07-26 01:32:36,070 - root - INFO - roll False
2023-07-26 01:32:36,070 - root - INFO - num_blocks 8
2023-07-26 01:32:36,070 - root - INFO - nettype afno
2023-07-26 01:32:36,070 - root - INFO - patch_size 8
2023-07-26 01:32:36,070 - root - INFO - width 56
2023-07-26 01:32:36,071 - root - INFO - modes 32
2023-07-26 01:32:36,071 - root - INFO - target RH850
2023-07-26 01:32:36,071 - root - INFO - normalization zscore
2023-07-26 01:32:36,071 - root - INFO - log_to_screen True
2023-07-26 01:32:36,071 - root - INFO - save_checkpoint True
2023-07-26 01:32:36,071 - root - INFO - enable_nhwc False
2023-07-26 01:32:36,071 - root - INFO - optimizer_type FusedAdam
2023-07-26 01:32:36,071 - root - INFO - crop_size_x None
2023-07-26 01:32:36,071 - root - INFO - crop_size_y None
2023-07-26 01:32:36,071 - root - INFO - two_step_training False
2023-07-26 01:32:36,071 - root - INFO - plot_animations False
2023-07-26 01:32:36,071 - root - INFO - add_noise False
2023-07-26 01:32:36,071 - root - INFO - noise_std 0
2023-07-26 01:32:36,071 - root - INFO - world_size 1
2023-07-26 01:32:36,071 - root - INFO - interp 0
2023-07-26 01:32:36,071 - root - INFO - use_daily_climatology False
2023-07-26 01:32:36,071 - root - INFO - global_batch_size 64
2023-07-26 01:32:36,071 - root - INFO - ablate U1000
2023-07-26 01:32:36,071 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 01:32:36,071 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 01:32:36,071 - root - INFO - resuming False
2023-07-26 01:32:36,071 - root - INFO - local_rank 0
2023-07-26 01:32:36,071 - root - INFO - ---------------------------------------------------
2023-07-26 01:32:36,071 - root - INFO - Inference for 1 initial conditions
2023-07-26 01:32:36,370 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 01:32:36,372 - root - INFO - Number of samples per year: 1460
2023-07-26 01:32:36,372 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 01:32:36,372 - root - INFO - Delta t: 6 hours
2023-07-26 01:32:36,372 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 01:32:36,373 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 01:33:49,459 - root - INFO - Loading inference data
2023-07-26 01:33:49,462 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 01:33:49,830 - root - INFO - Initial condition 1 of 1
2023-07-26 01:33:50,602 - root - INFO - Extracting valid data from the first year
2023-07-26 01:36:21,363 - root - INFO - Standardizing data
2023-07-26 01:36:29,449 - root - INFO - Loading time means
2023-07-26 01:36:48,048 - root - INFO - Begin autoregressive inference
2023-07-26 01:36:58,969 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 01:37:08,965 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 7.606701850891113, ACC: 0.7587988376617432
2023-07-26 01:37:19,090 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 22.5172061920166, ACC: 0.3011218011379242
2023-07-26 01:37:28,829 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 45.87543869018555, ACC: 0.11951591074466705
2023-07-26 01:37:38,898 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 70.25996398925781, ACC: 0.0570073239505291
2023-07-26 01:37:49,161 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 85.50670623779297, ACC: 0.045110009610652924
2023-07-26 01:37:59,419 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 103.0474624633789, ACC: 0.05047931894659996
2023-07-26 01:38:10,545 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 136.77296447753906, ACC: 0.049847930669784546
2023-07-26 01:38:20,965 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 177.1230926513672, ACC: 0.03917131572961807
2023-07-26 01:38:30,749 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 202.431884765625, ACC: 0.007752366364002228
2023-07-26 01:38:41,240 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 208.96920776367188, ACC: -0.009269172325730324
2023-07-26 01:38:51,857 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 205.59735107421875, ACC: -0.02236897125840187
2023-07-26 01:39:01,684 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 200.7042999267578, ACC: -0.027260595932602882
2023-07-26 01:39:11,690 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 198.0867462158203, ACC: -0.03158020228147507
2023-07-26 01:39:21,596 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 198.41665649414062, ACC: -0.04049107804894447
2023-07-26 01:39:32,041 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 200.822265625, ACC: -0.04239744320511818
2023-07-26 01:39:41,927 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 204.34341430664062, ACC: -0.04802030697464943
2023-07-26 01:39:51,983 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 208.0023956298828, ACC: -0.047392588108778
2023-07-26 01:40:02,563 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 211.3519287109375, ACC: -0.05168963596224785
2023-07-26 01:40:13,225 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 213.87681579589844, ACC: -0.03654900938272476
2023-07-26 01:40:23,875 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 215.9761962890625, ACC: -0.036057379096746445
2023-07-26 01:40:34,274 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 217.48182678222656, ACC: -0.025895487517118454
2023-07-26 01:40:44,504 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 218.71484375, ACC: -0.026914386078715324
2023-07-26 01:40:54,317 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 219.51803588867188, ACC: -0.017811384052038193
2023-07-26 01:41:04,686 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 220.154052734375, ACC: -0.015611001290380955
2023-07-26 01:41:15,845 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 220.55459594726562, ACC: -0.008646531030535698
2023-07-26 01:41:26,859 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 220.91551208496094, ACC: -0.010619968175888062
2023-07-26 01:41:37,364 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 221.0812530517578, ACC: -0.003927007783204317
2023-07-26 01:41:46,860 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 221.2438201904297, ACC: -0.003663263749331236
2023-07-26 01:41:56,600 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 221.31028747558594, ACC: 0.0014586658217012882
2023-07-26 01:41:56,693 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-U1000_30-timesteps_vis.h5
2023-07-26 01:42:49,810 - root - INFO - ------------------ Configuration ------------------
2023-07-26 01:42:49,810 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 01:42:49,810 - root - INFO - Configuration name: afno_backbone
2023-07-26 01:42:49,811 - root - INFO - log_to_wandb True
2023-07-26 01:42:49,811 - root - INFO - lr 0.0005
2023-07-26 01:42:49,811 - root - INFO - batch_size 64
2023-07-26 01:42:49,811 - root - INFO - max_epochs 150
2023-07-26 01:42:49,811 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 01:42:49,811 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 01:42:49,811 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 01:42:49,811 - root - INFO - orography False
2023-07-26 01:42:49,811 - root - INFO - orography_path None
2023-07-26 01:42:49,811 - root - INFO - exp_dir FourCastNet/results
2023-07-26 01:42:49,811 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 01:42:49,811 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 01:42:49,811 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 01:42:49,811 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 01:42:49,811 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 01:42:49,811 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 01:42:49,811 - root - INFO - loss l2
2023-07-26 01:42:49,812 - root - INFO - num_data_workers 4
2023-07-26 01:42:49,812 - root - INFO - dt 1
2023-07-26 01:42:49,812 - root - INFO - n_history 0
2023-07-26 01:42:49,812 - root - INFO - prediction_type iterative
2023-07-26 01:42:49,812 - root - INFO - prediction_length 30
2023-07-26 01:42:49,812 - root - INFO - n_initial_conditions 5
2023-07-26 01:42:49,812 - root - INFO - ics_type default
2023-07-26 01:42:49,812 - root - INFO - save_raw_forecasts True
2023-07-26 01:42:49,812 - root - INFO - save_channel False
2023-07-26 01:42:49,812 - root - INFO - masked_acc False
2023-07-26 01:42:49,812 - root - INFO - maskpath None
2023-07-26 01:42:49,812 - root - INFO - perturb False
2023-07-26 01:42:49,812 - root - INFO - add_grid False
2023-07-26 01:42:49,812 - root - INFO - N_grid_channels 0
2023-07-26 01:42:49,812 - root - INFO - gridtype sinusoidal
2023-07-26 01:42:49,812 - root - INFO - roll False
2023-07-26 01:42:49,812 - root - INFO - num_blocks 8
2023-07-26 01:42:49,812 - root - INFO - nettype afno
2023-07-26 01:42:49,812 - root - INFO - patch_size 8
2023-07-26 01:42:49,812 - root - INFO - width 56
2023-07-26 01:42:49,812 - root - INFO - modes 32
2023-07-26 01:42:49,812 - root - INFO - target RH850
2023-07-26 01:42:49,812 - root - INFO - normalization zscore
2023-07-26 01:42:49,812 - root - INFO - log_to_screen True
2023-07-26 01:42:49,812 - root - INFO - save_checkpoint True
2023-07-26 01:42:49,812 - root - INFO - enable_nhwc False
2023-07-26 01:42:49,812 - root - INFO - optimizer_type FusedAdam
2023-07-26 01:42:49,812 - root - INFO - crop_size_x None
2023-07-26 01:42:49,813 - root - INFO - crop_size_y None
2023-07-26 01:42:49,813 - root - INFO - two_step_training False
2023-07-26 01:42:49,813 - root - INFO - plot_animations False
2023-07-26 01:42:49,813 - root - INFO - add_noise False
2023-07-26 01:42:49,813 - root - INFO - noise_std 0
2023-07-26 01:42:49,813 - root - INFO - world_size 1
2023-07-26 01:42:49,813 - root - INFO - interp 0
2023-07-26 01:42:49,813 - root - INFO - use_daily_climatology False
2023-07-26 01:42:49,813 - root - INFO - global_batch_size 64
2023-07-26 01:42:49,813 - root - INFO - ablate V1000
2023-07-26 01:42:49,813 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 01:42:49,813 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 01:42:49,813 - root - INFO - resuming False
2023-07-26 01:42:49,813 - root - INFO - local_rank 0
2023-07-26 01:42:49,813 - root - INFO - ---------------------------------------------------
2023-07-26 01:42:49,813 - root - INFO - Inference for 1 initial conditions
2023-07-26 01:42:50,059 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 01:42:50,060 - root - INFO - Number of samples per year: 1460
2023-07-26 01:42:50,060 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 01:42:50,060 - root - INFO - Delta t: 6 hours
2023-07-26 01:42:50,061 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 01:42:50,061 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 01:43:56,054 - root - INFO - Loading inference data
2023-07-26 01:43:56,055 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 01:43:56,314 - root - INFO - Initial condition 1 of 1
2023-07-26 01:43:57,203 - root - INFO - Extracting valid data from the first year
2023-07-26 01:46:19,392 - root - INFO - Standardizing data
2023-07-26 01:46:27,478 - root - INFO - Loading time means
2023-07-26 01:46:42,449 - root - INFO - Begin autoregressive inference
2023-07-26 01:46:52,528 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 01:47:04,180 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 1.8457669019699097, ACC: 0.9830283522605896
2023-07-26 01:47:15,319 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 2.3624932765960693, ACC: 0.9721618890762329
2023-07-26 01:47:27,212 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 2.7060980796813965, ACC: 0.9630261063575745
2023-07-26 01:47:38,973 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 3.0529465675354004, ACC: 0.9524132013320923
2023-07-26 01:47:49,883 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 3.336022138595581, ACC: 0.9426106214523315
2023-07-26 01:48:01,028 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 3.6499290466308594, ACC: 0.9324873685836792
2023-07-26 01:48:11,907 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 3.8919243812561035, ACC: 0.9244436025619507
2023-07-26 01:48:21,922 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 4.180022239685059, ACC: 0.915524959564209
2023-07-26 01:48:32,507 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 4.3454790115356445, ACC: 0.909328818321228
2023-07-26 01:48:43,361 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 4.56205415725708, ACC: 0.900937557220459
2023-07-26 01:48:54,200 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 4.805717468261719, ACC: 0.8878948092460632
2023-07-26 01:49:04,494 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 5.181301116943359, ACC: 0.8678621649742126
2023-07-26 01:49:14,583 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 5.473283767700195, ACC: 0.8516220450401306
2023-07-26 01:49:25,092 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 5.752495288848877, ACC: 0.8365576863288879
2023-07-26 01:49:35,619 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 5.973665714263916, ACC: 0.822589099407196
2023-07-26 01:49:46,294 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 6.274936676025391, ACC: 0.8055436015129089
2023-07-26 01:49:56,975 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 6.488945960998535, ACC: 0.7901307940483093
2023-07-26 01:50:08,428 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 6.668213844299316, ACC: 0.7808535695075989
2023-07-26 01:50:19,462 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 6.841320514678955, ACC: 0.7703742980957031
2023-07-26 01:50:30,552 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 7.017807483673096, ACC: 0.7620741724967957
2023-07-26 01:50:41,480 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 7.217162132263184, ACC: 0.7480829358100891
2023-07-26 01:50:52,177 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 7.577235698699951, ACC: 0.7264460921287537
2023-07-26 01:51:02,499 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 7.854647159576416, ACC: 0.706965982913971
2023-07-26 01:51:12,859 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 8.209197998046875, ACC: 0.6825592517852783
2023-07-26 01:51:23,005 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 8.46568489074707, ACC: 0.6654759049415588
2023-07-26 01:51:33,756 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 8.71272087097168, ACC: 0.6468393802642822
2023-07-26 01:51:44,152 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 8.924609184265137, ACC: 0.625210702419281
2023-07-26 01:51:54,678 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 9.030786514282227, ACC: 0.6080992221832275
2023-07-26 01:52:06,184 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 9.097077369689941, ACC: 0.5982529520988464
2023-07-26 01:52:06,285 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-V1000_30-timesteps_vis.h5
2023-07-26 01:52:59,533 - root - INFO - ------------------ Configuration ------------------
2023-07-26 01:52:59,533 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 01:52:59,533 - root - INFO - Configuration name: afno_backbone
2023-07-26 01:52:59,533 - root - INFO - log_to_wandb True
2023-07-26 01:52:59,533 - root - INFO - lr 0.0005
2023-07-26 01:52:59,533 - root - INFO - batch_size 64
2023-07-26 01:52:59,533 - root - INFO - max_epochs 150
2023-07-26 01:52:59,533 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 01:52:59,533 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 01:52:59,533 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 01:52:59,534 - root - INFO - orography False
2023-07-26 01:52:59,534 - root - INFO - orography_path None
2023-07-26 01:52:59,534 - root - INFO - exp_dir FourCastNet/results
2023-07-26 01:52:59,534 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 01:52:59,534 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 01:52:59,534 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 01:52:59,534 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 01:52:59,534 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 01:52:59,534 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 01:52:59,534 - root - INFO - loss l2
2023-07-26 01:52:59,534 - root - INFO - num_data_workers 4
2023-07-26 01:52:59,534 - root - INFO - dt 1
2023-07-26 01:52:59,534 - root - INFO - n_history 0
2023-07-26 01:52:59,534 - root - INFO - prediction_type iterative
2023-07-26 01:52:59,534 - root - INFO - prediction_length 30
2023-07-26 01:52:59,534 - root - INFO - n_initial_conditions 5
2023-07-26 01:52:59,534 - root - INFO - ics_type default
2023-07-26 01:52:59,535 - root - INFO - save_raw_forecasts True
2023-07-26 01:52:59,535 - root - INFO - save_channel False
2023-07-26 01:52:59,535 - root - INFO - masked_acc False
2023-07-26 01:52:59,535 - root - INFO - maskpath None
2023-07-26 01:52:59,535 - root - INFO - perturb False
2023-07-26 01:52:59,535 - root - INFO - add_grid False
2023-07-26 01:52:59,535 - root - INFO - N_grid_channels 0
2023-07-26 01:52:59,535 - root - INFO - gridtype sinusoidal
2023-07-26 01:52:59,535 - root - INFO - roll False
2023-07-26 01:52:59,535 - root - INFO - num_blocks 8
2023-07-26 01:52:59,535 - root - INFO - nettype afno
2023-07-26 01:52:59,535 - root - INFO - patch_size 8
2023-07-26 01:52:59,535 - root - INFO - width 56
2023-07-26 01:52:59,535 - root - INFO - modes 32
2023-07-26 01:52:59,535 - root - INFO - target RH850
2023-07-26 01:52:59,535 - root - INFO - normalization zscore
2023-07-26 01:52:59,535 - root - INFO - log_to_screen True
2023-07-26 01:52:59,535 - root - INFO - save_checkpoint True
2023-07-26 01:52:59,535 - root - INFO - enable_nhwc False
2023-07-26 01:52:59,536 - root - INFO - optimizer_type FusedAdam
2023-07-26 01:52:59,536 - root - INFO - crop_size_x None
2023-07-26 01:52:59,536 - root - INFO - crop_size_y None
2023-07-26 01:52:59,536 - root - INFO - two_step_training False
2023-07-26 01:52:59,536 - root - INFO - plot_animations False
2023-07-26 01:52:59,537 - root - INFO - add_noise False
2023-07-26 01:52:59,537 - root - INFO - noise_std 0
2023-07-26 01:52:59,537 - root - INFO - world_size 1
2023-07-26 01:52:59,537 - root - INFO - interp 0
2023-07-26 01:52:59,537 - root - INFO - use_daily_climatology False
2023-07-26 01:52:59,537 - root - INFO - global_batch_size 64
2023-07-26 01:52:59,537 - root - INFO - ablate Z1000
2023-07-26 01:52:59,537 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 01:52:59,538 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 01:52:59,538 - root - INFO - resuming False
2023-07-26 01:52:59,538 - root - INFO - local_rank 0
2023-07-26 01:52:59,538 - root - INFO - ---------------------------------------------------
2023-07-26 01:52:59,538 - root - INFO - Inference for 1 initial conditions
2023-07-26 01:52:59,817 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 01:52:59,818 - root - INFO - Number of samples per year: 1460
2023-07-26 01:52:59,818 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 01:52:59,818 - root - INFO - Delta t: 6 hours
2023-07-26 01:52:59,818 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 01:52:59,818 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 01:54:03,485 - root - INFO - Loading inference data
2023-07-26 01:54:03,486 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 01:54:03,624 - root - INFO - Initial condition 1 of 1
2023-07-26 01:54:04,479 - root - INFO - Extracting valid data from the first year
2023-07-26 01:56:13,700 - root - INFO - Standardizing data
2023-07-26 01:56:22,114 - root - INFO - Loading time means
2023-07-26 01:56:34,654 - root - INFO - Begin autoregressive inference
2023-07-26 01:56:46,449 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 01:56:58,241 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 1.2483986616134644, ACC: 0.9922681450843811
2023-07-26 01:57:10,336 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 1.7655116319656372, ACC: 0.9845498204231262
2023-07-26 01:57:21,571 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 2.06180477142334, ACC: 0.9787006974220276
2023-07-26 01:57:32,463 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 2.4145851135253906, ACC: 0.9704601764678955
2023-07-26 01:57:43,729 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 2.5959863662719727, ACC: 0.9654433727264404
2023-07-26 01:57:54,111 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 2.944732904434204, ACC: 0.9560839533805847
2023-07-26 01:58:04,975 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 3.1757583618164062, ACC: 0.9494650363922119
2023-07-26 01:58:15,837 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 3.534233331680298, ACC: 0.9393795132637024
2023-07-26 01:58:27,112 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 3.698108673095703, ACC: 0.9338173866271973
2023-07-26 01:58:37,325 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 3.88372540473938, ACC: 0.9275396466255188
2023-07-26 01:58:47,684 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 4.115019798278809, ACC: 0.9168568849563599
2023-07-26 01:58:58,189 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 4.441661357879639, ACC: 0.9020364880561829
2023-07-26 01:59:07,861 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 4.6287994384765625, ACC: 0.8933209776878357
2023-07-26 01:59:18,416 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 4.898501396179199, ACC: 0.8809348344802856
2023-07-26 01:59:29,267 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 5.167447566986084, ACC: 0.8663570880889893
2023-07-26 01:59:39,630 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 5.550856590270996, ACC: 0.8468878865242004
2023-07-26 01:59:49,962 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 5.83426570892334, ACC: 0.8294016122817993
2023-07-26 02:00:01,019 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 6.080929279327393, ACC: 0.8172750473022461
2023-07-26 02:00:13,229 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 6.3015241622924805, ACC: 0.8053790926933289
2023-07-26 02:00:25,255 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 6.5285773277282715, ACC: 0.795304536819458
2023-07-26 02:00:37,345 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 6.697464942932129, ACC: 0.7851178646087646
2023-07-26 02:00:48,170 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 6.9693074226379395, ACC: 0.7713415026664734
2023-07-26 02:00:58,554 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 7.231923580169678, ACC: 0.7548062801361084
2023-07-26 02:01:10,510 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 7.522801399230957, ACC: 0.7359514832496643
2023-07-26 02:01:21,817 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 7.638698577880859, ACC: 0.728089451789856
2023-07-26 02:01:32,549 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 7.744472503662109, ACC: 0.7196504473686218
2023-07-26 02:01:43,185 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 7.90098237991333, ACC: 0.7035312652587891
2023-07-26 02:01:53,633 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 8.023346900939941, ACC: 0.687885046005249
2023-07-26 02:02:04,396 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 8.185586929321289, ACC: 0.6730363965034485
2023-07-26 02:02:04,483 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-Z1000_30-timesteps_vis.h5
2023-07-26 02:02:57,704 - root - INFO - ------------------ Configuration ------------------
2023-07-26 02:02:57,704 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 02:02:57,704 - root - INFO - Configuration name: afno_backbone
2023-07-26 02:02:57,704 - root - INFO - log_to_wandb True
2023-07-26 02:02:57,704 - root - INFO - lr 0.0005
2023-07-26 02:02:57,704 - root - INFO - batch_size 64
2023-07-26 02:02:57,704 - root - INFO - max_epochs 150
2023-07-26 02:02:57,704 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 02:02:57,704 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 02:02:57,704 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 02:02:57,704 - root - INFO - orography False
2023-07-26 02:02:57,704 - root - INFO - orography_path None
2023-07-26 02:02:57,704 - root - INFO - exp_dir FourCastNet/results
2023-07-26 02:02:57,704 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 02:02:57,705 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 02:02:57,705 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 02:02:57,705 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 02:02:57,705 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 02:02:57,705 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 02:02:57,705 - root - INFO - loss l2
2023-07-26 02:02:57,705 - root - INFO - num_data_workers 4
2023-07-26 02:02:57,705 - root - INFO - dt 1
2023-07-26 02:02:57,705 - root - INFO - n_history 0
2023-07-26 02:02:57,705 - root - INFO - prediction_type iterative
2023-07-26 02:02:57,705 - root - INFO - prediction_length 30
2023-07-26 02:02:57,705 - root - INFO - n_initial_conditions 5
2023-07-26 02:02:57,705 - root - INFO - ics_type default
2023-07-26 02:02:57,705 - root - INFO - save_raw_forecasts True
2023-07-26 02:02:57,705 - root - INFO - save_channel False
2023-07-26 02:02:57,705 - root - INFO - masked_acc False
2023-07-26 02:02:57,705 - root - INFO - maskpath None
2023-07-26 02:02:57,705 - root - INFO - perturb False
2023-07-26 02:02:57,705 - root - INFO - add_grid False
2023-07-26 02:02:57,705 - root - INFO - N_grid_channels 0
2023-07-26 02:02:57,705 - root - INFO - gridtype sinusoidal
2023-07-26 02:02:57,705 - root - INFO - roll False
2023-07-26 02:02:57,705 - root - INFO - num_blocks 8
2023-07-26 02:02:57,705 - root - INFO - nettype afno
2023-07-26 02:02:57,705 - root - INFO - patch_size 8
2023-07-26 02:02:57,706 - root - INFO - width 56
2023-07-26 02:02:57,706 - root - INFO - modes 32
2023-07-26 02:02:57,706 - root - INFO - target RH850
2023-07-26 02:02:57,706 - root - INFO - normalization zscore
2023-07-26 02:02:57,706 - root - INFO - log_to_screen True
2023-07-26 02:02:57,706 - root - INFO - save_checkpoint True
2023-07-26 02:02:57,706 - root - INFO - enable_nhwc False
2023-07-26 02:02:57,706 - root - INFO - optimizer_type FusedAdam
2023-07-26 02:02:57,706 - root - INFO - crop_size_x None
2023-07-26 02:02:57,706 - root - INFO - crop_size_y None
2023-07-26 02:02:57,706 - root - INFO - two_step_training False
2023-07-26 02:02:57,706 - root - INFO - plot_animations False
2023-07-26 02:02:57,706 - root - INFO - add_noise False
2023-07-26 02:02:57,706 - root - INFO - noise_std 0
2023-07-26 02:02:57,706 - root - INFO - world_size 1
2023-07-26 02:02:57,706 - root - INFO - interp 0
2023-07-26 02:02:57,706 - root - INFO - use_daily_climatology False
2023-07-26 02:02:57,706 - root - INFO - global_batch_size 64
2023-07-26 02:02:57,707 - root - INFO - ablate T850
2023-07-26 02:02:57,707 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 02:02:57,707 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 02:02:57,707 - root - INFO - resuming False
2023-07-26 02:02:57,707 - root - INFO - local_rank 0
2023-07-26 02:02:57,707 - root - INFO - ---------------------------------------------------
2023-07-26 02:02:57,707 - root - INFO - Inference for 1 initial conditions
2023-07-26 02:02:57,918 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 02:02:57,919 - root - INFO - Number of samples per year: 1460
2023-07-26 02:02:57,919 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 02:02:57,919 - root - INFO - Delta t: 6 hours
2023-07-26 02:02:57,920 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 02:02:57,920 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 02:04:03,666 - root - INFO - Loading inference data
2023-07-26 02:04:03,667 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 02:04:03,855 - root - INFO - Initial condition 1 of 1
2023-07-26 02:04:04,684 - root - INFO - Extracting valid data from the first year
2023-07-26 02:06:27,869 - root - INFO - Standardizing data
2023-07-26 02:06:36,163 - root - INFO - Loading time means
2023-07-26 02:06:50,944 - root - INFO - Begin autoregressive inference
2023-07-26 02:07:02,993 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 02:07:15,448 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 16.986177444458008, ACC: 0.34852334856987
2023-07-26 02:07:28,085 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 52.50804901123047, ACC: 0.04348438233137131
2023-07-26 02:07:39,717 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 91.72347259521484, ACC: 0.0394437350332737
2023-07-26 02:07:50,234 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 154.8881072998047, ACC: 0.05591873824596405
2023-07-26 02:08:01,009 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 202.22120666503906, ACC: 0.05175667628645897
2023-07-26 02:08:12,107 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 218.8703155517578, ACC: 0.04355841875076294
2023-07-26 02:08:24,078 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 216.28298950195312, ACC: 0.02668861486017704
2023-07-26 02:08:35,092 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 208.21429443359375, ACC: 0.007029284257441759
2023-07-26 02:08:45,326 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 202.31752014160156, ACC: -0.013114570640027523
2023-07-26 02:08:55,078 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 199.89895629882812, ACC: -0.03202522173523903
2023-07-26 02:09:05,609 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 200.35751342773438, ACC: -0.03821643441915512
2023-07-26 02:09:17,236 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 202.7568817138672, ACC: -0.04537809640169144
2023-07-26 02:09:27,848 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 205.9341278076172, ACC: -0.04248737543821335
2023-07-26 02:09:38,659 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 209.3610076904297, ACC: -0.05099479854106903
2023-07-26 02:09:49,600 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 212.2958221435547, ACC: -0.04480626434087753
2023-07-26 02:10:00,318 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 214.82443237304688, ACC: -0.0488712303340435
2023-07-26 02:10:11,242 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 216.7232666015625, ACC: -0.045112576335668564
2023-07-26 02:10:21,966 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 218.26490783691406, ACC: -0.050895627588033676
2023-07-26 02:10:32,466 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 219.19322204589844, ACC: -0.03460626304149628
2023-07-26 02:10:43,751 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 220.00152587890625, ACC: -0.035050712525844574
2023-07-26 02:10:54,949 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 220.4654998779297, ACC: -0.024861235171556473
2023-07-26 02:11:05,860 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 220.8988037109375, ACC: -0.026294900104403496
2023-07-26 02:11:16,393 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 221.0973358154297, ACC: -0.017305847257375717
2023-07-26 02:11:27,017 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 221.28733825683594, ACC: -0.01531985029578209
2023-07-26 02:11:36,678 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 221.362060546875, ACC: -0.008424043655395508
2023-07-26 02:11:47,048 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 221.48846435546875, ACC: -0.01049951370805502
2023-07-26 02:11:57,842 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 221.4857940673828, ACC: -0.003787806024774909
2023-07-26 02:12:08,723 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 221.5291290283203, ACC: -0.003536594333127141
2023-07-26 02:12:18,877 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 221.51141357421875, ACC: 0.0015639292541891336
2023-07-26 02:12:18,979 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-T850_30-timesteps_vis.h5
2023-07-26 02:13:12,281 - root - INFO - ------------------ Configuration ------------------
2023-07-26 02:13:12,281 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 02:13:12,281 - root - INFO - Configuration name: afno_backbone
2023-07-26 02:13:12,281 - root - INFO - log_to_wandb True
2023-07-26 02:13:12,282 - root - INFO - lr 0.0005
2023-07-26 02:13:12,282 - root - INFO - batch_size 64
2023-07-26 02:13:12,282 - root - INFO - max_epochs 150
2023-07-26 02:13:12,282 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 02:13:12,282 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 02:13:12,282 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 02:13:12,282 - root - INFO - orography False
2023-07-26 02:13:12,282 - root - INFO - orography_path None
2023-07-26 02:13:12,282 - root - INFO - exp_dir FourCastNet/results
2023-07-26 02:13:12,282 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 02:13:12,282 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 02:13:12,282 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 02:13:12,282 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 02:13:12,282 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 02:13:12,282 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 02:13:12,282 - root - INFO - loss l2
2023-07-26 02:13:12,282 - root - INFO - num_data_workers 4
2023-07-26 02:13:12,282 - root - INFO - dt 1
2023-07-26 02:13:12,283 - root - INFO - n_history 0
2023-07-26 02:13:12,283 - root - INFO - prediction_type iterative
2023-07-26 02:13:12,283 - root - INFO - prediction_length 30
2023-07-26 02:13:12,283 - root - INFO - n_initial_conditions 5
2023-07-26 02:13:12,283 - root - INFO - ics_type default
2023-07-26 02:13:12,283 - root - INFO - save_raw_forecasts True
2023-07-26 02:13:12,283 - root - INFO - save_channel False
2023-07-26 02:13:12,283 - root - INFO - masked_acc False
2023-07-26 02:13:12,283 - root - INFO - maskpath None
2023-07-26 02:13:12,283 - root - INFO - perturb False
2023-07-26 02:13:12,283 - root - INFO - add_grid False
2023-07-26 02:13:12,283 - root - INFO - N_grid_channels 0
2023-07-26 02:13:12,283 - root - INFO - gridtype sinusoidal
2023-07-26 02:13:12,283 - root - INFO - roll False
2023-07-26 02:13:12,283 - root - INFO - num_blocks 8
2023-07-26 02:13:12,283 - root - INFO - nettype afno
2023-07-26 02:13:12,283 - root - INFO - patch_size 8
2023-07-26 02:13:12,283 - root - INFO - width 56
2023-07-26 02:13:12,283 - root - INFO - modes 32
2023-07-26 02:13:12,283 - root - INFO - target RH850
2023-07-26 02:13:12,283 - root - INFO - normalization zscore
2023-07-26 02:13:12,283 - root - INFO - log_to_screen True
2023-07-26 02:13:12,284 - root - INFO - save_checkpoint True
2023-07-26 02:13:12,284 - root - INFO - enable_nhwc False
2023-07-26 02:13:12,284 - root - INFO - optimizer_type FusedAdam
2023-07-26 02:13:12,284 - root - INFO - crop_size_x None
2023-07-26 02:13:12,284 - root - INFO - crop_size_y None
2023-07-26 02:13:12,284 - root - INFO - two_step_training False
2023-07-26 02:13:12,284 - root - INFO - plot_animations False
2023-07-26 02:13:12,284 - root - INFO - add_noise False
2023-07-26 02:13:12,284 - root - INFO - noise_std 0
2023-07-26 02:13:12,284 - root - INFO - world_size 1
2023-07-26 02:13:12,284 - root - INFO - interp 0
2023-07-26 02:13:12,284 - root - INFO - use_daily_climatology False
2023-07-26 02:13:12,284 - root - INFO - global_batch_size 64
2023-07-26 02:13:12,284 - root - INFO - ablate U850
2023-07-26 02:13:12,284 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 02:13:12,284 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 02:13:12,284 - root - INFO - resuming False
2023-07-26 02:13:12,284 - root - INFO - local_rank 0
2023-07-26 02:13:12,284 - root - INFO - ---------------------------------------------------
2023-07-26 02:13:12,284 - root - INFO - Inference for 1 initial conditions
2023-07-26 02:13:12,544 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 02:13:12,546 - root - INFO - Number of samples per year: 1460
2023-07-26 02:13:12,546 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 02:13:12,546 - root - INFO - Delta t: 6 hours
2023-07-26 02:13:12,546 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 02:13:12,547 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 02:14:14,162 - root - INFO - Loading inference data
2023-07-26 02:14:14,165 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 02:14:14,405 - root - INFO - Initial condition 1 of 1
2023-07-26 02:14:15,278 - root - INFO - Extracting valid data from the first year
2023-07-26 02:16:26,071 - root - INFO - Standardizing data
2023-07-26 02:16:33,951 - root - INFO - Loading time means
2023-07-26 02:16:48,931 - root - INFO - Begin autoregressive inference
2023-07-26 02:17:00,072 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 02:17:11,187 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 2.217726945877075, ACC: 0.9763821363449097
2023-07-26 02:17:22,680 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 2.2157270908355713, ACC: 0.9757764339447021
2023-07-26 02:17:34,031 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 2.441904306411743, ACC: 0.9699966907501221
2023-07-26 02:17:45,474 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 2.761059284210205, ACC: 0.9611905217170715
2023-07-26 02:17:55,788 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 2.935856819152832, ACC: 0.9555822014808655
2023-07-26 02:18:06,501 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 3.2118890285491943, ACC: 0.9475579261779785
2023-07-26 02:18:17,193 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 3.4344170093536377, ACC: 0.940678060054779
2023-07-26 02:18:28,797 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 3.837836742401123, ACC: 0.9284234642982483
2023-07-26 02:18:38,611 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 4.059723854064941, ACC: 0.9204006195068359
2023-07-26 02:18:49,097 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 4.268457889556885, ACC: 0.9127674102783203
2023-07-26 02:18:59,371 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 4.479495525360107, ACC: 0.9019178748130798
2023-07-26 02:19:09,328 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 4.816401958465576, ACC: 0.8853514194488525
2023-07-26 02:19:19,574 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 5.018435955047607, ACC: 0.8746252059936523
2023-07-26 02:19:29,268 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 5.292466640472412, ACC: 0.8605295419692993
2023-07-26 02:19:39,977 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 5.559095859527588, ACC: 0.8444250226020813
2023-07-26 02:19:50,048 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 5.944697380065918, ACC: 0.8230563998222351
2023-07-26 02:19:59,788 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 6.222729206085205, ACC: 0.8040509819984436
2023-07-26 02:20:10,426 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 6.547933578491211, ACC: 0.7861908674240112
2023-07-26 02:20:20,738 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 6.76668643951416, ACC: 0.773350715637207
2023-07-26 02:20:30,831 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 6.982266902923584, ACC: 0.7628862261772156
2023-07-26 02:20:41,860 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 7.097016334533691, ACC: 0.7548298239707947
2023-07-26 02:20:51,864 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 7.225511074066162, ACC: 0.749723494052887
2023-07-26 02:21:01,893 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 7.387270927429199, ACC: 0.7399874329566956
2023-07-26 02:21:12,826 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 7.661768436431885, ACC: 0.7230063676834106
2023-07-26 02:21:22,885 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 7.760647773742676, ACC: 0.7175960540771484
2023-07-26 02:21:33,291 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 7.854586124420166, ACC: 0.7104172110557556
2023-07-26 02:21:43,464 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 8.01108169555664, ACC: 0.6946307420730591
2023-07-26 02:21:54,342 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 8.147491455078125, ACC: 0.6766936779022217
2023-07-26 02:22:05,639 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 8.340789794921875, ACC: 0.6570038199424744
2023-07-26 02:22:05,738 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-U850_30-timesteps_vis.h5
2023-07-26 02:22:58,822 - root - INFO - ------------------ Configuration ------------------
2023-07-26 02:22:58,822 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 02:22:58,822 - root - INFO - Configuration name: afno_backbone
2023-07-26 02:22:58,822 - root - INFO - log_to_wandb True
2023-07-26 02:22:58,822 - root - INFO - lr 0.0005
2023-07-26 02:22:58,822 - root - INFO - batch_size 64
2023-07-26 02:22:58,822 - root - INFO - max_epochs 150
2023-07-26 02:22:58,822 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 02:22:58,822 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 02:22:58,822 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 02:22:58,822 - root - INFO - orography False
2023-07-26 02:22:58,822 - root - INFO - orography_path None
2023-07-26 02:22:58,823 - root - INFO - exp_dir FourCastNet/results
2023-07-26 02:22:58,823 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 02:22:58,823 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 02:22:58,823 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 02:22:58,823 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 02:22:58,823 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 02:22:58,823 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 02:22:58,823 - root - INFO - loss l2
2023-07-26 02:22:58,823 - root - INFO - num_data_workers 4
2023-07-26 02:22:58,823 - root - INFO - dt 1
2023-07-26 02:22:58,823 - root - INFO - n_history 0
2023-07-26 02:22:58,823 - root - INFO - prediction_type iterative
2023-07-26 02:22:58,823 - root - INFO - prediction_length 30
2023-07-26 02:22:58,823 - root - INFO - n_initial_conditions 5
2023-07-26 02:22:58,823 - root - INFO - ics_type default
2023-07-26 02:22:58,823 - root - INFO - save_raw_forecasts True
2023-07-26 02:22:58,823 - root - INFO - save_channel False
2023-07-26 02:22:58,823 - root - INFO - masked_acc False
2023-07-26 02:22:58,823 - root - INFO - maskpath None
2023-07-26 02:22:58,824 - root - INFO - perturb False
2023-07-26 02:22:58,824 - root - INFO - add_grid False
2023-07-26 02:22:58,824 - root - INFO - N_grid_channels 0
2023-07-26 02:22:58,824 - root - INFO - gridtype sinusoidal
2023-07-26 02:22:58,824 - root - INFO - roll False
2023-07-26 02:22:58,824 - root - INFO - num_blocks 8
2023-07-26 02:22:58,824 - root - INFO - nettype afno
2023-07-26 02:22:58,824 - root - INFO - patch_size 8
2023-07-26 02:22:58,824 - root - INFO - width 56
2023-07-26 02:22:58,824 - root - INFO - modes 32
2023-07-26 02:22:58,824 - root - INFO - target RH850
2023-07-26 02:22:58,824 - root - INFO - normalization zscore
2023-07-26 02:22:58,824 - root - INFO - log_to_screen True
2023-07-26 02:22:58,824 - root - INFO - save_checkpoint True
2023-07-26 02:22:58,824 - root - INFO - enable_nhwc False
2023-07-26 02:22:58,824 - root - INFO - optimizer_type FusedAdam
2023-07-26 02:22:58,824 - root - INFO - crop_size_x None
2023-07-26 02:22:58,824 - root - INFO - crop_size_y None
2023-07-26 02:22:58,824 - root - INFO - two_step_training False
2023-07-26 02:22:58,824 - root - INFO - plot_animations False
2023-07-26 02:22:58,824 - root - INFO - add_noise False
2023-07-26 02:22:58,824 - root - INFO - noise_std 0
2023-07-26 02:22:58,824 - root - INFO - world_size 1
2023-07-26 02:22:58,825 - root - INFO - interp 0
2023-07-26 02:22:58,825 - root - INFO - use_daily_climatology False
2023-07-26 02:22:58,825 - root - INFO - global_batch_size 64
2023-07-26 02:22:58,825 - root - INFO - ablate V850
2023-07-26 02:22:58,825 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 02:22:58,825 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 02:22:58,825 - root - INFO - resuming False
2023-07-26 02:22:58,825 - root - INFO - local_rank 0
2023-07-26 02:22:58,825 - root - INFO - ---------------------------------------------------
2023-07-26 02:22:58,825 - root - INFO - Inference for 1 initial conditions
2023-07-26 02:22:59,134 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 02:22:59,135 - root - INFO - Number of samples per year: 1460
2023-07-26 02:22:59,135 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 02:22:59,135 - root - INFO - Delta t: 6 hours
2023-07-26 02:22:59,135 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 02:22:59,136 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 02:24:01,165 - root - INFO - Loading inference data
2023-07-26 02:24:01,169 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 02:24:01,531 - root - INFO - Initial condition 1 of 1
2023-07-26 02:24:02,345 - root - INFO - Extracting valid data from the first year
2023-07-26 02:26:10,989 - root - INFO - Standardizing data
2023-07-26 02:26:19,120 - root - INFO - Loading time means
2023-07-26 02:26:31,683 - root - INFO - Begin autoregressive inference
2023-07-26 02:26:42,321 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 02:26:52,960 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 1.3384968042373657, ACC: 0.9911149740219116
2023-07-26 02:27:03,587 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 1.9295449256896973, ACC: 0.9815462827682495
2023-07-26 02:27:13,568 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 2.230011224746704, ACC: 0.9750357270240784
2023-07-26 02:27:23,136 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 2.5809459686279297, ACC: 0.9662116169929504
2023-07-26 02:27:33,079 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 2.721651077270508, ACC: 0.9619507193565369
2023-07-26 02:27:44,079 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 3.0522642135620117, ACC: 0.9527165293693542
2023-07-26 02:27:54,614 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 3.265814781188965, ACC: 0.9463537931442261
2023-07-26 02:28:04,659 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 3.5929009914398193, ACC: 0.9371063709259033
2023-07-26 02:28:14,742 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 3.716538906097412, ACC: 0.9327859282493591
2023-07-26 02:28:24,728 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 3.9037444591522217, ACC: 0.9264127612113953
2023-07-26 02:28:35,537 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 4.0948872566223145, ACC: 0.9173974394798279
2023-07-26 02:28:46,134 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 4.434289455413818, ACC: 0.9020341038703918
2023-07-26 02:28:56,236 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 4.599555492401123, ACC: 0.8941775560379028
2023-07-26 02:29:06,601 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 4.836846828460693, ACC: 0.8833802938461304
2023-07-26 02:29:17,350 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 5.139846324920654, ACC: 0.8671127557754517
2023-07-26 02:29:27,691 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 5.523762226104736, ACC: 0.8477214574813843
2023-07-26 02:29:38,005 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 5.782081604003906, ACC: 0.8318936228752136
2023-07-26 02:29:47,369 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 5.975987434387207, ACC: 0.8231947422027588
2023-07-26 02:29:56,750 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 6.10793399810791, ACC: 0.8165832757949829
2023-07-26 02:30:07,005 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 6.24867057800293, ACC: 0.811627984046936
2023-07-26 02:30:18,011 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 6.412550449371338, ACC: 0.8020009398460388
2023-07-26 02:30:29,129 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 6.640853404998779, ACC: 0.7913619875907898
2023-07-26 02:30:39,769 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 6.804427146911621, ACC: 0.7818310260772705
2023-07-26 02:30:50,025 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 6.961429595947266, ACC: 0.7728453278541565
2023-07-26 02:31:00,568 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 7.078671932220459, ACC: 0.7655150890350342
2023-07-26 02:31:11,901 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 7.268309593200684, ACC: 0.7520195841789246
2023-07-26 02:31:22,405 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 7.513030052185059, ACC: 0.7303241491317749
2023-07-26 02:31:33,634 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 7.705318450927734, ACC: 0.7096711993217468
2023-07-26 02:31:44,088 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 8.005742073059082, ACC: 0.6839966177940369
2023-07-26 02:31:44,176 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-V850_30-timesteps_vis.h5
2023-07-26 02:32:37,653 - root - INFO - ------------------ Configuration ------------------
2023-07-26 02:32:37,653 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 02:32:37,654 - root - INFO - Configuration name: afno_backbone
2023-07-26 02:32:37,654 - root - INFO - log_to_wandb True
2023-07-26 02:32:37,654 - root - INFO - lr 0.0005
2023-07-26 02:32:37,654 - root - INFO - batch_size 64
2023-07-26 02:32:37,654 - root - INFO - max_epochs 150
2023-07-26 02:32:37,654 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 02:32:37,654 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 02:32:37,654 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 02:32:37,654 - root - INFO - orography False
2023-07-26 02:32:37,654 - root - INFO - orography_path None
2023-07-26 02:32:37,654 - root - INFO - exp_dir FourCastNet/results
2023-07-26 02:32:37,654 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 02:32:37,654 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 02:32:37,654 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 02:32:37,654 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 02:32:37,654 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 02:32:37,654 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 02:32:37,654 - root - INFO - loss l2
2023-07-26 02:32:37,655 - root - INFO - num_data_workers 4
2023-07-26 02:32:37,655 - root - INFO - dt 1
2023-07-26 02:32:37,655 - root - INFO - n_history 0
2023-07-26 02:32:37,656 - root - INFO - prediction_type iterative
2023-07-26 02:32:37,656 - root - INFO - prediction_length 30
2023-07-26 02:32:37,656 - root - INFO - n_initial_conditions 5
2023-07-26 02:32:37,656 - root - INFO - ics_type default
2023-07-26 02:32:37,656 - root - INFO - save_raw_forecasts True
2023-07-26 02:32:37,656 - root - INFO - save_channel False
2023-07-26 02:32:37,656 - root - INFO - masked_acc False
2023-07-26 02:32:37,656 - root - INFO - maskpath None
2023-07-26 02:32:37,656 - root - INFO - perturb False
2023-07-26 02:32:37,657 - root - INFO - add_grid False
2023-07-26 02:32:37,657 - root - INFO - N_grid_channels 0
2023-07-26 02:32:37,657 - root - INFO - gridtype sinusoidal
2023-07-26 02:32:37,657 - root - INFO - roll False
2023-07-26 02:32:37,657 - root - INFO - num_blocks 8
2023-07-26 02:32:37,657 - root - INFO - nettype afno
2023-07-26 02:32:37,657 - root - INFO - patch_size 8
2023-07-26 02:32:37,657 - root - INFO - width 56
2023-07-26 02:32:37,657 - root - INFO - modes 32
2023-07-26 02:32:37,657 - root - INFO - target RH850
2023-07-26 02:32:37,657 - root - INFO - normalization zscore
2023-07-26 02:32:37,657 - root - INFO - log_to_screen True
2023-07-26 02:32:37,657 - root - INFO - save_checkpoint True
2023-07-26 02:32:37,658 - root - INFO - enable_nhwc False
2023-07-26 02:32:37,658 - root - INFO - optimizer_type FusedAdam
2023-07-26 02:32:37,658 - root - INFO - crop_size_x None
2023-07-26 02:32:37,658 - root - INFO - crop_size_y None
2023-07-26 02:32:37,658 - root - INFO - two_step_training False
2023-07-26 02:32:37,658 - root - INFO - plot_animations False
2023-07-26 02:32:37,658 - root - INFO - add_noise False
2023-07-26 02:32:37,658 - root - INFO - noise_std 0
2023-07-26 02:32:37,658 - root - INFO - world_size 1
2023-07-26 02:32:37,658 - root - INFO - interp 0
2023-07-26 02:32:37,658 - root - INFO - use_daily_climatology False
2023-07-26 02:32:37,658 - root - INFO - global_batch_size 64
2023-07-26 02:32:37,659 - root - INFO - ablate Z850
2023-07-26 02:32:37,659 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 02:32:37,659 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 02:32:37,659 - root - INFO - resuming False
2023-07-26 02:32:37,659 - root - INFO - local_rank 0
2023-07-26 02:32:37,659 - root - INFO - ---------------------------------------------------
2023-07-26 02:32:37,659 - root - INFO - Inference for 1 initial conditions
2023-07-26 02:32:37,978 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 02:32:37,980 - root - INFO - Number of samples per year: 1460
2023-07-26 02:32:37,980 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 02:32:37,981 - root - INFO - Delta t: 6 hours
2023-07-26 02:32:37,981 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 02:32:37,981 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 02:33:39,581 - root - INFO - Loading inference data
2023-07-26 02:33:39,583 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 02:33:39,716 - root - INFO - Initial condition 1 of 1
2023-07-26 02:33:40,509 - root - INFO - Extracting valid data from the first year
2023-07-26 02:35:53,932 - root - INFO - Standardizing data
2023-07-26 02:36:02,067 - root - INFO - Loading time means
2023-07-26 02:36:15,220 - root - INFO - Begin autoregressive inference
2023-07-26 02:36:25,860 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 02:36:36,694 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 21.436769485473633, ACC: 0.2810239791870117
2023-07-26 02:36:47,579 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 117.59159088134766, ACC: 0.07565221935510635
2023-07-26 02:36:58,162 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 195.1263885498047, ACC: 0.057725690305233
2023-07-26 02:37:09,999 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 224.63882446289062, ACC: 0.045924872159957886
2023-07-26 02:37:20,250 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 223.806884765625, ACC: 0.032118059694767
2023-07-26 02:37:30,773 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 214.10064697265625, ACC: 0.022238628938794136
2023-07-26 02:37:41,484 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 205.27488708496094, ACC: 0.01302195992320776
2023-07-26 02:37:52,379 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 200.24044799804688, ACC: -0.005067190155386925
2023-07-26 02:38:02,816 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 199.1144256591797, ACC: -0.017774034291505814
2023-07-26 02:38:13,219 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 201.2474365234375, ACC: -0.03275802358984947
2023-07-26 02:38:23,261 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 204.7768096923828, ACC: -0.03850620612502098
2023-07-26 02:38:33,781 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 208.5413818359375, ACC: -0.04648881033062935
2023-07-26 02:38:44,157 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 211.7802276611328, ACC: -0.042567238211631775
2023-07-26 02:38:54,593 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 214.55148315429688, ACC: -0.05226767435669899
2023-07-26 02:39:06,194 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 216.5419921875, ACC: -0.045506611466407776
2023-07-26 02:39:16,792 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 218.12530517578125, ACC: -0.04891220107674599
2023-07-26 02:39:26,635 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 219.20233154296875, ACC: -0.04455506056547165
2023-07-26 02:39:36,899 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 220.0894775390625, ACC: -0.050562113523483276
2023-07-26 02:39:47,361 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 220.5103302001953, ACC: -0.033988066017627716
2023-07-26 02:39:57,691 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 220.9430389404297, ACC: -0.034384287893772125
2023-07-26 02:40:09,202 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 221.13461303710938, ACC: -0.024231571704149246
2023-07-26 02:40:20,003 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 221.372802734375, ACC: -0.025751546025276184
2023-07-26 02:40:31,186 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 221.43289184570312, ACC: -0.016871992498636246
2023-07-26 02:40:41,827 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 221.52508544921875, ACC: -0.014996574260294437
2023-07-26 02:40:51,711 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 221.53050231933594, ACC: -0.008169303648173809
2023-07-26 02:41:01,494 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 221.60826110839844, ACC: -0.010329964570701122
2023-07-26 02:41:12,071 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 221.57107543945312, ACC: -0.0036706957034766674
2023-07-26 02:41:22,655 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 221.58990478515625, ACC: -0.003451254917308688
2023-07-26 02:41:32,846 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 221.5547637939453, ACC: 0.0016297861002385616
2023-07-26 02:41:32,934 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-Z850_30-timesteps_vis.h5
2023-07-26 02:42:26,131 - root - INFO - ------------------ Configuration ------------------
2023-07-26 02:42:26,131 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 02:42:26,132 - root - INFO - Configuration name: afno_backbone
2023-07-26 02:42:26,132 - root - INFO - log_to_wandb True
2023-07-26 02:42:26,132 - root - INFO - lr 0.0005
2023-07-26 02:42:26,132 - root - INFO - batch_size 64
2023-07-26 02:42:26,132 - root - INFO - max_epochs 150
2023-07-26 02:42:26,132 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 02:42:26,132 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 02:42:26,132 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 02:42:26,132 - root - INFO - orography False
2023-07-26 02:42:26,132 - root - INFO - orography_path None
2023-07-26 02:42:26,132 - root - INFO - exp_dir FourCastNet/results
2023-07-26 02:42:26,132 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 02:42:26,132 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 02:42:26,132 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 02:42:26,132 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 02:42:26,132 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 02:42:26,132 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 02:42:26,132 - root - INFO - loss l2
2023-07-26 02:42:26,132 - root - INFO - num_data_workers 4
2023-07-26 02:42:26,132 - root - INFO - dt 1
2023-07-26 02:42:26,133 - root - INFO - n_history 0
2023-07-26 02:42:26,133 - root - INFO - prediction_type iterative
2023-07-26 02:42:26,133 - root - INFO - prediction_length 30
2023-07-26 02:42:26,133 - root - INFO - n_initial_conditions 5
2023-07-26 02:42:26,133 - root - INFO - ics_type default
2023-07-26 02:42:26,133 - root - INFO - save_raw_forecasts True
2023-07-26 02:42:26,133 - root - INFO - save_channel False
2023-07-26 02:42:26,133 - root - INFO - masked_acc False
2023-07-26 02:42:26,133 - root - INFO - maskpath None
2023-07-26 02:42:26,133 - root - INFO - perturb False
2023-07-26 02:42:26,133 - root - INFO - add_grid False
2023-07-26 02:42:26,133 - root - INFO - N_grid_channels 0
2023-07-26 02:42:26,133 - root - INFO - gridtype sinusoidal
2023-07-26 02:42:26,133 - root - INFO - roll False
2023-07-26 02:42:26,133 - root - INFO - num_blocks 8
2023-07-26 02:42:26,133 - root - INFO - nettype afno
2023-07-26 02:42:26,133 - root - INFO - patch_size 8
2023-07-26 02:42:26,134 - root - INFO - width 56
2023-07-26 02:42:26,134 - root - INFO - modes 32
2023-07-26 02:42:26,134 - root - INFO - target RH850
2023-07-26 02:42:26,134 - root - INFO - normalization zscore
2023-07-26 02:42:26,134 - root - INFO - log_to_screen True
2023-07-26 02:42:26,134 - root - INFO - save_checkpoint True
2023-07-26 02:42:26,134 - root - INFO - enable_nhwc False
2023-07-26 02:42:26,134 - root - INFO - optimizer_type FusedAdam
2023-07-26 02:42:26,134 - root - INFO - crop_size_x None
2023-07-26 02:42:26,134 - root - INFO - crop_size_y None
2023-07-26 02:42:26,134 - root - INFO - two_step_training False
2023-07-26 02:42:26,134 - root - INFO - plot_animations False
2023-07-26 02:42:26,134 - root - INFO - add_noise False
2023-07-26 02:42:26,134 - root - INFO - noise_std 0
2023-07-26 02:42:26,134 - root - INFO - world_size 1
2023-07-26 02:42:26,134 - root - INFO - interp 0
2023-07-26 02:42:26,134 - root - INFO - use_daily_climatology False
2023-07-26 02:42:26,134 - root - INFO - global_batch_size 64
2023-07-26 02:42:26,134 - root - INFO - ablate T500
2023-07-26 02:42:26,135 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 02:42:26,135 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 02:42:26,135 - root - INFO - resuming False
2023-07-26 02:42:26,135 - root - INFO - local_rank 0
2023-07-26 02:42:26,135 - root - INFO - ---------------------------------------------------
2023-07-26 02:42:26,136 - root - INFO - Inference for 1 initial conditions
2023-07-26 02:42:26,432 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 02:42:26,433 - root - INFO - Number of samples per year: 1460
2023-07-26 02:42:26,433 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 02:42:26,434 - root - INFO - Delta t: 6 hours
2023-07-26 02:42:26,434 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 02:42:26,434 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 02:43:27,785 - root - INFO - Loading inference data
2023-07-26 02:43:27,786 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 02:43:28,009 - root - INFO - Initial condition 1 of 1
2023-07-26 02:43:28,823 - root - INFO - Extracting valid data from the first year
2023-07-26 02:45:38,068 - root - INFO - Standardizing data
2023-07-26 02:45:46,190 - root - INFO - Loading time means
2023-07-26 02:45:57,216 - root - INFO - Begin autoregressive inference
2023-07-26 02:46:07,939 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 02:46:19,613 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 4.066255569458008, ACC: 0.9177239537239075
2023-07-26 02:46:31,020 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 2.9347453117370605, ACC: 0.9567127823829651
2023-07-26 02:46:41,770 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 2.882469415664673, ACC: 0.9579413533210754
2023-07-26 02:46:52,697 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 3.0757482051849365, ACC: 0.9516223073005676
2023-07-26 02:47:03,294 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 3.195167303085327, ACC: 0.9471697807312012
2023-07-26 02:47:15,495 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 3.415724754333496, ACC: 0.9404085874557495
2023-07-26 02:47:27,088 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 3.619018316268921, ACC: 0.9336444735527039
2023-07-26 02:47:38,184 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 3.8925700187683105, ACC: 0.9256451725959778
2023-07-26 02:47:48,951 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 4.014241695404053, ACC: 0.9207547307014465
2023-07-26 02:47:59,828 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 4.250705242156982, ACC: 0.91166090965271
2023-07-26 02:48:11,480 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 4.494714736938477, ACC: 0.8988453149795532
2023-07-26 02:48:22,869 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 4.847743988037109, ACC: 0.8811444044113159
2023-07-26 02:48:33,793 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 5.006762981414795, ACC: 0.872906506061554
2023-07-26 02:48:44,693 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 5.213662147521973, ACC: 0.8630059957504272
2023-07-26 02:48:54,876 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 5.454652786254883, ACC: 0.8490775227546692
2023-07-26 02:49:05,958 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 5.737016201019287, ACC: 0.8349167108535767
2023-07-26 02:49:16,781 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 5.964877128601074, ACC: 0.8200852274894714
2023-07-26 02:49:27,485 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 6.104216575622559, ACC: 0.8141146302223206
2023-07-26 02:49:37,418 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 6.203104019165039, ACC: 0.8091105222702026
2023-07-26 02:49:47,208 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 6.31452751159668, ACC: 0.8055329918861389
2023-07-26 02:49:58,137 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 6.373146057128906, ACC: 0.8018357753753662
2023-07-26 02:50:09,517 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 6.575048446655273, ACC: 0.7929427027702332
2023-07-26 02:50:20,405 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 6.836989402770996, ACC: 0.7770559787750244
2023-07-26 02:50:30,318 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 7.138333797454834, ACC: 0.758575439453125
2023-07-26 02:50:41,917 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 7.366552829742432, ACC: 0.7436147928237915
2023-07-26 02:50:53,195 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 7.649056911468506, ACC: 0.7231695055961609
2023-07-26 02:51:03,750 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 7.959170341491699, ACC: 0.6960888504981995
2023-07-26 02:51:14,990 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 8.215570449829102, ACC: 0.670092761516571
2023-07-26 02:51:26,255 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 8.533918380737305, ACC: 0.641113817691803
2023-07-26 02:51:26,343 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-T500_30-timesteps_vis.h5
2023-07-26 02:52:19,503 - root - INFO - ------------------ Configuration ------------------
2023-07-26 02:52:19,504 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 02:52:19,504 - root - INFO - Configuration name: afno_backbone
2023-07-26 02:52:19,504 - root - INFO - log_to_wandb True
2023-07-26 02:52:19,504 - root - INFO - lr 0.0005
2023-07-26 02:52:19,504 - root - INFO - batch_size 64
2023-07-26 02:52:19,504 - root - INFO - max_epochs 150
2023-07-26 02:52:19,504 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 02:52:19,504 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 02:52:19,504 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 02:52:19,504 - root - INFO - orography False
2023-07-26 02:52:19,504 - root - INFO - orography_path None
2023-07-26 02:52:19,504 - root - INFO - exp_dir FourCastNet/results
2023-07-26 02:52:19,504 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 02:52:19,505 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 02:52:19,505 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 02:52:19,507 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 02:52:19,507 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 02:52:19,508 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 02:52:19,508 - root - INFO - loss l2
2023-07-26 02:52:19,508 - root - INFO - num_data_workers 4
2023-07-26 02:52:19,508 - root - INFO - dt 1
2023-07-26 02:52:19,508 - root - INFO - n_history 0
2023-07-26 02:52:19,508 - root - INFO - prediction_type iterative
2023-07-26 02:52:19,508 - root - INFO - prediction_length 30
2023-07-26 02:52:19,508 - root - INFO - n_initial_conditions 5
2023-07-26 02:52:19,508 - root - INFO - ics_type default
2023-07-26 02:52:19,509 - root - INFO - save_raw_forecasts True
2023-07-26 02:52:19,509 - root - INFO - save_channel False
2023-07-26 02:52:19,509 - root - INFO - masked_acc False
2023-07-26 02:52:19,509 - root - INFO - maskpath None
2023-07-26 02:52:19,509 - root - INFO - perturb False
2023-07-26 02:52:19,509 - root - INFO - add_grid False
2023-07-26 02:52:19,509 - root - INFO - N_grid_channels 0
2023-07-26 02:52:19,509 - root - INFO - gridtype sinusoidal
2023-07-26 02:52:19,509 - root - INFO - roll False
2023-07-26 02:52:19,509 - root - INFO - num_blocks 8
2023-07-26 02:52:19,509 - root - INFO - nettype afno
2023-07-26 02:52:19,509 - root - INFO - patch_size 8
2023-07-26 02:52:19,509 - root - INFO - width 56
2023-07-26 02:52:19,509 - root - INFO - modes 32
2023-07-26 02:52:19,509 - root - INFO - target RH850
2023-07-26 02:52:19,509 - root - INFO - normalization zscore
2023-07-26 02:52:19,509 - root - INFO - log_to_screen True
2023-07-26 02:52:19,509 - root - INFO - save_checkpoint True
2023-07-26 02:52:19,509 - root - INFO - enable_nhwc False
2023-07-26 02:52:19,509 - root - INFO - optimizer_type FusedAdam
2023-07-26 02:52:19,509 - root - INFO - crop_size_x None
2023-07-26 02:52:19,509 - root - INFO - crop_size_y None
2023-07-26 02:52:19,509 - root - INFO - two_step_training False
2023-07-26 02:52:19,510 - root - INFO - plot_animations False
2023-07-26 02:52:19,510 - root - INFO - add_noise False
2023-07-26 02:52:19,510 - root - INFO - noise_std 0
2023-07-26 02:52:19,512 - root - INFO - world_size 1
2023-07-26 02:52:19,512 - root - INFO - interp 0
2023-07-26 02:52:19,512 - root - INFO - use_daily_climatology False
2023-07-26 02:52:19,512 - root - INFO - global_batch_size 64
2023-07-26 02:52:19,513 - root - INFO - ablate U500
2023-07-26 02:52:19,513 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 02:52:19,513 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 02:52:19,513 - root - INFO - resuming False
2023-07-26 02:52:19,513 - root - INFO - local_rank 0
2023-07-26 02:52:19,513 - root - INFO - ---------------------------------------------------
2023-07-26 02:52:19,513 - root - INFO - Inference for 1 initial conditions
2023-07-26 02:52:19,722 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 02:52:19,724 - root - INFO - Number of samples per year: 1460
2023-07-26 02:52:19,724 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 02:52:19,724 - root - INFO - Delta t: 6 hours
2023-07-26 02:52:19,724 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 02:52:19,725 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 02:53:15,011 - root - INFO - Loading inference data
2023-07-26 02:53:15,015 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 02:53:15,154 - root - INFO - Initial condition 1 of 1
2023-07-26 02:53:16,017 - root - INFO - Extracting valid data from the first year
2023-07-26 02:55:09,366 - root - INFO - Standardizing data
2023-07-26 02:55:17,715 - root - INFO - Loading time means
2023-07-26 02:55:29,655 - root - INFO - Begin autoregressive inference
2023-07-26 02:55:40,597 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 02:55:51,203 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 21.513357162475586, ACC: 0.2993220388889313
2023-07-26 02:56:02,265 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 146.49720764160156, ACC: 0.06980738043785095
2023-07-26 02:56:13,360 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 209.56207275390625, ACC: 0.05452526733279228
2023-07-26 02:56:24,558 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 221.07861328125, ACC: 0.03852749243378639
2023-07-26 02:56:35,330 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 212.40798950195312, ACC: 0.018967779353260994
2023-07-26 02:56:46,195 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 202.35174560546875, ACC: 0.0020033796317875385
2023-07-26 02:56:57,453 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 196.62103271484375, ACC: -0.010017028078436852
2023-07-26 02:57:08,650 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 195.61903381347656, ACC: -0.02553737536072731
2023-07-26 02:57:19,373 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 197.93894958496094, ACC: -0.03637229651212692
2023-07-26 02:57:29,933 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 201.93756103515625, ACC: -0.04685819521546364
2023-07-26 02:57:40,296 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 206.21974182128906, ACC: -0.04741582274436951
2023-07-26 02:57:50,484 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 210.1222381591797, ACC: -0.05133441463112831
2023-07-26 02:58:01,983 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 213.2090606689453, ACC: -0.045287832617759705
2023-07-26 02:58:12,892 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 215.7235565185547, ACC: -0.05361475050449371
2023-07-26 02:58:24,050 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 217.45846557617188, ACC: -0.04629520699381828
2023-07-26 02:58:33,929 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 218.8216552734375, ACC: -0.04924413934350014
2023-07-26 02:58:44,097 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 219.72396850585938, ACC: -0.04471518471837044
2023-07-26 02:58:55,479 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 220.4750518798828, ACC: -0.05054522305727005
2023-07-26 02:59:06,538 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 220.79397583007812, ACC: -0.033967524766922
2023-07-26 02:59:17,685 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 221.14999389648438, ACC: -0.034327056258916855
2023-07-26 02:59:27,533 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 221.28515625, ACC: -0.024179931730031967
2023-07-26 02:59:37,725 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 221.48199462890625, ACC: -0.025716735050082207
2023-07-26 02:59:48,074 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 221.51193237304688, ACC: -0.016848577186465263
2023-07-26 02:59:59,200 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 221.58212280273438, ACC: -0.014974771067500114
2023-07-26 03:00:11,307 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 221.57162475585938, ACC: -0.008154282346367836
2023-07-26 03:00:22,847 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 221.6378631591797, ACC: -0.01031580101698637
2023-07-26 03:00:33,911 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 221.5924072265625, ACC: -0.003660632064566016
2023-07-26 03:00:45,051 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 221.6052703857422, ACC: -0.0034429391380399466
2023-07-26 03:00:56,174 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 221.56582641601562, ACC: 0.0016333152307197452
2023-07-26 03:00:56,288 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-U500_30-timesteps_vis.h5
2023-07-26 03:01:49,548 - root - INFO - ------------------ Configuration ------------------
2023-07-26 03:01:49,549 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 03:01:49,549 - root - INFO - Configuration name: afno_backbone
2023-07-26 03:01:49,549 - root - INFO - log_to_wandb True
2023-07-26 03:01:49,549 - root - INFO - lr 0.0005
2023-07-26 03:01:49,549 - root - INFO - batch_size 64
2023-07-26 03:01:49,549 - root - INFO - max_epochs 150
2023-07-26 03:01:49,549 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 03:01:49,549 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 03:01:49,549 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 03:01:49,549 - root - INFO - orography False
2023-07-26 03:01:49,549 - root - INFO - orography_path None
2023-07-26 03:01:49,549 - root - INFO - exp_dir FourCastNet/results
2023-07-26 03:01:49,549 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 03:01:49,549 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 03:01:49,549 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 03:01:49,549 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 03:01:49,549 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 03:01:49,549 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 03:01:49,550 - root - INFO - loss l2
2023-07-26 03:01:49,550 - root - INFO - num_data_workers 4
2023-07-26 03:01:49,550 - root - INFO - dt 1
2023-07-26 03:01:49,550 - root - INFO - n_history 0
2023-07-26 03:01:49,550 - root - INFO - prediction_type iterative
2023-07-26 03:01:49,550 - root - INFO - prediction_length 30
2023-07-26 03:01:49,550 - root - INFO - n_initial_conditions 5
2023-07-26 03:01:49,550 - root - INFO - ics_type default
2023-07-26 03:01:49,550 - root - INFO - save_raw_forecasts True
2023-07-26 03:01:49,550 - root - INFO - save_channel False
2023-07-26 03:01:49,550 - root - INFO - masked_acc False
2023-07-26 03:01:49,550 - root - INFO - maskpath None
2023-07-26 03:01:49,550 - root - INFO - perturb False
2023-07-26 03:01:49,550 - root - INFO - add_grid False
2023-07-26 03:01:49,550 - root - INFO - N_grid_channels 0
2023-07-26 03:01:49,550 - root - INFO - gridtype sinusoidal
2023-07-26 03:01:49,550 - root - INFO - roll False
2023-07-26 03:01:49,550 - root - INFO - num_blocks 8
2023-07-26 03:01:49,551 - root - INFO - nettype afno
2023-07-26 03:01:49,551 - root - INFO - patch_size 8
2023-07-26 03:01:49,551 - root - INFO - width 56
2023-07-26 03:01:49,551 - root - INFO - modes 32
2023-07-26 03:01:49,551 - root - INFO - target RH850
2023-07-26 03:01:49,551 - root - INFO - normalization zscore
2023-07-26 03:01:49,551 - root - INFO - log_to_screen True
2023-07-26 03:01:49,551 - root - INFO - save_checkpoint True
2023-07-26 03:01:49,551 - root - INFO - enable_nhwc False
2023-07-26 03:01:49,551 - root - INFO - optimizer_type FusedAdam
2023-07-26 03:01:49,551 - root - INFO - crop_size_x None
2023-07-26 03:01:49,551 - root - INFO - crop_size_y None
2023-07-26 03:01:49,551 - root - INFO - two_step_training False
2023-07-26 03:01:49,551 - root - INFO - plot_animations False
2023-07-26 03:01:49,551 - root - INFO - add_noise False
2023-07-26 03:01:49,551 - root - INFO - noise_std 0
2023-07-26 03:01:49,551 - root - INFO - world_size 1
2023-07-26 03:01:49,551 - root - INFO - interp 0
2023-07-26 03:01:49,551 - root - INFO - use_daily_climatology False
2023-07-26 03:01:49,551 - root - INFO - global_batch_size 64
2023-07-26 03:01:49,551 - root - INFO - ablate V500
2023-07-26 03:01:49,551 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 03:01:49,551 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 03:01:49,551 - root - INFO - resuming False
2023-07-26 03:01:49,551 - root - INFO - local_rank 0
2023-07-26 03:01:49,551 - root - INFO - ---------------------------------------------------
2023-07-26 03:01:49,552 - root - INFO - Inference for 1 initial conditions
2023-07-26 03:01:49,766 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 03:01:49,767 - root - INFO - Number of samples per year: 1460
2023-07-26 03:01:49,768 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 03:01:49,768 - root - INFO - Delta t: 6 hours
2023-07-26 03:01:49,768 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 03:01:49,768 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 03:02:52,832 - root - INFO - Loading inference data
2023-07-26 03:02:52,833 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 03:02:52,954 - root - INFO - Initial condition 1 of 1
2023-07-26 03:02:53,808 - root - INFO - Extracting valid data from the first year
2023-07-26 03:05:03,884 - root - INFO - Standardizing data
2023-07-26 03:05:12,688 - root - INFO - Loading time means
2023-07-26 03:05:26,828 - root - INFO - Begin autoregressive inference
2023-07-26 03:05:38,195 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 03:05:49,737 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 116.9049072265625, ACC: 0.3178362250328064
2023-07-26 03:06:01,649 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 185.42129516601562, ACC: 0.1175592765212059
2023-07-26 03:06:14,110 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 225.4080352783203, ACC: 0.03656137362122536
2023-07-26 03:06:25,374 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 228.31326293945312, ACC: 0.004183855373412371
2023-07-26 03:06:36,757 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 217.14344787597656, ACC: -0.00808356236666441
2023-07-26 03:06:48,955 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 205.33670043945312, ACC: -0.017488466575741768
2023-07-26 03:07:00,833 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 198.6186981201172, ACC: -0.023445196449756622
2023-07-26 03:07:11,596 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 197.5395965576172, ACC: -0.037591733038425446
2023-07-26 03:07:23,227 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 199.91371154785156, ACC: -0.043647971004247665
2023-07-26 03:07:35,407 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 203.8707275390625, ACC: -0.053673356771469116
2023-07-26 03:07:47,401 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 207.5460205078125, ACC: -0.05302019789814949
2023-07-26 03:07:59,134 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 210.97775268554688, ACC: -0.05739201605319977
2023-07-26 03:08:10,320 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 213.76780700683594, ACC: -0.05019519850611687
2023-07-26 03:08:22,757 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 216.0823974609375, ACC: -0.05805711820721626
2023-07-26 03:08:33,605 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 217.6707763671875, ACC: -0.04993165656924248
2023-07-26 03:08:44,883 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 218.93870544433594, ACC: -0.052251603454351425
2023-07-26 03:08:55,952 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 219.77670288085938, ACC: -0.047011759132146835
2023-07-26 03:09:05,813 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 220.48922729492188, ACC: -0.05224776640534401
2023-07-26 03:09:16,246 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 220.7883758544922, ACC: -0.03518194332718849
2023-07-26 03:09:26,957 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 221.1364288330078, ACC: -0.03517187014222145
2023-07-26 03:09:37,298 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 221.2706756591797, ACC: -0.024752818048000336
2023-07-26 03:09:47,472 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 221.47006225585938, ACC: -0.026104198768734932
2023-07-26 03:09:57,959 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 221.5032196044922, ACC: -0.017098527401685715
2023-07-26 03:10:08,625 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 221.57652282714844, ACC: -0.015153673477470875
2023-07-26 03:10:18,849 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 221.56825256347656, ACC: -0.008275019936263561
2023-07-26 03:10:29,228 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 221.63604736328125, ACC: -0.010401484556496143
2023-07-26 03:10:39,919 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 221.59146118164062, ACC: -0.0037153090815991163
2023-07-26 03:10:50,197 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 221.6048583984375, ACC: -0.003476711455732584
2023-07-26 03:11:00,215 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 221.565673828125, ACC: 0.0016154875047504902
2023-07-26 03:11:00,312 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-V500_30-timesteps_vis.h5
2023-07-26 03:11:53,675 - root - INFO - ------------------ Configuration ------------------
2023-07-26 03:11:53,675 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 03:11:53,675 - root - INFO - Configuration name: afno_backbone
2023-07-26 03:11:53,675 - root - INFO - log_to_wandb True
2023-07-26 03:11:53,675 - root - INFO - lr 0.0005
2023-07-26 03:11:53,675 - root - INFO - batch_size 64
2023-07-26 03:11:53,675 - root - INFO - max_epochs 150
2023-07-26 03:11:53,675 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 03:11:53,675 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 03:11:53,675 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 03:11:53,676 - root - INFO - orography False
2023-07-26 03:11:53,676 - root - INFO - orography_path None
2023-07-26 03:11:53,676 - root - INFO - exp_dir FourCastNet/results
2023-07-26 03:11:53,676 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 03:11:53,676 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 03:11:53,676 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 03:11:53,676 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 03:11:53,676 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 03:11:53,676 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 03:11:53,676 - root - INFO - loss l2
2023-07-26 03:11:53,676 - root - INFO - num_data_workers 4
2023-07-26 03:11:53,676 - root - INFO - dt 1
2023-07-26 03:11:53,676 - root - INFO - n_history 0
2023-07-26 03:11:53,676 - root - INFO - prediction_type iterative
2023-07-26 03:11:53,676 - root - INFO - prediction_length 30
2023-07-26 03:11:53,676 - root - INFO - n_initial_conditions 5
2023-07-26 03:11:53,676 - root - INFO - ics_type default
2023-07-26 03:11:53,676 - root - INFO - save_raw_forecasts True
2023-07-26 03:11:53,676 - root - INFO - save_channel False
2023-07-26 03:11:53,677 - root - INFO - masked_acc False
2023-07-26 03:11:53,677 - root - INFO - maskpath None
2023-07-26 03:11:53,677 - root - INFO - perturb False
2023-07-26 03:11:53,677 - root - INFO - add_grid False
2023-07-26 03:11:53,677 - root - INFO - N_grid_channels 0
2023-07-26 03:11:53,677 - root - INFO - gridtype sinusoidal
2023-07-26 03:11:53,677 - root - INFO - roll False
2023-07-26 03:11:53,677 - root - INFO - num_blocks 8
2023-07-26 03:11:53,677 - root - INFO - nettype afno
2023-07-26 03:11:53,677 - root - INFO - patch_size 8
2023-07-26 03:11:53,677 - root - INFO - width 56
2023-07-26 03:11:53,677 - root - INFO - modes 32
2023-07-26 03:11:53,677 - root - INFO - target RH850
2023-07-26 03:11:53,677 - root - INFO - normalization zscore
2023-07-26 03:11:53,677 - root - INFO - log_to_screen True
2023-07-26 03:11:53,677 - root - INFO - save_checkpoint True
2023-07-26 03:11:53,677 - root - INFO - enable_nhwc False
2023-07-26 03:11:53,678 - root - INFO - optimizer_type FusedAdam
2023-07-26 03:11:53,678 - root - INFO - crop_size_x None
2023-07-26 03:11:53,678 - root - INFO - crop_size_y None
2023-07-26 03:11:53,678 - root - INFO - two_step_training False
2023-07-26 03:11:53,678 - root - INFO - plot_animations False
2023-07-26 03:11:53,678 - root - INFO - add_noise False
2023-07-26 03:11:53,678 - root - INFO - noise_std 0
2023-07-26 03:11:53,678 - root - INFO - world_size 1
2023-07-26 03:11:53,679 - root - INFO - interp 0
2023-07-26 03:11:53,679 - root - INFO - use_daily_climatology False
2023-07-26 03:11:53,679 - root - INFO - global_batch_size 64
2023-07-26 03:11:53,679 - root - INFO - ablate Z500
2023-07-26 03:11:53,679 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 03:11:53,679 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 03:11:53,679 - root - INFO - resuming False
2023-07-26 03:11:53,680 - root - INFO - local_rank 0
2023-07-26 03:11:53,680 - root - INFO - ---------------------------------------------------
2023-07-26 03:11:53,680 - root - INFO - Inference for 1 initial conditions
2023-07-26 03:11:53,955 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 03:11:53,956 - root - INFO - Number of samples per year: 1460
2023-07-26 03:11:53,956 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 03:11:53,956 - root - INFO - Delta t: 6 hours
2023-07-26 03:11:53,956 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 03:11:53,957 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 03:13:07,973 - root - INFO - Loading inference data
2023-07-26 03:13:07,974 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 03:13:08,211 - root - INFO - Initial condition 1 of 1
2023-07-26 03:13:09,272 - root - INFO - Extracting valid data from the first year
2023-07-26 03:15:45,493 - root - INFO - Standardizing data
2023-07-26 03:15:53,298 - root - INFO - Loading time means
2023-07-26 03:16:12,299 - root - INFO - Begin autoregressive inference
2023-07-26 03:16:23,658 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 03:16:34,973 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 1.1486135721206665, ACC: 0.9934613704681396
2023-07-26 03:16:46,369 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 1.6638355255126953, ACC: 0.9862924814224243
2023-07-26 03:16:58,752 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 2.0109031200408936, ACC: 0.9797455072402954
2023-07-26 03:17:10,945 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 2.444164276123047, ACC: 0.9697107076644897
2023-07-26 03:17:22,503 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 2.677342653274536, ACC: 0.9632329344749451
2023-07-26 03:17:33,646 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 3.046712875366211, ACC: 0.9530205130577087
2023-07-26 03:17:44,347 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 3.300110340118408, ACC: 0.9455360174179077
2023-07-26 03:17:55,345 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 3.6025941371917725, ACC: 0.9370683431625366
2023-07-26 03:18:06,733 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 3.797374725341797, ACC: 0.9303371906280518
2023-07-26 03:18:17,585 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 3.999634265899658, ACC: 0.9231351017951965
2023-07-26 03:18:28,760 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 4.263640880584717, ACC: 0.9106902480125427
2023-07-26 03:18:38,834 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 4.638994216918945, ACC: 0.8929510712623596
2023-07-26 03:18:49,477 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 4.8566436767578125, ACC: 0.8824062347412109
2023-07-26 03:19:00,551 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 5.218547821044922, ACC: 0.8643379211425781
2023-07-26 03:19:11,856 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 5.616216659545898, ACC: 0.8416604995727539
2023-07-26 03:19:22,165 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 6.095702648162842, ACC: 0.8150985240936279
2023-07-26 03:19:32,843 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 6.427090167999268, ACC: 0.7935313582420349
2023-07-26 03:19:43,286 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 6.767507553100586, ACC: 0.7748755812644958
2023-07-26 03:19:53,713 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 6.9998955726623535, ACC: 0.7621063590049744
2023-07-26 03:20:04,179 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 7.281099319458008, ACC: 0.7476627230644226
2023-07-26 03:20:14,908 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 7.5544538497924805, ACC: 0.7296497821807861
2023-07-26 03:20:25,990 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 7.9174909591674805, ACC: 0.7076793909072876
2023-07-26 03:20:36,937 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 8.14382553100586, ACC: 0.6908044815063477
2023-07-26 03:20:47,787 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 8.454048156738281, ACC: 0.6678832173347473
2023-07-26 03:20:58,198 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 8.723363876342773, ACC: 0.6475732326507568
2023-07-26 03:21:08,450 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 9.00379467010498, ACC: 0.6235973238945007
2023-07-26 03:21:19,191 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 9.224498748779297, ACC: 0.5982733964920044
2023-07-26 03:21:29,854 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 9.454952239990234, ACC: 0.5677640438079834
2023-07-26 03:21:40,059 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 9.76983642578125, ACC: 0.533034086227417
2023-07-26 03:21:40,146 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-Z500_30-timesteps_vis.h5
2023-07-26 03:22:33,426 - root - INFO - ------------------ Configuration ------------------
2023-07-26 03:22:33,426 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 03:22:33,426 - root - INFO - Configuration name: afno_backbone
2023-07-26 03:22:33,426 - root - INFO - log_to_wandb True
2023-07-26 03:22:33,426 - root - INFO - lr 0.0005
2023-07-26 03:22:33,426 - root - INFO - batch_size 64
2023-07-26 03:22:33,426 - root - INFO - max_epochs 150
2023-07-26 03:22:33,427 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 03:22:33,427 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 03:22:33,427 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 03:22:33,427 - root - INFO - orography False
2023-07-26 03:22:33,427 - root - INFO - orography_path None
2023-07-26 03:22:33,427 - root - INFO - exp_dir FourCastNet/results
2023-07-26 03:22:33,427 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 03:22:33,427 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 03:22:33,427 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 03:22:33,427 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 03:22:33,427 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 03:22:33,427 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 03:22:33,427 - root - INFO - loss l2
2023-07-26 03:22:33,427 - root - INFO - num_data_workers 4
2023-07-26 03:22:33,427 - root - INFO - dt 1
2023-07-26 03:22:33,427 - root - INFO - n_history 0
2023-07-26 03:22:33,427 - root - INFO - prediction_type iterative
2023-07-26 03:22:33,427 - root - INFO - prediction_length 30
2023-07-26 03:22:33,427 - root - INFO - n_initial_conditions 5
2023-07-26 03:22:33,427 - root - INFO - ics_type default
2023-07-26 03:22:33,427 - root - INFO - save_raw_forecasts True
2023-07-26 03:22:33,427 - root - INFO - save_channel False
2023-07-26 03:22:33,427 - root - INFO - masked_acc False
2023-07-26 03:22:33,427 - root - INFO - maskpath None
2023-07-26 03:22:33,427 - root - INFO - perturb False
2023-07-26 03:22:33,428 - root - INFO - add_grid False
2023-07-26 03:22:33,428 - root - INFO - N_grid_channels 0
2023-07-26 03:22:33,428 - root - INFO - gridtype sinusoidal
2023-07-26 03:22:33,428 - root - INFO - roll False
2023-07-26 03:22:33,428 - root - INFO - num_blocks 8
2023-07-26 03:22:33,428 - root - INFO - nettype afno
2023-07-26 03:22:33,428 - root - INFO - patch_size 8
2023-07-26 03:22:33,428 - root - INFO - width 56
2023-07-26 03:22:33,428 - root - INFO - modes 32
2023-07-26 03:22:33,428 - root - INFO - target RH850
2023-07-26 03:22:33,428 - root - INFO - normalization zscore
2023-07-26 03:22:33,428 - root - INFO - log_to_screen True
2023-07-26 03:22:33,428 - root - INFO - save_checkpoint True
2023-07-26 03:22:33,428 - root - INFO - enable_nhwc False
2023-07-26 03:22:33,428 - root - INFO - optimizer_type FusedAdam
2023-07-26 03:22:33,428 - root - INFO - crop_size_x None
2023-07-26 03:22:33,428 - root - INFO - crop_size_y None
2023-07-26 03:22:33,428 - root - INFO - two_step_training False
2023-07-26 03:22:33,428 - root - INFO - plot_animations False
2023-07-26 03:22:33,428 - root - INFO - add_noise False
2023-07-26 03:22:33,428 - root - INFO - noise_std 0
2023-07-26 03:22:33,428 - root - INFO - world_size 1
2023-07-26 03:22:33,428 - root - INFO - interp 0
2023-07-26 03:22:33,428 - root - INFO - use_daily_climatology False
2023-07-26 03:22:33,428 - root - INFO - global_batch_size 64
2023-07-26 03:22:33,428 - root - INFO - ablate RH500
2023-07-26 03:22:33,428 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 03:22:33,428 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 03:22:33,428 - root - INFO - resuming False
2023-07-26 03:22:33,429 - root - INFO - local_rank 0
2023-07-26 03:22:33,429 - root - INFO - ---------------------------------------------------
2023-07-26 03:22:33,429 - root - INFO - Inference for 1 initial conditions
2023-07-26 03:22:33,889 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 03:22:33,890 - root - INFO - Number of samples per year: 1460
2023-07-26 03:22:33,890 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 03:22:33,890 - root - INFO - Delta t: 6 hours
2023-07-26 03:22:33,890 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 03:22:33,891 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 03:23:47,205 - root - INFO - Loading inference data
2023-07-26 03:23:47,206 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 03:23:47,336 - root - INFO - Initial condition 1 of 1
2023-07-26 03:23:48,161 - root - INFO - Extracting valid data from the first year
2023-07-26 03:26:19,151 - root - INFO - Standardizing data
2023-07-26 03:26:27,615 - root - INFO - Loading time means
2023-07-26 03:26:44,370 - root - INFO - Begin autoregressive inference
2023-07-26 03:26:55,594 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 03:27:07,594 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 1.2033891677856445, ACC: 0.9928209781646729
2023-07-26 03:27:19,294 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 1.736462116241455, ACC: 0.9850871562957764
2023-07-26 03:27:30,085 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 2.0623972415924072, ACC: 0.9787015914916992
2023-07-26 03:27:40,487 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 2.460387945175171, ACC: 0.9692997932434082
2023-07-26 03:27:51,036 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 2.636065721511841, ACC: 0.9643895030021667
2023-07-26 03:28:00,683 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 2.9643585681915283, ACC: 0.9556608200073242
2023-07-26 03:28:11,287 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 3.192906141281128, ACC: 0.9492974877357483
2023-07-26 03:28:21,658 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 3.4871621131896973, ACC: 0.9414742588996887
2023-07-26 03:28:31,296 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 3.6727638244628906, ACC: 0.9354255795478821
2023-07-26 03:28:41,119 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 3.9029834270477295, ACC: 0.927639365196228
2023-07-26 03:28:50,968 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 4.196399211883545, ACC: 0.9146206378936768
2023-07-26 03:29:01,261 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 4.533519744873047, ACC: 0.8990763425827026
2023-07-26 03:29:11,916 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 4.748846530914307, ACC: 0.8887912034988403
2023-07-26 03:29:22,781 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 4.994340419769287, ACC: 0.8773435354232788
2023-07-26 03:29:33,348 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 5.2955193519592285, ACC: 0.8611075282096863
2023-07-26 03:29:43,243 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 5.762197971343994, ACC: 0.8371373414993286
2023-07-26 03:29:54,091 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 6.1446852684021, ACC: 0.8140577673912048
2023-07-26 03:30:05,644 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 6.3961687088012695, ACC: 0.8013070821762085
2023-07-26 03:30:17,979 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 6.569056034088135, ACC: 0.7924309372901917
2023-07-26 03:30:28,479 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 6.739593982696533, ACC: 0.7859228849411011
2023-07-26 03:30:39,818 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 6.911176681518555, ACC: 0.7762963771820068
2023-07-26 03:30:49,890 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 7.197319507598877, ACC: 0.7620285749435425
2023-07-26 03:31:00,569 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 7.530116558074951, ACC: 0.7415411472320557
2023-07-26 03:31:11,000 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 7.852527618408203, ACC: 0.7213367819786072
2023-07-26 03:31:21,545 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 7.982535362243652, ACC: 0.7135003805160522
2023-07-26 03:31:33,128 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 8.008895874023438, ACC: 0.711887538433075
2023-07-26 03:31:43,817 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 8.205350875854492, ACC: 0.6951481699943542
2023-07-26 03:31:54,968 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 8.554856300354004, ACC: 0.6643495559692383
2023-07-26 03:32:06,152 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 8.907434463500977, ACC: 0.6355056762695312
2023-07-26 03:32:06,270 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-RH500_30-timesteps_vis.h5
2023-07-26 03:32:59,544 - root - INFO - ------------------ Configuration ------------------
2023-07-26 03:32:59,544 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 03:32:59,544 - root - INFO - Configuration name: afno_backbone
2023-07-26 03:32:59,544 - root - INFO - log_to_wandb True
2023-07-26 03:32:59,544 - root - INFO - lr 0.0005
2023-07-26 03:32:59,544 - root - INFO - batch_size 64
2023-07-26 03:32:59,544 - root - INFO - max_epochs 150
2023-07-26 03:32:59,544 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 03:32:59,544 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 03:32:59,544 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 03:32:59,544 - root - INFO - orography False
2023-07-26 03:32:59,544 - root - INFO - orography_path None
2023-07-26 03:32:59,544 - root - INFO - exp_dir FourCastNet/results
2023-07-26 03:32:59,545 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 03:32:59,545 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 03:32:59,545 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 03:32:59,545 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 03:32:59,545 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 03:32:59,545 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 03:32:59,545 - root - INFO - loss l2
2023-07-26 03:32:59,545 - root - INFO - num_data_workers 4
2023-07-26 03:32:59,545 - root - INFO - dt 1
2023-07-26 03:32:59,545 - root - INFO - n_history 0
2023-07-26 03:32:59,545 - root - INFO - prediction_type iterative
2023-07-26 03:32:59,545 - root - INFO - prediction_length 30
2023-07-26 03:32:59,545 - root - INFO - n_initial_conditions 5
2023-07-26 03:32:59,545 - root - INFO - ics_type default
2023-07-26 03:32:59,545 - root - INFO - save_raw_forecasts True
2023-07-26 03:32:59,545 - root - INFO - save_channel False
2023-07-26 03:32:59,545 - root - INFO - masked_acc False
2023-07-26 03:32:59,545 - root - INFO - maskpath None
2023-07-26 03:32:59,546 - root - INFO - perturb False
2023-07-26 03:32:59,546 - root - INFO - add_grid False
2023-07-26 03:32:59,546 - root - INFO - N_grid_channels 0
2023-07-26 03:32:59,546 - root - INFO - gridtype sinusoidal
2023-07-26 03:32:59,546 - root - INFO - roll False
2023-07-26 03:32:59,546 - root - INFO - num_blocks 8
2023-07-26 03:32:59,546 - root - INFO - nettype afno
2023-07-26 03:32:59,546 - root - INFO - patch_size 8
2023-07-26 03:32:59,546 - root - INFO - width 56
2023-07-26 03:32:59,546 - root - INFO - modes 32
2023-07-26 03:32:59,546 - root - INFO - target RH850
2023-07-26 03:32:59,546 - root - INFO - normalization zscore
2023-07-26 03:32:59,546 - root - INFO - log_to_screen True
2023-07-26 03:32:59,546 - root - INFO - save_checkpoint True
2023-07-26 03:32:59,546 - root - INFO - enable_nhwc False
2023-07-26 03:32:59,546 - root - INFO - optimizer_type FusedAdam
2023-07-26 03:32:59,546 - root - INFO - crop_size_x None
2023-07-26 03:32:59,546 - root - INFO - crop_size_y None
2023-07-26 03:32:59,547 - root - INFO - two_step_training False
2023-07-26 03:32:59,547 - root - INFO - plot_animations False
2023-07-26 03:32:59,547 - root - INFO - add_noise False
2023-07-26 03:32:59,547 - root - INFO - noise_std 0
2023-07-26 03:32:59,547 - root - INFO - world_size 1
2023-07-26 03:32:59,547 - root - INFO - interp 0
2023-07-26 03:32:59,547 - root - INFO - use_daily_climatology False
2023-07-26 03:32:59,547 - root - INFO - global_batch_size 64
2023-07-26 03:32:59,547 - root - INFO - ablate Z50
2023-07-26 03:32:59,547 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 03:32:59,547 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 03:32:59,547 - root - INFO - resuming False
2023-07-26 03:32:59,547 - root - INFO - local_rank 0
2023-07-26 03:32:59,547 - root - INFO - ---------------------------------------------------
2023-07-26 03:32:59,547 - root - INFO - Inference for 1 initial conditions
2023-07-26 03:32:59,788 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 03:32:59,789 - root - INFO - Number of samples per year: 1460
2023-07-26 03:32:59,789 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 03:32:59,789 - root - INFO - Delta t: 6 hours
2023-07-26 03:32:59,789 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 03:32:59,790 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 03:34:09,310 - root - INFO - Loading inference data
2023-07-26 03:34:09,311 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 03:34:09,494 - root - INFO - Initial condition 1 of 1
2023-07-26 03:34:10,335 - root - INFO - Extracting valid data from the first year
2023-07-26 03:36:43,763 - root - INFO - Standardizing data
2023-07-26 03:36:51,811 - root - INFO - Loading time means
2023-07-26 03:37:08,002 - root - INFO - Begin autoregressive inference
2023-07-26 03:37:18,759 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 03:37:29,830 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 1.1929759979248047, ACC: 0.9929496645927429
2023-07-26 03:37:39,771 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 1.6945834159851074, ACC: 0.9857761263847351
2023-07-26 03:37:50,191 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 1.9911072254180908, ACC: 0.9801400303840637
2023-07-26 03:38:00,398 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 2.3798205852508545, ACC: 0.9713093042373657
2023-07-26 03:38:10,920 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 2.573917865753174, ACC: 0.9660659432411194
2023-07-26 03:38:21,890 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 2.8840222358703613, ACC: 0.957993745803833
2023-07-26 03:38:32,203 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 3.0942540168762207, ACC: 0.9522126913070679
2023-07-26 03:38:42,639 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 3.406506299972534, ACC: 0.943925142288208
2023-07-26 03:38:52,524 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 3.5892350673675537, ACC: 0.937965989112854
2023-07-26 03:39:02,778 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 3.809838056564331, ACC: 0.9306164979934692
2023-07-26 03:39:14,061 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 4.009891033172607, ACC: 0.921414852142334
2023-07-26 03:39:23,608 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 4.327333450317383, ACC: 0.9072652459144592
2023-07-26 03:39:34,143 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 4.484804153442383, ACC: 0.8997763991355896
2023-07-26 03:39:46,123 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 4.751674175262451, ACC: 0.8876338601112366
2023-07-26 03:39:56,255 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 5.0122785568237305, ACC: 0.8737920522689819
2023-07-26 03:40:06,934 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 5.406277656555176, ACC: 0.8543040752410889
2023-07-26 03:40:17,946 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 5.716350555419922, ACC: 0.83584064245224
2023-07-26 03:40:28,092 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 5.967954635620117, ACC: 0.8240547180175781
2023-07-26 03:40:38,092 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 6.113386631011963, ACC: 0.8171998858451843
2023-07-26 03:40:47,753 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 6.316280841827393, ACC: 0.8086957931518555
2023-07-26 03:40:58,012 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 6.532661437988281, ACC: 0.7959961891174316
2023-07-26 03:41:08,381 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 6.820642948150635, ACC: 0.7813383340835571
2023-07-26 03:41:18,623 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 7.096542835235596, ACC: 0.7640115022659302
2023-07-26 03:41:28,862 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 7.425622940063477, ACC: 0.7425433397293091
2023-07-26 03:41:38,439 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 7.636912822723389, ACC: 0.7278051376342773
2023-07-26 03:41:48,752 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 7.819852352142334, ACC: 0.7131717205047607
2023-07-26 03:41:59,272 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 7.980001449584961, ACC: 0.6956278681755066
2023-07-26 03:42:09,336 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 8.156087875366211, ACC: 0.6744047403335571
2023-07-26 03:42:19,676 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 8.438629150390625, ACC: 0.6483322381973267
2023-07-26 03:42:19,763 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-Z50_30-timesteps_vis.h5
2023-07-26 03:43:13,056 - root - INFO - ------------------ Configuration ------------------
2023-07-26 03:43:13,056 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-26 03:43:13,057 - root - INFO - Configuration name: afno_backbone
2023-07-26 03:43:13,057 - root - INFO - log_to_wandb True
2023-07-26 03:43:13,057 - root - INFO - lr 0.0005
2023-07-26 03:43:13,057 - root - INFO - batch_size 64
2023-07-26 03:43:13,057 - root - INFO - max_epochs 150
2023-07-26 03:43:13,057 - root - INFO - scheduler CosineAnnealingLR
2023-07-26 03:43:13,057 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 03:43:13,057 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-26 03:43:13,057 - root - INFO - orography False
2023-07-26 03:43:13,057 - root - INFO - orography_path None
2023-07-26 03:43:13,057 - root - INFO - exp_dir FourCastNet/results
2023-07-26 03:43:13,057 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-26 03:43:13,057 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-26 03:43:13,057 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 03:43:13,057 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-26 03:43:13,057 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-26 03:43:13,058 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-26 03:43:13,058 - root - INFO - loss l2
2023-07-26 03:43:13,058 - root - INFO - num_data_workers 4
2023-07-26 03:43:13,058 - root - INFO - dt 1
2023-07-26 03:43:13,058 - root - INFO - n_history 0
2023-07-26 03:43:13,058 - root - INFO - prediction_type iterative
2023-07-26 03:43:13,058 - root - INFO - prediction_length 30
2023-07-26 03:43:13,058 - root - INFO - n_initial_conditions 5
2023-07-26 03:43:13,058 - root - INFO - ics_type default
2023-07-26 03:43:13,058 - root - INFO - save_raw_forecasts True
2023-07-26 03:43:13,058 - root - INFO - save_channel False
2023-07-26 03:43:13,058 - root - INFO - masked_acc False
2023-07-26 03:43:13,058 - root - INFO - maskpath None
2023-07-26 03:43:13,058 - root - INFO - perturb False
2023-07-26 03:43:13,058 - root - INFO - add_grid False
2023-07-26 03:43:13,058 - root - INFO - N_grid_channels 0
2023-07-26 03:43:13,058 - root - INFO - gridtype sinusoidal
2023-07-26 03:43:13,059 - root - INFO - roll False
2023-07-26 03:43:13,059 - root - INFO - num_blocks 8
2023-07-26 03:43:13,059 - root - INFO - nettype afno
2023-07-26 03:43:13,059 - root - INFO - patch_size 8
2023-07-26 03:43:13,059 - root - INFO - width 56
2023-07-26 03:43:13,059 - root - INFO - modes 32
2023-07-26 03:43:13,059 - root - INFO - target RH850
2023-07-26 03:43:13,059 - root - INFO - normalization zscore
2023-07-26 03:43:13,059 - root - INFO - log_to_screen True
2023-07-26 03:43:13,059 - root - INFO - save_checkpoint True
2023-07-26 03:43:13,059 - root - INFO - enable_nhwc False
2023-07-26 03:43:13,059 - root - INFO - optimizer_type FusedAdam
2023-07-26 03:43:13,059 - root - INFO - crop_size_x None
2023-07-26 03:43:13,060 - root - INFO - crop_size_y None
2023-07-26 03:43:13,060 - root - INFO - two_step_training False
2023-07-26 03:43:13,060 - root - INFO - plot_animations False
2023-07-26 03:43:13,060 - root - INFO - add_noise False
2023-07-26 03:43:13,060 - root - INFO - noise_std 0
2023-07-26 03:43:13,060 - root - INFO - world_size 1
2023-07-26 03:43:13,060 - root - INFO - interp 0
2023-07-26 03:43:13,060 - root - INFO - use_daily_climatology False
2023-07-26 03:43:13,060 - root - INFO - global_batch_size 64
2023-07-26 03:43:13,060 - root - INFO - ablate TCWV
2023-07-26 03:43:13,060 - root - INFO - experiment_dir /root/FourCastNet/override_dir/experiments
2023-07-26 03:43:13,060 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 03:43:13,060 - root - INFO - resuming False
2023-07-26 03:43:13,060 - root - INFO - local_rank 0
2023-07-26 03:43:13,060 - root - INFO - ---------------------------------------------------
2023-07-26 03:43:13,060 - root - INFO - Inference for 1 initial conditions
2023-07-26 03:43:13,265 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-26 03:43:13,266 - root - INFO - Number of samples per year: 1460
2023-07-26 03:43:13,266 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-26 03:43:13,266 - root - INFO - Delta t: 6 hours
2023-07-26 03:43:13,266 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-26 03:43:13,266 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-26 03:44:21,961 - root - INFO - Loading inference data
2023-07-26 03:44:21,962 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-26 03:44:22,306 - root - INFO - Initial condition 1 of 1
2023-07-26 03:44:23,134 - root - INFO - Extracting valid data from the first year
2023-07-26 03:46:41,218 - root - INFO - Standardizing data
2023-07-26 03:46:49,802 - root - INFO - Loading time means
2023-07-26 03:47:04,540 - root - INFO - Begin autoregressive inference
2023-07-26 03:47:14,954 - root - INFO - Predicted timestep 0 of 30. RH850 RMS Error: 0.0, ACC: 1.0
2023-07-26 03:47:26,179 - root - INFO - Predicted timestep 1 of 30. RH850 RMS Error: 3.2064905166625977, ACC: 0.94795823097229
2023-07-26 03:47:38,619 - root - INFO - Predicted timestep 2 of 30. RH850 RMS Error: 4.4589385986328125, ACC: 0.8977727890014648
2023-07-26 03:47:49,370 - root - INFO - Predicted timestep 3 of 30. RH850 RMS Error: 11.92216968536377, ACC: 0.5653946995735168
2023-07-26 03:48:00,087 - root - INFO - Predicted timestep 4 of 30. RH850 RMS Error: 15.855988502502441, ACC: 0.4384104907512665
2023-07-26 03:48:10,784 - root - INFO - Predicted timestep 5 of 30. RH850 RMS Error: 16.71936798095703, ACC: 0.39973604679107666
2023-07-26 03:48:21,852 - root - INFO - Predicted timestep 6 of 30. RH850 RMS Error: 17.545583724975586, ACC: 0.3671891987323761
2023-07-26 03:48:31,384 - root - INFO - Predicted timestep 7 of 30. RH850 RMS Error: 19.054903030395508, ACC: 0.3344739079475403
2023-07-26 03:48:42,610 - root - INFO - Predicted timestep 8 of 30. RH850 RMS Error: 20.952083587646484, ACC: 0.2948300242424011
2023-07-26 03:48:53,509 - root - INFO - Predicted timestep 9 of 30. RH850 RMS Error: 23.357685089111328, ACC: 0.25093427300453186
2023-07-26 03:49:04,106 - root - INFO - Predicted timestep 10 of 30. RH850 RMS Error: 25.581146240234375, ACC: 0.21638204157352448
2023-07-26 03:49:14,428 - root - INFO - Predicted timestep 11 of 30. RH850 RMS Error: 27.370744705200195, ACC: 0.18802578747272491
2023-07-26 03:49:24,775 - root - INFO - Predicted timestep 12 of 30. RH850 RMS Error: 28.83906364440918, ACC: 0.1606888622045517
2023-07-26 03:49:35,015 - root - INFO - Predicted timestep 13 of 30. RH850 RMS Error: 30.519853591918945, ACC: 0.1344698965549469
2023-07-26 03:49:45,779 - root - INFO - Predicted timestep 14 of 30. RH850 RMS Error: 32.57912063598633, ACC: 0.10727204382419586
2023-07-26 03:49:55,750 - root - INFO - Predicted timestep 15 of 30. RH850 RMS Error: 34.537254333496094, ACC: 0.09305348247289658
2023-07-26 03:50:07,143 - root - INFO - Predicted timestep 16 of 30. RH850 RMS Error: 36.841590881347656, ACC: 0.07612648606300354
2023-07-26 03:50:18,087 - root - INFO - Predicted timestep 17 of 30. RH850 RMS Error: 39.29649353027344, ACC: 0.060082387179136276
2023-07-26 03:50:28,939 - root - INFO - Predicted timestep 18 of 30. RH850 RMS Error: 41.77219009399414, ACC: 0.0474085696041584
2023-07-26 03:50:39,082 - root - INFO - Predicted timestep 19 of 30. RH850 RMS Error: 44.577152252197266, ACC: 0.03321558237075806
2023-07-26 03:50:49,423 - root - INFO - Predicted timestep 20 of 30. RH850 RMS Error: 48.24775695800781, ACC: 0.024296898394823074
2023-07-26 03:51:00,087 - root - INFO - Predicted timestep 21 of 30. RH850 RMS Error: 53.7880973815918, ACC: 0.020172327756881714
2023-07-26 03:51:10,458 - root - INFO - Predicted timestep 22 of 30. RH850 RMS Error: 65.91616821289062, ACC: 0.0056608994491398335
2023-07-26 03:51:20,699 - root - INFO - Predicted timestep 23 of 30. RH850 RMS Error: 95.82146453857422, ACC: -0.01847287453711033
2023-07-26 03:51:30,554 - root - INFO - Predicted timestep 24 of 30. RH850 RMS Error: 147.0592803955078, ACC: -0.02270897477865219
2023-07-26 03:51:40,324 - root - INFO - Predicted timestep 25 of 30. RH850 RMS Error: 196.6881866455078, ACC: -0.014974795281887054
2023-07-26 03:51:50,683 - root - INFO - Predicted timestep 26 of 30. RH850 RMS Error: 224.9743194580078, ACC: 3.411314173717983e-05
2023-07-26 03:52:02,273 - root - INFO - Predicted timestep 27 of 30. RH850 RMS Error: 229.6526641845703, ACC: 0.001661023823544383
2023-07-26 03:52:13,112 - root - INFO - Predicted timestep 28 of 30. RH850 RMS Error: 221.32415771484375, ACC: -0.0017040359089151025
2023-07-26 03:52:23,177 - root - INFO - Predicted timestep 29 of 30. RH850 RMS Error: 210.97885131835938, ACC: -0.0024012529756873846
2023-07-26 03:52:23,270 - root - INFO - Saving files at /root/FourCastNet/override_dir/experiments/predict-RH850_ablate-TCWV_30-timesteps_vis.h5
