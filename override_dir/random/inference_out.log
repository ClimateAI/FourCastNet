2023-07-14 20:24:18,789 - root - INFO - ------------------ Configuration ------------------
2023-07-14 20:24:18,789 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 20:24:18,789 - root - INFO - Configuration name: afno_backbone
2023-07-14 20:24:18,789 - root - INFO - log_to_wandb True
2023-07-14 20:24:18,789 - root - INFO - lr 0.0005
2023-07-14 20:24:18,789 - root - INFO - batch_size 64
2023-07-14 20:24:18,789 - root - INFO - max_epochs 150
2023-07-14 20:24:18,789 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 20:24:18,789 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 20:24:18,789 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 20:24:18,790 - root - INFO - orography False
2023-07-14 20:24:18,790 - root - INFO - orography_path None
2023-07-14 20:24:18,790 - root - INFO - exp_dir FourCastNet/results
2023-07-14 20:24:18,790 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 20:24:18,790 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 20:24:18,790 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 20:24:18,790 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 20:24:18,790 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 20:24:18,790 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 20:24:18,790 - root - INFO - loss l2
2023-07-14 20:24:18,790 - root - INFO - num_data_workers 4
2023-07-14 20:24:18,790 - root - INFO - dt 1
2023-07-14 20:24:18,790 - root - INFO - n_history 0
2023-07-14 20:24:18,790 - root - INFO - prediction_type iterative
2023-07-14 20:24:18,790 - root - INFO - prediction_length 41
2023-07-14 20:24:18,791 - root - INFO - n_initial_conditions 5
2023-07-14 20:24:18,791 - root - INFO - ics_type default
2023-07-14 20:24:18,791 - root - INFO - save_raw_forecasts True
2023-07-14 20:24:18,791 - root - INFO - save_channel False
2023-07-14 20:24:18,791 - root - INFO - masked_acc False
2023-07-14 20:24:18,791 - root - INFO - maskpath None
2023-07-14 20:24:18,791 - root - INFO - perturb False
2023-07-14 20:24:18,791 - root - INFO - add_grid False
2023-07-14 20:24:18,791 - root - INFO - N_grid_channels 0
2023-07-14 20:24:18,791 - root - INFO - gridtype sinusoidal
2023-07-14 20:24:18,791 - root - INFO - roll False
2023-07-14 20:24:18,791 - root - INFO - num_blocks 8
2023-07-14 20:24:18,792 - root - INFO - nettype afno
2023-07-14 20:24:18,792 - root - INFO - patch_size 8
2023-07-14 20:24:18,792 - root - INFO - width 56
2023-07-14 20:24:18,792 - root - INFO - modes 32
2023-07-14 20:24:18,792 - root - INFO - target default
2023-07-14 20:24:18,792 - root - INFO - normalization zscore
2023-07-14 20:24:18,792 - root - INFO - log_to_screen True
2023-07-14 20:24:18,792 - root - INFO - save_checkpoint True
2023-07-14 20:24:18,792 - root - INFO - enable_nhwc False
2023-07-14 20:24:18,792 - root - INFO - optimizer_type FusedAdam
2023-07-14 20:24:18,792 - root - INFO - crop_size_x None
2023-07-14 20:24:18,793 - root - INFO - crop_size_y None
2023-07-14 20:24:18,793 - root - INFO - two_step_training False
2023-07-14 20:24:18,793 - root - INFO - plot_animations False
2023-07-14 20:24:18,793 - root - INFO - add_noise False
2023-07-14 20:24:18,793 - root - INFO - noise_std 0
2023-07-14 20:24:18,793 - root - INFO - world_size 1
2023-07-14 20:24:18,793 - root - INFO - interp 0
2023-07-14 20:24:18,793 - root - INFO - use_daily_climatology False
2023-07-14 20:24:18,793 - root - INFO - global_batch_size 64
2023-07-14 20:24:18,793 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 20:24:18,793 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 20:24:18,793 - root - INFO - resuming False
2023-07-14 20:24:18,794 - root - INFO - local_rank 0
2023-07-14 20:24:18,794 - root - INFO - ---------------------------------------------------
2023-07-14 20:24:18,794 - root - INFO - Inference for 1 initial conditions
2023-07-14 20:24:19,108 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 20:24:19,117 - root - INFO - Number of samples per year: 1460
2023-07-14 20:24:19,117 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 20:24:19,117 - root - INFO - Delta t: 6 hours
2023-07-14 20:24:19,118 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 20:24:19,132 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 20:26:07,068 - root - INFO - ------------------ Configuration ------------------
2023-07-14 20:26:07,068 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 20:26:07,068 - root - INFO - Configuration name: afno_backbone
2023-07-14 20:26:07,068 - root - INFO - log_to_wandb True
2023-07-14 20:26:07,068 - root - INFO - lr 0.0005
2023-07-14 20:26:07,068 - root - INFO - batch_size 64
2023-07-14 20:26:07,068 - root - INFO - max_epochs 150
2023-07-14 20:26:07,068 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 20:26:07,068 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 20:26:07,069 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 20:26:07,069 - root - INFO - orography False
2023-07-14 20:26:07,069 - root - INFO - orography_path None
2023-07-14 20:26:07,069 - root - INFO - exp_dir FourCastNet/results
2023-07-14 20:26:07,069 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 20:26:07,069 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 20:26:07,069 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 20:26:07,069 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 20:26:07,069 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 20:26:07,069 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 20:26:07,069 - root - INFO - loss l2
2023-07-14 20:26:07,069 - root - INFO - num_data_workers 4
2023-07-14 20:26:07,069 - root - INFO - dt 1
2023-07-14 20:26:07,069 - root - INFO - n_history 0
2023-07-14 20:26:07,069 - root - INFO - prediction_type iterative
2023-07-14 20:26:07,070 - root - INFO - prediction_length 41
2023-07-14 20:26:07,070 - root - INFO - n_initial_conditions 5
2023-07-14 20:26:07,070 - root - INFO - ics_type default
2023-07-14 20:26:07,070 - root - INFO - save_raw_forecasts True
2023-07-14 20:26:07,070 - root - INFO - save_channel False
2023-07-14 20:26:07,070 - root - INFO - masked_acc False
2023-07-14 20:26:07,070 - root - INFO - maskpath None
2023-07-14 20:26:07,070 - root - INFO - perturb False
2023-07-14 20:26:07,070 - root - INFO - add_grid False
2023-07-14 20:26:07,070 - root - INFO - N_grid_channels 0
2023-07-14 20:26:07,070 - root - INFO - gridtype sinusoidal
2023-07-14 20:26:07,070 - root - INFO - roll False
2023-07-14 20:26:07,070 - root - INFO - num_blocks 8
2023-07-14 20:26:07,070 - root - INFO - nettype afno
2023-07-14 20:26:07,070 - root - INFO - patch_size 8
2023-07-14 20:26:07,070 - root - INFO - width 56
2023-07-14 20:26:07,070 - root - INFO - modes 32
2023-07-14 20:26:07,070 - root - INFO - target default
2023-07-14 20:26:07,070 - root - INFO - normalization zscore
2023-07-14 20:26:07,071 - root - INFO - log_to_screen True
2023-07-14 20:26:07,071 - root - INFO - save_checkpoint True
2023-07-14 20:26:07,071 - root - INFO - enable_nhwc False
2023-07-14 20:26:07,071 - root - INFO - optimizer_type FusedAdam
2023-07-14 20:26:07,071 - root - INFO - crop_size_x None
2023-07-14 20:26:07,071 - root - INFO - crop_size_y None
2023-07-14 20:26:07,071 - root - INFO - two_step_training False
2023-07-14 20:26:07,071 - root - INFO - plot_animations False
2023-07-14 20:26:07,071 - root - INFO - add_noise False
2023-07-14 20:26:07,071 - root - INFO - noise_std 0
2023-07-14 20:26:07,071 - root - INFO - world_size 1
2023-07-14 20:26:07,071 - root - INFO - interp 0
2023-07-14 20:26:07,071 - root - INFO - use_daily_climatology False
2023-07-14 20:26:07,071 - root - INFO - global_batch_size 64
2023-07-14 20:26:07,072 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 20:26:07,072 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 20:26:07,072 - root - INFO - resuming False
2023-07-14 20:26:07,072 - root - INFO - local_rank 0
2023-07-14 20:26:07,072 - root - INFO - ---------------------------------------------------
2023-07-14 20:26:07,072 - root - INFO - Inference for 1 initial conditions
2023-07-14 20:26:07,205 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 20:26:07,206 - root - INFO - Number of samples per year: 1460
2023-07-14 20:26:07,206 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 20:26:07,206 - root - INFO - Delta t: 6 hours
2023-07-14 20:26:07,206 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 20:26:07,207 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 20:27:25,427 - root - INFO - Loading inference data
2023-07-14 20:29:49,443 - root - INFO - ------------------ Configuration ------------------
2023-07-14 20:29:49,443 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 20:29:49,443 - root - INFO - Configuration name: afno_backbone
2023-07-14 20:29:49,443 - root - INFO - log_to_wandb True
2023-07-14 20:29:49,443 - root - INFO - lr 0.0005
2023-07-14 20:29:49,444 - root - INFO - batch_size 64
2023-07-14 20:29:49,444 - root - INFO - max_epochs 150
2023-07-14 20:29:49,444 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 20:29:49,444 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 20:29:49,444 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 20:29:49,444 - root - INFO - orography False
2023-07-14 20:29:49,444 - root - INFO - orography_path None
2023-07-14 20:29:49,444 - root - INFO - exp_dir FourCastNet/results
2023-07-14 20:29:49,444 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 20:29:49,444 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 20:29:49,444 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 20:29:49,444 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 20:29:49,444 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 20:29:49,444 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 20:29:49,444 - root - INFO - loss l2
2023-07-14 20:29:49,444 - root - INFO - num_data_workers 4
2023-07-14 20:29:49,445 - root - INFO - dt 1
2023-07-14 20:29:49,445 - root - INFO - n_history 0
2023-07-14 20:29:49,445 - root - INFO - prediction_type iterative
2023-07-14 20:29:49,445 - root - INFO - prediction_length 41
2023-07-14 20:29:49,445 - root - INFO - n_initial_conditions 5
2023-07-14 20:29:49,445 - root - INFO - ics_type default
2023-07-14 20:29:49,445 - root - INFO - save_raw_forecasts True
2023-07-14 20:29:49,445 - root - INFO - save_channel False
2023-07-14 20:29:49,445 - root - INFO - masked_acc False
2023-07-14 20:29:49,445 - root - INFO - maskpath None
2023-07-14 20:29:49,446 - root - INFO - perturb False
2023-07-14 20:29:49,446 - root - INFO - add_grid False
2023-07-14 20:29:49,446 - root - INFO - N_grid_channels 0
2023-07-14 20:29:49,446 - root - INFO - gridtype sinusoidal
2023-07-14 20:29:49,446 - root - INFO - roll False
2023-07-14 20:29:49,446 - root - INFO - num_blocks 8
2023-07-14 20:29:49,446 - root - INFO - nettype afno
2023-07-14 20:29:49,446 - root - INFO - patch_size 8
2023-07-14 20:29:49,446 - root - INFO - width 56
2023-07-14 20:29:49,446 - root - INFO - modes 32
2023-07-14 20:29:49,446 - root - INFO - target default
2023-07-14 20:29:49,446 - root - INFO - normalization zscore
2023-07-14 20:29:49,446 - root - INFO - log_to_screen True
2023-07-14 20:29:49,447 - root - INFO - save_checkpoint True
2023-07-14 20:29:49,447 - root - INFO - enable_nhwc False
2023-07-14 20:29:49,447 - root - INFO - optimizer_type FusedAdam
2023-07-14 20:29:49,447 - root - INFO - crop_size_x None
2023-07-14 20:29:49,447 - root - INFO - crop_size_y None
2023-07-14 20:29:49,447 - root - INFO - two_step_training False
2023-07-14 20:29:49,448 - root - INFO - plot_animations False
2023-07-14 20:29:49,448 - root - INFO - add_noise False
2023-07-14 20:29:49,448 - root - INFO - noise_std 0
2023-07-14 20:29:49,448 - root - INFO - world_size 1
2023-07-14 20:29:49,448 - root - INFO - interp 0
2023-07-14 20:29:49,448 - root - INFO - use_daily_climatology False
2023-07-14 20:29:49,448 - root - INFO - global_batch_size 64
2023-07-14 20:29:49,448 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 20:29:49,448 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 20:29:49,448 - root - INFO - resuming False
2023-07-14 20:29:49,448 - root - INFO - local_rank 0
2023-07-14 20:29:49,448 - root - INFO - ---------------------------------------------------
2023-07-14 20:29:49,448 - root - INFO - Inference for 1 initial conditions
2023-07-14 20:29:49,688 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 20:29:49,689 - root - INFO - Number of samples per year: 1460
2023-07-14 20:29:49,689 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 20:29:49,690 - root - INFO - Delta t: 6 hours
2023-07-14 20:29:49,690 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 20:29:49,690 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 20:31:02,037 - root - INFO - Loading inference data
2023-07-14 21:08:15,776 - root - INFO - ------------------ Configuration ------------------
2023-07-14 21:08:15,776 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 21:08:15,776 - root - INFO - Configuration name: afno_backbone
2023-07-14 21:08:15,776 - root - INFO - log_to_wandb True
2023-07-14 21:08:15,776 - root - INFO - lr 0.0005
2023-07-14 21:08:15,776 - root - INFO - batch_size 64
2023-07-14 21:08:15,776 - root - INFO - max_epochs 150
2023-07-14 21:08:15,776 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 21:08:15,776 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 21:08:15,777 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 21:08:15,777 - root - INFO - orography False
2023-07-14 21:08:15,777 - root - INFO - orography_path None
2023-07-14 21:08:15,777 - root - INFO - exp_dir FourCastNet/results
2023-07-14 21:08:15,777 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 21:08:15,777 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 21:08:15,777 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 21:08:15,777 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 21:08:15,777 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 21:08:15,777 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 21:08:15,777 - root - INFO - loss l2
2023-07-14 21:08:15,777 - root - INFO - num_data_workers 4
2023-07-14 21:08:15,777 - root - INFO - dt 1
2023-07-14 21:08:15,777 - root - INFO - n_history 0
2023-07-14 21:08:15,777 - root - INFO - prediction_type iterative
2023-07-14 21:08:15,777 - root - INFO - prediction_length 41
2023-07-14 21:08:15,777 - root - INFO - n_initial_conditions 5
2023-07-14 21:08:15,777 - root - INFO - ics_type default
2023-07-14 21:08:15,778 - root - INFO - save_raw_forecasts True
2023-07-14 21:08:15,778 - root - INFO - save_channel False
2023-07-14 21:08:15,778 - root - INFO - masked_acc False
2023-07-14 21:08:15,778 - root - INFO - maskpath None
2023-07-14 21:08:15,778 - root - INFO - perturb False
2023-07-14 21:08:15,778 - root - INFO - add_grid False
2023-07-14 21:08:15,778 - root - INFO - N_grid_channels 0
2023-07-14 21:08:15,778 - root - INFO - gridtype sinusoidal
2023-07-14 21:08:15,778 - root - INFO - roll False
2023-07-14 21:08:15,778 - root - INFO - num_blocks 8
2023-07-14 21:08:15,778 - root - INFO - nettype afno
2023-07-14 21:08:15,778 - root - INFO - patch_size 8
2023-07-14 21:08:15,778 - root - INFO - width 56
2023-07-14 21:08:15,778 - root - INFO - modes 32
2023-07-14 21:08:15,778 - root - INFO - target default
2023-07-14 21:08:15,778 - root - INFO - normalization zscore
2023-07-14 21:08:15,778 - root - INFO - log_to_screen True
2023-07-14 21:08:15,779 - root - INFO - save_checkpoint True
2023-07-14 21:08:15,779 - root - INFO - enable_nhwc False
2023-07-14 21:08:15,779 - root - INFO - optimizer_type FusedAdam
2023-07-14 21:08:15,779 - root - INFO - crop_size_x None
2023-07-14 21:08:15,779 - root - INFO - crop_size_y None
2023-07-14 21:08:15,779 - root - INFO - two_step_training False
2023-07-14 21:08:15,779 - root - INFO - plot_animations False
2023-07-14 21:08:15,779 - root - INFO - add_noise False
2023-07-14 21:08:15,779 - root - INFO - noise_std 0
2023-07-14 21:08:15,779 - root - INFO - world_size 1
2023-07-14 21:08:15,779 - root - INFO - interp 0
2023-07-14 21:08:15,779 - root - INFO - use_daily_climatology False
2023-07-14 21:08:15,779 - root - INFO - global_batch_size 64
2023-07-14 21:08:15,779 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 21:08:15,779 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 21:08:15,779 - root - INFO - resuming False
2023-07-14 21:08:15,779 - root - INFO - local_rank 0
2023-07-14 21:08:15,780 - root - INFO - ---------------------------------------------------
2023-07-14 21:08:15,780 - root - INFO - Inference for 1 initial conditions
2023-07-14 21:08:16,164 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 21:08:16,166 - root - INFO - Number of samples per year: 1460
2023-07-14 21:08:16,166 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 21:08:16,166 - root - INFO - Delta t: 6 hours
2023-07-14 21:08:16,166 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 21:08:16,167 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 21:09:25,779 - root - INFO - Loading inference data
2023-07-14 21:33:27,596 - root - INFO - ------------------ Configuration ------------------
2023-07-14 21:33:27,596 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 21:33:27,596 - root - INFO - Configuration name: afno_backbone
2023-07-14 21:33:27,596 - root - INFO - log_to_wandb True
2023-07-14 21:33:27,596 - root - INFO - lr 0.0005
2023-07-14 21:33:27,596 - root - INFO - batch_size 64
2023-07-14 21:33:27,596 - root - INFO - max_epochs 150
2023-07-14 21:33:27,596 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 21:33:27,597 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 21:33:27,597 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 21:33:27,597 - root - INFO - orography False
2023-07-14 21:33:27,597 - root - INFO - orography_path None
2023-07-14 21:33:27,597 - root - INFO - exp_dir FourCastNet/results
2023-07-14 21:33:27,597 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 21:33:27,597 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 21:33:27,597 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 21:33:27,597 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 21:33:27,597 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 21:33:27,597 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 21:33:27,597 - root - INFO - loss l2
2023-07-14 21:33:27,597 - root - INFO - num_data_workers 4
2023-07-14 21:33:27,597 - root - INFO - dt 1
2023-07-14 21:33:27,597 - root - INFO - n_history 0
2023-07-14 21:33:27,598 - root - INFO - prediction_type iterative
2023-07-14 21:33:27,598 - root - INFO - prediction_length 41
2023-07-14 21:33:27,598 - root - INFO - n_initial_conditions 5
2023-07-14 21:33:27,598 - root - INFO - ics_type default
2023-07-14 21:33:27,598 - root - INFO - save_raw_forecasts True
2023-07-14 21:33:27,598 - root - INFO - save_channel False
2023-07-14 21:33:27,598 - root - INFO - masked_acc False
2023-07-14 21:33:27,598 - root - INFO - maskpath None
2023-07-14 21:33:27,598 - root - INFO - perturb False
2023-07-14 21:33:27,598 - root - INFO - add_grid False
2023-07-14 21:33:27,598 - root - INFO - N_grid_channels 0
2023-07-14 21:33:27,598 - root - INFO - gridtype sinusoidal
2023-07-14 21:33:27,599 - root - INFO - roll False
2023-07-14 21:33:27,599 - root - INFO - num_blocks 8
2023-07-14 21:33:27,599 - root - INFO - nettype afno
2023-07-14 21:33:27,599 - root - INFO - patch_size 8
2023-07-14 21:33:27,599 - root - INFO - width 56
2023-07-14 21:33:27,599 - root - INFO - modes 32
2023-07-14 21:33:27,599 - root - INFO - target default
2023-07-14 21:33:27,599 - root - INFO - normalization zscore
2023-07-14 21:33:27,599 - root - INFO - log_to_screen True
2023-07-14 21:33:27,599 - root - INFO - save_checkpoint True
2023-07-14 21:33:27,599 - root - INFO - enable_nhwc False
2023-07-14 21:33:27,600 - root - INFO - optimizer_type FusedAdam
2023-07-14 21:33:27,600 - root - INFO - crop_size_x None
2023-07-14 21:33:27,600 - root - INFO - crop_size_y None
2023-07-14 21:33:27,600 - root - INFO - two_step_training False
2023-07-14 21:33:27,600 - root - INFO - plot_animations False
2023-07-14 21:33:27,600 - root - INFO - add_noise False
2023-07-14 21:33:27,600 - root - INFO - noise_std 0
2023-07-14 21:33:27,600 - root - INFO - world_size 1
2023-07-14 21:33:27,600 - root - INFO - interp 0
2023-07-14 21:33:27,600 - root - INFO - use_daily_climatology False
2023-07-14 21:33:27,600 - root - INFO - global_batch_size 64
2023-07-14 21:33:27,601 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 21:33:27,601 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 21:33:27,601 - root - INFO - resuming False
2023-07-14 21:33:27,601 - root - INFO - local_rank 0
2023-07-14 21:33:27,601 - root - INFO - ---------------------------------------------------
2023-07-14 21:33:27,601 - root - INFO - Inference for 1 initial conditions
2023-07-14 21:33:27,983 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 21:33:27,984 - root - INFO - Number of samples per year: 1460
2023-07-14 21:33:27,984 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 21:33:27,984 - root - INFO - Delta t: 6 hours
2023-07-14 21:33:27,984 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 21:33:27,985 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 21:34:37,698 - root - INFO - Loading inference data
2023-07-14 21:34:37,899 - root - INFO - Initial condition 1 of 1
2023-07-14 21:46:55,614 - root - INFO - ------------------ Configuration ------------------
2023-07-14 21:46:55,614 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 21:46:55,614 - root - INFO - Configuration name: afno_backbone
2023-07-14 21:46:55,614 - root - INFO - log_to_wandb True
2023-07-14 21:46:55,614 - root - INFO - lr 0.0005
2023-07-14 21:46:55,614 - root - INFO - batch_size 64
2023-07-14 21:46:55,614 - root - INFO - max_epochs 150
2023-07-14 21:46:55,614 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 21:46:55,615 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 21:46:55,615 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 21:46:55,615 - root - INFO - orography False
2023-07-14 21:46:55,615 - root - INFO - orography_path None
2023-07-14 21:46:55,615 - root - INFO - exp_dir FourCastNet/results
2023-07-14 21:46:55,615 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 21:46:55,615 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 21:46:55,615 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 21:46:55,615 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 21:46:55,615 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 21:46:55,615 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 21:46:55,615 - root - INFO - loss l2
2023-07-14 21:46:55,615 - root - INFO - num_data_workers 4
2023-07-14 21:46:55,615 - root - INFO - dt 1
2023-07-14 21:46:55,615 - root - INFO - n_history 0
2023-07-14 21:46:55,615 - root - INFO - prediction_type iterative
2023-07-14 21:46:55,615 - root - INFO - prediction_length 41
2023-07-14 21:46:55,616 - root - INFO - n_initial_conditions 5
2023-07-14 21:46:55,616 - root - INFO - ics_type default
2023-07-14 21:46:55,616 - root - INFO - save_raw_forecasts True
2023-07-14 21:46:55,616 - root - INFO - save_channel False
2023-07-14 21:46:55,616 - root - INFO - masked_acc False
2023-07-14 21:46:55,616 - root - INFO - maskpath None
2023-07-14 21:46:55,616 - root - INFO - perturb False
2023-07-14 21:46:55,616 - root - INFO - add_grid False
2023-07-14 21:46:55,616 - root - INFO - N_grid_channels 0
2023-07-14 21:46:55,616 - root - INFO - gridtype sinusoidal
2023-07-14 21:46:55,616 - root - INFO - roll False
2023-07-14 21:46:55,616 - root - INFO - num_blocks 8
2023-07-14 21:46:55,616 - root - INFO - nettype afno
2023-07-14 21:46:55,616 - root - INFO - patch_size 8
2023-07-14 21:46:55,616 - root - INFO - width 56
2023-07-14 21:46:55,616 - root - INFO - modes 32
2023-07-14 21:46:55,616 - root - INFO - target default
2023-07-14 21:46:55,616 - root - INFO - normalization zscore
2023-07-14 21:46:55,616 - root - INFO - log_to_screen True
2023-07-14 21:46:55,617 - root - INFO - save_checkpoint True
2023-07-14 21:46:55,617 - root - INFO - enable_nhwc False
2023-07-14 21:46:55,617 - root - INFO - optimizer_type FusedAdam
2023-07-14 21:46:55,617 - root - INFO - crop_size_x None
2023-07-14 21:46:55,617 - root - INFO - crop_size_y None
2023-07-14 21:46:55,617 - root - INFO - two_step_training False
2023-07-14 21:46:55,617 - root - INFO - plot_animations False
2023-07-14 21:46:55,617 - root - INFO - add_noise False
2023-07-14 21:46:55,617 - root - INFO - noise_std 0
2023-07-14 21:46:55,617 - root - INFO - world_size 1
2023-07-14 21:46:55,617 - root - INFO - interp 0
2023-07-14 21:46:55,617 - root - INFO - use_daily_climatology False
2023-07-14 21:46:55,617 - root - INFO - global_batch_size 64
2023-07-14 21:46:55,617 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 21:46:55,617 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 21:46:55,617 - root - INFO - resuming False
2023-07-14 21:46:55,617 - root - INFO - local_rank 0
2023-07-14 21:46:55,617 - root - INFO - ---------------------------------------------------
2023-07-14 21:46:55,617 - root - INFO - Inference for 1 initial conditions
2023-07-14 21:46:55,962 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 21:46:55,963 - root - INFO - Number of samples per year: 1460
2023-07-14 21:46:55,963 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 21:46:55,963 - root - INFO - Delta t: 6 hours
2023-07-14 21:46:55,963 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 21:46:55,965 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 21:48:08,355 - root - INFO - Loading inference data
2023-07-14 21:48:08,598 - root - INFO - Initial condition 1 of 1
2023-07-14 21:51:07,299 - root - INFO - ------------------ Configuration ------------------
2023-07-14 21:51:07,299 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 21:51:07,299 - root - INFO - Configuration name: afno_backbone
2023-07-14 21:51:07,299 - root - INFO - log_to_wandb True
2023-07-14 21:51:07,299 - root - INFO - lr 0.0005
2023-07-14 21:51:07,299 - root - INFO - batch_size 64
2023-07-14 21:51:07,299 - root - INFO - max_epochs 150
2023-07-14 21:51:07,299 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 21:51:07,300 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 21:51:07,300 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 21:51:07,300 - root - INFO - orography False
2023-07-14 21:51:07,300 - root - INFO - orography_path None
2023-07-14 21:51:07,300 - root - INFO - exp_dir FourCastNet/results
2023-07-14 21:51:07,300 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 21:51:07,300 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 21:51:07,300 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 21:51:07,300 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 21:51:07,300 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 21:51:07,300 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 21:51:07,300 - root - INFO - loss l2
2023-07-14 21:51:07,300 - root - INFO - num_data_workers 4
2023-07-14 21:51:07,300 - root - INFO - dt 1
2023-07-14 21:51:07,300 - root - INFO - n_history 0
2023-07-14 21:51:07,300 - root - INFO - prediction_type iterative
2023-07-14 21:51:07,300 - root - INFO - prediction_length 41
2023-07-14 21:51:07,301 - root - INFO - n_initial_conditions 5
2023-07-14 21:51:07,301 - root - INFO - ics_type default
2023-07-14 21:51:07,301 - root - INFO - save_raw_forecasts True
2023-07-14 21:51:07,301 - root - INFO - save_channel False
2023-07-14 21:51:07,301 - root - INFO - masked_acc False
2023-07-14 21:51:07,301 - root - INFO - maskpath None
2023-07-14 21:51:07,301 - root - INFO - perturb False
2023-07-14 21:51:07,301 - root - INFO - add_grid False
2023-07-14 21:51:07,301 - root - INFO - N_grid_channels 0
2023-07-14 21:51:07,301 - root - INFO - gridtype sinusoidal
2023-07-14 21:51:07,301 - root - INFO - roll False
2023-07-14 21:51:07,301 - root - INFO - num_blocks 8
2023-07-14 21:51:07,301 - root - INFO - nettype afno
2023-07-14 21:51:07,301 - root - INFO - patch_size 8
2023-07-14 21:51:07,301 - root - INFO - width 56
2023-07-14 21:51:07,301 - root - INFO - modes 32
2023-07-14 21:51:07,301 - root - INFO - target default
2023-07-14 21:51:07,301 - root - INFO - normalization zscore
2023-07-14 21:51:07,302 - root - INFO - log_to_screen True
2023-07-14 21:51:07,302 - root - INFO - save_checkpoint True
2023-07-14 21:51:07,302 - root - INFO - enable_nhwc False
2023-07-14 21:51:07,302 - root - INFO - optimizer_type FusedAdam
2023-07-14 21:51:07,302 - root - INFO - crop_size_x None
2023-07-14 21:51:07,302 - root - INFO - crop_size_y None
2023-07-14 21:51:07,302 - root - INFO - two_step_training False
2023-07-14 21:51:07,302 - root - INFO - plot_animations False
2023-07-14 21:51:07,302 - root - INFO - add_noise False
2023-07-14 21:51:07,302 - root - INFO - noise_std 0
2023-07-14 21:51:07,302 - root - INFO - world_size 1
2023-07-14 21:51:07,302 - root - INFO - interp 0
2023-07-14 21:51:07,302 - root - INFO - use_daily_climatology False
2023-07-14 21:51:07,302 - root - INFO - global_batch_size 64
2023-07-14 21:51:07,302 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 21:51:07,302 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 21:51:07,302 - root - INFO - resuming False
2023-07-14 21:51:07,303 - root - INFO - local_rank 0
2023-07-14 21:51:07,303 - root - INFO - ---------------------------------------------------
2023-07-14 21:51:07,303 - root - INFO - Inference for 1 initial conditions
2023-07-14 21:51:07,677 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 21:51:07,678 - root - INFO - Number of samples per year: 1460
2023-07-14 21:51:07,678 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 21:51:07,678 - root - INFO - Delta t: 6 hours
2023-07-14 21:51:07,678 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 21:51:07,680 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 21:52:06,106 - root - INFO - Loading inference data
2023-07-14 21:52:06,308 - root - INFO - Initial condition 1 of 1
2023-07-14 21:53:12,413 - root - INFO - ------------------ Configuration ------------------
2023-07-14 21:53:12,414 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 21:53:12,414 - root - INFO - Configuration name: afno_backbone
2023-07-14 21:53:12,414 - root - INFO - log_to_wandb True
2023-07-14 21:53:12,414 - root - INFO - lr 0.0005
2023-07-14 21:53:12,414 - root - INFO - batch_size 64
2023-07-14 21:53:12,414 - root - INFO - max_epochs 150
2023-07-14 21:53:12,414 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 21:53:12,414 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 21:53:12,414 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 21:53:12,414 - root - INFO - orography False
2023-07-14 21:53:12,414 - root - INFO - orography_path None
2023-07-14 21:53:12,414 - root - INFO - exp_dir FourCastNet/results
2023-07-14 21:53:12,414 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 21:53:12,414 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 21:53:12,415 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 21:53:12,415 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 21:53:12,415 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 21:53:12,415 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 21:53:12,415 - root - INFO - loss l2
2023-07-14 21:53:12,415 - root - INFO - num_data_workers 4
2023-07-14 21:53:12,415 - root - INFO - dt 1
2023-07-14 21:53:12,415 - root - INFO - n_history 0
2023-07-14 21:53:12,415 - root - INFO - prediction_type iterative
2023-07-14 21:53:12,415 - root - INFO - prediction_length 41
2023-07-14 21:53:12,415 - root - INFO - n_initial_conditions 5
2023-07-14 21:53:12,415 - root - INFO - ics_type default
2023-07-14 21:53:12,415 - root - INFO - save_raw_forecasts True
2023-07-14 21:53:12,415 - root - INFO - save_channel False
2023-07-14 21:53:12,415 - root - INFO - masked_acc False
2023-07-14 21:53:12,415 - root - INFO - maskpath None
2023-07-14 21:53:12,416 - root - INFO - perturb False
2023-07-14 21:53:12,416 - root - INFO - add_grid False
2023-07-14 21:53:12,416 - root - INFO - N_grid_channels 0
2023-07-14 21:53:12,416 - root - INFO - gridtype sinusoidal
2023-07-14 21:53:12,416 - root - INFO - roll False
2023-07-14 21:53:12,416 - root - INFO - num_blocks 8
2023-07-14 21:53:12,416 - root - INFO - nettype afno
2023-07-14 21:53:12,416 - root - INFO - patch_size 8
2023-07-14 21:53:12,416 - root - INFO - width 56
2023-07-14 21:53:12,416 - root - INFO - modes 32
2023-07-14 21:53:12,416 - root - INFO - target default
2023-07-14 21:53:12,416 - root - INFO - normalization zscore
2023-07-14 21:53:12,416 - root - INFO - log_to_screen True
2023-07-14 21:53:12,416 - root - INFO - save_checkpoint True
2023-07-14 21:53:12,416 - root - INFO - enable_nhwc False
2023-07-14 21:53:12,416 - root - INFO - optimizer_type FusedAdam
2023-07-14 21:53:12,416 - root - INFO - crop_size_x None
2023-07-14 21:53:12,416 - root - INFO - crop_size_y None
2023-07-14 21:53:12,416 - root - INFO - two_step_training False
2023-07-14 21:53:12,417 - root - INFO - plot_animations False
2023-07-14 21:53:12,417 - root - INFO - add_noise False
2023-07-14 21:53:12,417 - root - INFO - noise_std 0
2023-07-14 21:53:12,417 - root - INFO - world_size 1
2023-07-14 21:53:12,417 - root - INFO - interp 0
2023-07-14 21:53:12,417 - root - INFO - use_daily_climatology False
2023-07-14 21:53:12,417 - root - INFO - global_batch_size 64
2023-07-14 21:53:12,417 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 21:53:12,417 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 21:53:12,417 - root - INFO - resuming False
2023-07-14 21:53:12,417 - root - INFO - local_rank 0
2023-07-14 21:53:12,417 - root - INFO - ---------------------------------------------------
2023-07-14 21:53:12,417 - root - INFO - Inference for 1 initial conditions
2023-07-14 21:53:12,650 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 21:53:12,651 - root - INFO - Number of samples per year: 1460
2023-07-14 21:53:12,652 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 21:53:12,652 - root - INFO - Delta t: 6 hours
2023-07-14 21:53:12,652 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 21:53:12,653 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 21:53:59,671 - root - INFO - Loading inference data
2023-07-14 21:53:59,900 - root - INFO - Initial condition 1 of 1
2023-07-14 21:55:37,635 - root - INFO - ------------------ Configuration ------------------
2023-07-14 21:55:37,635 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 21:55:37,635 - root - INFO - Configuration name: afno_backbone
2023-07-14 21:55:37,635 - root - INFO - log_to_wandb True
2023-07-14 21:55:37,635 - root - INFO - lr 0.0005
2023-07-14 21:55:37,636 - root - INFO - batch_size 64
2023-07-14 21:55:37,636 - root - INFO - max_epochs 150
2023-07-14 21:55:37,636 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 21:55:37,636 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 21:55:37,636 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 21:55:37,636 - root - INFO - orography False
2023-07-14 21:55:37,636 - root - INFO - orography_path None
2023-07-14 21:55:37,636 - root - INFO - exp_dir FourCastNet/results
2023-07-14 21:55:37,636 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 21:55:37,636 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 21:55:37,636 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 21:55:37,636 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 21:55:37,636 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 21:55:37,636 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 21:55:37,636 - root - INFO - loss l2
2023-07-14 21:55:37,636 - root - INFO - num_data_workers 4
2023-07-14 21:55:37,636 - root - INFO - dt 1
2023-07-14 21:55:37,636 - root - INFO - n_history 0
2023-07-14 21:55:37,637 - root - INFO - prediction_type iterative
2023-07-14 21:55:37,637 - root - INFO - prediction_length 41
2023-07-14 21:55:37,637 - root - INFO - n_initial_conditions 5
2023-07-14 21:55:37,637 - root - INFO - ics_type default
2023-07-14 21:55:37,637 - root - INFO - save_raw_forecasts True
2023-07-14 21:55:37,637 - root - INFO - save_channel False
2023-07-14 21:55:37,637 - root - INFO - masked_acc False
2023-07-14 21:55:37,637 - root - INFO - maskpath None
2023-07-14 21:55:37,637 - root - INFO - perturb False
2023-07-14 21:55:37,642 - root - INFO - add_grid False
2023-07-14 21:55:37,643 - root - INFO - N_grid_channels 0
2023-07-14 21:55:37,643 - root - INFO - gridtype sinusoidal
2023-07-14 21:55:37,643 - root - INFO - roll False
2023-07-14 21:55:37,643 - root - INFO - num_blocks 8
2023-07-14 21:55:37,643 - root - INFO - nettype afno
2023-07-14 21:55:37,643 - root - INFO - patch_size 8
2023-07-14 21:55:37,643 - root - INFO - width 56
2023-07-14 21:55:37,644 - root - INFO - modes 32
2023-07-14 21:55:37,644 - root - INFO - target default
2023-07-14 21:55:37,644 - root - INFO - normalization zscore
2023-07-14 21:55:37,644 - root - INFO - log_to_screen True
2023-07-14 21:55:37,644 - root - INFO - save_checkpoint True
2023-07-14 21:55:37,644 - root - INFO - enable_nhwc False
2023-07-14 21:55:37,644 - root - INFO - optimizer_type FusedAdam
2023-07-14 21:55:37,644 - root - INFO - crop_size_x None
2023-07-14 21:55:37,644 - root - INFO - crop_size_y None
2023-07-14 21:55:37,644 - root - INFO - two_step_training False
2023-07-14 21:55:37,644 - root - INFO - plot_animations False
2023-07-14 21:55:37,644 - root - INFO - add_noise False
2023-07-14 21:55:37,645 - root - INFO - noise_std 0
2023-07-14 21:55:37,645 - root - INFO - world_size 1
2023-07-14 21:55:37,645 - root - INFO - interp 0
2023-07-14 21:55:37,645 - root - INFO - use_daily_climatology False
2023-07-14 21:55:37,645 - root - INFO - global_batch_size 64
2023-07-14 21:55:37,645 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 21:55:37,645 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 21:55:37,645 - root - INFO - resuming False
2023-07-14 21:55:37,645 - root - INFO - local_rank 0
2023-07-14 21:55:37,645 - root - INFO - ---------------------------------------------------
2023-07-14 21:55:37,645 - root - INFO - Inference for 1 initial conditions
2023-07-14 21:55:37,861 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 21:55:37,863 - root - INFO - Number of samples per year: 1460
2023-07-14 21:55:37,864 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 21:55:37,864 - root - INFO - Delta t: 6 hours
2023-07-14 21:55:37,864 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 21:55:37,867 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 21:56:13,960 - root - INFO - Loading inference data
2023-07-14 21:56:14,095 - root - INFO - Initial condition 1 of 1
2023-07-14 22:07:29,794 - root - INFO - ------------------ Configuration ------------------
2023-07-14 22:07:29,794 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 22:07:29,794 - root - INFO - Configuration name: afno_backbone
2023-07-14 22:07:29,795 - root - INFO - log_to_wandb True
2023-07-14 22:07:29,795 - root - INFO - lr 0.0005
2023-07-14 22:07:29,795 - root - INFO - batch_size 64
2023-07-14 22:07:29,795 - root - INFO - max_epochs 150
2023-07-14 22:07:29,795 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 22:07:29,795 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 22:07:29,795 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 22:07:29,795 - root - INFO - orography False
2023-07-14 22:07:29,795 - root - INFO - orography_path None
2023-07-14 22:07:29,795 - root - INFO - exp_dir FourCastNet/results
2023-07-14 22:07:29,795 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 22:07:29,795 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 22:07:29,795 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 22:07:29,795 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 22:07:29,796 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 22:07:29,796 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 22:07:29,796 - root - INFO - loss l2
2023-07-14 22:07:29,796 - root - INFO - num_data_workers 4
2023-07-14 22:07:29,796 - root - INFO - dt 1
2023-07-14 22:07:29,796 - root - INFO - n_history 0
2023-07-14 22:07:29,796 - root - INFO - prediction_type iterative
2023-07-14 22:07:29,796 - root - INFO - prediction_length 4
2023-07-14 22:07:29,796 - root - INFO - n_initial_conditions 5
2023-07-14 22:07:29,796 - root - INFO - ics_type default
2023-07-14 22:07:29,796 - root - INFO - save_raw_forecasts True
2023-07-14 22:07:29,796 - root - INFO - save_channel False
2023-07-14 22:07:29,796 - root - INFO - masked_acc False
2023-07-14 22:07:29,796 - root - INFO - maskpath None
2023-07-14 22:07:29,796 - root - INFO - perturb False
2023-07-14 22:07:29,796 - root - INFO - add_grid False
2023-07-14 22:07:29,796 - root - INFO - N_grid_channels 0
2023-07-14 22:07:29,797 - root - INFO - gridtype sinusoidal
2023-07-14 22:07:29,797 - root - INFO - roll False
2023-07-14 22:07:29,797 - root - INFO - num_blocks 8
2023-07-14 22:07:29,797 - root - INFO - nettype afno
2023-07-14 22:07:29,797 - root - INFO - patch_size 8
2023-07-14 22:07:29,797 - root - INFO - width 56
2023-07-14 22:07:29,797 - root - INFO - modes 32
2023-07-14 22:07:29,797 - root - INFO - target default
2023-07-14 22:07:29,797 - root - INFO - normalization zscore
2023-07-14 22:07:29,797 - root - INFO - log_to_screen True
2023-07-14 22:07:29,797 - root - INFO - save_checkpoint True
2023-07-14 22:07:29,797 - root - INFO - enable_nhwc False
2023-07-14 22:07:29,797 - root - INFO - optimizer_type FusedAdam
2023-07-14 22:07:29,797 - root - INFO - crop_size_x None
2023-07-14 22:07:29,798 - root - INFO - crop_size_y None
2023-07-14 22:07:29,798 - root - INFO - two_step_training False
2023-07-14 22:07:29,798 - root - INFO - plot_animations False
2023-07-14 22:07:29,798 - root - INFO - add_noise False
2023-07-14 22:07:29,798 - root - INFO - noise_std 0
2023-07-14 22:07:29,798 - root - INFO - world_size 1
2023-07-14 22:07:29,798 - root - INFO - interp 0
2023-07-14 22:07:29,798 - root - INFO - use_daily_climatology False
2023-07-14 22:07:29,798 - root - INFO - global_batch_size 64
2023-07-14 22:07:29,798 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 22:07:29,798 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 22:07:29,798 - root - INFO - resuming False
2023-07-14 22:07:29,798 - root - INFO - local_rank 0
2023-07-14 22:07:29,798 - root - INFO - ---------------------------------------------------
2023-07-14 22:07:29,799 - root - INFO - Inference for 1 initial conditions
2023-07-14 22:07:30,166 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 22:07:30,167 - root - INFO - Number of samples per year: 1460
2023-07-14 22:07:30,167 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 22:07:30,167 - root - INFO - Delta t: 6 hours
2023-07-14 22:07:30,168 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 22:07:30,169 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 22:08:41,917 - root - INFO - Loading inference data
2023-07-14 22:08:42,131 - root - INFO - Initial condition 1 of 1
2023-07-14 22:14:30,154 - root - INFO - ------------------ Configuration ------------------
2023-07-14 22:14:30,154 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 22:14:30,154 - root - INFO - Configuration name: afno_backbone
2023-07-14 22:14:30,155 - root - INFO - log_to_wandb True
2023-07-14 22:14:30,155 - root - INFO - lr 0.0005
2023-07-14 22:14:30,155 - root - INFO - batch_size 64
2023-07-14 22:14:30,155 - root - INFO - max_epochs 150
2023-07-14 22:14:30,155 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 22:14:30,155 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 22:14:30,155 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 22:14:30,155 - root - INFO - orography False
2023-07-14 22:14:30,155 - root - INFO - orography_path None
2023-07-14 22:14:30,155 - root - INFO - exp_dir FourCastNet/results
2023-07-14 22:14:30,155 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 22:14:30,155 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 22:14:30,155 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 22:14:30,155 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 22:14:30,155 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 22:14:30,156 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 22:14:30,156 - root - INFO - loss l2
2023-07-14 22:14:30,156 - root - INFO - num_data_workers 4
2023-07-14 22:14:30,156 - root - INFO - dt 1
2023-07-14 22:14:30,156 - root - INFO - n_history 0
2023-07-14 22:14:30,156 - root - INFO - prediction_type iterative
2023-07-14 22:14:30,156 - root - INFO - prediction_length 4
2023-07-14 22:14:30,156 - root - INFO - n_initial_conditions 5
2023-07-14 22:14:30,156 - root - INFO - ics_type default
2023-07-14 22:14:30,156 - root - INFO - save_raw_forecasts True
2023-07-14 22:14:30,156 - root - INFO - save_channel False
2023-07-14 22:14:30,156 - root - INFO - masked_acc False
2023-07-14 22:14:30,156 - root - INFO - maskpath None
2023-07-14 22:14:30,156 - root - INFO - perturb False
2023-07-14 22:14:30,156 - root - INFO - add_grid False
2023-07-14 22:14:30,156 - root - INFO - N_grid_channels 0
2023-07-14 22:14:30,156 - root - INFO - gridtype sinusoidal
2023-07-14 22:14:30,156 - root - INFO - roll False
2023-07-14 22:14:30,156 - root - INFO - num_blocks 8
2023-07-14 22:14:30,157 - root - INFO - nettype afno
2023-07-14 22:14:30,157 - root - INFO - patch_size 8
2023-07-14 22:14:30,157 - root - INFO - width 56
2023-07-14 22:14:30,157 - root - INFO - modes 32
2023-07-14 22:14:30,157 - root - INFO - target default
2023-07-14 22:14:30,157 - root - INFO - normalization zscore
2023-07-14 22:14:30,157 - root - INFO - log_to_screen True
2023-07-14 22:14:30,157 - root - INFO - save_checkpoint True
2023-07-14 22:14:30,157 - root - INFO - enable_nhwc False
2023-07-14 22:14:30,157 - root - INFO - optimizer_type FusedAdam
2023-07-14 22:14:30,157 - root - INFO - crop_size_x None
2023-07-14 22:14:30,157 - root - INFO - crop_size_y None
2023-07-14 22:14:30,157 - root - INFO - two_step_training False
2023-07-14 22:14:30,157 - root - INFO - plot_animations False
2023-07-14 22:14:30,157 - root - INFO - add_noise False
2023-07-14 22:14:30,157 - root - INFO - noise_std 0
2023-07-14 22:14:30,157 - root - INFO - world_size 1
2023-07-14 22:14:30,157 - root - INFO - interp 0
2023-07-14 22:14:30,157 - root - INFO - use_daily_climatology False
2023-07-14 22:14:30,158 - root - INFO - global_batch_size 64
2023-07-14 22:14:30,158 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 22:14:30,158 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 22:14:30,158 - root - INFO - resuming False
2023-07-14 22:14:30,158 - root - INFO - local_rank 0
2023-07-14 22:14:30,158 - root - INFO - ---------------------------------------------------
2023-07-14 22:14:30,158 - root - INFO - Inference for 1 initial conditions
2023-07-14 22:14:30,463 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 22:14:30,469 - root - INFO - Number of samples per year: 1460
2023-07-14 22:14:30,470 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 22:14:30,470 - root - INFO - Delta t: 6 hours
2023-07-14 22:14:30,470 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 22:14:30,474 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 22:15:35,276 - root - INFO - Loading inference data
2023-07-14 22:15:35,475 - root - INFO - Initial condition 1 of 1
2023-07-14 22:25:31,728 - root - INFO - ------------------ Configuration ------------------
2023-07-14 22:25:31,729 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 22:25:31,729 - root - INFO - Configuration name: afno_backbone
2023-07-14 22:25:31,729 - root - INFO - log_to_wandb True
2023-07-14 22:25:31,730 - root - INFO - lr 0.0005
2023-07-14 22:25:31,730 - root - INFO - batch_size 64
2023-07-14 22:25:31,730 - root - INFO - max_epochs 150
2023-07-14 22:25:31,730 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 22:25:31,730 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 22:25:31,731 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 22:25:31,731 - root - INFO - orography False
2023-07-14 22:25:31,731 - root - INFO - orography_path None
2023-07-14 22:25:31,731 - root - INFO - exp_dir FourCastNet/results
2023-07-14 22:25:31,731 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 22:25:31,731 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 22:25:31,731 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 22:25:31,731 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 22:25:31,731 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 22:25:31,731 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 22:25:31,732 - root - INFO - loss l2
2023-07-14 22:25:31,732 - root - INFO - num_data_workers 4
2023-07-14 22:25:31,732 - root - INFO - dt 1
2023-07-14 22:25:31,732 - root - INFO - n_history 0
2023-07-14 22:25:31,732 - root - INFO - prediction_type iterative
2023-07-14 22:25:31,732 - root - INFO - prediction_length 2
2023-07-14 22:25:31,732 - root - INFO - n_initial_conditions 5
2023-07-14 22:25:31,732 - root - INFO - ics_type default
2023-07-14 22:25:31,732 - root - INFO - save_raw_forecasts True
2023-07-14 22:25:31,732 - root - INFO - save_channel False
2023-07-14 22:25:31,732 - root - INFO - masked_acc False
2023-07-14 22:25:31,732 - root - INFO - maskpath None
2023-07-14 22:25:31,732 - root - INFO - perturb False
2023-07-14 22:25:31,732 - root - INFO - add_grid False
2023-07-14 22:25:31,732 - root - INFO - N_grid_channels 0
2023-07-14 22:25:31,732 - root - INFO - gridtype sinusoidal
2023-07-14 22:25:31,732 - root - INFO - roll False
2023-07-14 22:25:31,733 - root - INFO - num_blocks 8
2023-07-14 22:25:31,733 - root - INFO - nettype afno
2023-07-14 22:25:31,733 - root - INFO - patch_size 8
2023-07-14 22:25:31,733 - root - INFO - width 56
2023-07-14 22:25:31,733 - root - INFO - modes 32
2023-07-14 22:25:31,733 - root - INFO - target default
2023-07-14 22:25:31,733 - root - INFO - normalization zscore
2023-07-14 22:25:31,733 - root - INFO - log_to_screen True
2023-07-14 22:25:31,733 - root - INFO - save_checkpoint True
2023-07-14 22:25:31,733 - root - INFO - enable_nhwc False
2023-07-14 22:25:31,733 - root - INFO - optimizer_type FusedAdam
2023-07-14 22:25:31,733 - root - INFO - crop_size_x None
2023-07-14 22:25:31,733 - root - INFO - crop_size_y None
2023-07-14 22:25:31,734 - root - INFO - two_step_training False
2023-07-14 22:25:31,734 - root - INFO - plot_animations False
2023-07-14 22:25:31,734 - root - INFO - add_noise False
2023-07-14 22:25:31,734 - root - INFO - noise_std 0
2023-07-14 22:25:31,734 - root - INFO - world_size 1
2023-07-14 22:25:31,734 - root - INFO - interp 0
2023-07-14 22:25:31,734 - root - INFO - use_daily_climatology False
2023-07-14 22:25:31,734 - root - INFO - global_batch_size 64
2023-07-14 22:25:31,734 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 22:25:31,734 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 22:25:31,734 - root - INFO - resuming False
2023-07-14 22:25:31,734 - root - INFO - local_rank 0
2023-07-14 22:25:31,734 - root - INFO - ---------------------------------------------------
2023-07-14 22:25:31,734 - root - INFO - Inference for 1 initial conditions
2023-07-14 22:25:32,027 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 22:25:32,028 - root - INFO - Number of samples per year: 1460
2023-07-14 22:25:32,029 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 22:25:32,029 - root - INFO - Delta t: 6 hours
2023-07-14 22:25:32,029 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 22:25:32,031 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 22:26:43,228 - root - INFO - Loading inference data
2023-07-14 22:26:43,564 - root - INFO - Initial condition 1 of 1
2023-07-14 22:31:54,017 - root - INFO - ------------------ Configuration ------------------
2023-07-14 22:31:54,018 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 22:31:54,018 - root - INFO - Configuration name: afno_backbone
2023-07-14 22:31:54,018 - root - INFO - log_to_wandb True
2023-07-14 22:31:54,018 - root - INFO - lr 0.0005
2023-07-14 22:31:54,018 - root - INFO - batch_size 64
2023-07-14 22:31:54,018 - root - INFO - max_epochs 150
2023-07-14 22:31:54,018 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 22:31:54,018 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 22:31:54,018 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 22:31:54,018 - root - INFO - orography False
2023-07-14 22:31:54,018 - root - INFO - orography_path None
2023-07-14 22:31:54,018 - root - INFO - exp_dir FourCastNet/results
2023-07-14 22:31:54,019 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 22:31:54,019 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 22:31:54,019 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 22:31:54,019 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 22:31:54,019 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 22:31:54,019 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 22:31:54,019 - root - INFO - loss l2
2023-07-14 22:31:54,019 - root - INFO - num_data_workers 4
2023-07-14 22:31:54,019 - root - INFO - dt 1
2023-07-14 22:31:54,019 - root - INFO - n_history 0
2023-07-14 22:31:54,019 - root - INFO - prediction_type iterative
2023-07-14 22:31:54,019 - root - INFO - prediction_length 2
2023-07-14 22:31:54,019 - root - INFO - n_initial_conditions 5
2023-07-14 22:31:54,019 - root - INFO - ics_type default
2023-07-14 22:31:54,020 - root - INFO - save_raw_forecasts True
2023-07-14 22:31:54,020 - root - INFO - save_channel False
2023-07-14 22:31:54,020 - root - INFO - masked_acc False
2023-07-14 22:31:54,020 - root - INFO - maskpath None
2023-07-14 22:31:54,020 - root - INFO - perturb False
2023-07-14 22:31:54,020 - root - INFO - add_grid False
2023-07-14 22:31:54,020 - root - INFO - N_grid_channels 0
2023-07-14 22:31:54,020 - root - INFO - gridtype sinusoidal
2023-07-14 22:31:54,020 - root - INFO - roll False
2023-07-14 22:31:54,025 - root - INFO - num_blocks 8
2023-07-14 22:31:54,026 - root - INFO - nettype afno
2023-07-14 22:31:54,026 - root - INFO - patch_size 8
2023-07-14 22:31:54,026 - root - INFO - width 56
2023-07-14 22:31:54,026 - root - INFO - modes 32
2023-07-14 22:31:54,027 - root - INFO - target default
2023-07-14 22:31:54,028 - root - INFO - normalization zscore
2023-07-14 22:31:54,029 - root - INFO - log_to_screen True
2023-07-14 22:31:54,029 - root - INFO - save_checkpoint True
2023-07-14 22:31:54,032 - root - INFO - enable_nhwc False
2023-07-14 22:31:54,032 - root - INFO - optimizer_type FusedAdam
2023-07-14 22:31:54,032 - root - INFO - crop_size_x None
2023-07-14 22:31:54,033 - root - INFO - crop_size_y None
2023-07-14 22:31:54,033 - root - INFO - two_step_training False
2023-07-14 22:31:54,033 - root - INFO - plot_animations False
2023-07-14 22:31:54,033 - root - INFO - add_noise False
2023-07-14 22:31:54,034 - root - INFO - noise_std 0
2023-07-14 22:31:54,034 - root - INFO - world_size 1
2023-07-14 22:31:54,036 - root - INFO - interp 0
2023-07-14 22:31:54,037 - root - INFO - use_daily_climatology False
2023-07-14 22:31:54,037 - root - INFO - global_batch_size 64
2023-07-14 22:31:54,037 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 22:31:54,038 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 22:31:54,038 - root - INFO - resuming False
2023-07-14 22:31:54,038 - root - INFO - local_rank 0
2023-07-14 22:31:54,039 - root - INFO - ---------------------------------------------------
2023-07-14 22:31:54,039 - root - INFO - Inference for 1 initial conditions
2023-07-14 22:31:54,349 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 22:31:54,350 - root - INFO - Number of samples per year: 1460
2023-07-14 22:31:54,350 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 22:31:54,350 - root - INFO - Delta t: 6 hours
2023-07-14 22:31:54,350 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 22:31:54,351 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 22:32:59,629 - root - INFO - Loading inference data
2023-07-14 22:32:59,960 - root - INFO - Initial condition 1 of 1
2023-07-14 22:33:24,850 - root - INFO - Begin autoregressive inference
2023-07-14 22:34:06,595 - root - INFO - Predicted timestep 0 of 2. z500 RMS Error: 0.0, ACC: 1.0
2023-07-14 22:34:45,157 - root - INFO - Predicted timestep 1 of 2. z500 RMS Error: 34.42150115966797, ACC: 0.9996492862701416
2023-07-14 22:34:45,159 - root - INFO - Saving files at /root/FourCastNet/override_dir/autoregressive_predictions_z500_vis.h5
2023-07-14 22:35:46,944 - root - INFO - ------------------ Configuration ------------------
2023-07-14 22:35:46,944 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 22:35:46,944 - root - INFO - Configuration name: afno_backbone
2023-07-14 22:35:46,944 - root - INFO - log_to_wandb True
2023-07-14 22:35:46,944 - root - INFO - lr 0.0005
2023-07-14 22:35:46,944 - root - INFO - batch_size 64
2023-07-14 22:35:46,944 - root - INFO - max_epochs 150
2023-07-14 22:35:46,944 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 22:35:46,944 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 22:35:46,944 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 22:35:46,945 - root - INFO - orography False
2023-07-14 22:35:46,945 - root - INFO - orography_path None
2023-07-14 22:35:46,945 - root - INFO - exp_dir FourCastNet/results
2023-07-14 22:35:46,945 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 22:35:46,945 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 22:35:46,945 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 22:35:46,945 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 22:35:46,945 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 22:35:46,945 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 22:35:46,945 - root - INFO - loss l2
2023-07-14 22:35:46,945 - root - INFO - num_data_workers 4
2023-07-14 22:35:46,945 - root - INFO - dt 1
2023-07-14 22:35:46,945 - root - INFO - n_history 0
2023-07-14 22:35:46,945 - root - INFO - prediction_type iterative
2023-07-14 22:35:46,945 - root - INFO - prediction_length 3
2023-07-14 22:35:46,945 - root - INFO - n_initial_conditions 5
2023-07-14 22:35:46,945 - root - INFO - ics_type default
2023-07-14 22:35:46,945 - root - INFO - save_raw_forecasts True
2023-07-14 22:35:46,946 - root - INFO - save_channel False
2023-07-14 22:35:46,946 - root - INFO - masked_acc False
2023-07-14 22:35:46,946 - root - INFO - maskpath None
2023-07-14 22:35:46,946 - root - INFO - perturb False
2023-07-14 22:35:46,946 - root - INFO - add_grid False
2023-07-14 22:35:46,946 - root - INFO - N_grid_channels 0
2023-07-14 22:35:46,946 - root - INFO - gridtype sinusoidal
2023-07-14 22:35:46,946 - root - INFO - roll False
2023-07-14 22:35:46,946 - root - INFO - num_blocks 8
2023-07-14 22:35:46,946 - root - INFO - nettype afno
2023-07-14 22:35:46,946 - root - INFO - patch_size 8
2023-07-14 22:35:46,946 - root - INFO - width 56
2023-07-14 22:35:46,946 - root - INFO - modes 32
2023-07-14 22:35:46,946 - root - INFO - target default
2023-07-14 22:35:46,946 - root - INFO - normalization zscore
2023-07-14 22:35:46,947 - root - INFO - log_to_screen True
2023-07-14 22:35:46,947 - root - INFO - save_checkpoint True
2023-07-14 22:35:46,947 - root - INFO - enable_nhwc False
2023-07-14 22:35:46,947 - root - INFO - optimizer_type FusedAdam
2023-07-14 22:35:46,947 - root - INFO - crop_size_x None
2023-07-14 22:35:46,947 - root - INFO - crop_size_y None
2023-07-14 22:35:46,949 - root - INFO - two_step_training False
2023-07-14 22:35:46,949 - root - INFO - plot_animations False
2023-07-14 22:35:46,949 - root - INFO - add_noise False
2023-07-14 22:35:46,949 - root - INFO - noise_std 0
2023-07-14 22:35:46,949 - root - INFO - world_size 1
2023-07-14 22:35:46,949 - root - INFO - interp 0
2023-07-14 22:35:46,950 - root - INFO - use_daily_climatology False
2023-07-14 22:35:46,950 - root - INFO - global_batch_size 64
2023-07-14 22:35:46,950 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 22:35:46,950 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 22:35:46,950 - root - INFO - resuming False
2023-07-14 22:35:46,950 - root - INFO - local_rank 0
2023-07-14 22:35:46,950 - root - INFO - ---------------------------------------------------
2023-07-14 22:35:46,950 - root - INFO - Inference for 1 initial conditions
2023-07-14 22:35:47,241 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 22:35:47,242 - root - INFO - Number of samples per year: 1460
2023-07-14 22:35:47,242 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 22:35:47,242 - root - INFO - Delta t: 6 hours
2023-07-14 22:35:47,242 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 22:35:47,243 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 22:36:42,707 - root - INFO - Loading inference data
2023-07-14 22:36:42,911 - root - INFO - Initial condition 1 of 1
2023-07-14 22:37:26,588 - root - INFO - Begin autoregressive inference
2023-07-14 22:38:06,104 - root - INFO - Predicted timestep 0 of 3. u10 RMS Error: 0.0, ACC: 1.0
2023-07-14 22:38:44,172 - root - INFO - Predicted timestep 1 of 3. u10 RMS Error: 0.5590931177139282, ACC: 0.9902381896972656
2023-07-14 22:39:22,922 - root - INFO - Predicted timestep 2 of 3. u10 RMS Error: 0.7761334180831909, ACC: 0.9814416170120239
2023-07-14 22:39:22,932 - root - INFO - Saving files at /root/FourCastNet/override_dir/autoregressive_predictions_u10_vis.h5
2023-07-14 22:52:59,020 - root - INFO - ------------------ Configuration ------------------
2023-07-14 22:52:59,020 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-14 22:52:59,020 - root - INFO - Configuration name: afno_backbone
2023-07-14 22:52:59,020 - root - INFO - log_to_wandb True
2023-07-14 22:52:59,020 - root - INFO - lr 0.0005
2023-07-14 22:52:59,021 - root - INFO - batch_size 64
2023-07-14 22:52:59,021 - root - INFO - max_epochs 150
2023-07-14 22:52:59,021 - root - INFO - scheduler CosineAnnealingLR
2023-07-14 22:52:59,021 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 22:52:59,021 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-14 22:52:59,021 - root - INFO - orography False
2023-07-14 22:52:59,021 - root - INFO - orography_path None
2023-07-14 22:52:59,021 - root - INFO - exp_dir FourCastNet/results
2023-07-14 22:52:59,021 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-14 22:52:59,021 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-14 22:52:59,021 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-14 22:52:59,021 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-14 22:52:59,021 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-14 22:52:59,021 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-14 22:52:59,021 - root - INFO - loss l2
2023-07-14 22:52:59,021 - root - INFO - num_data_workers 4
2023-07-14 22:52:59,021 - root - INFO - dt 1
2023-07-14 22:52:59,021 - root - INFO - n_history 0
2023-07-14 22:52:59,021 - root - INFO - prediction_type iterative
2023-07-14 22:52:59,022 - root - INFO - prediction_length 4
2023-07-14 22:52:59,022 - root - INFO - n_initial_conditions 5
2023-07-14 22:52:59,022 - root - INFO - ics_type default
2023-07-14 22:52:59,022 - root - INFO - save_raw_forecasts True
2023-07-14 22:52:59,022 - root - INFO - save_channel False
2023-07-14 22:52:59,022 - root - INFO - masked_acc False
2023-07-14 22:52:59,022 - root - INFO - maskpath None
2023-07-14 22:52:59,022 - root - INFO - perturb False
2023-07-14 22:52:59,022 - root - INFO - add_grid False
2023-07-14 22:52:59,022 - root - INFO - N_grid_channels 0
2023-07-14 22:52:59,022 - root - INFO - gridtype sinusoidal
2023-07-14 22:52:59,022 - root - INFO - roll False
2023-07-14 22:52:59,022 - root - INFO - num_blocks 8
2023-07-14 22:52:59,023 - root - INFO - nettype afno
2023-07-14 22:52:59,023 - root - INFO - patch_size 8
2023-07-14 22:52:59,023 - root - INFO - width 56
2023-07-14 22:52:59,023 - root - INFO - modes 32
2023-07-14 22:52:59,023 - root - INFO - target default
2023-07-14 22:52:59,023 - root - INFO - normalization zscore
2023-07-14 22:52:59,023 - root - INFO - log_to_screen True
2023-07-14 22:52:59,023 - root - INFO - save_checkpoint True
2023-07-14 22:52:59,023 - root - INFO - enable_nhwc False
2023-07-14 22:52:59,023 - root - INFO - optimizer_type FusedAdam
2023-07-14 22:52:59,023 - root - INFO - crop_size_x None
2023-07-14 22:52:59,023 - root - INFO - crop_size_y None
2023-07-14 22:52:59,023 - root - INFO - two_step_training False
2023-07-14 22:52:59,023 - root - INFO - plot_animations False
2023-07-14 22:52:59,023 - root - INFO - add_noise False
2023-07-14 22:52:59,023 - root - INFO - noise_std 0
2023-07-14 22:52:59,024 - root - INFO - world_size 1
2023-07-14 22:52:59,025 - root - INFO - interp 0
2023-07-14 22:52:59,025 - root - INFO - use_daily_climatology False
2023-07-14 22:52:59,025 - root - INFO - global_batch_size 64
2023-07-14 22:52:59,025 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-14 22:52:59,025 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 22:52:59,026 - root - INFO - resuming False
2023-07-14 22:52:59,026 - root - INFO - local_rank 0
2023-07-14 22:52:59,026 - root - INFO - ---------------------------------------------------
2023-07-14 22:52:59,026 - root - INFO - Inference for 1 initial conditions
2023-07-14 22:52:59,364 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-14 22:52:59,365 - root - INFO - Number of samples per year: 1460
2023-07-14 22:52:59,366 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-14 22:52:59,366 - root - INFO - Delta t: 6 hours
2023-07-14 22:52:59,366 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-14 22:52:59,368 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-14 22:54:08,606 - root - INFO - Loading inference data
2023-07-14 22:54:08,901 - root - INFO - Initial condition 1 of 1
2023-07-17 17:23:28,704 - root - INFO - ------------------ Configuration ------------------
2023-07-17 17:23:28,704 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 17:23:28,704 - root - INFO - Configuration name: afno_backbone
2023-07-17 17:23:28,704 - root - INFO - log_to_wandb True
2023-07-17 17:23:28,704 - root - INFO - lr 0.0005
2023-07-17 17:23:28,704 - root - INFO - batch_size 64
2023-07-17 17:23:28,704 - root - INFO - max_epochs 150
2023-07-17 17:23:28,704 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 17:23:28,704 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 17:23:28,704 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 17:23:28,704 - root - INFO - orography False
2023-07-17 17:23:28,704 - root - INFO - orography_path None
2023-07-17 17:23:28,705 - root - INFO - exp_dir FourCastNet/results
2023-07-17 17:23:28,705 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 17:23:28,705 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 17:23:28,705 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 17:23:28,705 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 17:23:28,705 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 17:23:28,705 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 17:23:28,705 - root - INFO - loss l2
2023-07-17 17:23:28,705 - root - INFO - num_data_workers 4
2023-07-17 17:23:28,705 - root - INFO - dt 1
2023-07-17 17:23:28,705 - root - INFO - n_history 0
2023-07-17 17:23:28,705 - root - INFO - prediction_type iterative
2023-07-17 17:23:28,705 - root - INFO - prediction_length 4
2023-07-17 17:23:28,705 - root - INFO - n_initial_conditions 5
2023-07-17 17:23:28,705 - root - INFO - ics_type default
2023-07-17 17:23:28,705 - root - INFO - save_raw_forecasts True
2023-07-17 17:23:28,705 - root - INFO - save_channel False
2023-07-17 17:23:28,705 - root - INFO - masked_acc False
2023-07-17 17:23:28,705 - root - INFO - maskpath None
2023-07-17 17:23:28,705 - root - INFO - perturb False
2023-07-17 17:23:28,705 - root - INFO - add_grid False
2023-07-17 17:23:28,705 - root - INFO - N_grid_channels 0
2023-07-17 17:23:28,706 - root - INFO - gridtype sinusoidal
2023-07-17 17:23:28,706 - root - INFO - roll False
2023-07-17 17:23:28,706 - root - INFO - num_blocks 8
2023-07-17 17:23:28,706 - root - INFO - nettype afno
2023-07-17 17:23:28,706 - root - INFO - patch_size 8
2023-07-17 17:23:28,706 - root - INFO - width 56
2023-07-17 17:23:28,706 - root - INFO - modes 32
2023-07-17 17:23:28,706 - root - INFO - target default
2023-07-17 17:23:28,706 - root - INFO - normalization zscore
2023-07-17 17:23:28,706 - root - INFO - log_to_screen True
2023-07-17 17:23:28,706 - root - INFO - save_checkpoint True
2023-07-17 17:23:28,706 - root - INFO - enable_nhwc False
2023-07-17 17:23:28,706 - root - INFO - optimizer_type FusedAdam
2023-07-17 17:23:28,706 - root - INFO - crop_size_x None
2023-07-17 17:23:28,706 - root - INFO - crop_size_y None
2023-07-17 17:23:28,706 - root - INFO - two_step_training False
2023-07-17 17:23:28,706 - root - INFO - plot_animations False
2023-07-17 17:23:28,706 - root - INFO - add_noise False
2023-07-17 17:23:28,706 - root - INFO - noise_std 0
2023-07-17 17:23:28,706 - root - INFO - world_size 1
2023-07-17 17:23:28,706 - root - INFO - interp 0
2023-07-17 17:23:28,707 - root - INFO - use_daily_climatology False
2023-07-17 17:23:28,707 - root - INFO - global_batch_size 64
2023-07-17 17:23:28,707 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 17:23:28,707 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 17:23:28,707 - root - INFO - resuming False
2023-07-17 17:23:28,707 - root - INFO - local_rank 0
2023-07-17 17:23:28,707 - root - INFO - ---------------------------------------------------
2023-07-17 17:23:28,707 - root - INFO - Inference for 1 initial conditions
2023-07-17 17:23:29,044 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 17:23:29,044 - root - INFO - Number of samples per year: 1460
2023-07-17 17:23:29,044 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 17:23:29,045 - root - INFO - Delta t: 6 hours
2023-07-17 17:23:29,045 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 17:23:29,045 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 17:24:38,751 - root - INFO - Loading inference data
2023-07-17 17:24:39,070 - root - INFO - Initial condition 1 of 1
2023-07-17 17:25:14,958 - root - INFO - Begin autoregressive inference
2023-07-17 17:25:43,488 - root - INFO - Predicted timestep 0 of 4. u10 RMS Error: 0.0, ACC: 1.0
2023-07-17 17:26:12,077 - root - INFO - Predicted timestep 1 of 4. u10 RMS Error: 0.5590931177139282, ACC: 0.9902381896972656
2023-07-17 17:26:40,472 - root - INFO - Predicted timestep 2 of 4. u10 RMS Error: 0.7761334180831909, ACC: 0.9814416170120239
2023-07-17 17:27:09,059 - root - INFO - Predicted timestep 3 of 4. u10 RMS Error: 0.8559064865112305, ACC: 0.9776168465614319
2023-07-17 17:27:09,071 - root - INFO - Saving files at /root/FourCastNet/override_dir/autoregressive_predictions_u10_vis.h5
2023-07-17 18:08:43,699 - root - INFO - ------------------ Configuration ------------------
2023-07-17 18:08:43,699 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 18:08:43,699 - root - INFO - Configuration name: afno_backbone
2023-07-17 18:08:43,699 - root - INFO - log_to_wandb True
2023-07-17 18:08:43,699 - root - INFO - lr 0.0005
2023-07-17 18:08:43,699 - root - INFO - batch_size 64
2023-07-17 18:08:43,699 - root - INFO - max_epochs 150
2023-07-17 18:08:43,700 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 18:08:43,700 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 18:08:43,700 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 18:08:43,700 - root - INFO - orography False
2023-07-17 18:08:43,700 - root - INFO - orography_path None
2023-07-17 18:08:43,700 - root - INFO - exp_dir FourCastNet/results
2023-07-17 18:08:43,700 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 18:08:43,700 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 18:08:43,700 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 18:08:43,700 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 18:08:43,700 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 18:08:43,700 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 18:08:43,700 - root - INFO - loss l2
2023-07-17 18:08:43,700 - root - INFO - num_data_workers 4
2023-07-17 18:08:43,700 - root - INFO - dt 1
2023-07-17 18:08:43,700 - root - INFO - n_history 0
2023-07-17 18:08:43,701 - root - INFO - prediction_type iterative
2023-07-17 18:08:43,701 - root - INFO - prediction_length 8
2023-07-17 18:08:43,701 - root - INFO - n_initial_conditions 5
2023-07-17 18:08:43,701 - root - INFO - ics_type default
2023-07-17 18:08:43,701 - root - INFO - save_raw_forecasts True
2023-07-17 18:08:43,701 - root - INFO - save_channel False
2023-07-17 18:08:43,701 - root - INFO - masked_acc False
2023-07-17 18:08:43,701 - root - INFO - maskpath None
2023-07-17 18:08:43,701 - root - INFO - perturb False
2023-07-17 18:08:43,701 - root - INFO - add_grid False
2023-07-17 18:08:43,701 - root - INFO - N_grid_channels 0
2023-07-17 18:08:43,701 - root - INFO - gridtype sinusoidal
2023-07-17 18:08:43,701 - root - INFO - roll False
2023-07-17 18:08:43,701 - root - INFO - num_blocks 8
2023-07-17 18:08:43,701 - root - INFO - nettype afno
2023-07-17 18:08:43,701 - root - INFO - patch_size 8
2023-07-17 18:08:43,701 - root - INFO - width 56
2023-07-17 18:08:43,701 - root - INFO - modes 32
2023-07-17 18:08:43,701 - root - INFO - target default
2023-07-17 18:08:43,701 - root - INFO - normalization zscore
2023-07-17 18:08:43,701 - root - INFO - log_to_screen True
2023-07-17 18:08:43,701 - root - INFO - save_checkpoint True
2023-07-17 18:08:43,702 - root - INFO - enable_nhwc False
2023-07-17 18:08:43,702 - root - INFO - optimizer_type FusedAdam
2023-07-17 18:08:43,702 - root - INFO - crop_size_x None
2023-07-17 18:08:43,702 - root - INFO - crop_size_y None
2023-07-17 18:08:43,702 - root - INFO - two_step_training False
2023-07-17 18:08:43,702 - root - INFO - plot_animations False
2023-07-17 18:08:43,702 - root - INFO - add_noise False
2023-07-17 18:08:43,702 - root - INFO - noise_std 0
2023-07-17 18:08:43,702 - root - INFO - world_size 1
2023-07-17 18:08:43,702 - root - INFO - interp 0
2023-07-17 18:08:43,702 - root - INFO - use_daily_climatology False
2023-07-17 18:08:43,702 - root - INFO - global_batch_size 64
2023-07-17 18:08:43,702 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 18:08:43,702 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 18:08:43,702 - root - INFO - resuming False
2023-07-17 18:08:43,702 - root - INFO - local_rank 0
2023-07-17 18:08:43,702 - root - INFO - ---------------------------------------------------
2023-07-17 18:08:43,702 - root - INFO - Inference for 1 initial conditions
2023-07-17 18:08:44,009 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 18:08:44,009 - root - INFO - Number of samples per year: 1460
2023-07-17 18:08:44,009 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 18:08:44,010 - root - INFO - Delta t: 6 hours
2023-07-17 18:08:44,010 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 18:08:44,010 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 18:09:55,884 - root - INFO - Loading inference data
2023-07-17 18:09:56,090 - root - INFO - Initial condition 1 of 1
2023-07-17 18:10:56,558 - root - INFO - Begin autoregressive inference
2023-07-17 18:11:25,196 - root - INFO - Predicted timestep 0 of 8. u10 RMS Error: 0.0, ACC: 1.0
2023-07-17 18:11:53,658 - root - INFO - Predicted timestep 1 of 8. u10 RMS Error: 0.5590931177139282, ACC: 0.9902381896972656
2023-07-17 18:12:21,076 - root - INFO - ------------------ Configuration ------------------
2023-07-17 18:12:21,076 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 18:12:21,076 - root - INFO - Configuration name: afno_backbone
2023-07-17 18:12:21,076 - root - INFO - log_to_wandb True
2023-07-17 18:12:21,076 - root - INFO - lr 0.0005
2023-07-17 18:12:21,076 - root - INFO - batch_size 64
2023-07-17 18:12:21,076 - root - INFO - max_epochs 150
2023-07-17 18:12:21,076 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 18:12:21,076 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 18:12:21,076 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 18:12:21,076 - root - INFO - orography False
2023-07-17 18:12:21,077 - root - INFO - orography_path None
2023-07-17 18:12:21,077 - root - INFO - exp_dir FourCastNet/results
2023-07-17 18:12:21,077 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 18:12:21,077 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 18:12:21,077 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 18:12:21,077 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 18:12:21,077 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 18:12:21,077 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 18:12:21,077 - root - INFO - loss l2
2023-07-17 18:12:21,077 - root - INFO - num_data_workers 4
2023-07-17 18:12:21,077 - root - INFO - dt 1
2023-07-17 18:12:21,077 - root - INFO - n_history 0
2023-07-17 18:12:21,077 - root - INFO - prediction_type iterative
2023-07-17 18:12:21,077 - root - INFO - prediction_length 41
2023-07-17 18:12:21,077 - root - INFO - n_initial_conditions 5
2023-07-17 18:12:21,077 - root - INFO - ics_type default
2023-07-17 18:12:21,077 - root - INFO - save_raw_forecasts True
2023-07-17 18:12:21,077 - root - INFO - save_channel False
2023-07-17 18:12:21,077 - root - INFO - masked_acc False
2023-07-17 18:12:21,077 - root - INFO - maskpath None
2023-07-17 18:12:21,077 - root - INFO - perturb False
2023-07-17 18:12:21,077 - root - INFO - add_grid False
2023-07-17 18:12:21,078 - root - INFO - N_grid_channels 0
2023-07-17 18:12:21,078 - root - INFO - gridtype sinusoidal
2023-07-17 18:12:21,078 - root - INFO - roll False
2023-07-17 18:12:21,078 - root - INFO - num_blocks 8
2023-07-17 18:12:21,078 - root - INFO - nettype afno
2023-07-17 18:12:21,078 - root - INFO - patch_size 8
2023-07-17 18:12:21,078 - root - INFO - width 56
2023-07-17 18:12:21,078 - root - INFO - modes 32
2023-07-17 18:12:21,078 - root - INFO - target default
2023-07-17 18:12:21,078 - root - INFO - normalization zscore
2023-07-17 18:12:21,078 - root - INFO - log_to_screen True
2023-07-17 18:12:21,078 - root - INFO - save_checkpoint True
2023-07-17 18:12:21,078 - root - INFO - enable_nhwc False
2023-07-17 18:12:21,078 - root - INFO - optimizer_type FusedAdam
2023-07-17 18:12:21,078 - root - INFO - crop_size_x None
2023-07-17 18:12:21,078 - root - INFO - crop_size_y None
2023-07-17 18:12:21,078 - root - INFO - two_step_training False
2023-07-17 18:12:21,078 - root - INFO - plot_animations False
2023-07-17 18:12:21,078 - root - INFO - add_noise False
2023-07-17 18:12:21,078 - root - INFO - noise_std 0
2023-07-17 18:12:21,078 - root - INFO - world_size 1
2023-07-17 18:12:21,078 - root - INFO - interp 0
2023-07-17 18:12:21,079 - root - INFO - use_daily_climatology False
2023-07-17 18:12:21,079 - root - INFO - global_batch_size 64
2023-07-17 18:12:21,079 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 18:12:21,079 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 18:12:21,079 - root - INFO - resuming False
2023-07-17 18:12:21,079 - root - INFO - local_rank 0
2023-07-17 18:12:21,079 - root - INFO - ---------------------------------------------------
2023-07-17 18:12:21,079 - root - INFO - Inference for 1 initial conditions
2023-07-17 18:12:21,316 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 18:12:21,317 - root - INFO - Number of samples per year: 1460
2023-07-17 18:12:21,317 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 18:12:21,317 - root - INFO - Delta t: 6 hours
2023-07-17 18:12:21,317 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 18:12:21,318 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 18:13:27,574 - root - INFO - Loading inference data
2023-07-17 18:13:27,737 - root - INFO - Initial condition 1 of 1
2023-07-17 18:14:50,154 - root - INFO - ------------------ Configuration ------------------
2023-07-17 18:14:50,154 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 18:14:50,154 - root - INFO - Configuration name: afno_backbone
2023-07-17 18:14:50,154 - root - INFO - log_to_wandb True
2023-07-17 18:14:50,154 - root - INFO - lr 0.0005
2023-07-17 18:14:50,154 - root - INFO - batch_size 64
2023-07-17 18:14:50,154 - root - INFO - max_epochs 150
2023-07-17 18:14:50,154 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 18:14:50,154 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 18:14:50,154 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 18:14:50,154 - root - INFO - orography False
2023-07-17 18:14:50,154 - root - INFO - orography_path None
2023-07-17 18:14:50,154 - root - INFO - exp_dir FourCastNet/results
2023-07-17 18:14:50,154 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 18:14:50,154 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 18:14:50,154 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 18:14:50,154 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 18:14:50,155 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 18:14:50,155 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 18:14:50,155 - root - INFO - loss l2
2023-07-17 18:14:50,155 - root - INFO - num_data_workers 4
2023-07-17 18:14:50,155 - root - INFO - dt 1
2023-07-17 18:14:50,155 - root - INFO - n_history 0
2023-07-17 18:14:50,155 - root - INFO - prediction_type iterative
2023-07-17 18:14:50,155 - root - INFO - prediction_length 20
2023-07-17 18:14:50,155 - root - INFO - n_initial_conditions 5
2023-07-17 18:14:50,155 - root - INFO - ics_type default
2023-07-17 18:14:50,155 - root - INFO - save_raw_forecasts True
2023-07-17 18:14:50,155 - root - INFO - save_channel False
2023-07-17 18:14:50,155 - root - INFO - masked_acc False
2023-07-17 18:14:50,155 - root - INFO - maskpath None
2023-07-17 18:14:50,155 - root - INFO - perturb False
2023-07-17 18:14:50,155 - root - INFO - add_grid False
2023-07-17 18:14:50,155 - root - INFO - N_grid_channels 0
2023-07-17 18:14:50,155 - root - INFO - gridtype sinusoidal
2023-07-17 18:14:50,155 - root - INFO - roll False
2023-07-17 18:14:50,155 - root - INFO - num_blocks 8
2023-07-17 18:14:50,156 - root - INFO - nettype afno
2023-07-17 18:14:50,156 - root - INFO - patch_size 8
2023-07-17 18:14:50,156 - root - INFO - width 56
2023-07-17 18:14:50,156 - root - INFO - modes 32
2023-07-17 18:14:50,156 - root - INFO - target default
2023-07-17 18:14:50,156 - root - INFO - normalization zscore
2023-07-17 18:14:50,156 - root - INFO - log_to_screen True
2023-07-17 18:14:50,156 - root - INFO - save_checkpoint True
2023-07-17 18:14:50,156 - root - INFO - enable_nhwc False
2023-07-17 18:14:50,156 - root - INFO - optimizer_type FusedAdam
2023-07-17 18:14:50,156 - root - INFO - crop_size_x None
2023-07-17 18:14:50,156 - root - INFO - crop_size_y None
2023-07-17 18:14:50,156 - root - INFO - two_step_training False
2023-07-17 18:14:50,156 - root - INFO - plot_animations False
2023-07-17 18:14:50,156 - root - INFO - add_noise False
2023-07-17 18:14:50,156 - root - INFO - noise_std 0
2023-07-17 18:14:50,156 - root - INFO - world_size 1
2023-07-17 18:14:50,156 - root - INFO - interp 0
2023-07-17 18:14:50,156 - root - INFO - use_daily_climatology False
2023-07-17 18:14:50,156 - root - INFO - global_batch_size 64
2023-07-17 18:14:50,156 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 18:14:50,156 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 18:14:50,157 - root - INFO - resuming False
2023-07-17 18:14:50,157 - root - INFO - local_rank 0
2023-07-17 18:14:50,157 - root - INFO - ---------------------------------------------------
2023-07-17 18:14:50,157 - root - INFO - Inference for 1 initial conditions
2023-07-17 18:14:50,360 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 18:14:50,361 - root - INFO - Number of samples per year: 1460
2023-07-17 18:14:50,361 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 18:14:50,361 - root - INFO - Delta t: 6 hours
2023-07-17 18:14:50,361 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 18:14:50,363 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 18:15:40,607 - root - INFO - Loading inference data
2023-07-17 18:15:40,742 - root - INFO - Initial condition 1 of 1
2023-07-17 18:17:57,502 - root - INFO - ------------------ Configuration ------------------
2023-07-17 18:17:57,502 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 18:17:57,502 - root - INFO - Configuration name: afno_backbone
2023-07-17 18:17:57,502 - root - INFO - log_to_wandb True
2023-07-17 18:17:57,502 - root - INFO - lr 0.0005
2023-07-17 18:17:57,502 - root - INFO - batch_size 64
2023-07-17 18:17:57,502 - root - INFO - max_epochs 150
2023-07-17 18:17:57,502 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 18:17:57,502 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 18:17:57,502 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 18:17:57,502 - root - INFO - orography False
2023-07-17 18:17:57,502 - root - INFO - orography_path None
2023-07-17 18:17:57,502 - root - INFO - exp_dir FourCastNet/results
2023-07-17 18:17:57,503 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 18:17:57,503 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 18:17:57,503 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 18:17:57,503 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 18:17:57,503 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 18:17:57,503 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 18:17:57,503 - root - INFO - loss l2
2023-07-17 18:17:57,503 - root - INFO - num_data_workers 4
2023-07-17 18:17:57,503 - root - INFO - dt 1
2023-07-17 18:17:57,503 - root - INFO - n_history 0
2023-07-17 18:17:57,503 - root - INFO - prediction_type iterative
2023-07-17 18:17:57,503 - root - INFO - prediction_length 10
2023-07-17 18:17:57,503 - root - INFO - n_initial_conditions 5
2023-07-17 18:17:57,503 - root - INFO - ics_type default
2023-07-17 18:17:57,503 - root - INFO - save_raw_forecasts True
2023-07-17 18:17:57,503 - root - INFO - save_channel False
2023-07-17 18:17:57,503 - root - INFO - masked_acc False
2023-07-17 18:17:57,503 - root - INFO - maskpath None
2023-07-17 18:17:57,503 - root - INFO - perturb False
2023-07-17 18:17:57,503 - root - INFO - add_grid False
2023-07-17 18:17:57,503 - root - INFO - N_grid_channels 0
2023-07-17 18:17:57,504 - root - INFO - gridtype sinusoidal
2023-07-17 18:17:57,504 - root - INFO - roll False
2023-07-17 18:17:57,504 - root - INFO - num_blocks 8
2023-07-17 18:17:57,504 - root - INFO - nettype afno
2023-07-17 18:17:57,504 - root - INFO - patch_size 8
2023-07-17 18:17:57,504 - root - INFO - width 56
2023-07-17 18:17:57,504 - root - INFO - modes 32
2023-07-17 18:17:57,504 - root - INFO - target default
2023-07-17 18:17:57,504 - root - INFO - normalization zscore
2023-07-17 18:17:57,504 - root - INFO - log_to_screen True
2023-07-17 18:17:57,504 - root - INFO - save_checkpoint True
2023-07-17 18:17:57,504 - root - INFO - enable_nhwc False
2023-07-17 18:17:57,504 - root - INFO - optimizer_type FusedAdam
2023-07-17 18:17:57,504 - root - INFO - crop_size_x None
2023-07-17 18:17:57,504 - root - INFO - crop_size_y None
2023-07-17 18:17:57,504 - root - INFO - two_step_training False
2023-07-17 18:17:57,504 - root - INFO - plot_animations False
2023-07-17 18:17:57,504 - root - INFO - add_noise False
2023-07-17 18:17:57,504 - root - INFO - noise_std 0
2023-07-17 18:17:57,504 - root - INFO - world_size 1
2023-07-17 18:17:57,504 - root - INFO - interp 0
2023-07-17 18:17:57,504 - root - INFO - use_daily_climatology False
2023-07-17 18:17:57,505 - root - INFO - global_batch_size 64
2023-07-17 18:17:57,505 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 18:17:57,505 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 18:17:57,505 - root - INFO - resuming False
2023-07-17 18:17:57,505 - root - INFO - local_rank 0
2023-07-17 18:17:57,505 - root - INFO - ---------------------------------------------------
2023-07-17 18:17:57,505 - root - INFO - Inference for 1 initial conditions
2023-07-17 18:17:57,680 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 18:17:57,680 - root - INFO - Number of samples per year: 1460
2023-07-17 18:17:57,681 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 18:17:57,681 - root - INFO - Delta t: 6 hours
2023-07-17 18:17:57,681 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 18:17:57,682 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 18:18:37,491 - root - INFO - Loading inference data
2023-07-17 18:18:37,592 - root - INFO - Initial condition 1 of 1
2023-07-17 18:19:47,768 - root - INFO - ------------------ Configuration ------------------
2023-07-17 18:19:47,768 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 18:19:47,768 - root - INFO - Configuration name: afno_backbone
2023-07-17 18:19:47,768 - root - INFO - log_to_wandb True
2023-07-17 18:19:47,768 - root - INFO - lr 0.0005
2023-07-17 18:19:47,768 - root - INFO - batch_size 64
2023-07-17 18:19:47,768 - root - INFO - max_epochs 150
2023-07-17 18:19:47,768 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 18:19:47,769 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 18:19:47,769 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 18:19:47,769 - root - INFO - orography False
2023-07-17 18:19:47,769 - root - INFO - orography_path None
2023-07-17 18:19:47,769 - root - INFO - exp_dir FourCastNet/results
2023-07-17 18:19:47,769 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 18:19:47,769 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 18:19:47,769 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 18:19:47,769 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 18:19:47,769 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 18:19:47,769 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 18:19:47,769 - root - INFO - loss l2
2023-07-17 18:19:47,769 - root - INFO - num_data_workers 4
2023-07-17 18:19:47,769 - root - INFO - dt 1
2023-07-17 18:19:47,769 - root - INFO - n_history 0
2023-07-17 18:19:47,769 - root - INFO - prediction_type iterative
2023-07-17 18:19:47,769 - root - INFO - prediction_length 9
2023-07-17 18:19:47,769 - root - INFO - n_initial_conditions 5
2023-07-17 18:19:47,769 - root - INFO - ics_type default
2023-07-17 18:19:47,769 - root - INFO - save_raw_forecasts True
2023-07-17 18:19:47,769 - root - INFO - save_channel False
2023-07-17 18:19:47,770 - root - INFO - masked_acc False
2023-07-17 18:19:47,770 - root - INFO - maskpath None
2023-07-17 18:19:47,770 - root - INFO - perturb False
2023-07-17 18:19:47,770 - root - INFO - add_grid False
2023-07-17 18:19:47,770 - root - INFO - N_grid_channels 0
2023-07-17 18:19:47,770 - root - INFO - gridtype sinusoidal
2023-07-17 18:19:47,770 - root - INFO - roll False
2023-07-17 18:19:47,770 - root - INFO - num_blocks 8
2023-07-17 18:19:47,770 - root - INFO - nettype afno
2023-07-17 18:19:47,770 - root - INFO - patch_size 8
2023-07-17 18:19:47,770 - root - INFO - width 56
2023-07-17 18:19:47,770 - root - INFO - modes 32
2023-07-17 18:19:47,770 - root - INFO - target default
2023-07-17 18:19:47,770 - root - INFO - normalization zscore
2023-07-17 18:19:47,770 - root - INFO - log_to_screen True
2023-07-17 18:19:47,770 - root - INFO - save_checkpoint True
2023-07-17 18:19:47,770 - root - INFO - enable_nhwc False
2023-07-17 18:19:47,770 - root - INFO - optimizer_type FusedAdam
2023-07-17 18:19:47,770 - root - INFO - crop_size_x None
2023-07-17 18:19:47,770 - root - INFO - crop_size_y None
2023-07-17 18:19:47,770 - root - INFO - two_step_training False
2023-07-17 18:19:47,771 - root - INFO - plot_animations False
2023-07-17 18:19:47,771 - root - INFO - add_noise False
2023-07-17 18:19:47,771 - root - INFO - noise_std 0
2023-07-17 18:19:47,771 - root - INFO - world_size 1
2023-07-17 18:19:47,771 - root - INFO - interp 0
2023-07-17 18:19:47,771 - root - INFO - use_daily_climatology False
2023-07-17 18:19:47,771 - root - INFO - global_batch_size 64
2023-07-17 18:19:47,771 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 18:19:47,771 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 18:19:47,771 - root - INFO - resuming False
2023-07-17 18:19:47,771 - root - INFO - local_rank 0
2023-07-17 18:19:47,771 - root - INFO - ---------------------------------------------------
2023-07-17 18:19:47,771 - root - INFO - Inference for 1 initial conditions
2023-07-17 18:19:47,913 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 18:19:47,914 - root - INFO - Number of samples per year: 1460
2023-07-17 18:19:47,914 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 18:19:47,914 - root - INFO - Delta t: 6 hours
2023-07-17 18:19:47,915 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 18:19:47,916 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 18:20:18,887 - root - INFO - Loading inference data
2023-07-17 18:20:18,997 - root - INFO - Initial condition 1 of 1
2023-07-17 18:20:59,780 - root - INFO - Begin autoregressive inference
2023-07-17 18:21:28,163 - root - INFO - Predicted timestep 0 of 9. u10 RMS Error: 0.0, ACC: 1.0
2023-07-17 18:21:56,492 - root - INFO - Predicted timestep 1 of 9. u10 RMS Error: 0.5590931177139282, ACC: 0.9902381896972656
2023-07-17 18:22:24,683 - root - INFO - Predicted timestep 2 of 9. u10 RMS Error: 0.7761334180831909, ACC: 0.9814416170120239
2023-07-17 18:22:52,839 - root - INFO - Predicted timestep 3 of 9. u10 RMS Error: 0.8559064865112305, ACC: 0.9776168465614319
2023-07-17 18:23:20,979 - root - INFO - Predicted timestep 4 of 9. u10 RMS Error: 0.9933351874351501, ACC: 0.9702491164207458
2023-07-17 18:23:49,085 - root - INFO - Predicted timestep 5 of 9. u10 RMS Error: 1.084041953086853, ACC: 0.9663973450660706
2023-07-17 18:24:17,336 - root - INFO - Predicted timestep 6 of 9. u10 RMS Error: 1.2145159244537354, ACC: 0.9588381052017212
2023-07-17 18:24:45,426 - root - INFO - Predicted timestep 7 of 9. u10 RMS Error: 1.322469711303711, ACC: 0.9523354768753052
2023-07-17 18:25:13,554 - root - INFO - Predicted timestep 8 of 9. u10 RMS Error: 1.4626010656356812, ACC: 0.9417334794998169
2023-07-17 18:25:13,577 - root - INFO - Saving files at /root/FourCastNet/override_dir/autoregressive_predictions_u10_vis.h5
2023-07-17 18:48:16,240 - root - INFO - ------------------ Configuration ------------------
2023-07-17 18:48:16,240 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 18:48:16,240 - root - INFO - Configuration name: afno_backbone
2023-07-17 18:48:16,240 - root - INFO - log_to_wandb True
2023-07-17 18:48:16,240 - root - INFO - lr 0.0005
2023-07-17 18:48:16,240 - root - INFO - batch_size 64
2023-07-17 18:48:16,240 - root - INFO - max_epochs 150
2023-07-17 18:48:16,241 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 18:48:16,241 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 18:48:16,241 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 18:48:16,241 - root - INFO - orography False
2023-07-17 18:48:16,241 - root - INFO - orography_path None
2023-07-17 18:48:16,241 - root - INFO - exp_dir FourCastNet/results
2023-07-17 18:48:16,241 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 18:48:16,241 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 18:48:16,241 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 18:48:16,241 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 18:48:16,241 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 18:48:16,241 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 18:48:16,241 - root - INFO - loss l2
2023-07-17 18:48:16,241 - root - INFO - num_data_workers 4
2023-07-17 18:48:16,241 - root - INFO - dt 1
2023-07-17 18:48:16,241 - root - INFO - n_history 0
2023-07-17 18:48:16,241 - root - INFO - prediction_type iterative
2023-07-17 18:48:16,241 - root - INFO - prediction_length 20
2023-07-17 18:48:16,242 - root - INFO - n_initial_conditions 5
2023-07-17 18:48:16,242 - root - INFO - ics_type default
2023-07-17 18:48:16,242 - root - INFO - save_raw_forecasts True
2023-07-17 18:48:16,242 - root - INFO - save_channel False
2023-07-17 18:48:16,242 - root - INFO - masked_acc False
2023-07-17 18:48:16,242 - root - INFO - maskpath None
2023-07-17 18:48:16,242 - root - INFO - perturb False
2023-07-17 18:48:16,242 - root - INFO - add_grid False
2023-07-17 18:48:16,242 - root - INFO - N_grid_channels 0
2023-07-17 18:48:16,242 - root - INFO - gridtype sinusoidal
2023-07-17 18:48:16,242 - root - INFO - roll False
2023-07-17 18:48:16,242 - root - INFO - num_blocks 8
2023-07-17 18:48:16,242 - root - INFO - nettype afno
2023-07-17 18:48:16,242 - root - INFO - patch_size 8
2023-07-17 18:48:16,242 - root - INFO - width 56
2023-07-17 18:48:16,242 - root - INFO - modes 32
2023-07-17 18:48:16,243 - root - INFO - target default
2023-07-17 18:48:16,243 - root - INFO - normalization zscore
2023-07-17 18:48:16,243 - root - INFO - log_to_screen True
2023-07-17 18:48:16,243 - root - INFO - save_checkpoint True
2023-07-17 18:48:16,243 - root - INFO - enable_nhwc False
2023-07-17 18:48:16,243 - root - INFO - optimizer_type FusedAdam
2023-07-17 18:48:16,243 - root - INFO - crop_size_x None
2023-07-17 18:48:16,243 - root - INFO - crop_size_y None
2023-07-17 18:48:16,243 - root - INFO - two_step_training False
2023-07-17 18:48:16,243 - root - INFO - plot_animations False
2023-07-17 18:48:16,243 - root - INFO - add_noise False
2023-07-17 18:48:16,243 - root - INFO - noise_std 0
2023-07-17 18:48:16,243 - root - INFO - world_size 1
2023-07-17 18:48:16,243 - root - INFO - interp 0
2023-07-17 18:48:16,243 - root - INFO - use_daily_climatology False
2023-07-17 18:48:16,243 - root - INFO - global_batch_size 64
2023-07-17 18:48:16,243 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 18:48:16,244 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 18:48:16,244 - root - INFO - resuming False
2023-07-17 18:48:16,244 - root - INFO - local_rank 0
2023-07-17 18:48:16,244 - root - INFO - ---------------------------------------------------
2023-07-17 18:48:16,244 - root - INFO - Inference for 1 initial conditions
2023-07-17 18:48:16,714 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 18:48:16,716 - root - INFO - Number of samples per year: 1460
2023-07-17 18:48:16,717 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 18:48:16,717 - root - INFO - Delta t: 6 hours
2023-07-17 18:48:16,717 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 18:48:16,718 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 18:49:27,293 - root - INFO - Loading inference data
2023-07-17 18:49:27,514 - root - INFO - Initial condition 1 of 1
2023-07-17 18:51:29,260 - root - INFO - Begin autoregressive inference
2023-07-17 18:51:51,542 - root - INFO - Predicted timestep 0 of 20. u10 RMS Error: 0.0, ACC: 1.0
2023-07-17 18:52:13,487 - root - INFO - Predicted timestep 1 of 20. u10 RMS Error: 0.5590931177139282, ACC: 0.9902381896972656
2023-07-17 18:52:35,478 - root - INFO - Predicted timestep 2 of 20. u10 RMS Error: 0.7761334180831909, ACC: 0.9814416170120239
2023-07-17 18:52:56,145 - root - INFO - Predicted timestep 3 of 20. u10 RMS Error: 0.8559064865112305, ACC: 0.9776168465614319
2023-07-17 18:53:16,599 - root - INFO - Predicted timestep 4 of 20. u10 RMS Error: 0.9933351874351501, ACC: 0.9702491164207458
2023-07-17 18:53:39,271 - root - INFO - Predicted timestep 5 of 20. u10 RMS Error: 1.084041953086853, ACC: 0.9663973450660706
2023-07-17 18:54:14,649 - root - INFO - ------------------ Configuration ------------------
2023-07-17 18:54:14,650 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 18:54:14,650 - root - INFO - Configuration name: afno_backbone
2023-07-17 18:54:14,650 - root - INFO - log_to_wandb True
2023-07-17 18:54:14,650 - root - INFO - lr 0.0005
2023-07-17 18:54:14,650 - root - INFO - batch_size 64
2023-07-17 18:54:14,650 - root - INFO - max_epochs 150
2023-07-17 18:54:14,650 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 18:54:14,650 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 18:54:14,650 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 18:54:14,650 - root - INFO - orography False
2023-07-17 18:54:14,650 - root - INFO - orography_path None
2023-07-17 18:54:14,650 - root - INFO - exp_dir FourCastNet/results
2023-07-17 18:54:14,650 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 18:54:14,650 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 18:54:14,651 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 18:54:14,651 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 18:54:14,651 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 18:54:14,651 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 18:54:14,651 - root - INFO - loss l2
2023-07-17 18:54:14,651 - root - INFO - num_data_workers 4
2023-07-17 18:54:14,651 - root - INFO - dt 1
2023-07-17 18:54:14,651 - root - INFO - n_history 0
2023-07-17 18:54:14,651 - root - INFO - prediction_type iterative
2023-07-17 18:54:14,651 - root - INFO - prediction_length 41
2023-07-17 18:54:14,651 - root - INFO - n_initial_conditions 5
2023-07-17 18:54:14,651 - root - INFO - ics_type default
2023-07-17 18:54:14,651 - root - INFO - save_raw_forecasts True
2023-07-17 18:54:14,651 - root - INFO - save_channel False
2023-07-17 18:54:14,652 - root - INFO - masked_acc False
2023-07-17 18:54:14,652 - root - INFO - maskpath None
2023-07-17 18:54:14,652 - root - INFO - perturb False
2023-07-17 18:54:14,652 - root - INFO - add_grid False
2023-07-17 18:54:14,652 - root - INFO - N_grid_channels 0
2023-07-17 18:54:14,652 - root - INFO - gridtype sinusoidal
2023-07-17 18:54:14,652 - root - INFO - roll False
2023-07-17 18:54:14,652 - root - INFO - num_blocks 8
2023-07-17 18:54:14,652 - root - INFO - nettype afno
2023-07-17 18:54:14,652 - root - INFO - patch_size 8
2023-07-17 18:54:14,652 - root - INFO - width 56
2023-07-17 18:54:14,652 - root - INFO - modes 32
2023-07-17 18:54:14,652 - root - INFO - target default
2023-07-17 18:54:14,652 - root - INFO - normalization zscore
2023-07-17 18:54:14,652 - root - INFO - log_to_screen True
2023-07-17 18:54:14,653 - root - INFO - save_checkpoint True
2023-07-17 18:54:14,653 - root - INFO - enable_nhwc False
2023-07-17 18:54:14,653 - root - INFO - optimizer_type FusedAdam
2023-07-17 18:54:14,653 - root - INFO - crop_size_x None
2023-07-17 18:54:14,653 - root - INFO - crop_size_y None
2023-07-17 18:54:14,653 - root - INFO - two_step_training False
2023-07-17 18:54:14,653 - root - INFO - plot_animations False
2023-07-17 18:54:14,653 - root - INFO - add_noise False
2023-07-17 18:54:14,653 - root - INFO - noise_std 0
2023-07-17 18:54:14,653 - root - INFO - world_size 1
2023-07-17 18:54:14,653 - root - INFO - interp 0
2023-07-17 18:54:14,653 - root - INFO - use_daily_climatology False
2023-07-17 18:54:14,653 - root - INFO - global_batch_size 64
2023-07-17 18:54:14,653 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 18:54:14,653 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 18:54:14,653 - root - INFO - resuming False
2023-07-17 18:54:14,653 - root - INFO - local_rank 0
2023-07-17 18:54:14,654 - root - INFO - ---------------------------------------------------
2023-07-17 18:54:14,654 - root - INFO - Inference for 1 initial conditions
2023-07-17 18:54:14,890 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 18:54:14,891 - root - INFO - Number of samples per year: 1460
2023-07-17 18:54:14,892 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 18:54:14,892 - root - INFO - Delta t: 6 hours
2023-07-17 18:54:14,892 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 18:54:14,892 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 18:55:14,908 - root - INFO - Loading inference data
2023-07-17 18:55:15,083 - root - INFO - Initial condition 1 of 1
2023-07-17 19:02:55,918 - root - INFO - ------------------ Configuration ------------------
2023-07-17 19:02:55,918 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 19:02:55,918 - root - INFO - Configuration name: afno_backbone
2023-07-17 19:02:55,919 - root - INFO - log_to_wandb True
2023-07-17 19:02:55,919 - root - INFO - lr 0.0005
2023-07-17 19:02:55,919 - root - INFO - batch_size 64
2023-07-17 19:02:55,919 - root - INFO - max_epochs 150
2023-07-17 19:02:55,919 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 19:02:55,919 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 19:02:55,919 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 19:02:55,919 - root - INFO - orography False
2023-07-17 19:02:55,919 - root - INFO - orography_path None
2023-07-17 19:02:55,919 - root - INFO - exp_dir FourCastNet/results
2023-07-17 19:02:55,919 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 19:02:55,919 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 19:02:55,919 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 19:02:55,919 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 19:02:55,919 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 19:02:55,919 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 19:02:55,919 - root - INFO - loss l2
2023-07-17 19:02:55,919 - root - INFO - num_data_workers 4
2023-07-17 19:02:55,920 - root - INFO - dt 1
2023-07-17 19:02:55,920 - root - INFO - n_history 0
2023-07-17 19:02:55,920 - root - INFO - prediction_type iterative
2023-07-17 19:02:55,920 - root - INFO - prediction_length 30
2023-07-17 19:02:55,920 - root - INFO - n_initial_conditions 5
2023-07-17 19:02:55,920 - root - INFO - ics_type default
2023-07-17 19:02:55,920 - root - INFO - save_raw_forecasts True
2023-07-17 19:02:55,920 - root - INFO - save_channel False
2023-07-17 19:02:55,920 - root - INFO - masked_acc False
2023-07-17 19:02:55,920 - root - INFO - maskpath None
2023-07-17 19:02:55,920 - root - INFO - perturb False
2023-07-17 19:02:55,920 - root - INFO - add_grid False
2023-07-17 19:02:55,920 - root - INFO - N_grid_channels 0
2023-07-17 19:02:55,920 - root - INFO - gridtype sinusoidal
2023-07-17 19:02:55,920 - root - INFO - roll False
2023-07-17 19:02:55,920 - root - INFO - num_blocks 8
2023-07-17 19:02:55,920 - root - INFO - nettype afno
2023-07-17 19:02:55,920 - root - INFO - patch_size 8
2023-07-17 19:02:55,921 - root - INFO - width 56
2023-07-17 19:02:55,921 - root - INFO - modes 32
2023-07-17 19:02:55,921 - root - INFO - target default
2023-07-17 19:02:55,921 - root - INFO - normalization zscore
2023-07-17 19:02:55,921 - root - INFO - log_to_screen True
2023-07-17 19:02:55,921 - root - INFO - save_checkpoint True
2023-07-17 19:02:55,921 - root - INFO - enable_nhwc False
2023-07-17 19:02:55,921 - root - INFO - optimizer_type FusedAdam
2023-07-17 19:02:55,921 - root - INFO - crop_size_x None
2023-07-17 19:02:55,921 - root - INFO - crop_size_y None
2023-07-17 19:02:55,921 - root - INFO - two_step_training False
2023-07-17 19:02:55,921 - root - INFO - plot_animations False
2023-07-17 19:02:55,921 - root - INFO - add_noise False
2023-07-17 19:02:55,921 - root - INFO - noise_std 0
2023-07-17 19:02:55,921 - root - INFO - world_size 1
2023-07-17 19:02:55,921 - root - INFO - interp 0
2023-07-17 19:02:55,921 - root - INFO - use_daily_climatology False
2023-07-17 19:02:55,922 - root - INFO - global_batch_size 64
2023-07-17 19:02:55,922 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 19:02:55,922 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 19:02:55,922 - root - INFO - resuming False
2023-07-17 19:02:55,922 - root - INFO - local_rank 0
2023-07-17 19:02:55,922 - root - INFO - ---------------------------------------------------
2023-07-17 19:02:55,922 - root - INFO - Inference for 1 initial conditions
2023-07-17 19:02:56,133 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 19:02:56,133 - root - INFO - Number of samples per year: 1460
2023-07-17 19:02:56,134 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 19:02:56,134 - root - INFO - Delta t: 6 hours
2023-07-17 19:02:56,134 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 19:02:56,134 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 19:03:52,513 - root - INFO - Loading inference data
2023-07-17 19:03:52,702 - root - INFO - Initial condition 1 of 1
2023-07-17 19:07:04,178 - root - INFO - ------------------ Configuration ------------------
2023-07-17 19:07:04,178 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 19:07:04,178 - root - INFO - Configuration name: afno_backbone
2023-07-17 19:07:04,179 - root - INFO - log_to_wandb True
2023-07-17 19:07:04,179 - root - INFO - lr 0.0005
2023-07-17 19:07:04,179 - root - INFO - batch_size 64
2023-07-17 19:07:04,179 - root - INFO - max_epochs 150
2023-07-17 19:07:04,179 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 19:07:04,179 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 19:07:04,179 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 19:07:04,179 - root - INFO - orography False
2023-07-17 19:07:04,179 - root - INFO - orography_path None
2023-07-17 19:07:04,179 - root - INFO - exp_dir FourCastNet/results
2023-07-17 19:07:04,179 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 19:07:04,179 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 19:07:04,179 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 19:07:04,179 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 19:07:04,180 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 19:07:04,180 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 19:07:04,180 - root - INFO - loss l2
2023-07-17 19:07:04,180 - root - INFO - num_data_workers 4
2023-07-17 19:07:04,180 - root - INFO - dt 1
2023-07-17 19:07:04,180 - root - INFO - n_history 0
2023-07-17 19:07:04,180 - root - INFO - prediction_type iterative
2023-07-17 19:07:04,180 - root - INFO - prediction_length 25
2023-07-17 19:07:04,180 - root - INFO - n_initial_conditions 5
2023-07-17 19:07:04,180 - root - INFO - ics_type default
2023-07-17 19:07:04,180 - root - INFO - save_raw_forecasts True
2023-07-17 19:07:04,180 - root - INFO - save_channel False
2023-07-17 19:07:04,180 - root - INFO - masked_acc False
2023-07-17 19:07:04,180 - root - INFO - maskpath None
2023-07-17 19:07:04,180 - root - INFO - perturb False
2023-07-17 19:07:04,180 - root - INFO - add_grid False
2023-07-17 19:07:04,180 - root - INFO - N_grid_channels 0
2023-07-17 19:07:04,180 - root - INFO - gridtype sinusoidal
2023-07-17 19:07:04,180 - root - INFO - roll False
2023-07-17 19:07:04,180 - root - INFO - num_blocks 8
2023-07-17 19:07:04,181 - root - INFO - nettype afno
2023-07-17 19:07:04,181 - root - INFO - patch_size 8
2023-07-17 19:07:04,181 - root - INFO - width 56
2023-07-17 19:07:04,181 - root - INFO - modes 32
2023-07-17 19:07:04,181 - root - INFO - target default
2023-07-17 19:07:04,181 - root - INFO - normalization zscore
2023-07-17 19:07:04,181 - root - INFO - log_to_screen True
2023-07-17 19:07:04,181 - root - INFO - save_checkpoint True
2023-07-17 19:07:04,181 - root - INFO - enable_nhwc False
2023-07-17 19:07:04,181 - root - INFO - optimizer_type FusedAdam
2023-07-17 19:07:04,181 - root - INFO - crop_size_x None
2023-07-17 19:07:04,181 - root - INFO - crop_size_y None
2023-07-17 19:07:04,181 - root - INFO - two_step_training False
2023-07-17 19:07:04,181 - root - INFO - plot_animations False
2023-07-17 19:07:04,181 - root - INFO - add_noise False
2023-07-17 19:07:04,181 - root - INFO - noise_std 0
2023-07-17 19:07:04,181 - root - INFO - world_size 1
2023-07-17 19:07:04,181 - root - INFO - interp 0
2023-07-17 19:07:04,181 - root - INFO - use_daily_climatology False
2023-07-17 19:07:04,181 - root - INFO - global_batch_size 64
2023-07-17 19:07:04,181 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 19:07:04,182 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 19:07:04,182 - root - INFO - resuming False
2023-07-17 19:07:04,182 - root - INFO - local_rank 0
2023-07-17 19:07:04,182 - root - INFO - ---------------------------------------------------
2023-07-17 19:07:04,182 - root - INFO - Inference for 1 initial conditions
2023-07-17 19:07:04,402 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 19:07:04,403 - root - INFO - Number of samples per year: 1460
2023-07-17 19:07:04,403 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 19:07:04,403 - root - INFO - Delta t: 6 hours
2023-07-17 19:07:04,403 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 19:07:04,403 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 19:07:56,195 - root - INFO - Loading inference data
2023-07-17 19:07:56,326 - root - INFO - Initial condition 1 of 1
2023-07-17 19:12:39,655 - root - INFO - ------------------ Configuration ------------------
2023-07-17 19:12:39,655 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 19:12:39,655 - root - INFO - Configuration name: afno_backbone
2023-07-17 19:12:39,655 - root - INFO - log_to_wandb True
2023-07-17 19:12:39,655 - root - INFO - lr 0.0005
2023-07-17 19:12:39,655 - root - INFO - batch_size 64
2023-07-17 19:12:39,656 - root - INFO - max_epochs 150
2023-07-17 19:12:39,656 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 19:12:39,656 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 19:12:39,656 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 19:12:39,656 - root - INFO - orography False
2023-07-17 19:12:39,656 - root - INFO - orography_path None
2023-07-17 19:12:39,656 - root - INFO - exp_dir FourCastNet/results
2023-07-17 19:12:39,656 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 19:12:39,656 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 19:12:39,656 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 19:12:39,656 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 19:12:39,656 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 19:12:39,656 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 19:12:39,656 - root - INFO - loss l2
2023-07-17 19:12:39,656 - root - INFO - num_data_workers 4
2023-07-17 19:12:39,656 - root - INFO - dt 1
2023-07-17 19:12:39,656 - root - INFO - n_history 0
2023-07-17 19:12:39,656 - root - INFO - prediction_type iterative
2023-07-17 19:12:39,656 - root - INFO - prediction_length 22
2023-07-17 19:12:39,656 - root - INFO - n_initial_conditions 5
2023-07-17 19:12:39,656 - root - INFO - ics_type default
2023-07-17 19:12:39,656 - root - INFO - save_raw_forecasts True
2023-07-17 19:12:39,657 - root - INFO - save_channel False
2023-07-17 19:12:39,657 - root - INFO - masked_acc False
2023-07-17 19:12:39,657 - root - INFO - maskpath None
2023-07-17 19:12:39,657 - root - INFO - perturb False
2023-07-17 19:12:39,657 - root - INFO - add_grid False
2023-07-17 19:12:39,657 - root - INFO - N_grid_channels 0
2023-07-17 19:12:39,657 - root - INFO - gridtype sinusoidal
2023-07-17 19:12:39,657 - root - INFO - roll False
2023-07-17 19:12:39,657 - root - INFO - num_blocks 8
2023-07-17 19:12:39,657 - root - INFO - nettype afno
2023-07-17 19:12:39,657 - root - INFO - patch_size 8
2023-07-17 19:12:39,657 - root - INFO - width 56
2023-07-17 19:12:39,657 - root - INFO - modes 32
2023-07-17 19:12:39,657 - root - INFO - target default
2023-07-17 19:12:39,657 - root - INFO - normalization zscore
2023-07-17 19:12:39,657 - root - INFO - log_to_screen True
2023-07-17 19:12:39,657 - root - INFO - save_checkpoint True
2023-07-17 19:12:39,657 - root - INFO - enable_nhwc False
2023-07-17 19:12:39,657 - root - INFO - optimizer_type FusedAdam
2023-07-17 19:12:39,658 - root - INFO - crop_size_x None
2023-07-17 19:12:39,658 - root - INFO - crop_size_y None
2023-07-17 19:12:39,658 - root - INFO - two_step_training False
2023-07-17 19:12:39,658 - root - INFO - plot_animations False
2023-07-17 19:12:39,658 - root - INFO - add_noise False
2023-07-17 19:12:39,658 - root - INFO - noise_std 0
2023-07-17 19:12:39,658 - root - INFO - world_size 1
2023-07-17 19:12:39,658 - root - INFO - interp 0
2023-07-17 19:12:39,658 - root - INFO - use_daily_climatology False
2023-07-17 19:12:39,658 - root - INFO - global_batch_size 64
2023-07-17 19:12:39,658 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 19:12:39,658 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 19:12:39,658 - root - INFO - resuming False
2023-07-17 19:12:39,658 - root - INFO - local_rank 0
2023-07-17 19:12:39,658 - root - INFO - ---------------------------------------------------
2023-07-17 19:12:39,658 - root - INFO - Inference for 1 initial conditions
2023-07-17 19:12:39,847 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 19:12:39,848 - root - INFO - Number of samples per year: 1460
2023-07-17 19:12:39,848 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 19:12:39,848 - root - INFO - Delta t: 6 hours
2023-07-17 19:12:39,848 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 19:12:39,849 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 19:13:28,280 - root - INFO - Loading inference data
2023-07-17 19:13:28,398 - root - INFO - Initial condition 1 of 1
2023-07-17 19:15:06,426 - root - INFO - Begin autoregressive inference
2023-07-17 19:15:27,520 - root - INFO - Predicted timestep 0 of 22. u10 RMS Error: 0.0, ACC: 1.0
2023-07-17 19:15:49,346 - root - INFO - Predicted timestep 1 of 22. u10 RMS Error: 0.5590931177139282, ACC: 0.9902381896972656
2023-07-17 19:16:10,937 - root - INFO - Predicted timestep 2 of 22. u10 RMS Error: 0.7761334180831909, ACC: 0.9814416170120239
2023-07-17 19:16:33,245 - root - INFO - Predicted timestep 3 of 22. u10 RMS Error: 0.8559064865112305, ACC: 0.9776168465614319
2023-07-17 19:16:54,348 - root - INFO - Predicted timestep 4 of 22. u10 RMS Error: 0.9933351874351501, ACC: 0.9702491164207458
2023-07-17 19:17:15,476 - root - INFO - Predicted timestep 5 of 22. u10 RMS Error: 1.084041953086853, ACC: 0.9663973450660706
2023-07-17 19:17:36,854 - root - INFO - Predicted timestep 6 of 22. u10 RMS Error: 1.2145159244537354, ACC: 0.9588381052017212
2023-07-17 19:17:56,773 - root - INFO - Predicted timestep 7 of 22. u10 RMS Error: 1.322469711303711, ACC: 0.9523354768753052
2023-07-17 19:18:17,439 - root - INFO - Predicted timestep 8 of 22. u10 RMS Error: 1.4626010656356812, ACC: 0.9417334794998169
2023-07-17 19:18:38,704 - root - INFO - Predicted timestep 9 of 22. u10 RMS Error: 1.6035945415496826, ACC: 0.9332709908485413
2023-07-17 19:18:59,115 - root - INFO - Predicted timestep 10 of 22. u10 RMS Error: 1.7647966146469116, ACC: 0.9193205237388611
2023-07-17 19:20:09,143 - root - INFO - ------------------ Configuration ------------------
2023-07-17 19:20:09,143 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 19:20:09,143 - root - INFO - Configuration name: afno_backbone
2023-07-17 19:20:09,143 - root - INFO - log_to_wandb True
2023-07-17 19:20:09,144 - root - INFO - lr 0.0005
2023-07-17 19:20:09,144 - root - INFO - batch_size 64
2023-07-17 19:20:09,144 - root - INFO - max_epochs 150
2023-07-17 19:20:09,144 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 19:20:09,144 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 19:20:09,144 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 19:20:09,144 - root - INFO - orography False
2023-07-17 19:20:09,144 - root - INFO - orography_path None
2023-07-17 19:20:09,144 - root - INFO - exp_dir FourCastNet/results
2023-07-17 19:20:09,144 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 19:20:09,144 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 19:20:09,144 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 19:20:09,144 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 19:20:09,144 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 19:20:09,144 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 19:20:09,144 - root - INFO - loss l2
2023-07-17 19:20:09,144 - root - INFO - num_data_workers 4
2023-07-17 19:20:09,144 - root - INFO - dt 1
2023-07-17 19:20:09,145 - root - INFO - n_history 0
2023-07-17 19:20:09,145 - root - INFO - prediction_type iterative
2023-07-17 19:20:09,145 - root - INFO - prediction_length 24
2023-07-17 19:20:09,145 - root - INFO - n_initial_conditions 5
2023-07-17 19:20:09,145 - root - INFO - ics_type default
2023-07-17 19:20:09,145 - root - INFO - save_raw_forecasts True
2023-07-17 19:20:09,145 - root - INFO - save_channel False
2023-07-17 19:20:09,145 - root - INFO - masked_acc False
2023-07-17 19:20:09,145 - root - INFO - maskpath None
2023-07-17 19:20:09,145 - root - INFO - perturb False
2023-07-17 19:20:09,145 - root - INFO - add_grid False
2023-07-17 19:20:09,145 - root - INFO - N_grid_channels 0
2023-07-17 19:20:09,145 - root - INFO - gridtype sinusoidal
2023-07-17 19:20:09,145 - root - INFO - roll False
2023-07-17 19:20:09,145 - root - INFO - num_blocks 8
2023-07-17 19:20:09,146 - root - INFO - nettype afno
2023-07-17 19:20:09,146 - root - INFO - patch_size 8
2023-07-17 19:20:09,146 - root - INFO - width 56
2023-07-17 19:20:09,146 - root - INFO - modes 32
2023-07-17 19:20:09,146 - root - INFO - target default
2023-07-17 19:20:09,146 - root - INFO - normalization zscore
2023-07-17 19:20:09,146 - root - INFO - log_to_screen True
2023-07-17 19:20:09,146 - root - INFO - save_checkpoint True
2023-07-17 19:20:09,146 - root - INFO - enable_nhwc False
2023-07-17 19:20:09,146 - root - INFO - optimizer_type FusedAdam
2023-07-17 19:20:09,146 - root - INFO - crop_size_x None
2023-07-17 19:20:09,146 - root - INFO - crop_size_y None
2023-07-17 19:20:09,146 - root - INFO - two_step_training False
2023-07-17 19:20:09,146 - root - INFO - plot_animations False
2023-07-17 19:20:09,147 - root - INFO - add_noise False
2023-07-17 19:20:09,147 - root - INFO - noise_std 0
2023-07-17 19:20:09,147 - root - INFO - world_size 1
2023-07-17 19:20:09,147 - root - INFO - interp 0
2023-07-17 19:20:09,147 - root - INFO - use_daily_climatology False
2023-07-17 19:20:09,147 - root - INFO - global_batch_size 64
2023-07-17 19:20:09,147 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 19:20:09,147 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 19:20:09,147 - root - INFO - resuming False
2023-07-17 19:20:09,147 - root - INFO - local_rank 0
2023-07-17 19:20:09,147 - root - INFO - ---------------------------------------------------
2023-07-17 19:20:09,147 - root - INFO - Inference for 1 initial conditions
2023-07-17 19:20:09,383 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 19:20:09,384 - root - INFO - Number of samples per year: 1460
2023-07-17 19:20:09,384 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 19:20:09,384 - root - INFO - Delta t: 6 hours
2023-07-17 19:20:09,384 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 19:20:09,385 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 19:21:02,258 - root - INFO - Loading inference data
2023-07-17 19:21:02,413 - root - INFO - Initial condition 1 of 1
2023-07-17 19:26:39,352 - root - INFO - ------------------ Configuration ------------------
2023-07-17 19:26:39,352 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 19:26:39,352 - root - INFO - Configuration name: afno_backbone
2023-07-17 19:26:39,352 - root - INFO - log_to_wandb True
2023-07-17 19:26:39,352 - root - INFO - lr 0.0005
2023-07-17 19:26:39,352 - root - INFO - batch_size 64
2023-07-17 19:26:39,352 - root - INFO - max_epochs 150
2023-07-17 19:26:39,352 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 19:26:39,352 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 19:26:39,352 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 19:26:39,352 - root - INFO - orography False
2023-07-17 19:26:39,352 - root - INFO - orography_path None
2023-07-17 19:26:39,353 - root - INFO - exp_dir FourCastNet/results
2023-07-17 19:26:39,353 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 19:26:39,353 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 19:26:39,353 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 19:26:39,353 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 19:26:39,353 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 19:26:39,353 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 19:26:39,353 - root - INFO - loss l2
2023-07-17 19:26:39,353 - root - INFO - num_data_workers 4
2023-07-17 19:26:39,353 - root - INFO - dt 1
2023-07-17 19:26:39,353 - root - INFO - n_history 0
2023-07-17 19:26:39,353 - root - INFO - prediction_type iterative
2023-07-17 19:26:39,353 - root - INFO - prediction_length 23
2023-07-17 19:26:39,353 - root - INFO - n_initial_conditions 5
2023-07-17 19:26:39,353 - root - INFO - ics_type default
2023-07-17 19:26:39,353 - root - INFO - save_raw_forecasts True
2023-07-17 19:26:39,353 - root - INFO - save_channel False
2023-07-17 19:26:39,353 - root - INFO - masked_acc False
2023-07-17 19:26:39,353 - root - INFO - maskpath None
2023-07-17 19:26:39,354 - root - INFO - perturb False
2023-07-17 19:26:39,354 - root - INFO - add_grid False
2023-07-17 19:26:39,354 - root - INFO - N_grid_channels 0
2023-07-17 19:26:39,354 - root - INFO - gridtype sinusoidal
2023-07-17 19:26:39,354 - root - INFO - roll False
2023-07-17 19:26:39,354 - root - INFO - num_blocks 8
2023-07-17 19:26:39,354 - root - INFO - nettype afno
2023-07-17 19:26:39,354 - root - INFO - patch_size 8
2023-07-17 19:26:39,354 - root - INFO - width 56
2023-07-17 19:26:39,354 - root - INFO - modes 32
2023-07-17 19:26:39,354 - root - INFO - target default
2023-07-17 19:26:39,354 - root - INFO - normalization zscore
2023-07-17 19:26:39,354 - root - INFO - log_to_screen True
2023-07-17 19:26:39,354 - root - INFO - save_checkpoint True
2023-07-17 19:26:39,354 - root - INFO - enable_nhwc False
2023-07-17 19:26:39,354 - root - INFO - optimizer_type FusedAdam
2023-07-17 19:26:39,354 - root - INFO - crop_size_x None
2023-07-17 19:26:39,354 - root - INFO - crop_size_y None
2023-07-17 19:26:39,354 - root - INFO - two_step_training False
2023-07-17 19:26:39,355 - root - INFO - plot_animations False
2023-07-17 19:26:39,355 - root - INFO - add_noise False
2023-07-17 19:26:39,355 - root - INFO - noise_std 0
2023-07-17 19:26:39,355 - root - INFO - world_size 1
2023-07-17 19:26:39,355 - root - INFO - interp 0
2023-07-17 19:26:39,355 - root - INFO - use_daily_climatology False
2023-07-17 19:26:39,355 - root - INFO - global_batch_size 64
2023-07-17 19:26:39,355 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 19:26:39,355 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 19:26:39,355 - root - INFO - resuming False
2023-07-17 19:26:39,355 - root - INFO - local_rank 0
2023-07-17 19:26:39,355 - root - INFO - ---------------------------------------------------
2023-07-17 19:26:39,355 - root - INFO - Inference for 1 initial conditions
2023-07-17 19:26:39,602 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 19:26:39,603 - root - INFO - Number of samples per year: 1460
2023-07-17 19:26:39,603 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 19:26:39,603 - root - INFO - Delta t: 6 hours
2023-07-17 19:26:39,603 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 19:26:39,603 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 19:27:34,216 - root - INFO - Loading inference data
2023-07-17 19:27:34,375 - root - INFO - Initial condition 1 of 1
2023-07-17 19:29:18,105 - root - INFO - Begin autoregressive inference
2023-07-17 19:29:38,925 - root - INFO - Predicted timestep 0 of 23. u10 RMS Error: 0.0, ACC: 1.0
2023-07-17 19:30:02,070 - root - INFO - Predicted timestep 1 of 23. u10 RMS Error: 0.5590931177139282, ACC: 0.9902381896972656
2023-07-17 19:30:23,375 - root - INFO - Predicted timestep 2 of 23. u10 RMS Error: 0.7761334180831909, ACC: 0.9814416170120239
2023-07-17 19:30:46,706 - root - INFO - Predicted timestep 3 of 23. u10 RMS Error: 0.8559064865112305, ACC: 0.9776168465614319
2023-07-17 19:31:07,334 - root - INFO - Predicted timestep 4 of 23. u10 RMS Error: 0.9933351874351501, ACC: 0.9702491164207458
2023-07-17 19:31:28,239 - root - INFO - Predicted timestep 5 of 23. u10 RMS Error: 1.084041953086853, ACC: 0.9663973450660706
2023-07-17 19:31:49,936 - root - INFO - Predicted timestep 6 of 23. u10 RMS Error: 1.2145159244537354, ACC: 0.9588381052017212
2023-07-17 19:32:11,411 - root - INFO - Predicted timestep 7 of 23. u10 RMS Error: 1.322469711303711, ACC: 0.9523354768753052
2023-07-17 19:32:32,804 - root - INFO - Predicted timestep 8 of 23. u10 RMS Error: 1.4626010656356812, ACC: 0.9417334794998169
2023-07-17 19:32:54,069 - root - INFO - Predicted timestep 9 of 23. u10 RMS Error: 1.6035945415496826, ACC: 0.9332709908485413
2023-07-17 19:33:14,874 - root - INFO - Predicted timestep 10 of 23. u10 RMS Error: 1.7647966146469116, ACC: 0.9193205237388611
2023-07-17 19:33:36,434 - root - INFO - Predicted timestep 11 of 23. u10 RMS Error: 1.9450163841247559, ACC: 0.9042477607727051
2023-07-17 19:33:56,903 - root - INFO - Predicted timestep 12 of 23. u10 RMS Error: 2.131335496902466, ACC: 0.884164571762085
2023-07-17 19:34:18,000 - root - INFO - Predicted timestep 13 of 23. u10 RMS Error: 2.275282144546509, ACC: 0.872995913028717
2023-07-17 19:34:39,394 - root - INFO - Predicted timestep 14 of 23. u10 RMS Error: 2.4148809909820557, ACC: 0.85841304063797
2023-07-17 19:35:00,952 - root - INFO - Predicted timestep 15 of 23. u10 RMS Error: 2.5672991275787354, ACC: 0.8366684317588806
2023-07-17 19:35:21,167 - root - INFO - Predicted timestep 16 of 23. u10 RMS Error: 2.711310386657715, ACC: 0.8093157410621643
2023-07-17 19:35:43,131 - root - INFO - Predicted timestep 17 of 23. u10 RMS Error: 2.7873690128326416, ACC: 0.7957525849342346
2023-07-17 19:36:04,009 - root - INFO - Predicted timestep 18 of 23. u10 RMS Error: 2.868622064590454, ACC: 0.7811367511749268
2023-07-17 19:36:26,084 - root - INFO - Predicted timestep 19 of 23. u10 RMS Error: 2.8856496810913086, ACC: 0.7724628448486328
2023-07-17 19:36:46,348 - root - INFO - Predicted timestep 20 of 23. u10 RMS Error: 2.9324519634246826, ACC: 0.7523570656776428
2023-07-17 19:37:06,369 - root - INFO - Predicted timestep 21 of 23. u10 RMS Error: 3.0300469398498535, ACC: 0.7418485283851624
2023-07-17 20:19:55,837 - root - INFO - ------------------ Configuration ------------------
2023-07-17 20:19:55,837 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 20:19:55,837 - root - INFO - Configuration name: afno_backbone
2023-07-17 20:19:55,837 - root - INFO - log_to_wandb True
2023-07-17 20:19:55,837 - root - INFO - lr 0.0005
2023-07-17 20:19:55,837 - root - INFO - batch_size 64
2023-07-17 20:19:55,837 - root - INFO - max_epochs 150
2023-07-17 20:19:55,837 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 20:19:55,837 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 20:19:55,837 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 20:19:55,838 - root - INFO - orography False
2023-07-17 20:19:55,838 - root - INFO - orography_path None
2023-07-17 20:19:55,838 - root - INFO - exp_dir FourCastNet/results
2023-07-17 20:19:55,838 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 20:19:55,838 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 20:19:55,838 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 20:19:55,838 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 20:19:55,838 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 20:19:55,838 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 20:19:55,838 - root - INFO - loss l2
2023-07-17 20:19:55,838 - root - INFO - num_data_workers 4
2023-07-17 20:19:55,838 - root - INFO - dt 1
2023-07-17 20:19:55,838 - root - INFO - n_history 0
2023-07-17 20:19:55,839 - root - INFO - prediction_type iterative
2023-07-17 20:19:55,839 - root - INFO - prediction_length 41
2023-07-17 20:19:55,839 - root - INFO - n_initial_conditions 5
2023-07-17 20:19:55,839 - root - INFO - ics_type default
2023-07-17 20:19:55,839 - root - INFO - save_raw_forecasts True
2023-07-17 20:19:55,839 - root - INFO - save_channel False
2023-07-17 20:19:55,839 - root - INFO - masked_acc False
2023-07-17 20:19:55,839 - root - INFO - maskpath None
2023-07-17 20:19:55,839 - root - INFO - perturb False
2023-07-17 20:19:55,839 - root - INFO - add_grid False
2023-07-17 20:19:55,839 - root - INFO - N_grid_channels 0
2023-07-17 20:19:55,839 - root - INFO - gridtype sinusoidal
2023-07-17 20:19:55,839 - root - INFO - roll False
2023-07-17 20:19:55,839 - root - INFO - num_blocks 8
2023-07-17 20:19:55,839 - root - INFO - nettype afno
2023-07-17 20:19:55,839 - root - INFO - patch_size 8
2023-07-17 20:19:55,839 - root - INFO - width 56
2023-07-17 20:19:55,840 - root - INFO - modes 32
2023-07-17 20:19:55,840 - root - INFO - target default
2023-07-17 20:19:55,840 - root - INFO - normalization zscore
2023-07-17 20:19:55,840 - root - INFO - log_to_screen True
2023-07-17 20:19:55,840 - root - INFO - save_checkpoint True
2023-07-17 20:19:55,840 - root - INFO - enable_nhwc False
2023-07-17 20:19:55,840 - root - INFO - optimizer_type FusedAdam
2023-07-17 20:19:55,840 - root - INFO - crop_size_x None
2023-07-17 20:19:55,840 - root - INFO - crop_size_y None
2023-07-17 20:19:55,840 - root - INFO - two_step_training False
2023-07-17 20:19:55,840 - root - INFO - plot_animations False
2023-07-17 20:19:55,840 - root - INFO - add_noise False
2023-07-17 20:19:55,840 - root - INFO - noise_std 0
2023-07-17 20:19:55,840 - root - INFO - world_size 1
2023-07-17 20:19:55,840 - root - INFO - interp 0
2023-07-17 20:19:55,840 - root - INFO - use_daily_climatology False
2023-07-17 20:19:55,840 - root - INFO - global_batch_size 64
2023-07-17 20:19:55,840 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 20:19:55,841 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 20:19:55,841 - root - INFO - resuming False
2023-07-17 20:19:55,841 - root - INFO - local_rank 0
2023-07-17 20:19:55,841 - root - INFO - ---------------------------------------------------
2023-07-17 20:19:55,841 - root - INFO - Inference for 1 initial conditions
2023-07-17 20:19:56,233 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 20:19:56,234 - root - INFO - Number of samples per year: 1460
2023-07-17 20:19:56,234 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 20:19:56,234 - root - INFO - Delta t: 6 hours
2023-07-17 20:19:56,234 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 20:19:56,234 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 20:21:12,270 - root - INFO - Loading inference data
2023-07-17 20:21:12,601 - root - INFO - Initial condition 1 of 1
2023-07-17 20:25:13,973 - root - INFO - Begin autoregressive inference
2023-07-17 20:25:27,353 - root - INFO - Predicted timestep 0 of 41. u10 RMS Error: 0.0, ACC: 1.0
2023-07-17 20:25:40,712 - root - INFO - Predicted timestep 1 of 41. u10 RMS Error: 0.5590931177139282, ACC: 0.9902381896972656
2023-07-17 20:25:53,859 - root - INFO - Predicted timestep 2 of 41. u10 RMS Error: 0.7761334180831909, ACC: 0.9814416170120239
2023-07-17 20:26:07,070 - root - INFO - Predicted timestep 3 of 41. u10 RMS Error: 0.8559064865112305, ACC: 0.9776168465614319
2023-07-17 20:28:27,466 - root - INFO - ------------------ Configuration ------------------
2023-07-17 20:28:27,466 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 20:28:27,466 - root - INFO - Configuration name: afno_backbone
2023-07-17 20:28:27,466 - root - INFO - log_to_wandb True
2023-07-17 20:28:27,466 - root - INFO - lr 0.0005
2023-07-17 20:28:27,467 - root - INFO - batch_size 64
2023-07-17 20:28:27,467 - root - INFO - max_epochs 150
2023-07-17 20:28:27,467 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 20:28:27,467 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 20:28:27,467 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 20:28:27,467 - root - INFO - orography False
2023-07-17 20:28:27,467 - root - INFO - orography_path None
2023-07-17 20:28:27,467 - root - INFO - exp_dir FourCastNet/results
2023-07-17 20:28:27,467 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 20:28:27,467 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 20:28:27,467 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 20:28:27,467 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 20:28:27,467 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 20:28:27,467 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 20:28:27,467 - root - INFO - loss l2
2023-07-17 20:28:27,467 - root - INFO - num_data_workers 4
2023-07-17 20:28:27,467 - root - INFO - dt 1
2023-07-17 20:28:27,467 - root - INFO - n_history 0
2023-07-17 20:28:27,467 - root - INFO - prediction_type iterative
2023-07-17 20:28:27,467 - root - INFO - prediction_length 60
2023-07-17 20:28:27,467 - root - INFO - n_initial_conditions 5
2023-07-17 20:28:27,467 - root - INFO - ics_type default
2023-07-17 20:28:27,467 - root - INFO - save_raw_forecasts True
2023-07-17 20:28:27,468 - root - INFO - save_channel False
2023-07-17 20:28:27,468 - root - INFO - masked_acc False
2023-07-17 20:28:27,468 - root - INFO - maskpath None
2023-07-17 20:28:27,468 - root - INFO - perturb False
2023-07-17 20:28:27,468 - root - INFO - add_grid False
2023-07-17 20:28:27,468 - root - INFO - N_grid_channels 0
2023-07-17 20:28:27,468 - root - INFO - gridtype sinusoidal
2023-07-17 20:28:27,468 - root - INFO - roll False
2023-07-17 20:28:27,468 - root - INFO - num_blocks 8
2023-07-17 20:28:27,468 - root - INFO - nettype afno
2023-07-17 20:28:27,468 - root - INFO - patch_size 8
2023-07-17 20:28:27,468 - root - INFO - width 56
2023-07-17 20:28:27,468 - root - INFO - modes 32
2023-07-17 20:28:27,468 - root - INFO - target default
2023-07-17 20:28:27,468 - root - INFO - normalization zscore
2023-07-17 20:28:27,468 - root - INFO - log_to_screen True
2023-07-17 20:28:27,468 - root - INFO - save_checkpoint True
2023-07-17 20:28:27,468 - root - INFO - enable_nhwc False
2023-07-17 20:28:27,468 - root - INFO - optimizer_type FusedAdam
2023-07-17 20:28:27,469 - root - INFO - crop_size_x None
2023-07-17 20:28:27,469 - root - INFO - crop_size_y None
2023-07-17 20:28:27,469 - root - INFO - two_step_training False
2023-07-17 20:28:27,469 - root - INFO - plot_animations False
2023-07-17 20:28:27,469 - root - INFO - add_noise False
2023-07-17 20:28:27,469 - root - INFO - noise_std 0
2023-07-17 20:28:27,469 - root - INFO - world_size 1
2023-07-17 20:28:27,469 - root - INFO - interp 0
2023-07-17 20:28:27,469 - root - INFO - use_daily_climatology False
2023-07-17 20:28:27,469 - root - INFO - global_batch_size 64
2023-07-17 20:28:27,469 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 20:28:27,469 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 20:28:27,469 - root - INFO - resuming False
2023-07-17 20:28:27,469 - root - INFO - local_rank 0
2023-07-17 20:28:27,469 - root - INFO - ---------------------------------------------------
2023-07-17 20:28:27,469 - root - INFO - Inference for 1 initial conditions
2023-07-17 20:28:27,716 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 20:28:27,718 - root - INFO - Number of samples per year: 1460
2023-07-17 20:28:27,718 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 20:28:27,718 - root - INFO - Delta t: 6 hours
2023-07-17 20:28:27,718 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 20:28:27,719 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 20:29:31,036 - root - INFO - Loading inference data
2023-07-17 20:29:31,336 - root - INFO - Initial condition 1 of 1
2023-07-17 20:47:45,540 - root - INFO - ------------------ Configuration ------------------
2023-07-17 20:47:45,540 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 20:47:45,540 - root - INFO - Configuration name: afno_backbone
2023-07-17 20:47:45,540 - root - INFO - log_to_wandb True
2023-07-17 20:47:45,540 - root - INFO - lr 0.0005
2023-07-17 20:47:45,540 - root - INFO - batch_size 64
2023-07-17 20:47:45,540 - root - INFO - max_epochs 150
2023-07-17 20:47:45,540 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 20:47:45,540 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 20:47:45,540 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 20:47:45,540 - root - INFO - orography False
2023-07-17 20:47:45,540 - root - INFO - orography_path None
2023-07-17 20:47:45,540 - root - INFO - exp_dir FourCastNet/results
2023-07-17 20:47:45,541 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 20:47:45,541 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 20:47:45,541 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 20:47:45,541 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 20:47:45,541 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 20:47:45,541 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 20:47:45,541 - root - INFO - loss l2
2023-07-17 20:47:45,541 - root - INFO - num_data_workers 4
2023-07-17 20:47:45,541 - root - INFO - dt 1
2023-07-17 20:47:45,541 - root - INFO - n_history 0
2023-07-17 20:47:45,541 - root - INFO - prediction_type iterative
2023-07-17 20:47:45,541 - root - INFO - prediction_length 56
2023-07-17 20:47:45,541 - root - INFO - n_initial_conditions 5
2023-07-17 20:47:45,541 - root - INFO - ics_type default
2023-07-17 20:47:45,541 - root - INFO - save_raw_forecasts True
2023-07-17 20:47:45,542 - root - INFO - save_channel False
2023-07-17 20:47:45,542 - root - INFO - masked_acc False
2023-07-17 20:47:45,542 - root - INFO - maskpath None
2023-07-17 20:47:45,542 - root - INFO - perturb False
2023-07-17 20:47:45,542 - root - INFO - add_grid False
2023-07-17 20:47:45,542 - root - INFO - N_grid_channels 0
2023-07-17 20:47:45,542 - root - INFO - gridtype sinusoidal
2023-07-17 20:47:45,542 - root - INFO - roll False
2023-07-17 20:47:45,542 - root - INFO - num_blocks 8
2023-07-17 20:47:45,542 - root - INFO - nettype afno
2023-07-17 20:47:45,542 - root - INFO - patch_size 8
2023-07-17 20:47:45,542 - root - INFO - width 56
2023-07-17 20:47:45,542 - root - INFO - modes 32
2023-07-17 20:47:45,542 - root - INFO - target default
2023-07-17 20:47:45,542 - root - INFO - normalization zscore
2023-07-17 20:47:45,542 - root - INFO - log_to_screen True
2023-07-17 20:47:45,542 - root - INFO - save_checkpoint True
2023-07-17 20:47:45,542 - root - INFO - enable_nhwc False
2023-07-17 20:47:45,542 - root - INFO - optimizer_type FusedAdam
2023-07-17 20:47:45,542 - root - INFO - crop_size_x None
2023-07-17 20:47:45,543 - root - INFO - crop_size_y None
2023-07-17 20:47:45,543 - root - INFO - two_step_training False
2023-07-17 20:47:45,543 - root - INFO - plot_animations False
2023-07-17 20:47:45,543 - root - INFO - add_noise False
2023-07-17 20:47:45,543 - root - INFO - noise_std 0
2023-07-17 20:47:45,543 - root - INFO - world_size 1
2023-07-17 20:47:45,543 - root - INFO - interp 0
2023-07-17 20:47:45,543 - root - INFO - use_daily_climatology False
2023-07-17 20:47:45,543 - root - INFO - global_batch_size 64
2023-07-17 20:47:45,543 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 20:47:45,543 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 20:47:45,543 - root - INFO - resuming False
2023-07-17 20:47:45,543 - root - INFO - local_rank 0
2023-07-17 20:47:45,543 - root - INFO - ---------------------------------------------------
2023-07-17 20:47:45,543 - root - INFO - Inference for 1 initial conditions
2023-07-17 20:47:45,868 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 20:47:45,870 - root - INFO - Number of samples per year: 1460
2023-07-17 20:47:45,871 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 20:47:45,871 - root - INFO - Delta t: 6 hours
2023-07-17 20:47:45,871 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 20:47:45,871 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 20:48:50,190 - root - INFO - Loading inference data
2023-07-17 20:48:50,391 - root - INFO - Initial condition 1 of 1
2023-07-17 20:53:58,970 - root - INFO - ------------------ Configuration ------------------
2023-07-17 20:53:58,970 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 20:53:58,970 - root - INFO - Configuration name: afno_backbone
2023-07-17 20:53:58,970 - root - INFO - log_to_wandb True
2023-07-17 20:53:58,970 - root - INFO - lr 0.0005
2023-07-17 20:53:58,970 - root - INFO - batch_size 64
2023-07-17 20:53:58,971 - root - INFO - max_epochs 150
2023-07-17 20:53:58,971 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 20:53:58,971 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 20:53:58,971 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 20:53:58,971 - root - INFO - orography False
2023-07-17 20:53:58,971 - root - INFO - orography_path None
2023-07-17 20:53:58,971 - root - INFO - exp_dir FourCastNet/results
2023-07-17 20:53:58,971 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 20:53:58,971 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 20:53:58,971 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 20:53:58,971 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 20:53:58,971 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 20:53:58,971 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 20:53:58,971 - root - INFO - loss l2
2023-07-17 20:53:58,971 - root - INFO - num_data_workers 4
2023-07-17 20:53:58,971 - root - INFO - dt 1
2023-07-17 20:53:58,971 - root - INFO - n_history 0
2023-07-17 20:53:58,971 - root - INFO - prediction_type iterative
2023-07-17 20:53:58,971 - root - INFO - prediction_length 50
2023-07-17 20:53:58,972 - root - INFO - n_initial_conditions 5
2023-07-17 20:53:58,972 - root - INFO - ics_type default
2023-07-17 20:53:58,972 - root - INFO - save_raw_forecasts True
2023-07-17 20:53:58,972 - root - INFO - save_channel False
2023-07-17 20:53:58,972 - root - INFO - masked_acc False
2023-07-17 20:53:58,972 - root - INFO - maskpath None
2023-07-17 20:53:58,972 - root - INFO - perturb False
2023-07-17 20:53:58,972 - root - INFO - add_grid False
2023-07-17 20:53:58,972 - root - INFO - N_grid_channels 0
2023-07-17 20:53:58,972 - root - INFO - gridtype sinusoidal
2023-07-17 20:53:58,972 - root - INFO - roll False
2023-07-17 20:53:58,972 - root - INFO - num_blocks 8
2023-07-17 20:53:58,972 - root - INFO - nettype afno
2023-07-17 20:53:58,972 - root - INFO - patch_size 8
2023-07-17 20:53:58,972 - root - INFO - width 56
2023-07-17 20:53:58,972 - root - INFO - modes 32
2023-07-17 20:53:58,972 - root - INFO - target default
2023-07-17 20:53:58,972 - root - INFO - normalization zscore
2023-07-17 20:53:58,972 - root - INFO - log_to_screen True
2023-07-17 20:53:58,972 - root - INFO - save_checkpoint True
2023-07-17 20:53:58,972 - root - INFO - enable_nhwc False
2023-07-17 20:53:58,973 - root - INFO - optimizer_type FusedAdam
2023-07-17 20:53:58,973 - root - INFO - crop_size_x None
2023-07-17 20:53:58,973 - root - INFO - crop_size_y None
2023-07-17 20:53:58,973 - root - INFO - two_step_training False
2023-07-17 20:53:58,973 - root - INFO - plot_animations False
2023-07-17 20:53:58,973 - root - INFO - add_noise False
2023-07-17 20:53:58,973 - root - INFO - noise_std 0
2023-07-17 20:53:58,973 - root - INFO - world_size 1
2023-07-17 20:53:58,973 - root - INFO - interp 0
2023-07-17 20:53:58,973 - root - INFO - use_daily_climatology False
2023-07-17 20:53:58,973 - root - INFO - global_batch_size 64
2023-07-17 20:53:58,973 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 20:53:58,973 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 20:53:58,973 - root - INFO - resuming False
2023-07-17 20:53:58,973 - root - INFO - local_rank 0
2023-07-17 20:53:58,973 - root - INFO - ---------------------------------------------------
2023-07-17 20:53:58,973 - root - INFO - Inference for 1 initial conditions
2023-07-17 20:53:59,211 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 20:53:59,213 - root - INFO - Number of samples per year: 1460
2023-07-17 20:53:59,213 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 20:53:59,213 - root - INFO - Delta t: 6 hours
2023-07-17 20:53:59,213 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 20:53:59,213 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 20:54:53,602 - root - INFO - Loading inference data
2023-07-17 20:54:53,767 - root - INFO - Initial condition 1 of 1
2023-07-17 20:58:31,186 - root - INFO - Begin autoregressive inference
2023-07-17 20:58:43,838 - root - INFO - Predicted timestep 0 of 50. u10 RMS Error: 0.0, ACC: 1.0
2023-07-17 20:58:57,713 - root - INFO - Predicted timestep 1 of 50. u10 RMS Error: 0.5590931177139282, ACC: 0.9902381896972656
2023-07-17 20:59:11,605 - root - INFO - Predicted timestep 2 of 50. u10 RMS Error: 0.7761334180831909, ACC: 0.9814416170120239
2023-07-17 20:59:25,304 - root - INFO - Predicted timestep 3 of 50. u10 RMS Error: 0.8559064865112305, ACC: 0.9776168465614319
2023-07-17 20:59:39,449 - root - INFO - Predicted timestep 4 of 50. u10 RMS Error: 0.9933351874351501, ACC: 0.9702491164207458
2023-07-17 20:59:52,381 - root - INFO - Predicted timestep 5 of 50. u10 RMS Error: 1.084041953086853, ACC: 0.9663973450660706
2023-07-17 21:00:35,852 - root - INFO - ------------------ Configuration ------------------
2023-07-17 21:00:35,852 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 21:00:35,852 - root - INFO - Configuration name: afno_backbone
2023-07-17 21:00:35,852 - root - INFO - log_to_wandb True
2023-07-17 21:00:35,852 - root - INFO - lr 0.0005
2023-07-17 21:00:35,852 - root - INFO - batch_size 64
2023-07-17 21:00:35,852 - root - INFO - max_epochs 150
2023-07-17 21:00:35,852 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 21:00:35,852 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 21:00:35,852 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 21:00:35,852 - root - INFO - orography False
2023-07-17 21:00:35,853 - root - INFO - orography_path None
2023-07-17 21:00:35,853 - root - INFO - exp_dir FourCastNet/results
2023-07-17 21:00:35,853 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 21:00:35,853 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 21:00:35,853 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 21:00:35,853 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 21:00:35,853 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 21:00:35,853 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 21:00:35,853 - root - INFO - loss l2
2023-07-17 21:00:35,853 - root - INFO - num_data_workers 4
2023-07-17 21:00:35,853 - root - INFO - dt 1
2023-07-17 21:00:35,853 - root - INFO - n_history 0
2023-07-17 21:00:35,853 - root - INFO - prediction_type iterative
2023-07-17 21:00:35,853 - root - INFO - prediction_length 53
2023-07-17 21:00:35,853 - root - INFO - n_initial_conditions 5
2023-07-17 21:00:35,853 - root - INFO - ics_type default
2023-07-17 21:00:35,853 - root - INFO - save_raw_forecasts True
2023-07-17 21:00:35,853 - root - INFO - save_channel False
2023-07-17 21:00:35,853 - root - INFO - masked_acc False
2023-07-17 21:00:35,853 - root - INFO - maskpath None
2023-07-17 21:00:35,854 - root - INFO - perturb False
2023-07-17 21:00:35,854 - root - INFO - add_grid False
2023-07-17 21:00:35,854 - root - INFO - N_grid_channels 0
2023-07-17 21:00:35,854 - root - INFO - gridtype sinusoidal
2023-07-17 21:00:35,854 - root - INFO - roll False
2023-07-17 21:00:35,854 - root - INFO - num_blocks 8
2023-07-17 21:00:35,854 - root - INFO - nettype afno
2023-07-17 21:00:35,854 - root - INFO - patch_size 8
2023-07-17 21:00:35,854 - root - INFO - width 56
2023-07-17 21:00:35,854 - root - INFO - modes 32
2023-07-17 21:00:35,854 - root - INFO - target default
2023-07-17 21:00:35,854 - root - INFO - normalization zscore
2023-07-17 21:00:35,854 - root - INFO - log_to_screen True
2023-07-17 21:00:35,854 - root - INFO - save_checkpoint True
2023-07-17 21:00:35,854 - root - INFO - enable_nhwc False
2023-07-17 21:00:35,854 - root - INFO - optimizer_type FusedAdam
2023-07-17 21:00:35,854 - root - INFO - crop_size_x None
2023-07-17 21:00:35,854 - root - INFO - crop_size_y None
2023-07-17 21:00:35,854 - root - INFO - two_step_training False
2023-07-17 21:00:35,854 - root - INFO - plot_animations False
2023-07-17 21:00:35,854 - root - INFO - add_noise False
2023-07-17 21:00:35,855 - root - INFO - noise_std 0
2023-07-17 21:00:35,855 - root - INFO - world_size 1
2023-07-17 21:00:35,855 - root - INFO - interp 0
2023-07-17 21:00:35,855 - root - INFO - use_daily_climatology False
2023-07-17 21:00:35,855 - root - INFO - global_batch_size 64
2023-07-17 21:00:35,855 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 21:00:35,855 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 21:00:35,855 - root - INFO - resuming False
2023-07-17 21:00:35,855 - root - INFO - local_rank 0
2023-07-17 21:00:35,855 - root - INFO - ---------------------------------------------------
2023-07-17 21:00:35,855 - root - INFO - Inference for 1 initial conditions
2023-07-17 21:00:36,064 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 21:00:36,065 - root - INFO - Number of samples per year: 1460
2023-07-17 21:00:36,065 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 21:00:36,065 - root - INFO - Delta t: 6 hours
2023-07-17 21:00:36,065 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 21:00:36,066 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 21:01:26,395 - root - INFO - Loading inference data
2023-07-17 21:01:26,619 - root - INFO - Initial condition 1 of 1
2023-07-17 21:13:42,541 - root - INFO - ------------------ Configuration ------------------
2023-07-17 21:13:42,541 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 21:13:42,541 - root - INFO - Configuration name: afno_backbone
2023-07-17 21:13:42,541 - root - INFO - log_to_wandb True
2023-07-17 21:13:42,541 - root - INFO - lr 0.0005
2023-07-17 21:13:42,541 - root - INFO - batch_size 64
2023-07-17 21:13:42,541 - root - INFO - max_epochs 150
2023-07-17 21:13:42,541 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 21:13:42,541 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 21:13:42,541 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 21:13:42,541 - root - INFO - orography False
2023-07-17 21:13:42,541 - root - INFO - orography_path None
2023-07-17 21:13:42,541 - root - INFO - exp_dir FourCastNet/results
2023-07-17 21:13:42,541 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 21:13:42,541 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 21:13:42,541 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 21:13:42,541 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 21:13:42,541 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 21:13:42,541 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 21:13:42,542 - root - INFO - loss l2
2023-07-17 21:13:42,542 - root - INFO - num_data_workers 4
2023-07-17 21:13:42,542 - root - INFO - dt 1
2023-07-17 21:13:42,542 - root - INFO - n_history 0
2023-07-17 21:13:42,542 - root - INFO - prediction_type iterative
2023-07-17 21:13:42,542 - root - INFO - prediction_length 51
2023-07-17 21:13:42,542 - root - INFO - n_initial_conditions 5
2023-07-17 21:13:42,542 - root - INFO - ics_type default
2023-07-17 21:13:42,542 - root - INFO - save_raw_forecasts True
2023-07-17 21:13:42,542 - root - INFO - save_channel False
2023-07-17 21:13:42,542 - root - INFO - masked_acc False
2023-07-17 21:13:42,542 - root - INFO - maskpath None
2023-07-17 21:13:42,542 - root - INFO - perturb False
2023-07-17 21:13:42,542 - root - INFO - add_grid False
2023-07-17 21:13:42,542 - root - INFO - N_grid_channels 0
2023-07-17 21:13:42,542 - root - INFO - gridtype sinusoidal
2023-07-17 21:13:42,542 - root - INFO - roll False
2023-07-17 21:13:42,542 - root - INFO - num_blocks 8
2023-07-17 21:13:42,542 - root - INFO - nettype afno
2023-07-17 21:13:42,542 - root - INFO - patch_size 8
2023-07-17 21:13:42,542 - root - INFO - width 56
2023-07-17 21:13:42,542 - root - INFO - modes 32
2023-07-17 21:13:42,542 - root - INFO - target default
2023-07-17 21:13:42,542 - root - INFO - normalization zscore
2023-07-17 21:13:42,542 - root - INFO - log_to_screen True
2023-07-17 21:13:42,542 - root - INFO - save_checkpoint True
2023-07-17 21:13:42,542 - root - INFO - enable_nhwc False
2023-07-17 21:13:42,543 - root - INFO - optimizer_type FusedAdam
2023-07-17 21:13:42,543 - root - INFO - crop_size_x None
2023-07-17 21:13:42,543 - root - INFO - crop_size_y None
2023-07-17 21:13:42,543 - root - INFO - two_step_training False
2023-07-17 21:13:42,543 - root - INFO - plot_animations False
2023-07-17 21:13:42,543 - root - INFO - add_noise False
2023-07-17 21:13:42,543 - root - INFO - noise_std 0
2023-07-17 21:13:42,543 - root - INFO - world_size 1
2023-07-17 21:13:42,543 - root - INFO - interp 0
2023-07-17 21:13:42,543 - root - INFO - use_daily_climatology False
2023-07-17 21:13:42,543 - root - INFO - global_batch_size 64
2023-07-17 21:13:42,543 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 21:13:42,543 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 21:13:42,543 - root - INFO - resuming False
2023-07-17 21:13:42,543 - root - INFO - local_rank 0
2023-07-17 21:13:42,543 - root - INFO - ---------------------------------------------------
2023-07-17 21:13:42,543 - root - INFO - Inference for 1 initial conditions
2023-07-17 21:13:42,959 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 21:13:42,960 - root - INFO - Number of samples per year: 1460
2023-07-17 21:13:42,960 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 21:13:42,960 - root - INFO - Delta t: 6 hours
2023-07-17 21:13:42,960 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 21:13:42,961 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 21:14:46,511 - root - INFO - Loading inference data
2023-07-17 21:14:46,825 - root - INFO - Initial condition 1 of 1
2023-07-17 21:19:02,530 - root - INFO - Begin autoregressive inference
2023-07-17 21:19:15,930 - root - INFO - Predicted timestep 0 of 51. u10 RMS Error: 0.0, ACC: 1.0
2023-07-17 21:19:30,799 - root - INFO - Predicted timestep 1 of 51. u10 RMS Error: 0.5590931177139282, ACC: 0.9902381896972656
2023-07-17 21:19:44,558 - root - INFO - Predicted timestep 2 of 51. u10 RMS Error: 0.7761334180831909, ACC: 0.9814416170120239
2023-07-17 21:19:58,902 - root - INFO - Predicted timestep 3 of 51. u10 RMS Error: 0.8559064865112305, ACC: 0.9776168465614319
2023-07-17 21:20:12,631 - root - INFO - Predicted timestep 4 of 51. u10 RMS Error: 0.9933351874351501, ACC: 0.9702491164207458
2023-07-17 21:20:26,394 - root - INFO - Predicted timestep 5 of 51. u10 RMS Error: 1.084041953086853, ACC: 0.9663973450660706
2023-07-17 21:20:38,566 - root - INFO - Predicted timestep 6 of 51. u10 RMS Error: 1.2145159244537354, ACC: 0.9588381052017212
2023-07-17 21:20:51,174 - root - INFO - Predicted timestep 7 of 51. u10 RMS Error: 1.322469711303711, ACC: 0.9523354768753052
2023-07-17 21:21:04,634 - root - INFO - Predicted timestep 8 of 51. u10 RMS Error: 1.4626010656356812, ACC: 0.9417334794998169
2023-07-17 21:21:19,022 - root - INFO - Predicted timestep 9 of 51. u10 RMS Error: 1.6035945415496826, ACC: 0.9332709908485413
2023-07-17 21:21:32,768 - root - INFO - Predicted timestep 10 of 51. u10 RMS Error: 1.7647966146469116, ACC: 0.9193205237388611
2023-07-17 21:21:45,791 - root - INFO - Predicted timestep 11 of 51. u10 RMS Error: 1.9450163841247559, ACC: 0.9042477607727051
2023-07-17 21:21:55,053 - root - INFO - ------------------ Configuration ------------------
2023-07-17 21:21:55,053 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-17 21:21:55,053 - root - INFO - Configuration name: afno_backbone
2023-07-17 21:21:55,053 - root - INFO - log_to_wandb True
2023-07-17 21:21:55,053 - root - INFO - lr 0.0005
2023-07-17 21:21:55,053 - root - INFO - batch_size 64
2023-07-17 21:21:55,053 - root - INFO - max_epochs 150
2023-07-17 21:21:55,053 - root - INFO - scheduler CosineAnnealingLR
2023-07-17 21:21:55,053 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 21:21:55,053 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-17 21:21:55,053 - root - INFO - orography False
2023-07-17 21:21:55,053 - root - INFO - orography_path None
2023-07-17 21:21:55,053 - root - INFO - exp_dir FourCastNet/results
2023-07-17 21:21:55,053 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-17 21:21:55,053 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-17 21:21:55,053 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-17 21:21:55,053 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-17 21:21:55,053 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-17 21:21:55,054 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-17 21:21:55,054 - root - INFO - loss l2
2023-07-17 21:21:55,054 - root - INFO - num_data_workers 4
2023-07-17 21:21:55,054 - root - INFO - dt 1
2023-07-17 21:21:55,054 - root - INFO - n_history 0
2023-07-17 21:21:55,054 - root - INFO - prediction_type iterative
2023-07-17 21:21:55,054 - root - INFO - prediction_length 52
2023-07-17 21:21:55,054 - root - INFO - n_initial_conditions 5
2023-07-17 21:21:55,054 - root - INFO - ics_type default
2023-07-17 21:21:55,054 - root - INFO - save_raw_forecasts True
2023-07-17 21:21:55,054 - root - INFO - save_channel False
2023-07-17 21:21:55,054 - root - INFO - masked_acc False
2023-07-17 21:21:55,054 - root - INFO - maskpath None
2023-07-17 21:21:55,054 - root - INFO - perturb False
2023-07-17 21:21:55,054 - root - INFO - add_grid False
2023-07-17 21:21:55,054 - root - INFO - N_grid_channels 0
2023-07-17 21:21:55,054 - root - INFO - gridtype sinusoidal
2023-07-17 21:21:55,054 - root - INFO - roll False
2023-07-17 21:21:55,054 - root - INFO - num_blocks 8
2023-07-17 21:21:55,054 - root - INFO - nettype afno
2023-07-17 21:21:55,054 - root - INFO - patch_size 8
2023-07-17 21:21:55,054 - root - INFO - width 56
2023-07-17 21:21:55,054 - root - INFO - modes 32
2023-07-17 21:21:55,054 - root - INFO - target default
2023-07-17 21:21:55,054 - root - INFO - normalization zscore
2023-07-17 21:21:55,055 - root - INFO - log_to_screen True
2023-07-17 21:21:55,055 - root - INFO - save_checkpoint True
2023-07-17 21:21:55,055 - root - INFO - enable_nhwc False
2023-07-17 21:21:55,055 - root - INFO - optimizer_type FusedAdam
2023-07-17 21:21:55,055 - root - INFO - crop_size_x None
2023-07-17 21:21:55,055 - root - INFO - crop_size_y None
2023-07-17 21:21:55,055 - root - INFO - two_step_training False
2023-07-17 21:21:55,055 - root - INFO - plot_animations False
2023-07-17 21:21:55,055 - root - INFO - add_noise False
2023-07-17 21:21:55,055 - root - INFO - noise_std 0
2023-07-17 21:21:55,055 - root - INFO - world_size 1
2023-07-17 21:21:55,055 - root - INFO - interp 0
2023-07-17 21:21:55,055 - root - INFO - use_daily_climatology False
2023-07-17 21:21:55,055 - root - INFO - global_batch_size 64
2023-07-17 21:21:55,055 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-17 21:21:55,055 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 21:21:55,055 - root - INFO - resuming False
2023-07-17 21:21:55,055 - root - INFO - local_rank 0
2023-07-17 21:21:55,055 - root - INFO - ---------------------------------------------------
2023-07-17 21:21:55,055 - root - INFO - Inference for 1 initial conditions
2023-07-17 21:21:55,272 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-17 21:21:55,273 - root - INFO - Number of samples per year: 1460
2023-07-17 21:21:55,273 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-17 21:21:55,273 - root - INFO - Delta t: 6 hours
2023-07-17 21:21:55,273 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-17 21:21:55,274 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-17 21:22:57,895 - root - INFO - Loading inference data
2023-07-17 21:22:58,093 - root - INFO - Initial condition 1 of 1
2023-07-17 21:27:18,942 - root - INFO - Begin autoregressive inference
2023-07-17 21:27:31,094 - root - INFO - Predicted timestep 0 of 52. u10 RMS Error: 0.0, ACC: 1.0
2023-07-17 21:27:44,459 - root - INFO - Predicted timestep 1 of 52. u10 RMS Error: 0.5590931177139282, ACC: 0.9902381896972656
2023-07-17 21:27:57,837 - root - INFO - Predicted timestep 2 of 52. u10 RMS Error: 0.7761334180831909, ACC: 0.9814416170120239
2023-07-17 21:28:10,373 - root - INFO - Predicted timestep 3 of 52. u10 RMS Error: 0.8559064865112305, ACC: 0.9776168465614319
2023-07-17 21:28:23,917 - root - INFO - Predicted timestep 4 of 52. u10 RMS Error: 0.9933351874351501, ACC: 0.9702491164207458
2023-07-17 21:28:38,421 - root - INFO - Predicted timestep 5 of 52. u10 RMS Error: 1.084041953086853, ACC: 0.9663973450660706
2023-07-17 21:28:51,382 - root - INFO - Predicted timestep 6 of 52. u10 RMS Error: 1.2145159244537354, ACC: 0.9588381052017212
2023-07-17 21:29:05,629 - root - INFO - Predicted timestep 7 of 52. u10 RMS Error: 1.322469711303711, ACC: 0.9523354768753052
2023-07-17 21:29:18,867 - root - INFO - Predicted timestep 8 of 52. u10 RMS Error: 1.4626010656356812, ACC: 0.9417334794998169
2023-07-17 21:29:31,563 - root - INFO - Predicted timestep 9 of 52. u10 RMS Error: 1.6035945415496826, ACC: 0.9332709908485413
2023-07-17 21:29:43,226 - root - INFO - Predicted timestep 10 of 52. u10 RMS Error: 1.7647966146469116, ACC: 0.9193205237388611
2023-07-17 21:29:55,443 - root - INFO - Predicted timestep 11 of 52. u10 RMS Error: 1.9450163841247559, ACC: 0.9042477607727051
2023-07-17 21:30:09,879 - root - INFO - Predicted timestep 12 of 52. u10 RMS Error: 2.131335496902466, ACC: 0.884164571762085
2023-07-17 21:30:25,461 - root - INFO - Predicted timestep 13 of 52. u10 RMS Error: 2.275282144546509, ACC: 0.872995913028717
2023-07-17 21:30:40,151 - root - INFO - Predicted timestep 14 of 52. u10 RMS Error: 2.4148809909820557, ACC: 0.85841304063797
2023-07-17 21:30:55,267 - root - INFO - Predicted timestep 15 of 52. u10 RMS Error: 2.5672991275787354, ACC: 0.8366684317588806
2023-07-17 21:31:08,599 - root - INFO - Predicted timestep 16 of 52. u10 RMS Error: 2.711310386657715, ACC: 0.8093157410621643
2023-07-17 21:31:21,279 - root - INFO - Predicted timestep 17 of 52. u10 RMS Error: 2.7873690128326416, ACC: 0.7957525849342346
2023-07-17 21:31:33,860 - root - INFO - Predicted timestep 18 of 52. u10 RMS Error: 2.868622064590454, ACC: 0.7811367511749268
2023-07-17 21:31:46,587 - root - INFO - Predicted timestep 19 of 52. u10 RMS Error: 2.8856496810913086, ACC: 0.7724628448486328
2023-07-17 21:32:00,204 - root - INFO - Predicted timestep 20 of 52. u10 RMS Error: 2.9324519634246826, ACC: 0.7523570656776428
2023-07-17 21:32:13,926 - root - INFO - Predicted timestep 21 of 52. u10 RMS Error: 3.0300469398498535, ACC: 0.7418485283851624
2023-07-17 21:32:27,781 - root - INFO - Predicted timestep 22 of 52. u10 RMS Error: 3.169504165649414, ACC: 0.7182261943817139
2023-07-17 21:32:43,254 - root - INFO - Predicted timestep 23 of 52. u10 RMS Error: 3.3011393547058105, ACC: 0.7060644030570984
2023-07-17 21:32:57,228 - root - INFO - Predicted timestep 24 of 52. u10 RMS Error: 3.415634870529175, ACC: 0.6804043054580688
2023-07-17 21:33:12,081 - root - INFO - Predicted timestep 25 of 52. u10 RMS Error: 3.522355794906616, ACC: 0.6725112199783325
2023-07-17 21:33:25,174 - root - INFO - Predicted timestep 26 of 52. u10 RMS Error: 3.641960859298706, ACC: 0.6492530703544617
2023-07-17 21:33:37,891 - root - INFO - Predicted timestep 27 of 52. u10 RMS Error: 3.7479915618896484, ACC: 0.6361474990844727
2023-07-17 21:33:51,321 - root - INFO - Predicted timestep 28 of 52. u10 RMS Error: 3.831310510635376, ACC: 0.6067420244216919
2023-07-17 21:34:03,073 - root - INFO - Predicted timestep 29 of 52. u10 RMS Error: 3.9596409797668457, ACC: 0.5893595814704895
2023-07-17 21:34:16,439 - root - INFO - Predicted timestep 30 of 52. u10 RMS Error: 4.053340435028076, ACC: 0.5607014298439026
2023-07-17 21:34:29,361 - root - INFO - Predicted timestep 31 of 52. u10 RMS Error: 4.156162261962891, ACC: 0.5356249213218689
2023-07-17 21:34:42,940 - root - INFO - Predicted timestep 32 of 52. u10 RMS Error: 4.244533061981201, ACC: 0.5063677430152893
2023-07-17 21:34:56,494 - root - INFO - Predicted timestep 33 of 52. u10 RMS Error: 4.342313289642334, ACC: 0.4784224331378937
2023-07-17 21:35:09,951 - root - INFO - Predicted timestep 34 of 52. u10 RMS Error: 4.460883140563965, ACC: 0.4332551956176758
2023-07-17 21:35:23,235 - root - INFO - Predicted timestep 35 of 52. u10 RMS Error: 4.579351425170898, ACC: 0.385954350233078
2023-07-17 21:35:35,266 - root - INFO - Predicted timestep 36 of 52. u10 RMS Error: 4.570924758911133, ACC: 0.3758653402328491
2023-07-17 21:35:48,237 - root - INFO - Predicted timestep 37 of 52. u10 RMS Error: 4.521507740020752, ACC: 0.3939049243927002
2023-07-17 21:36:00,604 - root - INFO - Predicted timestep 38 of 52. u10 RMS Error: 4.4704790115356445, ACC: 0.4139570891857147
2023-07-17 21:36:12,742 - root - INFO - Predicted timestep 39 of 52. u10 RMS Error: 4.456634998321533, ACC: 0.42036402225494385
2023-07-17 21:36:24,749 - root - INFO - Predicted timestep 40 of 52. u10 RMS Error: 4.405697345733643, ACC: 0.43691286444664
2023-07-17 21:36:37,987 - root - INFO - Predicted timestep 41 of 52. u10 RMS Error: 4.369840145111084, ACC: 0.45238208770751953
2023-07-17 21:36:51,507 - root - INFO - Predicted timestep 42 of 52. u10 RMS Error: 4.313632488250732, ACC: 0.460955411195755
2023-07-17 21:37:04,262 - root - INFO - Predicted timestep 43 of 52. u10 RMS Error: 4.315351486206055, ACC: 0.47104164958000183
2023-07-17 21:37:17,802 - root - INFO - Predicted timestep 44 of 52. u10 RMS Error: 4.310096263885498, ACC: 0.4747082591056824
2023-07-17 21:37:32,026 - root - INFO - Predicted timestep 45 of 52. u10 RMS Error: 4.437244415283203, ACC: 0.46364492177963257
2023-07-17 21:37:45,288 - root - INFO - Predicted timestep 46 of 52. u10 RMS Error: 4.478766918182373, ACC: 0.4489082396030426
2023-07-17 21:37:58,269 - root - INFO - Predicted timestep 47 of 52. u10 RMS Error: 4.458522796630859, ACC: 0.4586685001850128
2023-07-17 21:38:11,121 - root - INFO - Predicted timestep 48 of 52. u10 RMS Error: 4.426968574523926, ACC: 0.46424955129623413
2023-07-17 21:38:23,264 - root - INFO - Predicted timestep 49 of 52. u10 RMS Error: 4.568367958068848, ACC: 0.45547401905059814
2023-07-17 21:38:36,806 - root - INFO - Predicted timestep 50 of 52. u10 RMS Error: 4.816341876983643, ACC: 0.41965970396995544
2023-07-17 21:38:49,769 - root - INFO - Predicted timestep 51 of 52. u10 RMS Error: 5.113300800323486, ACC: 0.3850920796394348
2023-07-17 21:38:49,961 - root - INFO - Saving files at /root/FourCastNet/override_dir/autoregressive_predictions_u10_vis.h5
2023-07-18 17:54:14,318 - root - INFO - ------------------ Configuration ------------------
2023-07-18 17:54:14,318 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-18 17:54:14,318 - root - INFO - Configuration name: afno_backbone
2023-07-18 17:54:14,318 - root - INFO - log_to_wandb True
2023-07-18 17:54:14,318 - root - INFO - lr 0.0005
2023-07-18 17:54:14,319 - root - INFO - batch_size 64
2023-07-18 17:54:14,319 - root - INFO - max_epochs 150
2023-07-18 17:54:14,319 - root - INFO - scheduler CosineAnnealingLR
2023-07-18 17:54:14,319 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-18 17:54:14,319 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-18 17:54:14,319 - root - INFO - orography False
2023-07-18 17:54:14,319 - root - INFO - orography_path None
2023-07-18 17:54:14,319 - root - INFO - exp_dir FourCastNet/results
2023-07-18 17:54:14,319 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-18 17:54:14,319 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-18 17:54:14,319 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-18 17:54:14,319 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-18 17:54:14,319 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-18 17:54:14,319 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-18 17:54:14,319 - root - INFO - loss l2
2023-07-18 17:54:14,319 - root - INFO - num_data_workers 4
2023-07-18 17:54:14,319 - root - INFO - dt 1
2023-07-18 17:54:14,319 - root - INFO - n_history 0
2023-07-18 17:54:14,319 - root - INFO - prediction_type iterative
2023-07-18 17:54:14,319 - root - INFO - prediction_length 8
2023-07-18 17:54:14,319 - root - INFO - n_initial_conditions 5
2023-07-18 17:54:14,319 - root - INFO - ics_type default
2023-07-18 17:54:14,319 - root - INFO - save_raw_forecasts True
2023-07-18 17:54:14,319 - root - INFO - save_channel False
2023-07-18 17:54:14,319 - root - INFO - masked_acc False
2023-07-18 17:54:14,320 - root - INFO - maskpath None
2023-07-18 17:54:14,320 - root - INFO - perturb False
2023-07-18 17:54:14,320 - root - INFO - add_grid False
2023-07-18 17:54:14,320 - root - INFO - N_grid_channels 0
2023-07-18 17:54:14,320 - root - INFO - gridtype sinusoidal
2023-07-18 17:54:14,320 - root - INFO - roll False
2023-07-18 17:54:14,320 - root - INFO - num_blocks 8
2023-07-18 17:54:14,320 - root - INFO - nettype afno
2023-07-18 17:54:14,320 - root - INFO - patch_size 8
2023-07-18 17:54:14,320 - root - INFO - width 56
2023-07-18 17:54:14,320 - root - INFO - modes 32
2023-07-18 17:54:14,320 - root - INFO - target default
2023-07-18 17:54:14,320 - root - INFO - normalization zscore
2023-07-18 17:54:14,320 - root - INFO - log_to_screen True
2023-07-18 17:54:14,320 - root - INFO - save_checkpoint True
2023-07-18 17:54:14,320 - root - INFO - enable_nhwc False
2023-07-18 17:54:14,320 - root - INFO - optimizer_type FusedAdam
2023-07-18 17:54:14,320 - root - INFO - crop_size_x None
2023-07-18 17:54:14,320 - root - INFO - crop_size_y None
2023-07-18 17:54:14,320 - root - INFO - two_step_training False
2023-07-18 17:54:14,320 - root - INFO - plot_animations False
2023-07-18 17:54:14,320 - root - INFO - add_noise False
2023-07-18 17:54:14,320 - root - INFO - noise_std 0
2023-07-18 17:54:14,320 - root - INFO - world_size 1
2023-07-18 17:54:14,320 - root - INFO - interp 0
2023-07-18 17:54:14,321 - root - INFO - use_daily_climatology False
2023-07-18 17:54:14,321 - root - INFO - global_batch_size 64
2023-07-18 17:54:14,321 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-18 17:54:14,321 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-18 17:54:14,321 - root - INFO - resuming False
2023-07-18 17:54:14,321 - root - INFO - local_rank 0
2023-07-18 17:54:14,321 - root - INFO - ---------------------------------------------------
2023-07-18 17:54:14,321 - root - INFO - Inference for 1 initial conditions
2023-07-18 17:54:14,607 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-18 17:54:14,608 - root - INFO - Number of samples per year: 1460
2023-07-18 17:54:14,608 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-18 17:54:14,608 - root - INFO - Delta t: 6 hours
2023-07-18 17:54:14,608 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-18 17:54:14,609 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-18 17:55:01,418 - root - INFO - ------------------ Configuration ------------------
2023-07-18 17:55:01,419 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-07-18 17:55:01,419 - root - INFO - Configuration name: afno_backbone
2023-07-18 17:55:01,419 - root - INFO - log_to_wandb True
2023-07-18 17:55:01,419 - root - INFO - lr 0.0005
2023-07-18 17:55:01,419 - root - INFO - batch_size 64
2023-07-18 17:55:01,419 - root - INFO - max_epochs 150
2023-07-18 17:55:01,419 - root - INFO - scheduler CosineAnnealingLR
2023-07-18 17:55:01,419 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-18 17:55:01,419 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-07-18 17:55:01,419 - root - INFO - orography False
2023-07-18 17:55:01,419 - root - INFO - orography_path None
2023-07-18 17:55:01,419 - root - INFO - exp_dir FourCastNet/results
2023-07-18 17:55:01,419 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-07-18 17:55:01,419 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-07-18 17:55:01,419 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-07-18 17:55:01,419 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-07-18 17:55:01,419 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-07-18 17:55:01,420 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-07-18 17:55:01,420 - root - INFO - loss l2
2023-07-18 17:55:01,420 - root - INFO - num_data_workers 4
2023-07-18 17:55:01,420 - root - INFO - dt 1
2023-07-18 17:55:01,420 - root - INFO - n_history 0
2023-07-18 17:55:01,420 - root - INFO - prediction_type iterative
2023-07-18 17:55:01,420 - root - INFO - prediction_length 8
2023-07-18 17:55:01,420 - root - INFO - n_initial_conditions 5
2023-07-18 17:55:01,420 - root - INFO - ics_type default
2023-07-18 17:55:01,420 - root - INFO - save_raw_forecasts True
2023-07-18 17:55:01,420 - root - INFO - save_channel False
2023-07-18 17:55:01,420 - root - INFO - masked_acc False
2023-07-18 17:55:01,420 - root - INFO - maskpath None
2023-07-18 17:55:01,420 - root - INFO - perturb False
2023-07-18 17:55:01,420 - root - INFO - add_grid False
2023-07-18 17:55:01,420 - root - INFO - N_grid_channels 0
2023-07-18 17:55:01,420 - root - INFO - gridtype sinusoidal
2023-07-18 17:55:01,420 - root - INFO - roll False
2023-07-18 17:55:01,420 - root - INFO - num_blocks 8
2023-07-18 17:55:01,420 - root - INFO - nettype afno
2023-07-18 17:55:01,420 - root - INFO - patch_size 8
2023-07-18 17:55:01,421 - root - INFO - width 56
2023-07-18 17:55:01,421 - root - INFO - modes 32
2023-07-18 17:55:01,421 - root - INFO - target default
2023-07-18 17:55:01,421 - root - INFO - normalization zscore
2023-07-18 17:55:01,421 - root - INFO - log_to_screen True
2023-07-18 17:55:01,421 - root - INFO - save_checkpoint True
2023-07-18 17:55:01,421 - root - INFO - enable_nhwc False
2023-07-18 17:55:01,421 - root - INFO - optimizer_type FusedAdam
2023-07-18 17:55:01,421 - root - INFO - crop_size_x None
2023-07-18 17:55:01,421 - root - INFO - crop_size_y None
2023-07-18 17:55:01,421 - root - INFO - two_step_training False
2023-07-18 17:55:01,421 - root - INFO - plot_animations False
2023-07-18 17:55:01,421 - root - INFO - add_noise False
2023-07-18 17:55:01,421 - root - INFO - noise_std 0
2023-07-18 17:55:01,421 - root - INFO - world_size 1
2023-07-18 17:55:01,421 - root - INFO - interp 0
2023-07-18 17:55:01,421 - root - INFO - use_daily_climatology False
2023-07-18 17:55:01,421 - root - INFO - global_batch_size 64
2023-07-18 17:55:01,421 - root - INFO - experiment_dir /root/FourCastNet/override_dir
2023-07-18 17:55:01,421 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-18 17:55:01,421 - root - INFO - resuming False
2023-07-18 17:55:01,421 - root - INFO - local_rank 0
2023-07-18 17:55:01,422 - root - INFO - ---------------------------------------------------
2023-07-18 17:55:01,422 - root - INFO - Inference for 1 initial conditions
2023-07-18 17:55:01,691 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-07-18 17:55:01,692 - root - INFO - Number of samples per year: 1460
2023-07-18 17:55:01,692 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-07-18 17:55:01,692 - root - INFO - Delta t: 6 hours
2023-07-18 17:55:01,692 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-07-18 17:55:01,692 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-07-18 17:55:58,485 - root - INFO - Loading inference data
2023-07-18 17:55:58,722 - root - INFO - Initial condition 1 of 1
2023-07-18 17:56:45,503 - root - INFO - Begin autoregressive inference
2023-07-18 17:56:57,140 - root - INFO - Predicted timestep 0 of 8. u10 RMS Error: 0.0, ACC: 1.0
2023-07-18 17:57:09,443 - root - INFO - Predicted timestep 1 of 8. u10 RMS Error: 0.5590931177139282, ACC: 0.9902381896972656
2023-07-18 17:57:21,364 - root - INFO - Predicted timestep 2 of 8. u10 RMS Error: 0.7761334180831909, ACC: 0.9814416170120239
2023-07-18 17:57:33,269 - root - INFO - Predicted timestep 3 of 8. u10 RMS Error: 0.8559064865112305, ACC: 0.9776168465614319
2023-07-18 17:57:44,516 - root - INFO - Predicted timestep 4 of 8. u10 RMS Error: 0.9933351874351501, ACC: 0.9702491164207458
2023-07-18 17:57:56,125 - root - INFO - Predicted timestep 5 of 8. u10 RMS Error: 1.084041953086853, ACC: 0.9663973450660706
2023-07-18 17:58:07,417 - root - INFO - Predicted timestep 6 of 8. u10 RMS Error: 1.2145159244537354, ACC: 0.9588381052017212
2023-07-18 17:58:19,121 - root - INFO - Predicted timestep 7 of 8. u10 RMS Error: 1.322469711303711, ACC: 0.9523354768753052
2023-07-18 17:58:19,147 - root - INFO - Saving files at /root/FourCastNet/override_dir/autoregressive_predictions_u10_vis.h5
2023-08-03 18:17:27,193 - root - INFO - ------------------ Configuration ------------------
2023-08-03 18:17:27,194 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-08-03 18:17:27,194 - root - INFO - Configuration name: afno_backbone
2023-08-03 18:17:27,194 - root - INFO - log_to_wandb True
2023-08-03 18:17:27,194 - root - INFO - lr 0.0005
2023-08-03 18:17:27,194 - root - INFO - batch_size 64
2023-08-03 18:17:27,194 - root - INFO - max_epochs 150
2023-08-03 18:17:27,194 - root - INFO - scheduler CosineAnnealingLR
2023-08-03 18:17:27,194 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-08-03 18:17:27,194 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-08-03 18:17:27,194 - root - INFO - orography False
2023-08-03 18:17:27,194 - root - INFO - orography_path None
2023-08-03 18:17:27,194 - root - INFO - exp_dir ../results
2023-08-03 18:17:27,194 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-08-03 18:17:27,194 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-08-03 18:17:27,194 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-08-03 18:17:27,194 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-08-03 18:17:27,194 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-08-03 18:17:27,194 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-08-03 18:17:27,194 - root - INFO - loss l2
2023-08-03 18:17:27,194 - root - INFO - num_data_workers 4
2023-08-03 18:17:27,194 - root - INFO - dt 1
2023-08-03 18:17:27,195 - root - INFO - n_history 0
2023-08-03 18:17:27,195 - root - INFO - prediction_type iterative
2023-08-03 18:17:27,195 - root - INFO - prediction_length 8
2023-08-03 18:17:27,195 - root - INFO - n_initial_conditions 5
2023-08-03 18:17:27,195 - root - INFO - ics_type default
2023-08-03 18:17:27,195 - root - INFO - save_raw_forecasts True
2023-08-03 18:17:27,195 - root - INFO - save_channel False
2023-08-03 18:17:27,195 - root - INFO - masked_acc False
2023-08-03 18:17:27,195 - root - INFO - maskpath None
2023-08-03 18:17:27,195 - root - INFO - perturb False
2023-08-03 18:17:27,195 - root - INFO - add_grid False
2023-08-03 18:17:27,195 - root - INFO - N_grid_channels 0
2023-08-03 18:17:27,195 - root - INFO - gridtype sinusoidal
2023-08-03 18:17:27,195 - root - INFO - roll False
2023-08-03 18:17:27,195 - root - INFO - num_blocks 8
2023-08-03 18:17:27,195 - root - INFO - nettype afno
2023-08-03 18:17:27,195 - root - INFO - patch_size 8
2023-08-03 18:17:27,195 - root - INFO - width 56
2023-08-03 18:17:27,195 - root - INFO - modes 32
2023-08-03 18:17:27,195 - root - INFO - target T2m
2023-08-03 18:17:27,195 - root - INFO - normalization zscore
2023-08-03 18:17:27,195 - root - INFO - log_to_screen True
2023-08-03 18:17:27,195 - root - INFO - save_checkpoint True
2023-08-03 18:17:27,195 - root - INFO - enable_nhwc False
2023-08-03 18:17:27,195 - root - INFO - optimizer_type FusedAdam
2023-08-03 18:17:27,195 - root - INFO - crop_size_x None
2023-08-03 18:17:27,196 - root - INFO - crop_size_y None
2023-08-03 18:17:27,196 - root - INFO - two_step_training False
2023-08-03 18:17:27,196 - root - INFO - plot_animations False
2023-08-03 18:17:27,196 - root - INFO - add_noise False
2023-08-03 18:17:27,196 - root - INFO - noise_std 0
2023-08-03 18:17:27,196 - root - INFO - world_size 1
2023-08-03 18:17:27,196 - root - INFO - interp 0
2023-08-03 18:17:27,196 - root - INFO - use_daily_climatology False
2023-08-03 18:17:27,196 - root - INFO - global_batch_size 64
2023-08-03 18:17:27,196 - root - INFO - ablate T2m
2023-08-03 18:17:27,196 - root - INFO - experiment_dir /root/FourCastNet/override_dir/random
2023-08-03 18:17:27,196 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-08-03 18:17:27,196 - root - INFO - resuming False
2023-08-03 18:17:27,196 - root - INFO - local_rank 0
2023-08-03 18:17:27,196 - root - INFO - ---------------------------------------------------
2023-08-03 18:17:27,196 - root - INFO - Inference for 1 initial conditions
2023-08-03 18:17:27,608 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-08-03 18:17:27,609 - root - INFO - Number of samples per year: 1460
2023-08-03 18:17:27,609 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-08-03 18:17:27,609 - root - INFO - Delta t: 6 hours
2023-08-03 18:17:27,609 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-08-03 18:17:27,609 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-08-03 18:18:33,789 - root - INFO - Loading inference data
2023-08-03 18:18:33,790 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-08-03 18:18:34,049 - root - INFO - Initial condition 1 of 1
2023-08-03 18:18:34,283 - root - INFO - Extracting valid data from the first year
2023-08-03 18:19:07,801 - root - INFO - Standardizing data
2023-08-03 18:19:08,963 - root - INFO - Loading time means
2023-08-03 18:19:21,670 - root - INFO - Begin autoregressive inference
2023-08-03 18:19:32,274 - root - INFO - Predicted timestep 0 of 8. T2m RMS Error: 0.0, ACC: 1.0
2023-08-03 18:19:43,041 - root - INFO - Predicted timestep 1 of 8. T2m RMS Error: 147.64967346191406, ACC: 0.40856054425239563
2023-08-03 18:19:52,468 - root - INFO - Predicted timestep 2 of 8. T2m RMS Error: 686.705078125, ACC: -0.4537431001663208
2023-08-03 18:20:02,268 - root - INFO - Predicted timestep 3 of 8. T2m RMS Error: 1426.1754150390625, ACC: -0.4321102499961853
2023-08-03 18:20:11,769 - root - INFO - Predicted timestep 4 of 8. T2m RMS Error: 2247.177490234375, ACC: -0.40831249952316284
2023-08-03 18:20:21,548 - root - INFO - Predicted timestep 5 of 8. T2m RMS Error: 2997.21923828125, ACC: -0.33190909028053284
2023-08-03 18:20:30,245 - root - INFO - Predicted timestep 6 of 8. T2m RMS Error: 3598.457275390625, ACC: -0.2518332898616791
2023-08-03 18:20:38,484 - root - INFO - Predicted timestep 7 of 8. T2m RMS Error: 4048.9375, ACC: -0.2618885934352875
2023-08-03 18:20:38,506 - root - INFO - Saving files at /root/FourCastNet/override_dir/random/predict-T2m_ablate-T2m_8-timesteps_vis.h5
2023-08-03 18:30:09,215 - root - INFO - ------------------ Configuration ------------------
2023-08-03 18:30:09,215 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-08-03 18:30:09,215 - root - INFO - Configuration name: afno_backbone
2023-08-03 18:30:09,215 - root - INFO - log_to_wandb True
2023-08-03 18:30:09,216 - root - INFO - lr 0.0005
2023-08-03 18:30:09,216 - root - INFO - batch_size 64
2023-08-03 18:30:09,216 - root - INFO - max_epochs 150
2023-08-03 18:30:09,216 - root - INFO - scheduler CosineAnnealingLR
2023-08-03 18:30:09,216 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-08-03 18:30:09,216 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-08-03 18:30:09,216 - root - INFO - orography False
2023-08-03 18:30:09,216 - root - INFO - orography_path None
2023-08-03 18:30:09,216 - root - INFO - exp_dir ../results
2023-08-03 18:30:09,216 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-08-03 18:30:09,216 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-08-03 18:30:09,216 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-08-03 18:30:09,216 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-08-03 18:30:09,216 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-08-03 18:30:09,216 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-08-03 18:30:09,216 - root - INFO - loss l2
2023-08-03 18:30:09,216 - root - INFO - num_data_workers 4
2023-08-03 18:30:09,216 - root - INFO - dt 1
2023-08-03 18:30:09,216 - root - INFO - n_history 0
2023-08-03 18:30:09,216 - root - INFO - prediction_type iterative
2023-08-03 18:30:09,217 - root - INFO - prediction_length 8
2023-08-03 18:30:09,217 - root - INFO - n_initial_conditions 5
2023-08-03 18:30:09,217 - root - INFO - ics_type default
2023-08-03 18:30:09,217 - root - INFO - save_raw_forecasts True
2023-08-03 18:30:09,217 - root - INFO - save_channel False
2023-08-03 18:30:09,217 - root - INFO - masked_acc False
2023-08-03 18:30:09,217 - root - INFO - maskpath None
2023-08-03 18:30:09,217 - root - INFO - perturb False
2023-08-03 18:30:09,217 - root - INFO - add_grid False
2023-08-03 18:30:09,217 - root - INFO - N_grid_channels 0
2023-08-03 18:30:09,217 - root - INFO - gridtype sinusoidal
2023-08-03 18:30:09,217 - root - INFO - roll False
2023-08-03 18:30:09,217 - root - INFO - num_blocks 8
2023-08-03 18:30:09,217 - root - INFO - nettype afno
2023-08-03 18:30:09,217 - root - INFO - patch_size 8
2023-08-03 18:30:09,217 - root - INFO - width 56
2023-08-03 18:30:09,217 - root - INFO - modes 32
2023-08-03 18:30:09,217 - root - INFO - target T2m
2023-08-03 18:30:09,217 - root - INFO - normalization zscore
2023-08-03 18:30:09,217 - root - INFO - log_to_screen True
2023-08-03 18:30:09,217 - root - INFO - save_checkpoint True
2023-08-03 18:30:09,217 - root - INFO - enable_nhwc False
2023-08-03 18:30:09,218 - root - INFO - optimizer_type FusedAdam
2023-08-03 18:30:09,218 - root - INFO - crop_size_x None
2023-08-03 18:30:09,218 - root - INFO - crop_size_y None
2023-08-03 18:30:09,218 - root - INFO - two_step_training False
2023-08-03 18:30:09,218 - root - INFO - plot_animations False
2023-08-03 18:30:09,218 - root - INFO - add_noise False
2023-08-03 18:30:09,218 - root - INFO - noise_std 0
2023-08-03 18:30:09,218 - root - INFO - world_size 1
2023-08-03 18:30:09,218 - root - INFO - interp 0
2023-08-03 18:30:09,218 - root - INFO - use_daily_climatology False
2023-08-03 18:30:09,219 - root - INFO - global_batch_size 64
2023-08-03 18:30:09,219 - root - INFO - ablate T2m
2023-08-03 18:30:09,219 - root - INFO - experiment_dir /root/FourCastNet/override_dir/random
2023-08-03 18:30:09,219 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-08-03 18:30:09,219 - root - INFO - resuming False
2023-08-03 18:30:09,219 - root - INFO - local_rank 0
2023-08-03 18:30:09,219 - root - INFO - ---------------------------------------------------
2023-08-03 18:30:09,219 - root - INFO - Inference for 1 initial conditions
2023-08-03 18:30:09,553 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-08-03 18:30:09,554 - root - INFO - Number of samples per year: 1460
2023-08-03 18:30:09,554 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-08-03 18:30:09,554 - root - INFO - Delta t: 6 hours
2023-08-03 18:30:09,554 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-08-03 18:30:09,555 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-08-03 18:31:06,371 - root - INFO - Loading inference data
2023-08-03 18:31:06,372 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-08-03 18:31:06,649 - root - INFO - Initial condition 1 of 1
2023-08-03 18:31:06,854 - root - INFO - Extracting valid data from the first year
2023-08-03 18:31:37,964 - root - INFO - Standardizing data
2023-08-03 18:31:38,950 - root - INFO - Loading time means
2023-08-03 18:31:53,486 - root - INFO - Begin autoregressive inference
2023-08-03 18:32:02,307 - root - INFO - Predicted timestep 0 of 8. T2m RMS Error: 0.0, ACC: 1.0
2023-08-03 18:32:11,271 - root - INFO - Predicted timestep 1 of 8. T2m RMS Error: 0.7502903938293457, ACC: 0.9969218373298645
2023-08-03 18:32:20,223 - root - INFO - Predicted timestep 2 of 8. T2m RMS Error: 0.8730559945106506, ACC: 0.9957129955291748
2023-08-03 18:32:29,288 - root - INFO - Predicted timestep 3 of 8. T2m RMS Error: 0.9344302415847778, ACC: 0.9950171709060669
2023-08-03 18:32:38,333 - root - INFO - Predicted timestep 4 of 8. T2m RMS Error: 0.9774948954582214, ACC: 0.9949641227722168
2023-08-03 18:32:46,161 - root - INFO - Predicted timestep 5 of 8. T2m RMS Error: 1.0328140258789062, ACC: 0.9941373467445374
2023-08-03 18:32:54,849 - root - INFO - Predicted timestep 6 of 8. T2m RMS Error: 1.06240713596344, ACC: 0.993396520614624
2023-08-03 18:33:03,829 - root - INFO - Predicted timestep 7 of 8. T2m RMS Error: 1.1067156791687012, ACC: 0.9927569031715393
2023-08-03 18:33:03,851 - root - INFO - Saving files at /root/FourCastNet/override_dir/random/predict-T2m_ablate-T2m_8-timesteps_vis.h5
2023-08-07 21:59:24,100 - root - INFO - ------------------ Configuration ------------------
2023-08-07 21:59:24,100 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-08-07 21:59:24,100 - root - INFO - Configuration name: afno_backbone
2023-08-07 21:59:24,100 - root - INFO - log_to_wandb True
2023-08-07 21:59:24,100 - root - INFO - lr 0.0005
2023-08-07 21:59:24,100 - root - INFO - batch_size 64
2023-08-07 21:59:24,100 - root - INFO - max_epochs 150
2023-08-07 21:59:24,101 - root - INFO - scheduler CosineAnnealingLR
2023-08-07 21:59:24,101 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-08-07 21:59:24,101 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-08-07 21:59:24,101 - root - INFO - orography False
2023-08-07 21:59:24,101 - root - INFO - orography_path None
2023-08-07 21:59:24,101 - root - INFO - exp_dir ../results
2023-08-07 21:59:24,101 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-08-07 21:59:24,101 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-08-07 21:59:24,101 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-08-07 21:59:24,101 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-08-07 21:59:24,101 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-08-07 21:59:24,101 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-08-07 21:59:24,101 - root - INFO - loss l2
2023-08-07 21:59:24,101 - root - INFO - num_data_workers 4
2023-08-07 21:59:24,101 - root - INFO - dt 1
2023-08-07 21:59:24,101 - root - INFO - n_history 0
2023-08-07 21:59:24,101 - root - INFO - prediction_type iterative
2023-08-07 21:59:24,101 - root - INFO - prediction_length 5
2023-08-07 21:59:24,101 - root - INFO - n_initial_conditions 5
2023-08-07 21:59:24,101 - root - INFO - ics_type default
2023-08-07 21:59:24,101 - root - INFO - save_raw_forecasts True
2023-08-07 21:59:24,101 - root - INFO - save_channel False
2023-08-07 21:59:24,101 - root - INFO - masked_acc False
2023-08-07 21:59:24,101 - root - INFO - maskpath None
2023-08-07 21:59:24,101 - root - INFO - perturb False
2023-08-07 21:59:24,102 - root - INFO - add_grid False
2023-08-07 21:59:24,102 - root - INFO - N_grid_channels 0
2023-08-07 21:59:24,102 - root - INFO - gridtype sinusoidal
2023-08-07 21:59:24,102 - root - INFO - roll False
2023-08-07 21:59:24,102 - root - INFO - num_blocks 8
2023-08-07 21:59:24,102 - root - INFO - nettype afno
2023-08-07 21:59:24,102 - root - INFO - patch_size 8
2023-08-07 21:59:24,102 - root - INFO - width 56
2023-08-07 21:59:24,102 - root - INFO - modes 32
2023-08-07 21:59:24,102 - root - INFO - target T2m
2023-08-07 21:59:24,102 - root - INFO - normalization zscore
2023-08-07 21:59:24,102 - root - INFO - log_to_screen True
2023-08-07 21:59:24,102 - root - INFO - save_checkpoint True
2023-08-07 21:59:24,102 - root - INFO - enable_nhwc False
2023-08-07 21:59:24,102 - root - INFO - optimizer_type FusedAdam
2023-08-07 21:59:24,102 - root - INFO - crop_size_x None
2023-08-07 21:59:24,102 - root - INFO - crop_size_y None
2023-08-07 21:59:24,102 - root - INFO - two_step_training False
2023-08-07 21:59:24,102 - root - INFO - plot_animations False
2023-08-07 21:59:24,102 - root - INFO - add_noise False
2023-08-07 21:59:24,102 - root - INFO - noise_std 0
2023-08-07 21:59:24,102 - root - INFO - world_size 1
2023-08-07 21:59:24,102 - root - INFO - interp 0
2023-08-07 21:59:24,102 - root - INFO - use_daily_climatology False
2023-08-07 21:59:24,102 - root - INFO - global_batch_size 64
2023-08-07 21:59:24,102 - root - INFO - ablate T2m
2023-08-07 21:59:24,103 - root - INFO - experiment_dir /root/FourCastNet/override_dir/random
2023-08-07 21:59:24,103 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-08-07 21:59:24,103 - root - INFO - resuming False
2023-08-07 21:59:24,103 - root - INFO - local_rank 0
2023-08-07 21:59:24,103 - root - INFO - ---------------------------------------------------
2023-08-07 21:59:24,103 - root - INFO - Inference for 1 initial conditions
2023-08-07 21:59:24,440 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-08-07 21:59:24,441 - root - INFO - Number of samples per year: 1460
2023-08-07 21:59:24,441 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-08-07 21:59:24,441 - root - INFO - Delta t: 6 hours
2023-08-07 21:59:24,441 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-08-07 21:59:24,442 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-08-07 22:00:17,965 - root - INFO - Loading inference data
2023-08-07 22:00:17,966 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-08-07 22:00:18,185 - root - INFO - Initial condition 1 of 1
2023-08-07 22:00:18,384 - root - INFO - Extracting valid data from the first year
2023-08-07 22:00:39,807 - root - INFO - Standardizing data
2023-08-07 22:00:40,597 - root - INFO - Loading time means
2023-08-07 22:00:51,767 - root - INFO - Begin autoregressive inference
2023-08-07 22:01:03,603 - root - INFO - Predicted timestep 0 of 5. T2m RMS Error: 0.0, ACC: 1.0
2023-08-07 22:01:17,053 - root - INFO - Predicted timestep 1 of 5. T2m RMS Error: 0.7502903938293457, ACC: 0.9969218373298645
2023-08-07 22:01:28,339 - root - INFO - Predicted timestep 2 of 5. T2m RMS Error: 0.8730559945106506, ACC: 0.9957129955291748
2023-08-07 22:01:40,585 - root - INFO - Predicted timestep 3 of 5. T2m RMS Error: 0.9344302415847778, ACC: 0.9950171709060669
2023-08-07 22:01:52,016 - root - INFO - Predicted timestep 4 of 5. T2m RMS Error: 0.9774948954582214, ACC: 0.9949641227722168
2023-08-07 22:01:52,030 - root - INFO - Saving files at /root/FourCastNet/override_dir/random/predict-T2m_ablate-T2m_5-timesteps_vis.h5
2023-08-07 23:20:18,367 - root - INFO - ------------------ Configuration ------------------
2023-08-07 23:20:18,368 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-08-07 23:20:18,368 - root - INFO - Configuration name: afno_backbone
2023-08-07 23:20:18,368 - root - INFO - log_to_wandb True
2023-08-07 23:20:18,368 - root - INFO - lr 0.0005
2023-08-07 23:20:18,368 - root - INFO - batch_size 64
2023-08-07 23:20:18,368 - root - INFO - max_epochs 150
2023-08-07 23:20:18,368 - root - INFO - scheduler CosineAnnealingLR
2023-08-07 23:20:18,369 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-08-07 23:20:18,369 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-08-07 23:20:18,370 - root - INFO - orography False
2023-08-07 23:20:18,370 - root - INFO - orography_path None
2023-08-07 23:20:18,370 - root - INFO - exp_dir ../results
2023-08-07 23:20:18,370 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-08-07 23:20:18,370 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-08-07 23:20:18,370 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-08-07 23:20:18,370 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-08-07 23:20:18,370 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-08-07 23:20:18,370 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-08-07 23:20:18,370 - root - INFO - loss l2
2023-08-07 23:20:18,370 - root - INFO - num_data_workers 4
2023-08-07 23:20:18,370 - root - INFO - dt 1
2023-08-07 23:20:18,370 - root - INFO - n_history 0
2023-08-07 23:20:18,371 - root - INFO - prediction_type iterative
2023-08-07 23:20:18,371 - root - INFO - prediction_length 9
2023-08-07 23:20:18,371 - root - INFO - n_initial_conditions 5
2023-08-07 23:20:18,371 - root - INFO - ics_type default
2023-08-07 23:20:18,371 - root - INFO - save_raw_forecasts True
2023-08-07 23:20:18,371 - root - INFO - save_channel False
2023-08-07 23:20:18,373 - root - INFO - masked_acc False
2023-08-07 23:20:18,373 - root - INFO - maskpath None
2023-08-07 23:20:18,373 - root - INFO - perturb False
2023-08-07 23:20:18,373 - root - INFO - add_grid False
2023-08-07 23:20:18,373 - root - INFO - N_grid_channels 0
2023-08-07 23:20:18,373 - root - INFO - gridtype sinusoidal
2023-08-07 23:20:18,373 - root - INFO - roll False
2023-08-07 23:20:18,373 - root - INFO - num_blocks 8
2023-08-07 23:20:18,373 - root - INFO - nettype afno
2023-08-07 23:20:18,373 - root - INFO - patch_size 8
2023-08-07 23:20:18,373 - root - INFO - width 56
2023-08-07 23:20:18,373 - root - INFO - modes 32
2023-08-07 23:20:18,373 - root - INFO - target T2m
2023-08-07 23:20:18,373 - root - INFO - normalization zscore
2023-08-07 23:20:18,373 - root - INFO - log_to_screen True
2023-08-07 23:20:18,374 - root - INFO - save_checkpoint True
2023-08-07 23:20:18,374 - root - INFO - enable_nhwc False
2023-08-07 23:20:18,374 - root - INFO - optimizer_type FusedAdam
2023-08-07 23:20:18,374 - root - INFO - crop_size_x None
2023-08-07 23:20:18,374 - root - INFO - crop_size_y None
2023-08-07 23:20:18,374 - root - INFO - two_step_training False
2023-08-07 23:20:18,374 - root - INFO - plot_animations False
2023-08-07 23:20:18,374 - root - INFO - add_noise False
2023-08-07 23:20:18,374 - root - INFO - noise_std 0
2023-08-07 23:20:18,374 - root - INFO - world_size 1
2023-08-07 23:20:18,374 - root - INFO - interp 0
2023-08-07 23:20:18,375 - root - INFO - use_daily_climatology False
2023-08-07 23:20:18,375 - root - INFO - global_batch_size 64
2023-08-07 23:20:18,375 - root - INFO - ablate T2m
2023-08-07 23:20:18,375 - root - INFO - experiment_dir /root/FourCastNet/override_dir/random
2023-08-07 23:20:18,375 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-08-07 23:20:18,375 - root - INFO - resuming False
2023-08-07 23:20:18,375 - root - INFO - local_rank 0
2023-08-07 23:20:18,375 - root - INFO - ---------------------------------------------------
2023-08-07 23:20:18,375 - root - INFO - Inference for 1 initial conditions
2023-08-07 23:20:18,721 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-08-07 23:20:18,722 - root - INFO - Number of samples per year: 1460
2023-08-07 23:20:18,722 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-08-07 23:20:18,722 - root - INFO - Delta t: 6 hours
2023-08-07 23:20:18,722 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-08-07 23:20:18,722 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-08-07 23:21:12,779 - root - INFO - Loading inference data
2023-08-07 23:21:12,781 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-08-07 23:21:13,044 - root - INFO - Initial condition 1 of 1
2023-08-07 23:21:13,372 - root - INFO - Extracting valid data from the first year
2023-08-07 23:21:46,972 - root - INFO - Standardizing data
2023-08-07 23:21:48,399 - root - INFO - Loading time means
2023-08-07 23:21:59,914 - root - INFO - Begin autoregressive inference
2023-08-07 23:22:12,310 - root - INFO - Predicted timestep 0 of 9. T2m RMS Error: 0.0, ACC: 1.0
2023-08-07 23:22:27,341 - root - INFO - Predicted timestep 1 of 9. T2m RMS Error: 0.0, ACC: 1.0
2023-08-07 23:22:39,410 - root - INFO - Predicted timestep 2 of 9. T2m RMS Error: 0.0, ACC: 1.0
2023-08-07 23:22:51,896 - root - INFO - Predicted timestep 3 of 9. T2m RMS Error: 0.0, ACC: 1.0
2023-08-07 23:23:04,846 - root - INFO - Predicted timestep 4 of 9. T2m RMS Error: 0.0, ACC: 1.0
2023-08-07 23:23:19,161 - root - INFO - Predicted timestep 5 of 9. T2m RMS Error: 0.0, ACC: 1.0
2023-08-07 23:23:32,363 - root - INFO - Predicted timestep 6 of 9. T2m RMS Error: 0.0, ACC: 1.0
2023-08-07 23:23:44,985 - root - INFO - Predicted timestep 7 of 9. T2m RMS Error: 0.0, ACC: 1.0
2023-08-07 23:23:57,719 - root - INFO - Predicted timestep 8 of 9. T2m RMS Error: 0.0, ACC: 1.0
2023-08-07 23:23:57,754 - root - INFO - Saving files at /root/FourCastNet/override_dir/random/predict-T2m_ablate-T2m_9-timesteps_vis.h5
2023-08-07 23:28:49,152 - root - INFO - ------------------ Configuration ------------------
2023-08-07 23:28:49,152 - root - INFO - Configuration file: /root/FourCastNet/config/AFNO.yaml
2023-08-07 23:28:49,152 - root - INFO - Configuration name: afno_backbone
2023-08-07 23:28:49,152 - root - INFO - log_to_wandb True
2023-08-07 23:28:49,152 - root - INFO - lr 0.0005
2023-08-07 23:28:49,153 - root - INFO - batch_size 64
2023-08-07 23:28:49,153 - root - INFO - max_epochs 150
2023-08-07 23:28:49,153 - root - INFO - scheduler CosineAnnealingLR
2023-08-07 23:28:49,153 - root - INFO - in_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-08-07 23:28:49,153 - root - INFO - out_channels [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2023-08-07 23:28:49,153 - root - INFO - orography False
2023-08-07 23:28:49,153 - root - INFO - orography_path None
2023-08-07 23:28:49,153 - root - INFO - exp_dir ../results
2023-08-07 23:28:49,153 - root - INFO - train_data_path /pscratch/sd/s/shas1693/data/era5/train
2023-08-07 23:28:49,153 - root - INFO - valid_data_path /pscratch/sd/s/shas1693/data/era5/test
2023-08-07 23:28:49,153 - root - INFO - inf_data_path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-08-07 23:28:49,153 - root - INFO - time_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/time_means.npy
2023-08-07 23:28:49,153 - root - INFO - global_means_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_means.npy
2023-08-07 23:28:49,153 - root - INFO - global_stds_path s3://climate-ai-data-science-sandbox-fourcastnet/stats_v0/global_stds.npy
2023-08-07 23:28:49,153 - root - INFO - loss l2
2023-08-07 23:28:49,153 - root - INFO - num_data_workers 4
2023-08-07 23:28:49,153 - root - INFO - dt 1
2023-08-07 23:28:49,153 - root - INFO - n_history 0
2023-08-07 23:28:49,153 - root - INFO - prediction_type iterative
2023-08-07 23:28:49,153 - root - INFO - prediction_length 9
2023-08-07 23:28:49,153 - root - INFO - n_initial_conditions 5
2023-08-07 23:28:49,153 - root - INFO - ics_type default
2023-08-07 23:28:49,153 - root - INFO - save_raw_forecasts True
2023-08-07 23:28:49,153 - root - INFO - save_channel False
2023-08-07 23:28:49,153 - root - INFO - masked_acc False
2023-08-07 23:28:49,153 - root - INFO - maskpath None
2023-08-07 23:28:49,154 - root - INFO - perturb False
2023-08-07 23:28:49,154 - root - INFO - add_grid False
2023-08-07 23:28:49,154 - root - INFO - N_grid_channels 0
2023-08-07 23:28:49,154 - root - INFO - gridtype sinusoidal
2023-08-07 23:28:49,154 - root - INFO - roll False
2023-08-07 23:28:49,155 - root - INFO - num_blocks 8
2023-08-07 23:28:49,155 - root - INFO - nettype afno
2023-08-07 23:28:49,155 - root - INFO - patch_size 8
2023-08-07 23:28:49,155 - root - INFO - width 56
2023-08-07 23:28:49,155 - root - INFO - modes 32
2023-08-07 23:28:49,155 - root - INFO - target V10
2023-08-07 23:28:49,155 - root - INFO - normalization zscore
2023-08-07 23:28:49,155 - root - INFO - log_to_screen True
2023-08-07 23:28:49,155 - root - INFO - save_checkpoint True
2023-08-07 23:28:49,155 - root - INFO - enable_nhwc False
2023-08-07 23:28:49,155 - root - INFO - optimizer_type FusedAdam
2023-08-07 23:28:49,156 - root - INFO - crop_size_x None
2023-08-07 23:28:49,156 - root - INFO - crop_size_y None
2023-08-07 23:28:49,156 - root - INFO - two_step_training False
2023-08-07 23:28:49,156 - root - INFO - plot_animations False
2023-08-07 23:28:49,156 - root - INFO - add_noise False
2023-08-07 23:28:49,156 - root - INFO - noise_std 0
2023-08-07 23:28:49,156 - root - INFO - world_size 1
2023-08-07 23:28:49,156 - root - INFO - interp 0
2023-08-07 23:28:49,156 - root - INFO - use_daily_climatology False
2023-08-07 23:28:49,157 - root - INFO - global_batch_size 64
2023-08-07 23:28:49,157 - root - INFO - ablate V10
2023-08-07 23:28:49,157 - root - INFO - experiment_dir /root/FourCastNet/override_dir/random
2023-08-07 23:28:49,157 - root - INFO - best_checkpoint_path s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-08-07 23:28:49,157 - root - INFO - resuming False
2023-08-07 23:28:49,157 - root - INFO - local_rank 0
2023-08-07 23:28:49,157 - root - INFO - ---------------------------------------------------
2023-08-07 23:28:49,157 - root - INFO - Inference for 1 initial conditions
2023-08-07 23:28:49,448 - root - INFO - Getting file stats from <File-like object S3FileSystem, climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5>
2023-08-07 23:28:49,449 - root - INFO - Number of samples per year: 1460
2023-08-07 23:28:49,449 - root - INFO - Found data at path s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5. Number of examples: 1460. Image Shape: 720 x 1440 x 20
2023-08-07 23:28:49,449 - root - INFO - Delta t: 6 hours
2023-08-07 23:28:49,449 - root - INFO - Including 0 hours of past history in training at a frequency of 6 hours
2023-08-07 23:28:49,450 - root - INFO - Loading trained model checkpoint from s3://climate-ai-data-science-sandbox-fourcastnet/FCN_weights_v0/backbone.ckpt
2023-08-07 23:29:42,242 - root - INFO - Loading inference data
2023-08-07 23:29:42,243 - root - INFO - Inference data from s3://climate-ai-data-science-sandbox-fourcastnet/data/out_of_sample/2018.h5
2023-08-07 23:29:42,416 - root - INFO - Initial condition 1 of 1
2023-08-07 23:29:42,726 - root - INFO - Extracting valid data from the first year
2023-08-07 23:30:13,420 - root - INFO - Standardizing data
2023-08-07 23:30:14,860 - root - INFO - Loading time means
2023-08-07 23:30:25,229 - root - INFO - Begin autoregressive inference
2023-08-07 23:30:38,847 - root - INFO - Predicted timestep 0 of 9. V10 RMS Error: 0.0, ACC: 1.0
2023-08-07 23:30:52,404 - root - INFO - Predicted timestep 1 of 9. V10 RMS Error: 0.0, ACC: 1.0
2023-08-07 23:31:06,610 - root - INFO - Predicted timestep 2 of 9. V10 RMS Error: 0.0, ACC: 1.0
2023-08-07 23:31:20,916 - root - INFO - Predicted timestep 3 of 9. V10 RMS Error: 0.0, ACC: 1.0
2023-08-07 23:31:34,447 - root - INFO - Predicted timestep 4 of 9. V10 RMS Error: 0.0, ACC: 1.0
2023-08-07 23:31:48,813 - root - INFO - Predicted timestep 5 of 9. V10 RMS Error: 0.0, ACC: 1.0
2023-08-07 23:32:04,285 - root - INFO - Predicted timestep 6 of 9. V10 RMS Error: 0.0, ACC: 1.0
2023-08-07 23:32:20,831 - root - INFO - Predicted timestep 7 of 9. V10 RMS Error: 0.0, ACC: 1.0
2023-08-07 23:32:36,232 - root - INFO - Predicted timestep 8 of 9. V10 RMS Error: 0.0, ACC: 1.0
2023-08-07 23:32:36,264 - root - INFO - Saving files at /root/FourCastNet/override_dir/random/predict-V10_ablate-V10_9-timesteps_vis.h5
